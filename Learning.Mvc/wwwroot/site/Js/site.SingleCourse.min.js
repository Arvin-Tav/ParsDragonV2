/*!
 * clipboard.js v1.7.1
 * https://zenorocha.github.io/clipboard.js
 *
 * Licensed MIT © Zeno Rocha
 */
function AddToFavorite(n) { $.get("/AddToFavorite/" + n, function () { $(".wrapper").slideUp("slow").remove(); swal("عملیات موفقیت آمیز بود", "دوره با موفقیت به علاقه مندی های شما افزوده شد", "success") }) } function VoteCourse(n) { $("#corseVote").slideUp("slow"); $.get("/Course/CourseVote/" + CourseId + "?vote=" + n, function (n) { $("#corseVote").html(n).slideDown() }) } function LoadVoteCourse(n) { $("#corseVote").load("/Course/CourseVote/" + n) } function saveDescDisLike(n) { $("#votes").val() || $.ajax({ url: "/Course/AddDescToVote/" + n, type: "GET", data: { Desc: $("#txtdescvote").val() } }).done(function () { $("#votes").hide().remove() }) } function setCourseId() { if (CourseId === undefined || CourseId === null) { var n = document.body.getElementsByTagName("script"), t = n[n.length - 1], i = t, r = i.getAttribute("class"); CourseId = r; (CourseId === undefined || CourseId === null) && (CourseId = $("#CourseId").val()) } } function loadComments() { currentCommentPageId += 1; fetch("/courses/" + CourseId + "/Comments?pageId=" + currentCommentPageId).then(function (n) { return n.text() }).then(function (n) { var u = new DOMParser, f = u.parseFromString(n, "text/html"), t, i, r; $("#CommentList").append(n); t = f.getElementsByName("CommentPageState"); t.length !== 0 ? (i = t[0].attributes.getNamedItem("pageCount").value, r = t[0].attributes.getNamedItem("currentPage").value, i === r ? $("#view-comment-more-button").remove() : $("#view-comment-more-button").show()) : $("#view-comment-more-button").remove() }) } function LoadVideoForShowLive(n, t) { $(".video-js").length > 0 && $.each($(".video-js"), function (n, t) { t.player.pause() }); $.each(Players, function (n, t) { t.pause() }); var i = t; LoadingShow("#" + i); $.ajax({ url: "/courses/GetLiveVideoToShow?episodeId=" + n, type: "Get", contentType: !1, processData: !1, success: function (n) { $("#" + i).html(n); initVideoPlayer(); LoadingHide("#" + i) }, error: function (n) { LoadingHide("#" + i); n.status === 500 && setTimeout(function (n) { SubmitForms(n) }(form), 1e3) } }) } function GetPreConstructedText(n, t) { $("#" + n).val($("#" + t).val()) } function SetCommentPrivate(n) { swal({ title: "اخطار", text: "آیا از این عملیات اطمینان دارید؟", type: "warning", showCancelButton: !0, confirmButtonClass: "btn-danger", confirmButtonText: "بله", cancelButtonText: "خیر", closeOnConfirm: !1, closeOnCancel: !1, dangerMode: !0 }).then(t => { t.value && ($("#CourseCommentChange_CommentId").val(n), $("#CourseCommentChange_IsSetPrivate").val(!0), $("#CourseCommentChange_IsSetDelete").val(!1), $("#CourseCommentChangeState").modal()) }) } function DeleteComment(n) { swal({ title: "اخطار", text: "آیا از این عملیات اطمینان دارید؟", type: "warning", showCancelButton: !0, confirmButtonClass: "btn-danger", confirmButtonText: "بله", cancelButtonText: "خیر", closeOnConfirm: !1, closeOnCancel: !1, dangerMode: !0 }).then(t => { t.value && ($("#CourseCommentChange_CommentId").val(n), $("#CourseCommentChange_IsSetPrivate").val(!1), $("#CourseCommentChange_IsSetDelete").val(!0), $("#CourseCommentChangeState").modal()) }) } function OnSuccessChangeCommentState(n) { n.status === "Done" ? ($("#Comment_" + n.data.id).remove(), location.reload(), $("#CourseCommentChangeState").modal("toggle")) : ShowAlertForResult("warning", n.message, "هشدار") } function SetComments(n) { CourseId = n } function GetComments() { $.get("/courses/" + CourseId + "/Comments", null, function (n) { $("#CommentList").html(n); var t = window.$("pre"); t.length > 0 && window.$.getScript("/Site/ckeditor/plugins/codesnippet/lib/highlight/highlight.pack.js", function () { window.$("<link/>", { rel: "stylesheet", type: "text/css", href: "/Site/ckeditor/plugins/codesnippet/lib/highlight/styles/atelier-dune.light.css" }).appendTo("head"); hljs.initHighlightingOnLoad() }) }) } function ReplyComment(n) { $("#replyIdInput").val(n); $("#commentTitle").html("پاسخ خودرا وارد کنید!"); $("#commentText").focus(); $("html,body").animate({ scrollTop: $("#TextEditorPlace").offset().top }, "slow"); timer = setInterval(change, 1e3) } function ReportComment(n) { $("#ReportModal").modal(); $("#CommentIdInput").val(n) } function change() { var n = document.getElementById("TextEditorPlace"); n.style.backgroundColor = ["orange", ""][i]; i === 1 && clearInterval(timer); i = 1 } function scrollForEpisode() { if (window.location.href.indexOf("?episodeId=") > 0) { var n = $("#ActiveEpisodeId").val(); $("html,body").animate({ scrollTop: $("#Ep_" + n).offset().top }, "slow") } } function initVideoPlayer() { if (setCourseId(), IsEpisodeView = window.location.href.indexOf("?episodeId=") > 0, document.getElementsByClassName("video-js").length !== 0) { var n = document.getElementsByClassName("video-js")[0]; $(".video-js").each(function (n, t) { var r = $(t).attr("id"), i = !1; if ($.each(Players, function (n, t) { t.id_ == r && (i = !0) }), !i) { if (player = videojs(t, { aspectRatio: "16:9", notSupportedMessage: "پشتیبانی از این فرمت انجام نمیشود!", suppressNotSupportedError: !0 }), IsEpisodeView) { player.on("ended", VideoEnded); player.on("play", VideoPlay); player.on("firstplay", VideoFirstPlay); player.on("pause", VideoPause); GetFileName(); GetEpisodeId(); SetTimeFromServer() } Players.push(player) } }); console.log(Players) } } function IntervalRun() { } function IntervalStop() { } function VideoSeeking() { console.log("Seeking") } function VideoPlay(n) { console.log(n); IntervalRun(); SendCurrentTimeToServer() } function VideoFirstPlay() { IntervalRun() } function VideoPause() { IntervalStop(); SendCurrentTimeToServer() } function VideoEnded() { IntervalStop(); SendCurrentTimeToServer() } function ChangeVideo(n, t) { SendCurrentTimeToServer(); setVideoSource("/courses/LiveFreeVideo/" + n + "/" + t); GetFileName(); GetEpisodeId(); SetTimeFromServer() } function SendCurrentTimeToServer() { var n = player.duration(), t = getVideoPosition(); n > 0 } function SetTimeFromServer() { } function GetEpisodeId() { var t = window.location.href, n = t.split("?episodeId="); EpisodeId = n[n.length - 1]; console.log(EpisodeId) } function GetFileName() { var t = getSourceFile(), n = t.split("/"); FileName = n[n.length - 1]; console.log(FileName) } function getSourceFile() { return player.currentSrc() } function setVideoSource(n) { player.src({ type: "video/mp4", src: n }) } function getVideoPosition() { return player.currentTime() } function setVideoPosition(n) { return player.currentTime(n) } var player, EpisodeId, FileName, IsEpisodeView, SendDataToServerLoop, CourseId, Players, currentCommentPageId, timer, i; !function (n) { if ("object" == typeof exports && "undefined" != typeof module) module.exports = n(); else if ("function" == typeof define && define.amd) define([], n); else { var t; t = "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this; t.Clipboard = n() } }(function () { var n; return function n(t, i, r) { function u(f, o) { var h, c, s; if (!i[f]) { if (!t[f]) { if (h = "function" == typeof require && require, !o && h) return h(f, !0); if (e) return e(f, !0); c = new Error("Cannot find module '" + f + "'"); throw c.code = "MODULE_NOT_FOUND", c; } s = i[f] = { exports: {} }; t[f][0].call(s.exports, function (n) { var i = t[f][1][n]; return u(i || n) }, s, s.exports, n, t, i, r) } return i[f].exports } for (var e = "function" == typeof require && require, f = 0; f < r.length; f++)u(r[f]); return u }({ 1: [function (n, t) { function r(n, t) { for (; n && n.nodeType !== u;) { if ("function" == typeof n.matches && n.matches(t)) return n; n = n.parentNode } } var u = 9, i; "undefined" == typeof Element || Element.prototype.matches || (i = Element.prototype, i.matches = i.matchesSelector || i.mozMatchesSelector || i.msMatchesSelector || i.oMatchesSelector || i.webkitMatchesSelector); t.exports = r }, {}], 2: [function (n, t) { function i(n, t, i, u, f) { var e = r.apply(this, arguments); return n.addEventListener(i, e, f), { destroy: function () { n.removeEventListener(i, e, f) } } } function r(n, t, i, r) { return function (i) { i.delegateTarget = u(i.target, t); i.delegateTarget && r.call(n, i) } } var u = n("./closest"); t.exports = i }, { "./closest": 1 }], 3: [function (n, t, i) { i.node = function (n) { return void 0 !== n && n instanceof HTMLElement && 1 === n.nodeType }; i.nodeList = function (n) { var t = Object.prototype.toString.call(n); return void 0 !== n && ("[object NodeList]" === t || "[object HTMLCollection]" === t) && "length" in n && (0 === n.length || i.node(n[0])) }; i.string = function (n) { return "string" == typeof n || n instanceof String }; i.fn = function (n) { return "[object Function]" === Object.prototype.toString.call(n) } }, {}], 4: [function (n, t) { function r(n, t, r) { if (!n && !t && !r) throw new Error("Missing required arguments"); if (!i.string(t)) throw new TypeError("Second argument must be a String"); if (!i.fn(r)) throw new TypeError("Third argument must be a Function"); if (i.node(n)) return u(n, t, r); if (i.nodeList(n)) return f(n, t, r); if (i.string(n)) return e(n, t, r); throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList"); } function u(n, t, i) { return n.addEventListener(t, i), { destroy: function () { n.removeEventListener(t, i) } } } function f(n, t, i) { return Array.prototype.forEach.call(n, function (n) { n.addEventListener(t, i) }), { destroy: function () { Array.prototype.forEach.call(n, function (n) { n.removeEventListener(t, i) }) } } } function e(n, t, i) { return o(document.body, n, t, i) } var i = n("./is"), o = n("delegate"); t.exports = r }, { "./is": 3, delegate: 2 }], 5: [function (n, t) { function i(n) { var t, r, i, u; return "SELECT" === n.nodeName ? (n.focus(), t = n.value) : "INPUT" === n.nodeName || "TEXTAREA" === n.nodeName ? (r = n.hasAttribute("readonly"), r || n.setAttribute("readonly", ""), n.select(), n.setSelectionRange(0, n.value.length), r || n.removeAttribute("readonly"), t = n.value) : (n.hasAttribute("contenteditable") && n.focus(), i = window.getSelection(), u = document.createRange(), u.selectNodeContents(n), i.removeAllRanges(), i.addRange(u), t = i.toString()), t } t.exports = i }, {}], 6: [function (n, t) { function i() { } i.prototype = { on: function (n, t, i) { var r = this.e || (this.e = {}); return (r[n] || (r[n] = [])).push({ fn: t, ctx: i }), this }, once: function (n, t, i) { function r() { u.off(n, r); t.apply(i, arguments) } var u = this; return r._ = t, this.on(n, r, i) }, emit: function (n) { var r = [].slice.call(arguments, 1), i = ((this.e || (this.e = {}))[n] || []).slice(), t = 0, u = i.length; for (t; t < u; t++)i[t].fn.apply(i[t].ctx, r); return this }, off: function (n, t) { var u = this.e || (this.e = {}), r = u[n], f = [], i, e; if (r && t) for (i = 0, e = r.length; i < e; i++)r[i].fn !== t && r[i].fn._ !== t && f.push(r[i]); return f.length ? u[n] = f : delete u[n], this } }; t.exports = i }, {}], 7: [function (t, i, r) { !function (u, f) { if ("function" == typeof n && n.amd) n(["module", "select"], f); else if (void 0 !== r) f(i, t("select")); else { var e = { exports: {} }; f(e, u.select); u.clipboardAction = e.exports } }(this, function (n, t) { "use strict"; function r(n) { return n && n.__esModule ? n : { "default": n } } function u(n, t) { if (!(n instanceof t)) throw new TypeError("Cannot call a class as a function"); } var i = r(t), f = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (n) { return typeof n } : function (n) { return n && "function" == typeof Symbol && n.constructor === Symbol && n !== Symbol.prototype ? "symbol" : typeof n }, e = function () { function n(n, t) { for (var i, r = 0; r < t.length; r++)i = t[r], i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(n, i.key, i) } return function (t, i, r) { return i && n(t.prototype, i), r && n(t, r), t } }(), o = function () { function n(t) { u(this, n); this.resolveOptions(t); this.initSelection() } return e(n, [{ key: "resolveOptions", value: function () { var n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; this.action = n.action; this.container = n.container; this.emitter = n.emitter; this.target = n.target; this.text = n.text; this.trigger = n.trigger; this.selectedText = "" } }, { key: "initSelection", value: function () { this.text ? this.selectFake() : this.target && this.selectTarget() } }, { key: "selectFake", value: function () { var t = this, r = "rtl" == document.documentElement.getAttribute("dir"), n; this.removeFake(); this.fakeHandlerCallback = function () { return t.removeFake() }; this.fakeHandler = this.container.addEventListener("click", this.fakeHandlerCallback) || !0; this.fakeElem = document.createElement("textarea"); this.fakeElem.style.fontSize = "12pt"; this.fakeElem.style.border = "0"; this.fakeElem.style.padding = "0"; this.fakeElem.style.margin = "0"; this.fakeElem.style.position = "absolute"; this.fakeElem.style[r ? "right" : "left"] = "-9999px"; n = window.pageYOffset || document.documentElement.scrollTop; this.fakeElem.style.top = n + "px"; this.fakeElem.setAttribute("readonly", ""); this.fakeElem.value = this.text; this.container.appendChild(this.fakeElem); this.selectedText = i.default(this.fakeElem); this.copyText() } }, { key: "removeFake", value: function () { this.fakeHandler && (this.container.removeEventListener("click", this.fakeHandlerCallback), this.fakeHandler = null, this.fakeHandlerCallback = null); this.fakeElem && (this.container.removeChild(this.fakeElem), this.fakeElem = null) } }, { key: "selectTarget", value: function () { this.selectedText = i.default(this.target); this.copyText() } }, { key: "copyText", value: function () { var n = void 0; try { n = document.execCommand(this.action) } catch (t) { n = !1 } this.handleResult(n) } }, { key: "handleResult", value: function (n) { this.emitter.emit(n ? "success" : "error", { action: this.action, text: this.selectedText, trigger: this.trigger, clearSelection: this.clearSelection.bind(this) }) } }, { key: "clearSelection", value: function () { this.trigger && this.trigger.focus(); window.getSelection().removeAllRanges() } }, { key: "destroy", value: function () { this.removeFake() } }, { key: "action", set: function () { var n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "copy"; if (this._action = n, "copy" !== this._action && "cut" !== this._action) throw new Error('Invalid "action" value, use either "copy" or "cut"'); }, get: function () { return this._action } }, { key: "target", set: function (n) { if (void 0 !== n) { if (!n || "object" !== (void 0 === n ? "undefined" : f(n)) || 1 !== n.nodeType) throw new Error('Invalid "target" value, use a valid Element'); if ("copy" === this.action && n.hasAttribute("disabled")) throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute'); if ("cut" === this.action && (n.hasAttribute("readonly") || n.hasAttribute("disabled"))) throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes'); this._target = n } }, get: function () { return this._target } }]), n }(); n.exports = o }) }, { select: 5 }], 8: [function (t, i, r) { !function (u, f) { if ("function" == typeof n && n.amd) n(["module", "./clipboard-action", "tiny-emitter", "good-listener"], f); else if (void 0 !== r) f(i, t("./clipboard-action"), t("tiny-emitter"), t("good-listener")); else { var e = { exports: {} }; f(e, u.clipboardAction, u.tinyEmitter, u.goodListener); u.clipboard = e.exports } }(this, function (n, t, i, r) { "use strict"; function u(n) { return n && n.__esModule ? n : { "default": n } } function e(n, t) { if (!(n instanceof t)) throw new TypeError("Cannot call a class as a function"); } function o(n, t) { if (!n) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? n : t } function s(n, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); n.prototype = Object.create(t && t.prototype, { constructor: { value: n, enumerable: !1, writable: !0, configurable: !0 } }); t && (Object.setPrototypeOf ? Object.setPrototypeOf(n, t) : n.__proto__ = t) } function f(n, t) { var i = "data-clipboard-" + n; if (t.hasAttribute(i)) return t.getAttribute(i) } var h = u(t), c = u(i), l = u(r), a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (n) { return typeof n } : function (n) { return n && "function" == typeof Symbol && n.constructor === Symbol && n !== Symbol.prototype ? "symbol" : typeof n }, v = function () { function n(n, t) { for (var i, r = 0; r < t.length; r++)i = t[r], i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(n, i.key, i) } return function (t, i, r) { return i && n(t.prototype, i), r && n(t, r), t } }(), y = function (n) { function t(n, i) { e(this, t); var r = o(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)); return r.resolveOptions(i), r.listenClick(n), r } return s(t, n), v(t, [{ key: "resolveOptions", value: function () { var n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; this.action = "function" == typeof n.action ? n.action : this.defaultAction; this.target = "function" == typeof n.target ? n.target : this.defaultTarget; this.text = "function" == typeof n.text ? n.text : this.defaultText; this.container = "object" === a(n.container) ? n.container : document.body } }, { key: "listenClick", value: function (n) { var t = this; this.listener = l.default(n, "click", function (n) { return t.onClick(n) }) } }, { key: "onClick", value: function (n) { var t = n.delegateTarget || n.currentTarget; this.clipboardAction && (this.clipboardAction = null); this.clipboardAction = new h.default({ action: this.action(t), target: this.target(t), text: this.text(t), container: this.container, trigger: t, emitter: this }) } }, { key: "defaultAction", value: function (n) { return f("action", n) } }, { key: "defaultTarget", value: function (n) { var t = f("target", n); if (t) return document.querySelector(t) } }, { key: "defaultText", value: function (n) { return f("text", n) } }, { key: "destroy", value: function () { this.listener.destroy(); this.clipboardAction && (this.clipboardAction.destroy(), this.clipboardAction = null) } }], [{ key: "isSupported", value: function () { var n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : ["copy", "cut"], i = "string" == typeof n ? [n] : n, t = !!document.queryCommandSupported; return i.forEach(function (n) { t = t && !!document.queryCommandSupported(n) }), t } }]), t }(c.default); n.exports = y }) }, { "./clipboard-action": 7, "good-listener": 4, "tiny-emitter": 6 }] }, {}, [8])(8) }); $(function () { new Clipboard(".copy-btn"); $(".copy-btn").click(function () { var n = $(this); $(this).addClass("copied"); setTimeout(function () { $(n).removeClass("copied") }, 1e3) }); $(".video-items-layer .video-item > .view-description").bind("touchstart", function () { $(".video-items-layer .video-item .video-description-layer").css("display", "none"); $(this).parents().closest(".video-item").find(".video-description-layer").fadeIn("fast") }); $("html,body").on("click", function (n) { $(n.target).parents().hasClass("view-description") || $(".video-items-layer .video-item .video-description-layer").fadeOut("fast") }); $(document).on("click", ".video-items-layer .video-item > .view-description", function () { $(".video-items-layer .video-item .video-description-layer").css("display", "none"); $(this).parents().closest(".video-item").find(".video-description-layer").fadeIn("fast") }) }); $(".btnScrollToComments").click(function () { $("html, body").animate({ scrollTop: $(".comments-layer").offset().top }, 2e3) }); $(function () { $.ajax({ url: "/Course/GetCoursesAcademy", type: "Get" }).done(function (n) { $("#rightSideCourse").append(n) }) });
/*!
 * Infinite Scroll PACKAGED v3.0.6
 * Automatically add next page
 *
 * Licensed GPLv3 for open source use
 * or Infinite Scroll Commercial License for commercial use
 *
 * https://infinite-scroll.com
 * Copyright 2018 Metafizzy
 */
!function (n, t) { "function" == typeof define && define.amd ? define("jquery-bridget/jquery-bridget", ["jquery"], function (i) { return t(n, i) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("jquery")) : n.jQueryBridget = t(n, n.jQuery) }(window, function (n, t) { "use strict"; function i(i, u, o) { function s(n, t, r) { var u, e = "$()." + i + '("' + t + '")'; return n.each(function (n, s) { var h = o.data(s, i), c, l; if (!h) return void f(i + " not initialized. Cannot call methods, i.e. " + e); if (c = h[t], !c || "_" == t.charAt(0)) return void f(e + " is not a valid method"); l = c.apply(h, r); u = void 0 === u ? l : u }), void 0 !== u ? u : n } function h(n, t) { n.each(function (n, r) { var f = o.data(r, i); f ? (f.option(t), f._init()) : (f = new u(r, t), o.data(r, i, f)) }) } o = o || t || n.jQuery; o && (u.prototype.option || (u.prototype.option = function (n) { o.isPlainObject(n) && (this.options = o.extend(!0, this.options, n)) }), o.fn[i] = function (n) { if ("string" == typeof n) { var t = e.call(arguments, 1); return s(this, n, t) } return h(this, n), this }, r(o)) } function r(n) { !n || n && n.bridget || (n.bridget = i) } var e = Array.prototype.slice, u = n.console, f = "undefined" == typeof u ? function () { } : function (n) { u.error(n) }; return r(t || n.jQuery), i }), function (n, t) { "function" == typeof define && define.amd ? define("ev-emitter/ev-emitter", t) : "object" == typeof module && module.exports ? module.exports = t() : n.EvEmitter = t() }("undefined" != typeof window ? window : this, function () { function t() { } var n = t.prototype; return n.on = function (n, t) { if (n && t) { var i = this._events = this._events || {}, r = i[n] = i[n] || []; return r.indexOf(t) == -1 && r.push(t), this } }, n.once = function (n, t) { if (n && t) { this.on(n, t); var i = this._onceEvents = this._onceEvents || {}, r = i[n] = i[n] || {}; return r[t] = !0, this } }, n.off = function (n, t) { var i = this._events && this._events[n], r; if (i && i.length) return r = i.indexOf(t), r != -1 && i.splice(r, 1), this }, n.emitEvent = function (n, t) { var i = this._events && this._events[n], u, f, r, e; if (i && i.length) { for (i = i.slice(0), t = t || [], u = this._onceEvents && this._onceEvents[n], f = 0; f < i.length; f++)r = i[f], e = u && u[r], e && (this.off(n, r), delete u[r]), r.apply(this, t); return this } }, n.allOff = function () { delete this._events; delete this._onceEvents }, t }), function (n, t) { "use strict"; "function" == typeof define && define.amd ? define("desandro-matches-selector/matches-selector", t) : "object" == typeof module && module.exports ? module.exports = t() : n.matchesSelector = t() }(window, function () { "use strict"; var n = function () { var t = window.Element.prototype, i, n, u, r; if (t.matches) return "matches"; if (t.matchesSelector) return "matchesSelector"; for (i = ["webkit", "moz", "ms", "o"], n = 0; n < i.length; n++)if (u = i[n], r = u + "MatchesSelector", t[r]) return r }(); return function (t, i) { return t[n](i) } }), function (n, t) { "function" == typeof define && define.amd ? define("fizzy-ui-utils/utils", ["desandro-matches-selector/matches-selector"], function (i) { return t(n, i) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("desandro-matches-selector")) : n.fizzyUIUtils = t(n, n.matchesSelector) }(window, function (n, t) { var i = {}, u, r; return i.extend = function (n, t) { for (var i in t) n[i] = t[i]; return n }, i.modulo = function (n, t) { return (n % t + t) % t }, u = Array.prototype.slice, i.makeArray = function (n) { if (Array.isArray(n)) return n; if (null === n || void 0 === n) return []; var t = "object" == typeof n && "number" == typeof n.length; return t ? u.call(n) : [n] }, i.removeFrom = function (n, t) { var i = n.indexOf(t); i != -1 && n.splice(i, 1) }, i.getParent = function (n, i) { for (; n.parentNode && n != document.body;)if (n = n.parentNode, t(n, i)) return n }, i.getQueryElement = function (n) { return "string" == typeof n ? document.querySelector(n) : n }, i.handleEvent = function (n) { var t = "on" + n.type; this[t] && this[t](n) }, i.filterFindElements = function (n, r) { n = i.makeArray(n); var u = []; return n.forEach(function (n) { if (n instanceof HTMLElement) { if (!r) return void u.push(n); t(n, r) && u.push(n); for (var f = n.querySelectorAll(r), i = 0; i < f.length; i++)u.push(f[i]) } }), u }, i.debounceMethod = function (n, t, i) { i = i || 100; var u = n.prototype[t], r = t + "Timeout"; n.prototype[t] = function () { var f = this[r], t, n; clearTimeout(f); t = arguments; n = this; this[r] = setTimeout(function () { u.apply(n, t); delete n[r] }, i) } }, i.docReady = function (n) { var t = document.readyState; "complete" == t || "interactive" == t ? setTimeout(n) : document.addEventListener("DOMContentLoaded", n) }, i.toDashed = function (n) { return n.replace(/(.)([A-Z])/g, function (n, t, i) { return t + "-" + i }).toLowerCase() }, r = n.console, i.htmlInit = function (t, u) { i.docReady(function () { var e = i.toDashed(u), f = "data-" + e, s = document.querySelectorAll("[" + f + "]"), h = document.querySelectorAll(".js-" + e), c = i.makeArray(s).concat(i.makeArray(h)), l = f + "-options", o = n.jQuery; c.forEach(function (n) { var i, e = n.getAttribute(f) || n.getAttribute(l), s; try { i = e && JSON.parse(e) } catch (h) { return void (r && r.error("Error parsing " + f + " on " + n.className + ": " + h)) } s = new t(n, i); o && o.data(n, u, s) }) }) }, i }), function (n, t) { "function" == typeof define && define.amd ? define("infinite-scroll/js/core", ["ev-emitter/ev-emitter", "fizzy-ui-utils/utils"], function (i, r) { return t(n, i, r) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("ev-emitter"), require("fizzy-ui-utils")) : n.InfiniteScroll = t(n, n.EvEmitter, n.fizzyUIUtils) }(window, function (n, t, i) { function r(n, t) { var u = i.getQueryElement(n), o; if (!u) return void console.error("Bad element for InfiniteScroll: " + (u || n)); if (n = u, n.infiniteScrollGUID) return o = e[n.infiniteScrollGUID], o.option(t), o; this.element = n; this.options = i.extend({}, r.defaults); this.option(t); f && (this.$element = f(this.element)); this.create() } var f = n.jQuery, e = {}, u, s, h, o; return r.defaults = {}, r.create = {}, r.destroy = {}, u = r.prototype, i.extend(u, t.prototype), s = 0, u.create = function () { var n = this.guid = ++s, t, i; if (this.element.infiniteScrollGUID = n, e[n] = this, this.pageIndex = 1, this.loadCount = 0, this.updateGetPath(), t = this.getPath && this.getPath(), !t) return void console.error("Disabling InfiniteScroll"); this.updateGetAbsolutePath(); this.log("initialized", [this.element.className]); this.callOnInit(); for (i in r.create) r.create[i].call(this) }, u.option = function (n) { i.extend(this.options, n) }, u.callOnInit = function () { var n = this.options.onInit; n && n.call(this, this) }, u.dispatchEvent = function (n, t, i) { var e, r, u; this.log(n, i); e = t ? [t].concat(i) : i; (this.emitEvent(n, e), f && this.$element) && (n += ".infiniteScroll", r = n, t && (u = f.Event(t), u.type = n, r = u), this.$element.trigger(r, i)) }, h = { initialized: function (n) { return "on " + n }, request: function (n) { return "URL: " + n }, load: function (n, t) { return (n.title || "") + ". URL: " + t }, error: function (n, t) { return n + ". URL: " + t }, append: function (n, t, i) { return i.length + " items. URL: " + t }, last: function (n, t) { return "URL: " + t }, history: function (n, t) { return "URL: " + t }, pageIndex: function (n, t) { return "current page determined to be: " + n + " from " + t } }, u.log = function (n, t) { if (this.options.debug) { var i = "[InfiniteScroll] " + n, r = h[n]; r && (i += ". " + r.apply(this, t)); console.log(i) } }, u.updateMeasurements = function () { this.windowHeight = n.innerHeight; var t = this.element.getBoundingClientRect(); this.top = t.top + n.pageYOffset }, u.updateScroller = function () { var t = this.options.elementScroll; if (!t) return void (this.scroller = n); if (this.scroller = t === !0 ? this.element : i.getQueryElement(t), !this.scroller) throw "Unable to find elementScroll: " + t; }, u.updateGetPath = function () { var n = this.options.path, t, i; return n ? (t = typeof n, "function" == t) ? void (this.getPath = n) : (i = "string" == t && n.match("{{#}}"), i ? void this.updateGetPathTemplate(n) : void this.updateGetPathSelector(n)) : void console.error("InfiniteScroll path option required. Set as: " + n) }, u.updateGetPathTemplate = function (n) { this.getPath = function () { var t = this.pageIndex + 1; return n.replace("{{#}}", t) }.bind(this); var i = n.replace(/(\\\?|\?)/, "\\?").replace("{{#}}", "(\\d\\d?\\d?)"), r = new RegExp(i), t = location.href.match(r); t && (this.pageIndex = parseInt(t[1], 10), this.log("pageIndex", [this.pageIndex, "template string"])) }, o = [/^(.*?\/?page\/?)(\d\d?\d?)(.*?$)/, /^(.*?\/?\?page=)(\d\d?\d?)(.*?$)/, /(.*?)(\d\d?\d?)(?!.*\d)(.*?$)/], u.updateGetPathSelector = function (n) { var f = document.querySelector(n), t, e, i, r, u; if (!f) return void console.error("Bad InfiniteScroll path option. Next link not found: " + n); for (i = f.getAttribute("href"), r = 0; i && r < o.length; r++)if (e = o[r], u = i.match(e), u) { t = u.slice(1); break } return t ? (this.isPathSelector = !0, this.getPath = function () { var n = this.pageIndex + 1; return t[0] + n + t[2] }.bind(this), this.pageIndex = parseInt(t[1], 10) - 1, void this.log("pageIndex", [this.pageIndex, "next link"])) : void console.error("InfiniteScroll unable to parse next link href: " + i) }, u.updateGetAbsolutePath = function () { var t = this.getPath(), u = t.match(/^http/) || t.match(/^\//), n, i, r; if (u) return void (this.getAbsolutePath = this.getPath); if (n = location.pathname, i = t.match(/^\?/), i) return void (this.getAbsolutePath = function () { return n + this.getPath() }); r = n.substring(0, n.lastIndexOf("/")); this.getAbsolutePath = function () { return r + "/" + this.getPath() } }, r.create.hideNav = function () { var n = i.getQueryElement(this.options.hideNav); n && (n.style.display = "none", this.nav = n) }, r.destroy.hideNav = function () { this.nav && (this.nav.style.display = "") }, u.destroy = function () { this.allOff(); for (var n in r.destroy) r.destroy[n].call(this); delete this.element.infiniteScrollGUID; delete e[this.guid]; f && this.$element && f.removeData(this.element, "infiniteScroll") }, r.throttle = function (n, t) { t = t || 200; var i, r; return function () { var u = +new Date, e = arguments, f = function () { i = u; n.apply(this, e) }.bind(this); i && u < i + t ? (clearTimeout(r), r = setTimeout(f, t)) : f() } }, r.data = function (n) { n = i.getQueryElement(n); var t = n && n.infiniteScrollGUID; return t && e[t] }, r.setJQuery = function (n) { f = n }, i.htmlInit(r, "infinite-scroll"), u._init = function () { }, f && f.bridget && f.bridget("infiniteScroll", r), r }), function (n, t) { "function" == typeof define && define.amd ? define("infinite-scroll/js/page-load", ["./core"], function (i) { return t(n, i) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("./core")) : t(n, n.InfiniteScroll) }(window, function (n, t) { function r(n) { for (var i = document.createDocumentFragment(), t = 0; n && t < n.length; t++)i.appendChild(n[t]); return i } function u(n) { for (var t, r, u = n.querySelectorAll("script"), i = 0; i < u.length; i++)t = u[i], r = document.createElement("script"), f(t, r), r.innerHTML = t.innerHTML, t.parentNode.replaceChild(r, t) } function f(n, t) { for (var u, r = n.attributes, i = 0; i < r.length; i++)u = r[i], t.setAttribute(u.name, u.value) } function e(n, t, i, r, u) { var f = new XMLHttpRequest; f.open("GET", n, !0); f.responseType = t || ""; f.setRequestHeader("X-Requested-With", "XMLHttpRequest"); f.onload = function () { if (200 == f.status) i(f.response); else if (204 == f.status) u(f.response); else { var n = new Error(f.statusText); r(n) } }; f.onerror = function () { var t = new Error("Network error requesting " + n); r(t) }; f.send() } var i = t.prototype; return t.defaults.loadOnScroll = !0, t.defaults.checkLastPage = !0, t.defaults.responseType = "document", t.create.pageLoad = function () { this.canLoad = !0; this.on("scrollThreshold", this.onScrollThresholdLoad); this.on("load", this.checkLastPage); this.options.outlayer && this.on("append", this.onAppendOutlayer) }, i.onScrollThresholdLoad = function () { this.options.loadOnScroll && this.loadNextPage() }, i.loadNextPage = function () { var n; if (!this.isLoading && this.canLoad) { n = this.getAbsolutePath(); this.isLoading = !0; var t = function (t) { this.onPageLoad(t, n) }.bind(this), i = function (t) { this.onPageError(t, n) }.bind(this), r = function (t) { this.lastPageReached(t, n) }.bind(this); e(n, this.options.responseType, t, i, r); this.dispatchEvent("request", null, [n]) } }, i.onPageLoad = function (n, t) { return this.options.append || (this.isLoading = !1), this.pageIndex++, this.loadCount++, this.dispatchEvent("load", null, [n, t]), this.appendNextPage(n, t), n }, i.appendNextPage = function (n, t) { var u = this.options.append, o = "document" == this.options.responseType; if (o && u) { var i = n.querySelectorAll(u), f = r(i), e = function () { this.appendItems(i, f); this.isLoading = !1; this.dispatchEvent("append", null, [n, t, i]) }.bind(this); this.options.outlayer ? this.appendOutlayerItems(f, e) : e() } }, i.appendItems = function (n, t) { n && n.length && (t = t || r(n), u(t), this.element.appendChild(t)) }, i.appendOutlayerItems = function (i, r) { var u = t.imagesLoaded || n.imagesLoaded; return u ? void u(i, r) : (console.error("[InfiniteScroll] imagesLoaded required for outlayer option"), void (this.isLoading = !1)) }, i.onAppendOutlayer = function (n, t, i) { this.options.outlayer.appended(i) }, i.checkLastPage = function (n, t) { var r = this.options.checkLastPage, u, f, i, e; if (r) { if (u = this.options.path, "function" == typeof u && (f = this.getPath(), !f)) return void this.lastPageReached(n, t); ("string" == typeof r ? i = r : this.isPathSelector && (i = u), i && n.querySelector) && (e = n.querySelector(i), e || this.lastPageReached(n, t)) } }, i.lastPageReached = function (n, t) { this.canLoad = !1; this.dispatchEvent("last", null, [n, t]) }, i.onPageError = function (n, t) { return this.isLoading = !1, this.canLoad = !1, this.dispatchEvent("error", null, [n, t]), n }, t.create.prefill = function () { if (this.options.prefill) { var n = this.options.append; if (!n) return void console.error("append option required for prefill. Set as :" + n); this.updateMeasurements(); this.updateScroller(); this.isPrefilling = !0; this.on("append", this.prefill); this.once("error", this.stopPrefill); this.once("last", this.stopPrefill); this.prefill() } }, i.prefill = function () { var n = this.getPrefillDistance(); this.isPrefilling = n >= 0; this.isPrefilling ? (this.log("prefill"), this.loadNextPage()) : this.stopPrefill() }, i.getPrefillDistance = function () { return this.options.elementScroll ? this.scroller.clientHeight - this.scroller.scrollHeight : this.windowHeight - this.element.clientHeight }, i.stopPrefill = function () { this.log("stopPrefill"); this.off("append", this.prefill) }, t }), function (n, t) { "function" == typeof define && define.amd ? define("infinite-scroll/js/scroll-watch", ["./core", "fizzy-ui-utils/utils"], function (i, r) { return t(n, i, r) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("./core"), require("fizzy-ui-utils")) : t(n, n.InfiniteScroll, n.fizzyUIUtils) }(window, function (n, t, i) { var r = t.prototype; return t.defaults.scrollThreshold = 400, t.create.scrollWatch = function () { this.pageScrollHandler = this.onPageScroll.bind(this); this.resizeHandler = this.onResize.bind(this); var n = this.options.scrollThreshold, t = n || 0 === n; t && this.enableScrollWatch() }, t.destroy.scrollWatch = function () { this.disableScrollWatch() }, r.enableScrollWatch = function () { this.isScrollWatching || (this.isScrollWatching = !0, this.updateMeasurements(), this.updateScroller(), this.on("last", this.disableScrollWatch), this.bindScrollWatchEvents(!0)) }, r.disableScrollWatch = function () { this.isScrollWatching && (this.bindScrollWatchEvents(!1), delete this.isScrollWatching) }, r.bindScrollWatchEvents = function (t) { var i = t ? "addEventListener" : "removeEventListener"; this.scroller[i]("scroll", this.pageScrollHandler); n[i]("resize", this.resizeHandler) }, r.onPageScroll = t.throttle(function () { var n = this.getBottomDistance(); n <= this.options.scrollThreshold && this.dispatchEvent("scrollThreshold") }), r.getBottomDistance = function () { return this.options.elementScroll ? this.getElementBottomDistance() : this.getWindowBottomDistance() }, r.getWindowBottomDistance = function () { var t = this.top + this.element.clientHeight, i = n.pageYOffset + this.windowHeight; return t - i }, r.getElementBottomDistance = function () { var n = this.scroller.scrollHeight, t = this.scroller.scrollTop + this.scroller.clientHeight; return n - t }, r.onResize = function () { this.updateMeasurements() }, i.debounceMethod(t, "onResize", 150), t }), function (n, t) { "function" == typeof define && define.amd ? define("infinite-scroll/js/history", ["./core", "fizzy-ui-utils/utils"], function (i, r) { return t(n, i, r) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("./core"), require("fizzy-ui-utils")) : t(n, n.InfiniteScroll, n.fizzyUIUtils) }(window, function (n, t, i) { var r = t.prototype, u; return t.defaults.history = "replace", u = document.createElement("a"), t.create.history = function () { if (this.options.history) { u.href = this.getAbsolutePath(); var n = u.origin || u.protocol + "//" + u.host, t = n == location.origin; return t ? void (this.options.append ? this.createHistoryAppend() : this.createHistoryPageLoad()) : void console.error("[InfiniteScroll] cannot set history with different origin: " + u.origin + " on " + location.origin + " . History behavior disabled.") } }, r.createHistoryAppend = function () { this.updateMeasurements(); this.updateScroller(); this.scrollPages = [{ top: 0, path: location.href, title: document.title }]; this.scrollPageIndex = 0; this.scrollHistoryHandler = this.onScrollHistory.bind(this); this.unloadHandler = this.onUnload.bind(this); this.scroller.addEventListener("scroll", this.scrollHistoryHandler); this.on("append", this.onAppendHistory); this.bindHistoryAppendEvents(!0) }, r.bindHistoryAppendEvents = function (t) { var i = t ? "addEventListener" : "removeEventListener"; this.scroller[i]("scroll", this.scrollHistoryHandler); n[i]("unload", this.unloadHandler) }, r.createHistoryPageLoad = function () { this.on("load", this.onPageLoadHistory) }, t.destroy.history = r.destroyHistory = function () { var n = this.options.history && this.options.append; n && this.bindHistoryAppendEvents(!1) }, r.onAppendHistory = function (n, t, i) { if (i && i.length) { var r = i[0], f = this.getElementScrollY(r); u.href = t; this.scrollPages.push({ top: f, path: u.href, title: n.title }) } }, r.getElementScrollY = function (n) { return this.options.elementScroll ? this.getElementElementScrollY(n) : this.getElementWindowScrollY(n) }, r.getElementWindowScrollY = function (t) { var i = t.getBoundingClientRect(); return i.top + n.pageYOffset }, r.getElementElementScrollY = function (n) { return n.offsetTop - this.top }, r.onScrollHistory = function () { for (var t, i, r, u = this.getScrollViewY(), n = 0; n < this.scrollPages.length; n++) { if (r = this.scrollPages[n], r.top >= u) break; t = n; i = r } t != this.scrollPageIndex && (this.scrollPageIndex = t, this.setHistory(i.title, i.path)) }, i.debounceMethod(t, "onScrollHistory", 150), r.getScrollViewY = function () { return this.options.elementScroll ? this.scroller.scrollTop + this.scroller.clientHeight / 2 : n.pageYOffset + this.windowHeight / 2 }, r.setHistory = function (n, t) { var i = this.options.history, r = i && history[i + "State"]; r && (history[i + "State"](null, n, t), this.options.historyTitle && (document.title = n), this.dispatchEvent("history", null, [n, t])) }, r.onUnload = function () { var t = this.scrollPageIndex, i, r; 0 !== t && (i = this.scrollPages[t], r = n.pageYOffset - i.top + this.top, this.destroyHistory(), scrollTo(0, r)) }, r.onPageLoadHistory = function (n, t) { this.setHistory(n.title, t) }, t }), function (n, t) { "function" == typeof define && define.amd ? define("infinite-scroll/js/button", ["./core", "fizzy-ui-utils/utils"], function (i, r) { return t(n, i, r) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("./core"), require("fizzy-ui-utils")) : t(n, n.InfiniteScroll, n.fizzyUIUtils) }(window, function (n, t, i) { function r(n, t) { this.element = n; this.infScroll = t; this.clickHandler = this.onClick.bind(this); this.element.addEventListener("click", this.clickHandler); t.on("request", this.disable.bind(this)); t.on("load", this.enable.bind(this)); t.on("error", this.hide.bind(this)); t.on("last", this.hide.bind(this)) } return t.create.button = function () { var n = i.getQueryElement(this.options.button); n }, t.destroy.button = function () { this.button && this.button.destroy() }, r.prototype.onClick = function (n) { n.preventDefault(); this.infScroll.loadNextPage() }, r.prototype.enable = function () { this.element.removeAttribute("disabled") }, r.prototype.disable = function () { this.element.disabled = "disabled" }, r.prototype.hide = function () { this.element.style.display = "none" }, r.prototype.destroy = function () { this.element.removeEventListener("click", this.clickHandler) }, t.Button = r, t }), function (n, t) { "function" == typeof define && define.amd ? define("infinite-scroll/js/status", ["./core", "fizzy-ui-utils/utils"], function (i, r) { return t(n, i, r) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("./core"), require("fizzy-ui-utils")) : t(n, n.InfiniteScroll, n.fizzyUIUtils) }(window, function (n, t, i) { function u(n) { e(n, "none") } function f(n) { e(n, "block") } function e(n, t) { n && (n.style.display = t) } var r = t.prototype; return t.create.status = function () { var n = i.getQueryElement(this.options.status); n && (this.statusElement = n, this.statusEventElements = { request: n.querySelector(".infinite-scroll-request"), error: n.querySelector(".infinite-scroll-error"), last: n.querySelector(".infinite-scroll-last") }, this.on("request", this.showRequestStatus), this.on("error", this.showErrorStatus), this.on("last", this.showLastStatus), this.bindHideStatus("on")) }, r.bindHideStatus = function (n) { var t = this.options.append ? "append" : "load"; this[n](t, this.hideAllStatus) }, r.showRequestStatus = function () { this.showStatus("request") }, r.showErrorStatus = function () { this.showStatus("error") }, r.showLastStatus = function () { this.showStatus("last"); this.bindHideStatus("off") }, r.showStatus = function (n) { f(this.statusElement); this.hideStatusEventElements(); var t = this.statusEventElements[n]; f(t) }, r.hideAllStatus = function () { u(this.statusElement); this.hideStatusEventElements() }, r.hideStatusEventElements = function () { var n, t; for (n in this.statusEventElements) t = this.statusEventElements[n], u(t) }, t }), function (n, t) { "function" == typeof define && define.amd ? define(["infinite-scroll/js/core", "infinite-scroll/js/page-load", "infinite-scroll/js/scroll-watch", "infinite-scroll/js/history", "infinite-scroll/js/button", "infinite-scroll/js/status"], t) : "object" == typeof module && module.exports && (module.exports = t(require("./core"), require("./page-load"), require("./scroll-watch"), require("./history"), require("./button"), require("./status"))) }(window, function (n) { return n }), function (n, t) { "use strict"; "function" == typeof define && define.amd ? define("imagesloaded/imagesloaded", ["ev-emitter/ev-emitter"], function (i) { return t(n, i) }) : "object" == typeof module && module.exports ? module.exports = t(n, require("ev-emitter")) : n.imagesLoaded = t(n, n.EvEmitter) }("undefined" != typeof window ? window : this, function (n, t) { function o(n, t) { for (var i in t) n[i] = t[i]; return n } function h(n) { if (Array.isArray(n)) return n; var t = "object" == typeof n && "number" == typeof n.length; return t ? c.call(n) : [n] } function i(n, t, r) { if (!(this instanceof i)) return new i(n, t, r); var u = n; return "string" == typeof n && (u = document.querySelectorAll(n)), u ? (this.elements = h(u), this.options = o({}, this.options), "function" == typeof t ? r = t : o(this.options, t), r && this.on("always", r), this.getImages(), f && (this.jqDeferred = new f.Deferred), void setTimeout(this.check.bind(this))) : void e.error("Bad element for imagesLoaded " + (u || n)) } function r(n) { this.img = n } function u(n, t) { this.url = n; this.element = t; this.img = new Image } var f = n.jQuery, e = n.console, c = Array.prototype.slice, s; return i.prototype = Object.create(t.prototype), i.prototype.options = {}, i.prototype.getImages = function () { this.images = []; this.elements.forEach(this.addElementImages, this) }, i.prototype.addElementImages = function (n) { var i, r, t, f, u, e; if ("IMG" == n.nodeName && this.addImage(n), this.options.background === !0 && this.addElementBackgroundImages(n), i = n.nodeType, i && s[i]) { for (r = n.querySelectorAll("img"), t = 0; t < r.length; t++)f = r[t], this.addImage(f); if ("string" == typeof this.options.background) for (u = n.querySelectorAll(this.options.background), t = 0; t < u.length; t++)e = u[t], this.addElementBackgroundImages(e) } }, s = { 1: !0, 9: !0, 11: !0 }, i.prototype.addElementBackgroundImages = function (n) { var i = getComputedStyle(n), r, t, u; if (i) for (r = /url\((['"])?(.*?)\1\)/gi, t = r.exec(i.backgroundImage); null !== t;)u = t && t[2], u && this.addBackground(u, n), t = r.exec(i.backgroundImage) }, i.prototype.addImage = function (n) { var t = new r(n); this.images.push(t) }, i.prototype.addBackground = function (n, t) { var i = new u(n, t); this.images.push(i) }, i.prototype.check = function () { function n(n, i, r) { setTimeout(function () { t.progress(n, i, r) }) } var t = this; return this.progressedCount = 0, this.hasAnyBroken = !1, this.images.length ? void this.images.forEach(function (t) { t.once("progress", n); t.check() }) : void this.complete() }, i.prototype.progress = function (n, t, i) { this.progressedCount++; this.hasAnyBroken = this.hasAnyBroken || !n.isLoaded; this.emitEvent("progress", [this, n, t]); this.jqDeferred && this.jqDeferred.notify && this.jqDeferred.notify(this, n); this.progressedCount == this.images.length && this.complete(); this.options.debug && e && e.log("progress: " + i, n, t) }, i.prototype.complete = function () { var t = this.hasAnyBroken ? "fail" : "done", n; (this.isComplete = !0, this.emitEvent(t, [this]), this.emitEvent("always", [this]), this.jqDeferred) && (n = this.hasAnyBroken ? "reject" : "resolve", this.jqDeferred[n](this)) }, r.prototype = Object.create(t.prototype), r.prototype.check = function () { var n = this.getIsImageComplete(); return n ? void this.confirm(0 !== this.img.naturalWidth, "naturalWidth") : (this.proxyImage = new Image, this.proxyImage.addEventListener("load", this), this.proxyImage.addEventListener("error", this), this.img.addEventListener("load", this), this.img.addEventListener("error", this), void (this.proxyImage.src = this.img.src)) }, r.prototype.getIsImageComplete = function () { return this.img.complete && this.img.naturalWidth }, r.prototype.confirm = function (n, t) { this.isLoaded = n; this.emitEvent("progress", [this, this.img, t]) }, r.prototype.handleEvent = function (n) { var t = "on" + n.type; this[t] && this[t](n) }, r.prototype.onload = function () { this.confirm(!0, "onload"); this.unbindEvents() }, r.prototype.onerror = function () { this.confirm(!1, "onerror"); this.unbindEvents() }, r.prototype.unbindEvents = function () { this.proxyImage.removeEventListener("load", this); this.proxyImage.removeEventListener("error", this); this.img.removeEventListener("load", this); this.img.removeEventListener("error", this) }, u.prototype = Object.create(r.prototype), u.prototype.check = function () { this.img.addEventListener("load", this); this.img.addEventListener("error", this); this.img.src = this.url; var n = this.getIsImageComplete(); n && (this.confirm(0 !== this.img.naturalWidth, "naturalWidth"), this.unbindEvents()) }, u.prototype.unbindEvents = function () { this.img.removeEventListener("load", this); this.img.removeEventListener("error", this) }, u.prototype.confirm = function (n, t) { this.isLoaded = n; this.emitEvent("progress", [this, this.element, t]) }, i.makeJQueryPlugin = function (t) { t = t || n.jQuery; t && (f = t, f.fn.imagesLoaded = function (n, t) { var r = new i(this, n, t); return r.jqDeferred.promise(f(this)) }) }, i.makeJQueryPlugin(), i });
/**
 * @license
 * Video.js 7.6.6 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/master/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
 */
!function (n, t) { "object" == typeof exports && "undefined" != typeof module ? module.exports = t(require("global/window"), require("global/document")) : "function" == typeof define && define.amd ? define(["global/window", "global/document"], t) : (n = n || self).videojs = t(n.window, n.document) }(this, function (n, t) {
    function iu(n, t) { sp(n).forEach(function (i) { return t(n[i], i) }) } function y(n) { for (var i = arguments.length, r = new Array(1 < i ? i - 1 : 0), t = 1; t < i; t++)r[t - 1] = arguments[t]; return Object.assign ? Object.assign.apply(Object, [n].concat(r)) : (r.forEach(function (t) { t && iu(t, function (t, i) { n[i] = t }) }), n) } function vi(n) { return !!n && "object" == typeof n } function lf(n) { return vi(n) && "[object Object]" === op.call(n) && n.constructor === Object } function no(t, i) { if (!t || !i || "function" != typeof n.getComputedStyle) return ""; var r = n.getComputedStyle(t); return r ? r.getPropertyValue(i) || r[i] : "" } function hp(n) { return "string" == typeof n && /\S/.test(n) } function cp(n) { if (/\s/.test(n)) throw new Error("class has illegal whitespace characters"); } function ru() { return t === n.document } function af(n) { return vi(n) && 1 === n.nodeType } function lp() { try { return n.parent !== n.self } catch (t) { return !0 } } function ap(n) { return function (i, r) { if (!hp(i)) return t[n](null); hp(r) && (r = t.querySelector(r)); var u = af(r) ? r : t; return u[n] && u[n](i) } } function k(n, i, r, u) { void 0 === n && (n = "div"); void 0 === i && (i = {}); void 0 === r && (r = {}); var f = t.createElement(n); return Object.getOwnPropertyNames(i).forEach(function (n) { var t = i[n]; -1 !== n.indexOf("aria-") || "role" === n || "type" === n ? (c.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set " + n + " to " + t + "."), f.setAttribute(n, t)) : "textContent" === n ? uu(f, t) : f[n] = t }), Object.getOwnPropertyNames(r).forEach(function (n) { f.setAttribute(n, r[n]) }), u && ic(f, u), f } function uu(n, t) { return "undefined" == typeof n.textContent ? n.innerText = t : n.textContent = t, n } function gh(n, t) { t.firstChild ? t.insertBefore(n, t.firstChild) : t.appendChild(n) } function ir(n, t) { return cp(t), n.classList ? n.classList.contains(t) : function (n) { return new RegExp("(^|\\s)" + n + "($|\\s)") }(t).test(n.className) } function hi(n, t) { return n.classList ? n.classList.add(t) : ir(n, t) || (n.className = (n.className + " " + t).trim()), n } function vf(n, t) { return n.classList ? n.classList.remove(t) : (cp(t), n.className = n.className.split(/\s+/).filter(function (n) { return n !== t }).join(" ")), n } function vp(n, t, i) { var r = ir(n, t); if ("function" == typeof i && (i = i(n, t)), "boolean" != typeof i && (i = !r), i !== r) return i ? hi(n, t) : vf(n, t), n } function yp(n, t) { Object.getOwnPropertyNames(t).forEach(function (i) { var r = t[i]; null === r || "undefined" == typeof r || !1 === r ? n.removeAttribute(i) : n.setAttribute(i, !0 === r ? "" : r) }) } function ci(n) { var f = {}, i, t, r, u; if (n && n.attributes && 0 < n.attributes.length) for (i = n.attributes, t = i.length - 1; 0 <= t; t--)r = i[t].name, u = i[t].value, "boolean" != typeof n[r] && -1 === ",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf("," + r + ",") || (u = null !== u), f[r] = u; return f } function pp(n, t) { return n.getAttribute(t) } function yf(n, t, i) { n.setAttribute(t, i) } function to(n, t) { n.removeAttribute(t) } function wp() { t.body.focus(); t.onselectstart = function () { return !1 } } function bp() { t.onselectstart = function () { return !0 } } function pf(n) { if (n && n.getBoundingClientRect && n.parentNode) { var i = n.getBoundingClientRect(), t = {}; return ["bottom", "height", "left", "right", "top", "width"].forEach(function (n) { void 0 !== i[n] && (t[n] = i[n]) }), t.height || (t.height = parseFloat(no(n, "height"))), t.width || (t.width = parseFloat(no(n, "width"))), t } } function kp(i) { var r; if (i.getBoundingClientRect && i.parentNode && (r = i.getBoundingClientRect()), !r) return { left: 0, top: 0 }; var f = t.documentElement, u = t.body, e = f.clientLeft || u.clientLeft || 0, o = n.pageXOffset || u.scrollLeft, s = r.left + o - e, h = f.clientTop || u.clientTop || 0, c = n.pageYOffset || u.scrollTop, l = r.top + c - h; return { left: Math.round(s), top: Math.round(l) } } function nc(n, t) { var i = {}, r = kp(n), o = n.offsetWidth, u = n.offsetHeight, s = r.top, h = r.left, f = t.pageY, e = t.pageX; return t.changedTouches && (e = t.changedTouches[0].pageX, f = t.changedTouches[0].pageY), i.y = Math.max(0, Math.min(1, (s - f + u) / u)), i.x = Math.max(0, Math.min(1, (e - h) / o)), i } function dp(n) { return vi(n) && 3 === n.nodeType } function tc(n) { for (; n.firstChild;)n.removeChild(n.firstChild); return n } function gp(n) { return "function" == typeof n && (n = n()), (Array.isArray(n) ? n : [n]).map(function (n) { return "function" == typeof n && (n = n()), af(n) || dp(n) ? n : "string" == typeof n && /\S/.test(n) ? t.createTextNode(n) : void 0 }).filter(function (n) { return n }) } function ic(n, t) { return gp(t).forEach(function (t) { return n.appendChild(t) }), n } function nw(n, t) { return ic(tc(n), t) } function fu(n) { return void 0 === n.button && void 0 === n.buttons || 0 === n.button && void 0 === n.buttons || "mouseup" === n.type && 0 === n.button && 0 === n.buttons || 0 === n.button && 1 === n.buttons } function uc(t, i) { i && (rc = i); n.setTimeout(uut, t) } function fc() { rw = !0; n.removeEventListener("load", fc) } function uw(n) { var i = t.createElement("style"); return i.className = n, i } function fw(n, t) { n.styleSheet ? n.styleSheet.cssText = t : n.textContent = t } function pi() { return ow++ } function sw(n, t) { if (rt.has(n)) { var i = rt.get(n); 0 === i.handlers[t].length && (delete i.handlers[t], n.removeEventListener ? n.removeEventListener(t, i.dispatcher, !1) : n.detachEvent && n.detachEvent("on" + t, i.dispatcher)); Object.getOwnPropertyNames(i.handlers).length <= 0 && (delete i.handlers, delete i.dispatcher, delete i.disabled); 0 === Object.getOwnPropertyNames(i).length && rt.delete(n) } } function ec(n, t, i, r) { i.forEach(function (i) { n(t, i, r) }) } function io(i) { function o() { return !0 } function s() { return !1 } var r, u, f, e; if (!i || !i.isPropagationStopped) { r = i || n.event; for (u in i = {}, r) "layerX" !== u && "layerY" !== u && "keyLocation" !== u && "webkitMovementX" !== u && "webkitMovementY" !== u && ("returnValue" === u && r.preventDefault || (i[u] = r[u])); (i.target || (i.target = i.srcElement || t), i.relatedTarget || (i.relatedTarget = i.fromElement === i.target ? i.toElement : i.fromElement), i.preventDefault = function () { r.preventDefault && r.preventDefault(); i.returnValue = !1; r.returnValue = !1; i.defaultPrevented = !0 }, i.defaultPrevented = !1, i.stopPropagation = function () { r.stopPropagation && r.stopPropagation(); i.cancelBubble = !0; r.cancelBubble = !0; i.isPropagationStopped = o }, i.isPropagationStopped = s, i.stopImmediatePropagation = function () { r.stopImmediatePropagation && r.stopImmediatePropagation(); i.isImmediatePropagationStopped = o; i.stopPropagation() }, i.isImmediatePropagationStopped = s, null !== i.clientX && void 0 !== i.clientX) && (f = t.documentElement, e = t.body, i.pageX = i.clientX + (f && f.scrollLeft || e && e.scrollLeft || 0) - (f && f.clientLeft || e && e.clientLeft || 0), i.pageY = i.clientY + (f && f.scrollTop || e && e.scrollTop || 0) - (f && f.clientTop || e && e.clientTop || 0)); i.which = i.charCode || i.keyCode; null !== i.button && void 0 !== i.button && (i.button = 1 & i.button ? 0 : 4 & i.button ? 1 : 2 & i.button ? 2 : 0) } return i } function yt(n, t, i) { var r, u; if (Array.isArray(t)) return ec(yt, n, t, i); rt.has(n) || rt.set(n, {}); r = rt.get(n); (r.handlers || (r.handlers = {}), r.handlers[t] || (r.handlers[t] = []), i.guid || (i.guid = pi()), r.handlers[t].push(i), r.dispatcher || (r.disabled = !1, r.dispatcher = function (t, i) { var u; if (!r.disabled && (t = io(t), u = r.handlers[t.type], u)) for (var e = u.slice(0), f = 0, o = e.length; f < o && !t.isImmediatePropagationStopped(); f++)try { e[f].call(n, t, i) } catch (t) { c.error(t) } }), 1 === r.handlers[t].length) && (n.addEventListener ? (u = !1, oc && -1 < hw.indexOf(t) && (u = { passive: !0 }), n.addEventListener(t, r.dispatcher, u)) : n.attachEvent && n.attachEvent("on" + t, r.dispatcher)) } function nt(n, t, i) { var r, u, f, e; if (rt.has(n) && (r = rt.get(n), r.handlers)) { if (Array.isArray(t)) return ec(nt, n, t, i); function o(n, t) { r.handlers[t] = []; sw(n, t) } if (void 0 !== t) { if (u = r.handlers[t], u) if (i) { if (i.guid) for (f = 0; f < u.length; f++)u[f].guid === i.guid && u.splice(f--, 1); sw(n, t) } else o(n, t) } else for (e in r.handlers) Object.prototype.hasOwnProperty.call(r.handlers || {}, e) && o(n, e) } } function eu(n, t, i) { var f = rt.has(n) ? rt.get(n) : {}, r = n.parentNode || n.ownerDocument, u; return ("string" == typeof t ? t = { type: t, target: n } : t.target || (t.target = n), t = io(t), f.dispatcher && f.dispatcher.call(n, t, i), r && !t.isPropagationStopped() && !0 === t.bubbles) ? eu.call(null, r, t, i) : !r && !t.defaultPrevented && t.target && t.target[t.type] && (rt.has(t.target) || rt.set(t.target, {}), u = rt.get(t.target), t.target[t.type] && (u.disabled = !0, "function" == typeof t.target[t.type] && t.target[t.type](), u.disabled = !1)), !t.defaultPrevented } function ro(n, t, i) { function r() { nt(n, t, r); i.apply(this, arguments) } if (Array.isArray(t)) return ec(ro, n, t, i); r.guid = i.guid = i.guid || pi(); yt(n, t, r) } function cw(n, t, i) { function r() { nt(n, t, r); i.apply(this, arguments) } r.guid = i.guid = i.guid || pi(); yt(n, t, r) } function h(n, t, i) { t.guid || (t.guid = pi()); var r = t.bind(n); return r.guid = i ? i + "_" + t.guid : t.guid, r } function wi(t, i) { var r = n.performance.now(); return function () { var u = n.performance.now(); i <= u - r && (t.apply(void 0, arguments), r = u) } } function ft() { } function aw(n) { return "string" == typeof n && /\S/.test(n) || Array.isArray(n) && !!n.length } function sc(n) { if (!n.nodeName && !bi(n)) throw new Error("Invalid target; must be a DOM node or evented object."); } function vw(n) { if (!aw(n)) throw new Error("Invalid event type; must be a non-empty string or array."); } function yw(n) { if ("function" != typeof n) throw new Error("Invalid listener; must be a function."); } function hc(n, t) { var i, r, u, f = t.length < 3 || t[0] === n || t[0] === n.eventBusEl_; return u = f ? (i = n.eventBusEl_, 3 <= t.length && t.shift(), r = t[0], t[1]) : (i = t[0], r = t[1], t[2]), sc(i), vw(r), yw(u), { isTargetingSelf: f, target: i, type: r, listener: u = h(n, u) } } function rr(n, t, i, r) { sc(n); n.nodeName ? lw[t](n, i, r) : n[t](i, r) } function cc(t, i) { void 0 === i && (i = {}); var r = i.eventBusKey; if (r) { if (!t[r].nodeName) throw new Error('The eventBusKey "' + r + '" does not refer to an element.'); t.eventBusEl_ = t[r] } else t.eventBusEl_ = k("span", { className: "vjs-event-bus" }); return y(t, pw), t.eventedCallbacks && t.eventedCallbacks.forEach(function (n) { n() }), t.on("dispose", function () { t.off(); n.setTimeout(function () { t.eventBusEl_ = null }, 0) }), t } function bw(n, t) { return y(n, ww), n.state = y({}, n.state, t), "function" == typeof n.handleStateChanged && bi(n) && n.on("statechanged", n.handleStateChanged), n } function uo(n) { return "string" != typeof n ? n : n.replace(/./, function (n) { return n.toLowerCase() }) } function b(n) { return "string" != typeof n ? n : n.replace(/./, function (n) { return n.toUpperCase() }) } function a() { for (var n = {}, i = arguments.length, r = new Array(i), t = 0; t < i; t++)r[t] = arguments[t]; return r.forEach(function (t) { t && iu(t, function (t, i) { lf(t) ? (lf(n[i]) || (n[i] = {}), n[i] = a(n[i], t)) : n[i] = t }) }), n } function f(n, t) { n.prototype = Object.create(t.prototype); (n.prototype.constructor = n).__proto__ = t } function kw(n, t) { return (kw = Object.setPrototypeOf || function (n, t) { return n.__proto__ = t, n })(n, t) } function dw() { return (dw = function () { if ("undefined" == typeof Reflect || !Reflect.construct || Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Date.prototype.toString.call(Reflect.construct(Date, [], function () { })), !0 } catch (n) { return !1 } }() ? Reflect.construct : function (n, t, i) { var r = [null], u; return r.push.apply(r, t), u = new (Function.bind.apply(n, r)), i && kw(u, i.prototype), u }).apply(null, arguments) } function s(n) { if (void 0 === n) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return n } function eb(n, t, i, r) { return function (n, t, i) { if ("number" != typeof t || t < 0 || i < t) throw new Error("Failed to execute '" + n + "' on 'TimeRanges': The index provided (" + t + ") is non-numeric or out of bounds (0-" + i + ")."); }(n, r, i.length - 1), i[r][t] } function nl(n) { return void 0 === n || 0 === n.length ? { length: 0, start: function () { throw new Error("This TimeRanges object is empty"); }, end: function () { throw new Error("This TimeRanges object is empty"); } } : { length: n.length, start: eb.bind(null, "start", 0, n), end: eb.bind(null, "end", 1, n) } } function ur(n, t) { return Array.isArray(n) ? nl(n) : void 0 === n || void 0 === t ? nl() : nl([[n, t]]) } function ob(n, t) { var u, r, f = 0, i; if (!t) return 0; for (n && n.length || (n = ur(0, 0)), i = 0; i < n.length; i++)u = n.start(i), t < (r = n.end(i)) && (r = t), f += r - u; return f / t } function et(n) { if (n instanceof et) return n; "number" == typeof n ? this.code = n : "string" == typeof n ? this.message = n : vi(n) && ("number" == typeof n.code && (this.code = n.code), y(this, n)); this.message || (this.message = et.defaultMessages[this.code] || "") } function gf(n) { return null != n && "function" == typeof n.then } function di(n) { gf(n) && n.then(null, function () { }) } function cb(n) { return ["kind", "label", "language", "id", "inBandMetadataTrackDispatchType", "mode", "src"].reduce(function (t, i) { return n[i] && (t[i] = n[i]), t }, { cues: n.cues && Array.prototype.map.call(n.cues, function (n) { return { startTime: n.startTime, endTime: n.endTime, text: n.text, id: n.id } }) }) } function il(n, t) { return n(t = { exports: {} }, t.exports), t.exports } function ul(n, t) { for (var i = 0; i < n.length; i++)Object.keys(n[i]).length && t.id !== n[i].id && (n[i].enabled = !1) } function fl(n, t) { for (var i = 0; i < n.length; i++)Object.keys(n[i]).length && t.id !== n[i].id && (n[i].selected = !1) } function el(i) { var o = ["protocol", "hostname", "port", "pathname", "search", "hash", "host"], u = t.createElement("a"), f, s, r, e; for (u.href = i, s = "" === u.host && "file:" !== u.protocol, s && ((f = t.createElement("div")).innerHTML = '<a href="' + i + '"><\/a>', u = f.firstChild, f.setAttribute("style", "display:none; position:absolute;"), t.body.appendChild(f)), r = {}, e = 0; e < o.length; e++)r[o[e]] = u[o[e]]; return "http:" === r.protocol && (r.host = r.host.replace(/:80$/, "")), "https:" === r.protocol && (r.host = r.host.replace(/:443$/, "")), r.protocol || (r.protocol = n.location.protocol), s && t.body.removeChild(f), r } function yb(n) { if (!n.match(/^https?:\/\//)) { var i = t.createElement("div"); i.innerHTML = '<a href="' + n + '">x<\/a>'; n = i.firstChild.href } return n } function ol(n) { if ("string" == typeof n) { var t = /^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(n); if (t) return t.pop().toLowerCase() } return "" } function oo(t) { var i = n.location, r = el(t); return (":" === r.protocol ? i.protocol : r.protocol) + r.host !== i.protocol + i.host } function kb(n) { var t = gb.call(n), i = "[object Arguments]" === t; return i || "[object Array]" !== t && null !== n && "object" == typeof n && "number" == typeof n.length && 0 <= n.length && "[object Function]" === gb.call(n.callee) } function uft(n, t, i, r) { t in n && (!function (n) { return "function" == typeof n && "[object Function]" === oft.call(n) }(r) || !r()) || (fk ? ll(n, t, { configurable: !0, enumerable: !1, value: i, writable: !0 }) : n[t] = i) } function uk(n, t, i) { var f = 2 < arguments.length ? i : {}, r = fft(t), u; for (eft && (r = sft.call(r, Object.getOwnPropertySymbols(t))), u = 0; u < r.length; u += 1)uft(n, r[u], t[r[u]], f[r[u]]) } function ne(n, t) { if (1 < arguments.length && "boolean" != typeof t) throw new TypeError('"allowMissing" argument must be a boolean'); var i = "$ " + n; if (!(i in pl)) throw new SyntaxError("intrinsic " + n + " does not exist!"); if ("undefined" == typeof pl[i] && !t) throw new TypeError("intrinsic " + n + " exists, but is not available. Please file an issue!"); return pl[i] } function lo(n, t, i, r) { var u = lft[t]; if ("function" != typeof u) throw new cft("unknown record type: " + t); if (!u(n, r)) throw new lk(i + " must be a " + t); } function ek(n) { return 0 <= n ? 1 : -1 } function ok(n) { try { var t = vk.call(n); return vft.test(t) } catch (n) { return !1 } } function al(n) { if (!n || "function" != typeof n && "object" != typeof n) return !1; if ("function" == typeof n && !n.prototype) return !0; if (pft) return function (n) { try { return !ok(n) && (vk.call(n), !0) } catch (n) { return !1 } }(n); if (ok(n)) return !1; var t = yft.call(n); return "[object Function]" === t || "[object GeneratorFunction]" === t } function sk(n) { return null === n || "function" != typeof n && "object" != typeof n } function hk() { var n = pk.ToString(pk.CheckObjectCoercible(this)); return wk(wk(n, dft, ""), gft, "") } function vl() { return String.prototype.trim && "​" === "​".trim() ? String.prototype.trim : hk } function gk(n, t, i) { var r = n; return put(t) ? (i = t, "string" == typeof n && (r = { uri: n })) : r = ret(t, { uri: n }), r.callback = i, r } function gi(n, t, i) { return nd(t = gk(n, t, i)) } function nd(n) { function s(n) { return clearTimeout(h), n instanceof Error || (n = new Error("" + (n || "Unknown XMLHttpRequest Error"))), n.statusCode = 0, o(n, p) } function v() { var u, i, e; if (!f) return clearTimeout(h), u = n.useXDR && void 0 === t.status ? 200 : 1223 === t.status ? 204 : t.status, i = p, e = null, 0 !== u ? (i = { body: function () { var n = void 0; if (n = t.response ? t.response : t.responseText || function (n) { if ("document" === n.responseType) return n.responseXML; var t = n.responseXML && "parsererror" === n.responseXML.documentElement.nodeName; return "" !== n.responseType || t ? null : n.responseXML }(t), y) try { n = JSON.parse(n) } catch (n) { } return n }(), statusCode: u, method: r, headers: {}, url: c, rawRequest: t }, t.getAllResponseHeaders && (i.headers = iet(t.getAllResponseHeaders()))) : e = new Error("Internal XMLHttpRequest Error"), o(e, i, i.body) } var e, o; if ("undefined" == typeof n.callback) throw new Error("callback argument missing"); e = !1; o = function (t, i, r) { e || (e = !0, n.callback(t, i, r)) }; var u, f, h, t = n.xhr || null, c = (t = t || (n.cors || n.useXDR ? new gi.XDomainRequest : new gi.XMLHttpRequest)).url = n.uri || n.url, r = t.method = n.method || "GET", l = n.body || n.data, i = t.headers = n.headers || {}, a = !!n.sync, y = !1, p = { body: void 0, headers: {}, statusCode: 0, method: r, url: c, rawRequest: t }; if ("json" in n && !1 !== n.json && (y = !0, i.accept || i.Accept || (i.Accept = "application/json"), "GET" !== r && "HEAD" !== r && (i["content-type"] || i["Content-Type"] || (i["Content-Type"] = "application/json"), l = JSON.stringify(!0 === n.json ? l : n.json))), t.onreadystatechange = function () { 4 === t.readyState && setTimeout(v, 0) }, t.onload = v, t.onerror = s, t.onprogress = function () { }, t.onabort = function () { f = !0 }, t.ontimeout = s, t.open(r, c, !a, n.username, n.password), a || (t.withCredentials = !!n.withCredentials), !a && 0 < n.timeout && (h = setTimeout(function () { if (!f) { f = !0; t.abort("timeout"); var n = new Error("XMLHttpRequest timeout"); n.code = "ETIMEDOUT"; s(n) } }, n.timeout)), t.setRequestHeader) for (u in i) i.hasOwnProperty(u) && t.setRequestHeader(u, i[u]); else if (n.headers && !function (n) { for (var t in n) if (n.hasOwnProperty(t)) return !1; return !0 }(n.headers)) throw new Error("Headers cannot be set on an XDomainRequest object"); return "responseType" in n && (t.responseType = n.responseType), "beforeSend" in n && "function" == typeof n.beforeSend && n.beforeSend(t), t.send(l || null), t } function td(t, i) { var r = new n.WebVTT.Parser(n, n.vttjs, n.WebVTT.StringDecoder()), u = []; r.oncue = function (n) { i.addCue(n) }; r.onparsingerror = function (n) { u.push(n) }; r.onflush = function () { i.trigger({ type: "loadeddata", target: i }) }; r.parse(t); 0 < u.length && (n.console && n.console.groupCollapsed && n.console.groupCollapsed("Text Track parsing errors for " + i.src), u.forEach(function (n) { return c.error(n) }), n.console && n.console.groupEnd && n.console.groupEnd()); r.flush() } function ud() { } function fi(n, t) { this.name = "ParsingError"; this.code = n.code; this.message = t || n.message } function bl(n) { function i(n, t, i, r) { return 3600 * (0 | n) + 60 * (0 | t) + (0 | i) + (0 | r) / 1e3 } var t = n.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/); return t ? t[3] ? i(t[1], t[2], t[3].replace(":", ""), t[4]) : 59 < t[1] ? i(t[1], t[2], 0, t[4]) : i(0, t[1], t[2], t[4]) : null } function te() { this.values = vo(null) } function ie(n, t, i, r) { var f = r ? n.split(r) : [n], e, u; for (e in f) "string" == typeof f[e] && (u = f[e].split(i), 2 === u.length && t(u[0], u[1])) } function fet(n, t, i) { function s() { var t = bl(n); if (null === t) throw new fi(fi.Errors.BadTimeStamp, "Malformed timestamp: " + o); return n = n.replace(/^[^\sa-zA-Z-]+/, ""), t } function f() { n = n.replace(/^\s+/, "") } var e, u, r, o = n; if (f(), t.startTime = s(), f(), "-->" !== n.substr(0, 3)) throw new fi(fi.Errors.BadTimeStamp, "Malformed time stamp (time stamps must be separated by '-->'): " + o); n = n.substr(3); f(); t.endTime = s(); f(); e = n; u = t; r = new te; ie(e, function (n, t) { var f, u, e; switch (n) { case "region": for (f = i.length - 1; 0 <= f; f--)if (i[f].id === t) { r.set(n, i[f].region); break } break; case "vertical": r.alt(n, t, ["rl", "lr"]); break; case "line": u = t.split(","); e = u[0]; r.integer(n, e); r.percent(n, e) && r.set("snapToLines", !1); r.alt(n, e, ["auto"]); 2 === u.length && r.alt("lineAlign", u[1], ["start", "middle", "end"]); break; case "position": u = t.split(","); r.percent(n, u[0]); 2 === u.length && r.alt("positionAlign", u[1], ["start", "middle", "end"]); break; case "size": r.percent(n, t); break; case "align": r.alt(n, t, ["start", "middle", "end", "left", "right"]) } }, /:/, /\s/); u.region = r.get("region", null); u.vertical = r.get("vertical", ""); u.line = r.get("line", "auto"); u.lineAlign = r.get("lineAlign", "start"); u.snapToLines = r.get("snapToLines", !0); u.size = r.get("size", 100); u.align = r.get("align", "middle"); u.position = r.get("position", { start: 0, left: 0, middle: 50, end: 100, right: 100 }, u.align); u.positionAlign = r.get("positionAlign", { start: "start", left: "start", middle: "middle", end: "end", right: "end" }, u.align) } function ed(n, t) { function l() { if (!t) return null; var n, i = t.match(/^([^<]*)(<[^>]*>?)?/); return n = i[1] ? i[1] : i[2], t = t.substr(n.length), n } function a(n) { return eet[n] } function v(n) { for (; i = n.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)n = n.replace(i[0], a); return n } function y(t, i) { var u = oet[t], r, f; return u ? (r = n.document.createElement(u), r.localName = u, f = set[t], f && i && (r[f] = i.trim()), r) : null } for (var f, o, i, r, s, h, c = n.document.createElement("div"), u = c, e = []; null !== (r = l());)if ("<" !== r[0]) u.appendChild(n.document.createTextNode(v(r))); else { if ("/" === r[1]) { e.length && e[e.length - 1] === r.substr(2).replace(">", "") && (e.pop(), u = u.parentNode); continue } if (o = bl(r.substr(1, r.length - 2)), o) { f = n.document.createProcessingInstruction("timestamp", o); u.appendChild(f); continue } if (i = r.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/), !i) continue; if (!(f = y(i[1], i[3]))) continue; if (s = u, fd[(h = f).localName] && fd[h.localName] !== s.localName) continue; i[2] && (f.className = i[2].substr(1).replace(".", " ")); e.push(i[1]); u.appendChild(f); u = f } return c } function het(n) { for (var i, t = 0; t < kl.length; t++)if (i = kl[t], n >= i[0] && n <= i[1]) return !0; return !1 } function yo() { } function dl(n, t, i) { var u, r; yo.call(this); this.cue = t; this.cueDiv = ed(n, t.text); u = { color: "rgba(255, 255, 255, 1)", backgroundColor: "rgba(0, 0, 0, 0.8)", position: "relative", left: 0, right: 0, top: 0, bottom: 0, display: "inline", writingMode: "" === t.vertical ? "horizontal-tb" : "lr" === t.vertical ? "vertical-lr" : "vertical-rl", unicodeBidi: "plaintext" }; this.applyStyles(u, this.cueDiv); this.div = n.document.createElement("div"); u = { direction: function (n) { function f(n, t) { for (var i = t.childNodes.length - 1; 0 <= i; i--)n.push(t.childNodes[i]) } function r(n) { var t, i, u; return !n || !n.length ? null : (t = n.pop(), i = t.textContent || t.innerText, i) ? (u = i.match(/^.*(\n|\r)/), u ? u[n.length = 0] : i) : "ruby" === t.tagName ? r(n) : t.childNodes ? (f(n, t), r(n)) : void 0 } var u = [], i = "", t; if (!n || !n.childNodes) return "ltr"; for (f(u, n); i = r(u);)for (t = 0; t < i.length; t++)if (het(i.charCodeAt(t))) return "rtl"; return "ltr" }(this.cueDiv), writingMode: "" === t.vertical ? "horizontal-tb" : "lr" === t.vertical ? "vertical-lr" : "vertical-rl", unicodeBidi: "plaintext", textAlign: "middle" === t.align ? "center" : t.align, font: i.font, whiteSpace: "pre-line", position: "absolute" }; this.applyStyles(u); this.div.appendChild(this.cueDiv); r = 0; switch (t.positionAlign) { case "start": r = t.position; break; case "middle": r = t.position - t.size / 2; break; case "end": r = t.position - t.size }"" === t.vertical ? this.applyStyles({ left: this.formatStyle(r, "%"), width: this.formatStyle(t.size, "%") }) : this.applyStyles({ top: this.formatStyle(r, "%"), height: this.formatStyle(t.size, "%") }); this.move = function (n) { this.applyStyles({ top: this.formatStyle(n.top, "px"), bottom: this.formatStyle(n.bottom, "px"), left: this.formatStyle(n.left, "px"), right: this.formatStyle(n.right, "px"), height: this.formatStyle(n.height, "px"), width: this.formatStyle(n.width, "px") }) } } function ot(n) { var i, r, f, u, t; n.div && (r = n.div.offsetHeight, f = n.div.offsetWidth, u = n.div.offsetTop, t = (t = n.div.childNodes) && (t = t[0]) && t.getClientRects && t.getClientRects(), n = n.div.getBoundingClientRect(), i = t ? Math.max(t[0] && t[0].height || 0, n.height / t.length) : 0); this.left = n.left; this.right = n.right; this.top = n.top || u; this.height = n.height || r; this.bottom = n.bottom || u + (n.height || r); this.width = n.width || f; this.lineHeight = void 0 !== i ? i : n.lineHeight } function cet(n, t, i, r) { var s = new ot(t), e = t.cue, f = function (n) { if ("number" == typeof n.line && (n.snapToLines || 0 <= n.line && n.line <= 100)) return n.line; if (!n.track || !n.track.textTrackList || !n.track.textTrackList.mediaElement) return -1; for (var r = n.track, i = r.textTrackList, u = 0, t = 0; t < i.length && i[t] !== r; t++)"showing" === i[t].mode && u++; return -1 * ++u }(e), u = [], h, l, v; if (e.snapToLines) { switch (e.vertical) { case "": u = ["+y", "-y"]; h = "height"; break; case "rl": u = ["+x", "-x"]; h = "width"; break; case "lr": u = ["-x", "+x"]; h = "width" }var c = s.lineHeight, o = c * Math.round(f), a = i[h] + c, y = u[0]; Math.abs(o) > a && (o = o < 0 ? -1 : 1, o *= Math.ceil(a / c) * c); f < 0 && (o += "" === e.vertical ? i.height : i.width, u = u.reverse()); s.move(y, o) } else { l = s.lineHeight / i.height * 100; switch (e.lineAlign) { case "middle": f -= l / 2; break; case "end": f -= l }switch (e.vertical) { case "": t.applyStyles({ top: t.formatStyle(f, "%") }); break; case "rl": t.applyStyles({ left: t.formatStyle(f, "%") }); break; case "lr": t.applyStyles({ right: t.formatStyle(f, "%") }) }u = ["+y", "-x", "+x", "-y"]; s = new ot(t) } v = function (n, t) { for (var f, e, o = new ot(n), s = 1, u = 0; u < t.length; u++) { for (; n.overlapsOppositeAxis(i, t[u]) || n.within(i) && n.overlapsAny(r);)n.move(t[u]); if (n.within(i)) return n; f = n.intersectPercentage(i); f < s && (e = new ot(n), s = f); n = new ot(o) } return e || o }(s, u); t.move(v.toCSSCompatValues(i)) } function re() { } function gl(n) { return "string" == typeof n && !!yet[n.toLowerCase()] && n.toLowerCase() } function od(n, t, i) { this.hasBeenReset = !1; var r = "", u = !1, f = n, e = t, o = i, s = null, h = "", c = !0, l = "auto", a = "start", v = 50, y = "middle", p = 50, w = "middle"; Object.defineProperties(this, { id: { enumerable: !0, get: function () { return r }, set: function (n) { r = "" + n } }, pauseOnExit: { enumerable: !0, get: function () { return u }, set: function (n) { u = !!n } }, startTime: { enumerable: !0, get: function () { return f }, set: function (n) { if ("number" != typeof n) throw new TypeError("Start time must be set to a number."); f = n; this.hasBeenReset = !0 } }, endTime: { enumerable: !0, get: function () { return e }, set: function (n) { if ("number" != typeof n) throw new TypeError("End time must be set to a number."); e = n; this.hasBeenReset = !0 } }, text: { enumerable: !0, get: function () { return o }, set: function (n) { o = "" + n; this.hasBeenReset = !0 } }, region: { enumerable: !0, get: function () { return s }, set: function (n) { s = n; this.hasBeenReset = !0 } }, vertical: { enumerable: !0, get: function () { return h }, set: function (n) { var t = function (n) { return "string" == typeof n && !!vet[n.toLowerCase()] && n.toLowerCase() }(n); if (!1 === t) throw new SyntaxError("An invalid or illegal string was specified."); h = t; this.hasBeenReset = !0 } }, snapToLines: { enumerable: !0, get: function () { return c }, set: function (n) { c = !!n; this.hasBeenReset = !0 } }, line: { enumerable: !0, get: function () { return l }, set: function (n) { if ("number" != typeof n && "auto" !== n) throw new SyntaxError("An invalid number or illegal string was specified."); l = n; this.hasBeenReset = !0 } }, lineAlign: { enumerable: !0, get: function () { return a }, set: function (n) { var t = gl(n); if (!t) throw new SyntaxError("An invalid or illegal string was specified."); a = t; this.hasBeenReset = !0 } }, position: { enumerable: !0, get: function () { return v }, set: function (n) { if (n < 0 || 100 < n) throw new Error("Position must be between 0 and 100."); v = n; this.hasBeenReset = !0 } }, positionAlign: { enumerable: !0, get: function () { return y }, set: function (n) { var t = gl(n); if (!t) throw new SyntaxError("An invalid or illegal string was specified."); y = t; this.hasBeenReset = !0 } }, size: { enumerable: !0, get: function () { return p }, set: function (n) { if (n < 0 || 100 < n) throw new Error("Size must be between 0 and 100."); p = n; this.hasBeenReset = !0 } }, align: { enumerable: !0, get: function () { return w }, set: function (n) { var t = gl(n); if (!t) throw new SyntaxError("An invalid or illegal string was specified."); w = t; this.hasBeenReset = !0 } } }); this.displayState = void 0 } function ue(n) { return "number" == typeof n && 0 <= n && n <= 100 } function pet() { var n = 100, t = 3, i = 0, r = 100, u = 0, f = 100, e = ""; Object.defineProperties(this, { width: { enumerable: !0, get: function () { return n }, set: function (t) { if (!ue(t)) throw new Error("Width must be between 0 and 100."); n = t } }, lines: { enumerable: !0, get: function () { return t }, set: function (n) { if ("number" != typeof n) throw new TypeError("Lines must be set to a number."); t = n } }, regionAnchorY: { enumerable: !0, get: function () { return r }, set: function (n) { if (!ue(n)) throw new Error("RegionAnchorX must be between 0 and 100."); r = n } }, regionAnchorX: { enumerable: !0, get: function () { return i }, set: function (n) { if (!ue(n)) throw new Error("RegionAnchorY must be between 0 and 100."); i = n } }, viewportAnchorY: { enumerable: !0, get: function () { return f }, set: function (n) { if (!ue(n)) throw new Error("ViewportAnchorY must be between 0 and 100."); f = n } }, viewportAnchorX: { enumerable: !0, get: function () { return u }, set: function (n) { if (!ue(n)) throw new Error("ViewportAnchorX must be between 0 and 100."); u = n } }, scroll: { enumerable: !0, get: function () { return e }, set: function (n) { var t = function (n) { return "string" == typeof n && !!hd[n.toLowerCase()] && n.toLowerCase() }(n); if (!1 === t) throw new SyntaxError("An invalid or illegal string was specified."); e = t } } }) } function wet(n, t, i) { n.setTimeout(function () { return function i(n, t, r, u, f, e) { var s; void 0 === n && (n = {}); void 0 === t && (t = []); void 0 === f && (f = []); void 0 === e && (e = !1); var c = t, h = c[0], o = c.slice(1); if ("string" == typeof h) i(n, hr[h], r, u, f, e); else if (h) { if (s = det(u, h), !s.setSource) return f.push(s), i(n, o, r, u, f, e); s.setSource(y({}, n), function (t, h) { if (t) return i(n, o, r, u, f, e); f.push(s); i(h, n.type === h.type ? o : hr[h.type], r, u, f, e) }) } else o.length ? i(n, o, r, u, f, e) : e ? r(n, f) : i(n, hr["*"], r, u, f, !0) }(t, hr[t.type], i, n) }, 1) } function cd(n, t, i, r) { void 0 === r && (r = null); var o = "call" + b(i), u = n.reduce(ta(o), r), f = u === po, e = f ? null : t[i](u); return function (n, t, i, r) { for (var f, u = n.length - 1; 0 <= u; u--)f = n[u], f[t] && f[t](r, i) }(n, i, e, f), e } function ta(n) { return function (t, i) { return t === po ? po : i[n] ? i[n](t) : t } } function det(n, t) { var r = na[n.id()], i = null, u; if (null == r) return i = t(n), na[n.id()] = [[t, i]], i; for (u = 0; u < r.length; u++) { var f = r[u], e = f[0], o = f[1]; e === t && (i = o) } return null === i && (i = t(n), r.push([t, i])), i } function wo(n) { void 0 === n && (n = ""); var t = ol(n); return ad[t.toLowerCase()] || "" } function vd(n) { if (!n.type) { var t = wo(n.src); t && (n.type = t) } return n } function ia(n, t) { var i; if (4 === n.length) i = n[1] + n[1] + n[2] + n[2] + n[3] + n[3]; else { if (7 !== n.length) throw new Error("Invalid color code provided, " + n + "; must be formatted as e.g. #f0e or #f604e2."); i = n.slice(1) } return "rgba(" + parseInt(i.slice(0, 2), 16) + "," + parseInt(i.slice(2, 4), 16) + "," + parseInt(i.slice(4, 6), 16) + "," + t + ")" } function ra(n, t, i) { try { n.style[t] = i } catch (n) { return } } function gd(n, t) { n = n < 0 ? 0 : n; var i = Math.floor(n % 60), r = Math.floor(n / 60 % 60), u = Math.floor(n / 3600), f = Math.floor(t / 60 % 60), e = Math.floor(t / 3600); return !isNaN(n) && n !== 1 / 0 || (u = r = i = "-"), (u = 0 < u || 0 < e ? u + ":" : "") + (r = ((u || 10 <= f) && r < 10 ? "0" + r : r) + ":") + (i = i < 10 ? "0" + i : i) } function vu(n, t) { return void 0 === t && (t = n), bo(n, t) } function wg(n, t) { if (t && (n = t(n)), n && "none" !== n) return n } function uv(n) { var f = n.el(), i, r; if (f.hasAttribute("src")) return n.triggerSourceset(f.src), !0; var u = n.$$("source"), t = [], e = ""; if (!u.length) return !1; for (i = 0; i < u.length; i++)r = u[i].src, r && -1 === t.indexOf(r) && t.push(r); return !!t.length && (1 === t.length && (e = t[0]), n.triggerSourceset(e), !0) } function gg(n, t) { for (var i = {}, r = 0; r < n.length && !((i = Object.getOwnPropertyDescriptor(n[r], t)) && i.set && i.get); r++); return i.enumerable = !0, i.configurable = !0, i } function nn(t) { var i = t.el(), r, u; if (!i.resetSourceWatch_) { function f(n) { return function () { for (var e, u = arguments.length, f = new Array(u), r = 0; r < u; r++)f[r] = arguments[r]; return e = n.apply(i, f), uv(t), e } } r = {}; u = function (t) { return gg([t.el(), n.HTMLMediaElement.prototype, n.Element.prototype, not], "innerHTML") }(t);["append", "appendChild", "insertAdjacentHTML"].forEach(function (n) { i[n] && (r[n] = i[n], i[n] = f(r[n])) }); Object.defineProperty(i, "innerHTML", a(u, { set: f(u.set) })); i.resetSourceWatch_ = function () { i.resetSourceWatch_ = null; Object.keys(r).forEach(function (n) { i[n] = r[n] }); Object.defineProperty(i, "innerHTML", u) }; t.one("sourceset", i.resetSourceWatch_) } } function get(t) { var i; if (t.featuresSourceset && (i = t.el(), !i.resetSourceset_)) { var r = function (t) { return gg([t.el(), n.HTMLMediaElement.prototype, tot], "src") }(t), u = i.setAttribute, f = i.load; Object.defineProperty(i, "src", a(r, { set: function (n) { var u = r.set.call(i, n); return t.triggerSourceset(i.src), u } })); i.setAttribute = function (n, r) { var f = u.call(i, n, r); return /src/i.test(n) && t.triggerSourceset(i.src), f }; i.load = function () { var n = f.call(i); return uv(t) || (t.triggerSourceset(""), nn(t)), n }; i.currentSrc ? t.triggerSourceset(i.currentSrc) : uv(t) || nn(t); i.resetSourceset_ = function () { i.resetSourceset_ = null; i.load = f; i.setAttribute = u; Object.defineProperty(i, "src", r); i.resetSourceWatch_ && i.resetSourceWatch_() } } } function ws(n) { return ku.hasOwnProperty(n) } function bs(n) { if (ws(n)) return ku[n] } function fn(n, t) { n[bu] = n[bu] || {}; n[bu][t] = !0 } function ks(n, t, i) { var r = (i ? "before" : "") + "pluginsetup"; n.trigger(r, t); n.trigger(r + ":" + t.name, t) } function en(n, t) { return t.prototype.name = n, function () { var r; ks(this, { name: n, plugin: t, instance: null }, !0); for (var u = arguments.length, f = new Array(u), i = 0; i < u; i++)f[i] = arguments[i]; return r = dw(t, [this].concat(f)), this[n] = function () { return r }, ks(this, r.getEventHash()), r } } function i(n, t, u) { var e = i.getPlayer(n), f, o; if (e) return t && c.warn('Player "' + n + '" is already initialised. Options will not be applied.'), u && e.ready(u), e; if (f = "string" == typeof n ? yi("#" + sv(n)) : n, !af(f)) throw new TypeError("The element or ID supplied is not valid. (videojs)"); return f.ownerDocument.defaultView && f.ownerDocument.body.contains(f) || c.warn("The element supplied is not included in the DOM"), t = t || {}, i.hooks("beforesetup").forEach(function (n) { var i = n(f, a(t)); vi(i) && !Array.isArray(i) ? t = a(t, i) : c.error("please return an object in beforesetup hooks") }), o = r.getComponent("Player"), e = new o(f, t, u), i.hooks("setup").forEach(function (n) { return n(e) }), e } function on() { return (on = Object.assign || function (n) { for (var i, r, t = 1; t < arguments.length; t++) { i = arguments[t]; for (r in i) Object.prototype.hasOwnProperty.call(i, r) && (n[r] = i[r]) } return n }).apply(this, arguments) } function cv(n, t) { n.prototype = Object.create(t.prototype); (n.prototype.constructor = n).__proto__ = t } function ce(n) { for (var t, i = n.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')), u = {}, r = i.length; r--;)"" !== i[r] && ((t = /([^=]*)=(.*)/.exec(i[r]).slice(1))[0] = t[0].replace(/^\s+|\s+$/g, ""), t[1] = t[1].replace(/^\s+|\s+$/g, ""), t[1] = t[1].replace(/^['"](.*)['"]$/g, "$1"), u[t[0]] = t[1]); return u } function sn(n) { return !!n && "object" == typeof n } function lt() { for (var t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; return i.reduce(function (n, t) { return Object.keys(t).forEach(function (i) { n[i] = Array.isArray(n[i]) && Array.isArray(t[i]) ? n[i].concat(t[i]) : sn(n[i]) && sn(t[i]) ? lt(n[i], t[i]) : t[i] }), n }, {}) } function nh(n) { return n.reduce(function (n, t) { return n.concat(t) }, []) } function hn(n) { if (!n.length) return []; for (var i = [], t = 0; t < n.length; t++)i.push(n[t]); return i } function av(t, i) { return /^[a-z]+:/i.test(i) ? i : (/\/\//i.test(t) || (t = wn.buildAbsoluteURL(n.location.href, t)), wn.buildAbsoluteURL(t, i)) } function le(n) { var t = n.baseUrl, l = void 0 === t ? "" : t, i = n.source, r = void 0 === i ? "" : i, u = n.range, f = void 0 === u ? "" : u, e = n.indexRange, o = void 0 === e ? "" : e, s = { uri: r, resolvedUri: av(l || "", r) }; if (f || o) { var h = (f || o).split("-"), c = parseInt(h[0], 10), a = parseInt(h[1], 10); s.byterange = { length: a - c + 1, offset: c } } return s } function vv(n) { var r = n.type, u = void 0 === r ? "static" : r, o = n.duration, f = n.timescale, s = void 0 === f ? 1 : f, h = n.sourceDuration, e = wot[u](n), t = function (n, t) { for (var r = [], i = n; i < t; i++)r.push(i); return r }(e.start, e.end).map(function (n) { return function (t, i) { var r = n.duration, u = n.timescale, e = void 0 === u ? 1 : u, o = n.periodIndex, f = n.startNumber; return { number: (void 0 === f ? 1 : f) + t, duration: r / e, timeline: o, time: i * r } } }(n)), i; return "static" === u && (i = t.length - 1, t[i].duration = h - o / s * i), t } function ln(n) { var i = n.baseUrl, u = n.initialization, f = void 0 === u ? {} : u, e = n.sourceDuration, o = n.timescale, c = void 0 === o ? 1 : o, s = n.indexRange, l = void 0 === s ? "" : s, a = n.duration, h, t, r; if (!i) throw new Error(oot); return h = le({ baseUrl: i, source: f.sourceURL, range: f.range }), t = le({ baseUrl: i, source: i, indexRange: l }), (t.map = h, a) ? (r = vv(n), r.length && (t.duration = r[0].duration, t.timeline = r[0].timeline)) : e && (t.duration = e / c, t.timeline = 0), t.number = 0, [t] } function cot(n, t, i) { for (var f = n.sidx.map ? n.sidx.map : null, a = n.sidx.duration, e = n.timeline || 0, o = n.sidx.byterange, v = o.offset + o.length, y = t.timescale, p = t.references.filter(function (n) { return 1 !== n.referenceType }), s = [], r = v + t.firstOffset, u = 0; u < p.length; u++) { var h = t.references[u], c = h.referencedSize, w = h.subsegmentDuration, l = ln({ baseUrl: i, timescale: y, timeline: e, periodIndex: e, duration: w, sourceDuration: a, indexRange: r + "-" + (r + c - 1) })[0]; f && (l.map = f); s.push(l); r += c } return n.segments = s, n } function an(n) { return function (n) { return Object.keys(n).map(function (t) { return n[t] }) }(n.reduce(function (n, t) { var r, i = t.attributes.id + (t.attributes.lang || ""); return n[i] ? (t.segments[0] && (t.segments[0].discontinuity = !0), (r = n[i].segments).push.apply(r, t.segments), t.attributes.contentProtection && (n[i].attributes.contentProtection = t.attributes.contentProtection)) : n[i] = t, n }, {})).map(function (n) { return n.discontinuityStarts = function (n, t) { return n.reduce(function (n, i, r) { return i[t] && n.push(r), n }, []) }(n.segments, "discontinuity"), n }) } function yv(n, t) { var e, i, u, f, r, o; if (void 0 === t && (t = {}), !Object.keys(t).length) return n; for (e in n) i = n[e], i.sidx && (u = i.sidx.uri + "-" + (r = i.sidx.byterange, void 0, o = r.offset + r.length - 1, r.offset + "-" + o), f = t[u] && t[u].sidx, i.sidx && f && cot(i, f, i.sidx.resolvedUri)); return n } function lot(n) { var i, t = n.attributes, r = n.segments, f = n.sidx, u = { attributes: (i = { NAME: t.id, AUDIO: "audio", SUBTITLES: "subs", RESOLUTION: { width: t.width, height: t.height }, CODECS: t.codecs, BANDWIDTH: t.bandwidth }, i["PROGRAM-ID"] = 1, i), uri: "", endList: "static" === (t.type || "static"), timeline: t.periodIndex, resolvedUri: "", targetDuration: t.duration, segments: r, mediaSequence: r.length ? r[0].number : 1 }; return t.contentProtection && (u.contentProtection = t.contentProtection), f && (u.sidx = f), u } function aot(n, t) { var i; if (void 0 === t && (t = {}), !n.length) return {}; var u = n[0].attributes, s = u.sourceDuration, f = u.minimumUpdatePeriod, h = void 0 === f ? 0 : f, c = an(n.filter(function (n) { var t = n.attributes; return "video/mp4" === t.mimeType || "video" === t.contentType })).map(lot), e = an(n.filter(function (n) { var t = n.attributes; return "audio/mp4" === t.mimeType || "audio" === t.contentType })), o = n.filter(function (n) { var t = n.attributes; return "text/vtt" === t.mimeType || "text" === t.contentType }), r = { allowCache: !0, discontinuityStarts: [], segments: [], endList: !0, mediaGroups: (i = { AUDIO: {}, VIDEO: {} }, i["CLOSED-CAPTIONS"] = {}, i.SUBTITLES = {}, i), uri: "", duration: s, playlists: yv(c, t), minimumUpdatePeriod: 1e3 * h }; return e.length && (r.mediaGroups.AUDIO.audio = function (n, t) { var r, i; return void 0 === t && (t = {}), i = n.reduce(function (n, i) { var u = i.attributes.role && i.attributes.role.value || "", e = i.attributes.lang || "", f = "main", o; return e && (o = u ? " (" + u + ")" : "", f = i.attributes.lang + o), n[f] && n[f].playlists[0].attributes.BANDWIDTH > i.attributes.bandwidth || (n[f] = { language: e, autoselect: !0, "default": "main" === u, playlists: yv([function (n) { var i, t = n.attributes, r = n.segments, f = n.sidx, u = { attributes: (i = { NAME: t.id, BANDWIDTH: t.bandwidth, CODECS: t.codecs }, i["PROGRAM-ID"] = 1, i), uri: "", endList: "static" === (t.type || "static"), timeline: t.periodIndex, resolvedUri: "", targetDuration: t.duration, segments: r, mediaSequence: r.length ? r[0].number : 1 }; return t.contentProtection && (u.contentProtection = t.contentProtection), f && (u.sidx = f), u }(i)], t), uri: "" }, "undefined" == typeof r && "main" === u && ((r = i).default = !0)), n }, {}), r || (i[Object.keys(i)[0]].default = !0), i }(e, t)), o.length && (r.mediaGroups.SUBTITLES.subs = function (n, t) { return void 0 === t && (t = {}), n.reduce(function (n, i) { var r = i.attributes.lang || "text"; return n[r] || (n[r] = { language: r, "default": !1, autoselect: !1, playlists: yv([function (n) { var r, t = n.attributes, i = n.segments; return "undefined" == typeof i && (i = [{ uri: t.baseUrl, timeline: t.periodIndex, resolvedUri: t.baseUrl || "", duration: t.sourceDuration, number: 0 }], t.duration = t.sourceDuration), { attributes: (r = { NAME: t.id, BANDWIDTH: t.bandwidth }, r["PROGRAM-ID"] = 1, r), uri: "", endList: "static" === (t.type || "static"), timeline: t.periodIndex, resolvedUri: t.baseUrl || "", targetDuration: t.duration, segments: i, mediaSequence: i.length ? i[0].number : 1 } }(i)], t), uri: "" }), n }, {}) }(o, t)), r } function vn(n, t) { for (var s, y, ct, h, r, p, w, b, k, d, c, g, l, nt, a, tt, it = n.type, lt = void 0 === it ? "static" : it, rt = n.minimumUpdatePeriod, at = void 0 === rt ? 0 : rt, ut = n.media, vt = void 0 === ut ? "" : ut, yt = n.sourceDuration, ft = n.timescale, et = void 0 === ft ? 1 : ft, ot = n.startNumber, st = void 0 === ot ? 1 : ot, pt = n.periodIndex, f = [], i = -1, e = 0; e < t.length; e++) { var v = t[e], u = v.d, ht = v.r || 0, o = v.t || 0; for (i < 0 && (i = o), o && i < o && (i = o), s = void 0, ht < 0 ? (y = e + 1, s = y === t.length ? "dynamic" === lt && 0 < at && 0 < vt.indexOf("$Number$") ? (p = i, w = u, void 0, b = (r = n).NOW, k = r.clientOffset, d = r.availabilityStartTime, c = r.timescale, g = void 0 === c ? 1 : c, l = r.start, nt = void 0 === l ? 0 : l, a = r.minimumUpdatePeriod, tt = (b + k) / 1e3 + (void 0 === a ? 0 : a) - (d + nt), Math.ceil((tt * g - p) / w)) : (yt * et - i) / u : (t[y].t - i) / u) : s = ht + 1, ct = st + f.length + s, h = st + f.length; h < ct;)f.push({ number: h, duration: u / et, time: i, timeline: pt }), i += u, h++ } return f } function yn(n, t) { return n.replace(bot, function (n) { return function (t, i, r, u) { if ("$$" === t) return "$"; if ("undefined" == typeof n[i]) return t; var f = "" + n[i]; return "RepresentationID" === i ? f : (u = r ? parseInt(u, 10) : 1) <= f.length ? f : new Array(u - f.length + 1).join("0") + f } }(t)) } function vot(n, t) { var i = { RepresentationID: n.id, Bandwidth: n.bandwidth || 0 }, r = n.initialization, u = void 0 === r ? { sourceURL: "", range: "" } : r, f = le({ baseUrl: n.baseUrl, source: yn(u.sourceURL, i), range: u.range }); return function (n, t) { return n.duration || t ? n.duration ? vv(n) : vn(n, t) : [{ number: n.startNumber || 1, duration: n.sourceDuration, time: 0, timeline: n.periodIndex }] }(n, t).map(function (t) { i.Number = t.number; i.Time = t.time; var r = yn(n.media || "", i); return { uri: r, timeline: t.timeline, duration: t.duration, resolvedUri: av(n.baseUrl || "", r), map: f, number: t.number } }) } function yot(n, t) { var i = n.duration, f = n.segmentUrls, e = void 0 === f ? [] : f, r, u; if (!i && !t || i && t) throw new Error(sot); return u = e.map(function (t) { return function (n, t) { var i = n.baseUrl, r = n.initialization, u = void 0 === r ? {} : r, e = le({ baseUrl: i, source: u.sourceURL, range: u.range }), f = le({ baseUrl: i, source: t.media, range: t.mediaRange }); return f.map = e, f }(n, t) }), i && (r = vv(n)), t && (r = vn(n, t)), r.map(function (n, t) { if (u[t]) { var i = u[t]; return i.timeline = n.timeline, i.duration = n.duration, i.number = n.number, i } }).filter(function (n) { return n }) } function pot(n) { var t, u, e = n.attributes, i = n.segmentInfo, r, f; if (i.template ? (u = vot, t = lt(e, i.template)) : i.base ? (u = ln, t = lt(e, i.base)) : i.list && (u = yot, t = lt(e, i.list)), r = { attributes: e }, !u) return r; if (f = u(t, i.timeline), t.duration) { var o = t, h = o.duration, s = o.timescale, c = void 0 === s ? 1 : s; t.duration = h / c } else t.duration = f.length ? f.reduce(function (n, t) { return Math.max(n, Math.ceil(t.duration)) }, 0) : 0; return r.attributes = t, r.segments = f, i.base && t.indexRange && (r.sidx = f[0], r.segments = []), r } function g(n, t) { return hn(n.childNodes).filter(function (n) { return n.tagName === t }) } function pn(n) { return n.textContent.trim() } function ae(n) { var i = /P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(n); if (!i) return 0; var t = i.slice(1), r = t[0], u = t[1], f = t[2], e = t[3], o = t[4], s = t[5]; return 31536e3 * parseFloat(r || 0) + 2592e3 * parseFloat(u || 0) + 86400 * parseFloat(f || 0) + 3600 * parseFloat(e || 0) + 60 * parseFloat(o || 0) + parseFloat(s || 0) } function st(n) { return n && n.attributes ? hn(n.attributes).reduce(function (n, t) { var i = bn[t.name] || bn.DEFAULT; return n[t.name] = i(t.value), n }, {}) : {} } function th(n, t) { return t.length ? nh(n.map(function (n) { return t.map(function (t) { return av(n, pn(t)) }) })) : n } function wv(n) { var f = g(n, "SegmentTemplate")[0], i = g(n, "SegmentList")[0], c = i && g(i, "SegmentURL").map(function (n) { return lt({ tag: "SegmentURL" }, st(n)) }), e = g(n, "SegmentBase")[0], o = i || f, s = o && g(o, "SegmentTimeline")[0], h = i || e || f, r = h && g(h, "Initialization")[0], t = f && st(f), u; return t && r ? t.initialization = r && st(r) : t && t.initialization && (t.initialization = { sourceURL: t.initialization }), u = { template: t, timeline: s && g(s, "S").map(function (n) { return st(n) }), list: i && lt(st(i), { segmentUrls: c, initialization: st(r) }), base: e && lt(st(e), { initialization: st(r) }) }, Object.keys(u).forEach(function (n) { u[n] || delete u[n] }), u } function kot(t) { return t.reduce(function (t, i) { var e = st(i), r = tst[e.schemeIdUri], u, f, o; return r && (t[r] = { attributes: e }, u = g(i, "cenc:pssh")[0], u && (f = pn(u), o = f && function (t) { for (var r = n.atob(t), u = new Uint8Array(r.length), i = 0; i < r.length; i++)u[i] = r.charCodeAt(i); return u }(f), t[r].pssh = o)), t }, {}) } function dot(n, t, i) { return function (r) { var e = st(r), o = th(t, g(r, "BaseURL")), s = g(r, "Role")[0], h = { role: st(s) }, u = lt(n, e, h), f = kot(g(r, "ContentProtection")); Object.keys(f).length && (u = lt(u, { contentProtection: f })); var c = wv(r), l = g(r, "Representation"), a = lt(i, c); return nh(l.map(function (n, t, i) { return function (r) { var u = g(r, "BaseURL"), f = th(t, u), e = lt(n, st(r)), o = wv(r); return f.map(function (n) { return { segmentInfo: lt(i, o), attributes: lt(e, { baseUrl: n }) } }) } }(u, o, a))) } } function got(t, i) { var r, h; void 0 === i && (i = {}); var u = i, f = u.manifestUri, c = void 0 === f ? "" : f, e = u.NOW, l = void 0 === e ? Date.now() : e, o = u.clientOffset, a = void 0 === o ? 0 : o, s = g(t, "Period"); if (!s.length) throw new Error(uot); return r = st(t), h = th([c], g(t, "BaseURL")), r.sourceDuration = r.mediaPresentationDuration || 0, r.NOW = l, r.clientOffset = a, nh(s.map(function (t, i) { return function (r, u) { var e = th(i, g(r, "BaseURL")), o = st(r), f = parseInt(o.id, 10), s = n.isNaN(f) ? u : f, h = lt(t, { periodIndex: s }), c = g(r, "AdaptationSet"), l = wv(r); return nh(c.map(dot(h, e, l))) } }(r, h))) } function kn(t) { if ("" === t) throw new Error(fot); var r = (new n.DOMParser).parseFromString(t, "application/xml"), i = r && "MPD" === r.documentElement.tagName ? r.documentElement : null; if (!i || i && 0 < i.getElementsByTagName("parsererror").length) throw new Error(eot); return i } function dn(n, t) { return void 0 === t && (t = {}), aot(function (n) { return n.map(pot) }(got(kn(n), t)), t.sidxMapping) } function nst(n) { return function (n) { var i = g(n, "UTCTiming")[0], t; if (!i) return null; t = st(i); switch (t.schemeIdUri) { case "urn:mpeg:dash:utc:http-head:2014": case "urn:mpeg:dash:utc:http-head:2012": t.method = "HEAD"; break; case "urn:mpeg:dash:utc:http-xsdate:2014": case "urn:mpeg:dash:utc:http-iso:2014": case "urn:mpeg:dash:utc:http-xsdate:2012": case "urn:mpeg:dash:utc:http-iso:2012": t.method = "GET"; break; case "urn:mpeg:dash:utc:direct:2014": case "urn:mpeg:dash:utc:direct:2012": t.method = "DIRECT"; t.value = Date.parse(t.value); break; case "urn:mpeg:dash:utc:http-ntp:2014": case "urn:mpeg:dash:utc:ntp:2014": case "urn:mpeg:dash:utc:sntp:2014": default: throw new Error(hot); }return t }(kn(n)) } function gt(n) { return new Date(1e3 * n - 20828448e5) } function rtt(n) { return { isLeading: (12 & n[0]) >>> 2, dependsOn: 3 & n[0], isDependedOn: (192 & n[1]) >>> 6, hasRedundancy: (48 & n[1]) >>> 4, paddingValue: (14 & n[1]) >>> 1, isNonSyncSample: 1 & n[1], degradationPriority: n[2] << 8 | n[3] } } function pr() { this.init = function () { var n = {}; this.on = function (t, i) { n[t] || (n[t] = []); n[t] = n[t].concat(i) }; this.off = function (t, i) { var r; return !!n[t] && (r = n[t].indexOf(i), n[t] = n[t].slice(), n[t].splice(r, 1), -1 < r) }; this.trigger = function (t) { var r, i, u, f; if (r = n[t]) if (2 === arguments.length) for (u = r.length, i = 0; i < u; ++i)r[i].call(this, arguments[1]); else { for (f = [], i = arguments.length, i = 1; i < arguments.length; ++i)f.push(arguments[i]); for (u = r.length, i = 0; i < u; ++i)r[i].apply(this, f) } }; this.dispose = function () { n = {} } } } function ni() { ni.prototype.init.call(this); this.captionPackets_ = []; this.ccStreams_ = [new w(0, 0), new w(0, 1), new w(1, 0), new w(1, 1)]; this.reset(); this.ccStreams_.forEach(function (n) { n.on("data", this.trigger.bind(this, "data")); n.on("partialdone", this.trigger.bind(this, "partialdone")); n.on("done", this.trigger.bind(this, "done")) }, this) } function fh(n) { return null === n ? "" : (n = ost[n] || n, String.fromCharCode(n)) } function br() { for (var n = [], t = 15; t--;)n.push(""); return n } function hst(n, t) { for (var r, u = n, i = 0; i < t.length; i++) { if (r = t[i], u < r.size) return r; u -= r.size } return null } function cst(n, t) { var u = oi.findBox(n, ["moof", "traf"]), f = oi.findBox(n, ["mdat"]), i = {}, r = []; return f.forEach(function (n, t) { var i = u[t]; r.push({ mdat: n, traf: i }) }), r.forEach(function (n) { var f, h = n.mdat, u = n.traf, c = oi.findBox(u, ["tfhd"]), e = rh.parseTfhd(c[0]), r = e.trackId, o = oi.findBox(u, ["tfdt"]), l = 0 < o.length ? rh.parseTfdt(o[0]).baseMediaDecodeTime : 0, s = oi.findBox(u, ["trun"]); t === r && 0 < s.length && (f = function (n, t, i) { for (var u, f, o, c = new DataView(n.buffer, n.byteOffset, n.byteLength), h = [], s, e, r = 0; r + 4 < n.length; r += f)if (f = c.getUint32(r), r += 4, !(f <= 0)) switch (31 & n[r]) { case 6: s = n.subarray(r + 1, r + 1 + f); e = hst(r, t); u = { nalUnitType: "sei_rbsp", size: f, data: s, escapedRBSP: ast(s), trackId: i }; e ? (u.pts = e.pts, u.dts = e.dts, o = e) : (u.pts = o.pts, u.dts = o.dts); h.push(u) }return h }(h, function (n, t, i) { var r = t, f = i.defaultSampleDuration || 0, e = i.defaultSampleSize || 0, o = i.trackId, u = []; return n.forEach(function (n) { var t = rh.parseTrun(n).samples; t.forEach(function (n) { void 0 === n.duration && (n.duration = f); void 0 === n.size && (n.size = e); n.trackId = o; n.dts = r; void 0 === n.compositionTimeOffset && (n.compositionTimeOffset = 0); n.pts = r + n.compositionTimeOffset; r += n.duration }); u = u.concat(t) }), u }(s, l, e), r), i[r] || (i[r] = []), i[r] = i[r].concat(f)) }), i } function lst(n, t) { var i = 1; for (t < n && (i = -1); 4294967296 < Math.abs(t - n);)n += 8589934592 * i; return n } function ott(n) { var t = 31 & n[1]; return t <<= 8, t | n[2] } function eh(n) { return !!(64 & n[1]) } function oh(n) { var t = 0; return 1 < (48 & n[3]) >>> 4 && (t += n[4] + 1), t } function bv(n) { switch (n) { case 5: return "slice_layer_without_partitioning_rbsp_idr"; case 6: return "sei_rbsp"; case 7: return "seq_parameter_set_rbsp"; case 8: return "pic_parameter_set_rbsp"; case 9: return "access_unit_delimiter_rbsp"; default: return null } } function stt(n) { return n[0] << 21 | n[1] << 14 | n[2] << 7 | n[3] } function iht(n, t, i) { for (var u, s, h, e, f = 0, r = ht, o = !1; r <= n.byteLength;)if (71 !== n[f] || 71 !== n[r] && r !== n.byteLength) f++, r++; else { switch (u = n.subarray(f, r), l.ts.parseType(u, t.pid)) { case "pes": s = l.ts.parsePesType(u, t.table); h = l.ts.parsePayloadUnitStartIndicator(u); "audio" === s && h && (e = l.ts.parsePesTime(u)) && (e.type = "audio", i.audio.push(e), o = !0) }if (o) break; f += ht; r += ht } for (f = (r = n.byteLength) - ht, o = !1; 0 <= f;)if (71 !== n[f] || 71 !== n[r] && r !== n.byteLength) f--, r--; else { switch (u = n.subarray(f, r), l.ts.parseType(u, t.pid)) { case "pes": s = l.ts.parsePesType(u, t.table); h = l.ts.parsePayloadUnitStartIndicator(u); "audio" === s && h && (e = l.ts.parsePesTime(u)) && (e.type = "audio", i.audio.push(e), o = !0) }if (o) break; f -= ht; r -= ht } } function rht(n, t, i) { for (var p, r, c, h, o, a, v, y, u = 0, f = ht, s = !1, e = { data: [], size: 0 }; f < n.byteLength;)if (71 !== n[u] || 71 !== n[f]) u++, f++; else { switch (r = n.subarray(u, f), l.ts.parseType(r, t.pid)) { case "pes": if (c = l.ts.parsePesType(r, t.table), h = l.ts.parsePayloadUnitStartIndicator(r), "video" === c && (h && !s && (o = l.ts.parsePesTime(r)) && (o.type = "video", i.video.push(o), s = !0), !i.firstKeyFrame)) { if (h && 0 !== e.size) { for (a = new Uint8Array(e.size), v = 0; e.data.length;)y = e.data.shift(), a.set(y, v), v += y.byteLength; l.ts.videoPacketContainsKeyFrame(a) && (p = l.ts.parsePesTime(a), p && (i.firstKeyFrame = p, i.firstKeyFrame.type = "video")); e.size = 0 } e.data.push(r); e.size += r.byteLength } }if (s && i.firstKeyFrame) break; u += ht; f += ht } for (u = (f = n.byteLength) - ht, s = !1; 0 <= u;)if (71 !== n[u] || 71 !== n[f]) u--, f--; else { switch (r = n.subarray(u, f), l.ts.parseType(r, t.pid)) { case "pes": c = l.ts.parsePesType(r, t.table); h = l.ts.parsePayloadUnitStartIndicator(r); "video" === c && h && (o = l.ts.parsePesTime(r)) && (o.type = "video", i.video.push(o), s = !0) }if (s) break; u -= ht; f -= ht } } function uht(n) { var i = { pid: null, table: null }, t = {}; for (var r in function (n, t) { for (var r, u = 0, i = ht; i < n.byteLength;)if (71 !== n[u] || 71 !== n[i]) u++, i++; else { switch (r = n.subarray(u, i), l.ts.parseType(r, t.pid)) { case "pat": t.pid || (t.pid = l.ts.parsePat(r)); break; case "pmt": t.table || (t.table = l.ts.parsePmt(r)) }if (t.pid && t.table) return; u += ht; i += ht } }(n, i), i.table) if (i.table.hasOwnProperty(r)) switch (i.table[r]) { case ftt: t.video = []; rht(n, i, t); 0 === t.video.length && delete t.video; break; case ett: t.audio = []; iht(n, i, t); 0 === t.audio.length && delete t.audio }return t } function sh(n, t) { if (!(n instanceof t)) throw new TypeError("Cannot call a class as a function"); } function ctt(n, t) { for (var i, r = 0; r < t.length; r++)i = t[r], i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(n, i.key, i) } function kv(n) { sh(this, kv); wt = wt || function () { for (var h = [[[], [], [], [], []], [[], [], [], [], []]], f = h[0], e = h[1], l = f[4], y = e[4], n = void 0, i = void 0, t = void 0, u = [], a = [], c = void 0, v = void 0, r = void 0, o = void 0, s = void 0, n = 0; n < 256; n++)a[(u[n] = n << 1 ^ 283 * (n >> 7)) ^ n] = n; for (i = t = 0; !l[i]; i ^= c || 1, t = a[t] || 1)for (r = (r = t ^ t << 1 ^ t << 2 ^ t << 3 ^ t << 4) >> 8 ^ 255 & r ^ 99, s = 16843009 * u[v = u[c = u[y[l[i] = r] = i]]] ^ 65537 * v ^ 257 * c ^ 16843008 * i, o = 257 * u[r] ^ 16843008 * r, n = 0; n < 4; n++)f[n][i] = o = o << 24 ^ o >>> 8, e[n][r] = s = s << 24 ^ s >>> 8; for (n = 0; n < 5; n++)f[n] = f[n].slice(0), e[n] = e[n].slice(0); return h }(); this._tables = [[wt[0][0].slice(), wt[0][1].slice(), wt[0][2].slice(), wt[0][3].slice(), wt[0][4].slice()], [wt[1][0].slice(), wt[1][1].slice(), wt[1][2].slice(), wt[1][3].slice(), wt[1][4].slice()]]; var i = void 0, e = void 0, t = void 0, f = void 0, h = void 0, u = this._tables[0][4], o = this._tables[1], r = n.length, s = 1; if (4 !== r && 6 !== r && 8 !== r) throw new Error("Invalid aes key size"); for (f = n.slice(0), h = [], this._key = [f, h], i = r; i < 4 * r + 28; i++)t = f[i - 1], (i % r == 0 || 8 === r && i % r == 4) && (t = u[t >>> 24] << 24 ^ u[t >> 16 & 255] << 16 ^ u[t >> 8 & 255] << 8 ^ u[255 & t], i % r == 0 && (t = t << 8 ^ t >>> 24 ^ s << 24, s = s << 1 ^ 283 * (s >> 7))), f[i] = f[i - r] ^ t; for (e = 0; i; e++, i--)t = f[3 & e ? i : i - 4], h[e] = i <= 4 || e < 4 ? t : o[0][u[t >>> 24]] ^ o[1][u[t >> 16 & 255]] ^ o[2][u[t >> 8 & 255]] ^ o[3][u[255 & t]] } function dr() { sh(this, dr); this.listeners = {} } function ye() { sh(this, ye); var n = function (n, t) { if (!n) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? n : t }(this, att.call(this, dv)); return n.jobs = [], n.delay = 1, n.timeout_ = null, n } function ti(n) { return n << 24 | (65280 & n) << 8 | (16711680 & n) >> 8 | n >>> 24 } function vtt(n, t, i) { var f = new Int32Array(n.buffer, n.byteOffset, n.byteLength >> 2), p = new ltt(Array.prototype.slice.call(t)), y = new Uint8Array(n.byteLength), u = new Int32Array(y.buffer), e = void 0, o = void 0, s = void 0, h = void 0, c = void 0, l = void 0, a = void 0, v = void 0, r = void 0; for (e = i[0], o = i[1], s = i[2], h = i[3], r = 0; r < f.length; r += 4)c = ti(f[r]), l = ti(f[r + 1]), a = ti(f[r + 2]), v = ti(f[r + 3]), p.decrypt(c, l, a, v, u, r), u[r] = ti(u[r] ^ e), u[r + 1] = ti(u[r + 1] ^ o), u[r + 2] = ti(u[r + 2] ^ s), u[r + 3] = ti(u[r + 3] ^ h), e = c, o = l, s = a, h = v; return y } function pe(n, t, i, r) { sh(this, pe); var e = pe.STEP, f = new Int32Array(n.buffer), o = new Uint8Array(n.byteLength), u = 0; for (this.asyncStream_ = new gv, this.asyncStream_.push(this.decryptChunk_(f.subarray(u, u + e), t, i, o)), u = e; u < f.length; u += e)i = new Uint32Array([ti(f[u - 4]), ti(f[u - 3]), ti(f[u - 2]), ti(f[u - 1])]), this.asyncStream_.push(this.decryptChunk_(f.subarray(u, u + e), t, i, o)); this.asyncStream_.push(function () { r(null, function (n) { return n.subarray(0, n.byteLength - n[n.byteLength - 1]) }(o)) }) } function gr(t, i) { return /^[a-z]+:/i.test(i) ? i : (/\/\//i.test(t) || (t = hv.buildAbsoluteURL(n.location.href, t)), hv.buildAbsoluteURL(t, i)) } function hh(n, t, i) { return n && i.responseURL && t !== i.responseURL ? i.responseURL : t } function ii(n, t) { if (!(n instanceof t)) throw new TypeError("Cannot call a class as a function"); } function ptt(n, t) { for (var i, r = 0; r < t.length; r++)i = t[r], i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(n, i.key, i) } function ai(n, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); n.prototype = Object.create(t && t.prototype, { constructor: { value: n, enumerable: !1, writable: !0, configurable: !0 } }); t && (Object.setPrototypeOf ? Object.setPrototypeOf(n, t) : n.__proto__ = t) } function si(n, t) { if (!n) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? n : t } function ch(n, t) { ["AUDIO", "SUBTITLES"].forEach(function (i) { var r, u, f; for (r in n.mediaGroups[i]) for (u in n.mediaGroups[i][r]) f = n.mediaGroups[i][r][u], t(f, i, r, u) }) } function ny(n, t) { var r = ty(n, {}), i = r.playlists[t.uri], u, f; if (!i || i.segments && t.segments && i.segments.length === t.segments.length && i.endList === t.endList && i.mediaSequence === t.mediaSequence) return null; for (u = ty(i, t), i.segments && (u.segments = function (n, t, i) { var u = t.slice(), f, r; for (i = i || 0, f = Math.min(n.length, t.length + i), r = i; r < f; r++)u[r - i] = ty(n[r], u[r - i]); return u }(i.segments, t.segments, t.mediaSequence - i.mediaSequence)), u.segments.forEach(function (n) { !function (n, t) { n.resolvedUri || (n.resolvedUri = gr(t, n.uri)); n.key && !n.key.resolvedUri && (n.key.resolvedUri = gr(t, n.key.uri)); n.map && !n.map.resolvedUri && (n.map.resolvedUri = gr(t, n.map.uri)) }(n, u.resolvedUri) }), f = 0; f < r.playlists.length; f++)r.playlists[f].uri === t.uri && (r.playlists[f] = u); return r.playlists[t.uri] = u, r } function wtt(n) { for (var t, i = n.playlists.length; i--;)t = n.playlists[i], (n.playlists[t.uri] = t).resolvedUri = gr(n.uri, t.uri), t.id = i, t.attributes || (t.attributes = {}, oht.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")) } function btt(n) { ch(n, function (t) { t.uri && (t.resolvedUri = gr(n.uri, t.uri)) }) } function ktt(n, t) { var i = n.segments[n.segments.length - 1]; return t && i && i.duration ? 1e3 * i.duration : 500 * (n.targetDuration || 10) } function gu(n, t) { var u = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : {}, r; ii(this, gu); var i = si(this, (gu.__proto__ || Object.getPrototypeOf(gu)).call(this)), f = u.withCredentials, o = void 0 !== f && f, e = u.handleManifestRedirects, s = void 0 !== e && e; if (i.srcUrl = n, i.hls_ = t, i.withCredentials = o, i.handleManifestRedirects = s, r = t.options_, i.customTagParsers = r && r.customTagParsers || [], i.customTagMappers = r && r.customTagMappers || [], !i.srcUrl) throw new Error("A non-empty playlist URL is required"); return i.state = "HAVE_NOTHING", i.on("mediaupdatetimeout", function () { "HAVE_METADATA" === i.state && (i.state = "HAVE_CURRENT_METADATA", i.request = i.hls_.xhr({ uri: gr(i.master.uri, i.media().uri), withCredentials: i.withCredentials }, function (n) { if (i.request) return n ? i.playlistRequestError(i.request, i.media().uri, "HAVE_METADATA") : void i.haveMetadata(i.request, i.media().uri) })) }), i } function dtt(n, t, i) { var r, u; return "undefined" == typeof t && (t = n.mediaSequence + n.segments.length), t < n.mediaSequence ? 0 : (r = function (n, t) { var r = 0, u = t - n.mediaSequence, i = n.segments[u]; if (i) { if ("undefined" != typeof i.start) return { result: i.start, precise: !0 }; if ("undefined" != typeof i.end) return { result: i.end - i.duration, precise: !0 } } for (; u--;) { if ("undefined" != typeof (i = n.segments[u]).end) return { result: r + i.end, precise: !0 }; if (r += i.duration, "undefined" != typeof i.start) return { result: r + i.start, precise: !0 } } return { result: r, precise: !1 } }(n, t)).precise ? r.result : (u = function (n, t) { for (var r = 0, i = void 0, u = t - n.mediaSequence; u < n.segments.length; u++) { if ("undefined" != typeof (i = n.segments[u]).start) return { result: i.start - r, precise: !0 }; if (r += i.duration, "undefined" != typeof i.end) return { result: i.end - r, precise: !0 } } return { result: -1, precise: !1 } }(n, t)).precise ? u.result : r.result + i } function gtt(t, i, r) { if (!t) return 0; if ("number" != typeof r && (r = 0), "undefined" == typeof i) { if (t.totalDuration) return t.totalDuration; if (!t.endList) return n.Infinity } return dtt(t, i, r) } function we(n, t, i) { var u = 0, f, e, r; if (i < t && (f = [i, t], t = f[0], i = f[1]), t < 0) { for (e = t; e < Math.min(0, i); e++)u += n.targetDuration; t = 0 } for (r = t; r < i; r++)u += n.segments[r].duration; return u } function nit(n) { if (!n.segments.length) return 0; for (var t = n.segments.length - 1, i = n.segments[t].duration || n.targetDuration, r = i + 2 * n.targetDuration; t-- && !(r <= (i += n.segments[t].duration));); return Math.max(0, t) } function tit(n, t, i) { if (!n || !n.segments) return null; if (n.endList) return gtt(n); if (null === t) return null; t = t || 0; var r = i ? nit(n) : n.segments.length; return dtt(n, n.mediaSequence + r, t) } function iit(n) { return n - Math.floor(n) == 0 } function rit(n, t) { var r, i, u, f; if (iit(t)) return t + .1 * n; for (r = t.toString().split(".")[1].length, i = 1; i <= r; i++)if (u = Math.pow(10, i), f = t * u, iit(f) || i === r) return (f + n) / u } function uit(n) { return n.excludeUntil && n.excludeUntil > Date.now() } function iy(n) { return n.excludeUntil && n.excludeUntil === 1 / 0 } function ah(n) { var t = uit(n); return !n.disabled && !t } function fit(n, t) { return t.attributes && t.attributes[n] } function ry(n, t) { if (1 === n.playlists.length) return !0; var i = t.attributes.BANDWIDTH || Number.MAX_VALUE; return 0 === n.playlists.filter(function (n) { return !!ah(n) && (n.attributes.BANDWIDTH || 0) < i }).length } function eit() { return function n(t, r) { var f, e, u, o; return t = pht({ timeout: 45e3 }, t), f = n.beforeRequest || i.Hls.xhr.beforeRequest, f && "function" == typeof f && (e = f(t), e && (t = e)), u = yht(t, function (n, t) { var i = u.response; !n && i && (u.responseTime = Date.now(), u.roundTripTime = u.responseTime - u.requestTime, u.bytesReceived = i.byteLength || i.length, u.bandwidth || (u.bandwidth = Math.floor(u.bytesReceived / u.roundTripTime * 8e3))); t.headers && (u.responseHeaders = t.headers); n && "ETIMEDOUT" === n.code && (u.timedout = !0); n || u.aborted || 200 === t.statusCode || 206 === t.statusCode || 0 === t.statusCode || (n = new Error("XHR Failed with a response of: " + (u && (i || u.responseText)))); r(n, u) }), o = u.abort, u.abort = function () { return u.aborted = !0, o.apply(u, arguments) }, u.uri = t.uri, u.requestTime = Date.now(), u } } function uy(n) { var t = {}; return n.byterange && (t.Range = function (n) { var t; return t = n.offset + n.length - 1, "bytes=" + n.offset + "-" + t }(n.byterange)), t } function sht(n, t) { var i = n.toString(16); return "00".substring(0, 2 - i.length) + i + (t % 2 ? " " : "") } function hht(n) { return 32 <= n && n < 126 ? String.fromCharCode(n) : "." } function oit(n) { var t = {}; return Object.keys(n).forEach(function (i) { var r = n[i]; t[i] = ArrayBuffer.isView(r) ? { bytes: r.buffer, byteOffset: r.byteOffset, byteLength: r.byteLength } : r }), t } function vh(n) { var t = n.byterange || { length: 1 / 0, offset: 0 }; return [t.length, t.offset, n.resolvedUri].join(",") } function sit(n) { return n.resolvedUri } function hit(n) { for (var i = Array.prototype.slice.call(n), r = "", t = 0; t < i.length / 16; t++)r += i.slice(16 * t, 16 * t + 16).map(sht).join("") + " " + i.slice(16 * t, 16 * t + 16).map(hht).join("") + "\n"; return r } function cht(n) { var e = n.playlist, o = n.time, r = void 0 === o ? void 0 : o, t = n.callback, i, u, f; if (!t) throw new Error("getProgramTime: callback must be provided"); return !e || void 0 === r ? t({ message: "getProgramTime: playlist and time must be provided" }) : (i = function (n, t) { var u; if (!t || !t.segments || 0 === t.segments.length) return null; for (var r = 0, i = void 0, f = 0; f < t.segments.length && !(n <= (r = (i = t.segments[f]).videoTimingInfo ? i.videoTimingInfo.transmuxedPresentationEnd : r + i.duration)); f++); if (u = t.segments[t.segments.length - 1], u.videoTimingInfo && u.videoTimingInfo.transmuxedPresentationEnd < n) return null; if (r < n) { if (n > r + .25 * u.duration) return null; i = u } return { segment: i, estimatedStart: i.videoTimingInfo ? i.videoTimingInfo.transmuxedPresentationStart : r - i.duration, type: i.videoTimingInfo ? "accurate" : "estimate" } }(r, e), !i) ? t({ message: "valid programTime was not found" }) : "estimate" === i.type ? t({ message: "Accurate programTime could not be determined. Please seek to e.seekTime and try again", seekTime: i.estimatedStart }) : (u = { mediaSeconds: r }, f = function (n, t) { if (!t.dateTimeObject) return null; var i = t.videoTimingInfo.transmuxerPrependedSeconds, r = n - (t.videoTimingInfo.transmuxedPresentationStart + i); return new Date(t.dateTimeObject.getTime() + 1e3 * r) }(r, i.segment), f && (u.programDateTime = f.toISOString()), t(null, u)) } function cit(n) { var i = n.programTime, r = n.playlist, h = n.retryCount, c = void 0 === h ? 2 : h, e = n.seekTo, l = n.pauseAfterSeek, a = void 0 === l || l, u = n.tech, t = n.callback, f, o, s, v; if (!t) throw new Error("seekToProgramTime: callback must be provided"); if ("undefined" == typeof i || !r || !e) return t({ message: "seekToProgramTime: programTime, seekTo and playlist must be provided" }); if (!r.endList && !u.hasStarted_) return t({ message: "player must be playing a live stream to start buffering" }); if (!function (n) { if (!n.segments || 0 === n.segments.length) return !1; for (var t = 0; t < n.segments.length; t++)if (!n.segments[t].dateTimeObject) return !1; return !0 }(r)) return t({ message: "programDateTime tags must be provided in the manifest " + r.resolvedUri }); if (f = function (n, t) { var u = void 0, i, f; try { u = new Date(n) } catch (n) { return null } if (!t || !t.segments || 0 === t.segments.length || (i = t.segments[0], u < i.dateTimeObject)) return null; for (f = 0; f < t.segments.length - 1; f++)if (i = t.segments[f], u < t.segments[f + 1].dateTimeObject) break; var r = t.segments[t.segments.length - 1], e = r.dateTimeObject, o = r.videoTimingInfo ? function (n) { return n.transmuxedPresentationEnd - n.transmuxedPresentationStart - n.transmuxerPrependedSeconds }(r.videoTimingInfo) : r.duration + .25 * r.duration; return new Date(e.getTime() + 1e3 * o) < u ? null : (e < u && (i = r), { segment: i, estimatedStart: i.videoTimingInfo ? i.videoTimingInfo.transmuxedPresentationStart : vt.duration(t, t.mediaSequence + t.segments.indexOf(i)), type: i.videoTimingInfo ? "accurate" : "estimate" }) }(i, r), !f) return t({ message: i + " was not found in the stream" }); if (o = f.segment, s = function (n, t) { var i = void 0, r = void 0, u; try { i = new Date(n); r = new Date(t) } catch (n) { } return u = i.getTime(), (r.getTime() - u) / 1e3 }(o.dateTimeObject, i), "estimate" === f.type) return 0 === c ? t({ message: i + " is not buffered yet. Try again" }) : (e(f.estimatedStart + s), void u.one("seeked", function () { cit({ programTime: i, playlist: r, retryCount: c - 1, seekTo: e, pauseAfterSeek: a, tech: u, callback: t }) })); v = o.start + s; u.one("seeked", function () { return t(null, u.currentTime()) }); a && u.pause(); e(v) } function lit(n, t) { var u = [], r = void 0; if (n && n.length) for (r = 0; r < n.length; r++)t(n.start(r), n.end(r)) && u.push([n.start(r), n.end(r)]); return i.createTimeRanges(u) } function ait(n, t) { return lit(n, function (n, i) { return n - .1 <= t && t <= i + .1 }) } function vit(n, t) { return lit(n, function (n) { return t <= n - 1 / 30 }) } function fy(n) { var i = [], t; if (!n || !n.length) return ""; for (t = 0; t < n.length; t++)i.push(n.start(t) + " => " + n.end(t)); return i.join(", ") } function yit(n) { for (var i = [], t = 0; t < n.length; t++)i.push({ start: n.start(t), end: n.end(t) }); return i } function nf(n, t, i) { var r = void 0, u = void 0; if (i && i.cues) for (r = i.cues.length; r--;)(u = i.cues[r]).startTime <= t && u.endTime >= n && i.removeCue(u) } function pit(n) { return isNaN(n) || Math.abs(n) === 1 / 0 ? Number.MAX_VALUE : n } function lht(t, r, u) { var h = n.WebKitDataCue || n.VTTCue, c, o, s; if ((r && r.forEach(function (n) { var t = n.stream; this.inbandTextTracks_[t].addCue(new h(n.startTime + this.timestampOffset, n.endTime + this.timestampOffset, n.text)) }, t), u) && (c = pit(t.mediaSource_.duration), u.forEach(function (t) { var r = t.cueTime + this.timestampOffset; !("number" != typeof r || n.isNaN(r) || r < 0) && r < 1 / 0 && t.frames.forEach(function (n) { var t = new h(r, r, n.value || n.url || n.data || ""); t.frame = n; t.value = n, function (n) { Object.defineProperties(n.frame, { id: { get: function () { return i.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."), n.value.key } }, value: { get: function () { return i.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."), n.value.data } }, privateData: { get: function () { return i.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."), n.value.data } } }) }(t); this.metadataTrack_.addCue(t) }, this) }, t), t.metadataTrack_ && t.metadataTrack_.cues && t.metadataTrack_.cues.length)) { for (var e = t.metadataTrack_.cues, l = [], f = 0; f < e.length; f++)e[f] && l.push(e[f]); o = l.reduce(function (n, t) { var i = n[t.startTime] || []; return i.push(t), n[t.startTime] = i, n }, {}); s = Object.keys(o).sort(function (n, t) { return Number(n) - Number(t) }); s.forEach(function (n, t) { var i = o[n], r = Number(s[t + 1]) || c; i.forEach(function (n) { n.endTime = r }) }) } } function bit(n, t) { return function (i) { var u = this, f, r; if (!t) return new rf(n); if (rf && !i) return f = kit(t.toString().replace(/^function.+?{/, "").slice(0, -1)), this[ey] = new rf(f), function (n, t) { if (n && t) { var i = n.terminate; n.objURL = t; n.terminate = function () { n.objURL && tf.revokeObjectURL(n.objURL); i.call(n) } } }(this[ey], f), this[ey]; r = { postMessage: function (n) { u.onmessage && setTimeout(function () { u.onmessage({ data: n, target: r }) }) } }; t.call(r); this.postMessage = function (n) { setTimeout(function () { r.onmessage({ data: n, target: u }) }) }; this.isThisThread = !0 } } function kit(n) { try { return tf.createObjectURL(new Blob([n], { type: bht })) } catch (i) { var t = new kht; return t.append(n), tf.createObjectURL(t.getBlob(type)) } } function dit(n) { return n.map(function (n) { return n.replace(/avc1\.(\d+)\.(\d+)/i, function (n, t, i) { return "avc1." + ("00" + Number(t).toString(16)).slice(-2) + "00" + ("00" + Number(i).toString(16)).slice(-2) }) }) } function be(n) { var i, r = 0 < arguments.length && void 0 !== n ? n : "", t = { codecCount: 0 }; return t.codecCount = r.split(",").length, t.codecCount = t.codecCount || 2, (i = /(^|\s|,)+(avc[13])([^ ,]*)/i.exec(r)) && (t.videoCodec = i[2], t.videoObjectTypeIndicator = i[3]), t.audioProfile = /(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(r), t.audioProfile = t.audioProfile && t.audioProfile[2], t } function cy(n, t, i) { return n + "/" + t + '; codecs="' + i.filter(function (n) { return !!n }).join(", ") + '"' } function dht(n, t) { var s = function (n) { return n.segments && n.segments.length && n.segments[0].map ? "mp4" : "mp2t" }(t), u = function (n) { var t = n.attributes || {}; return t.CODECS ? be(t.CODECS) : trt }(t), h = t.attributes || {}, f = !0, c = !1, e, l, r; if (!t) return []; if (n.mediaGroups.AUDIO && h.AUDIO && (e = n.mediaGroups.AUDIO[h.AUDIO], e)) for (l in f = !(c = !0), e) if (!e[l].uri && !e[l].playlists) { f = !0; break } c && !u.audioProfile && (f || (u.audioProfile = function (n, t) { var i, u, r; if (!n.mediaGroups.AUDIO || !t || (i = n.mediaGroups.AUDIO[t], !i)) return null; for (u in i) if (r = i[u], r.default && r.playlists) return be(r.playlists[0].attributes.CODECS).audioProfile; return null }(n, h.AUDIO)), u.audioProfile || (i.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"), u.audioProfile = trt.audioProfile)); r = {}; u.videoCodec && (r.video = "" + u.videoCodec + u.videoObjectTypeIndicator); u.audioProfile && (r.audio = "mp4a.40." + u.audioProfile); var o = cy("audio", s, [r.audio]), v = cy("video", s, [r.video]), a = cy("video", s, [r.video, r.audio]); return c ? !f && r.video ? [v, o] : f || r.video ? [a, o] : [o, o] : r.video ? [a] : [o] } function git(n) { return /mp4a\.\d+.\d+/i.test(n) } function nrt(n) { return /avc1\.[\da-f]+/i.test(n) } function uf(n, t) { var r, u; return ii(this, uf), r = si(this, (uf.__proto__ || Object.getPrototypeOf(uf)).call(this, i.EventTarget)), r.timestampOffset_ = 0, r.pendingBuffers_ = [], r.bufferUpdating_ = !1, r.mediaSource_ = n, r.codecs_ = t, r.audioCodec_ = null, r.videoCodec_ = null, r.audioDisabled_ = !1, r.appendAudioInitSegment_ = !0, r.gopBuffer_ = [], r.timeMapping_ = 0, r.safeAppend_ = 11 <= i.browser.IE_VERSION, u = { remux: !1, alignGopsAtEnd: r.safeAppend_ }, r.codecs_.forEach(function (n) { git(n) ? r.audioCodec_ = n : nrt(n) && (r.videoCodec_ = n) }), r.transmuxer_ = new ght, r.transmuxer_.postMessage({ action: "init", options: u }), r.transmuxer_.onmessage = function (n) { return "data" === n.data.action ? r.data_(n) : "done" === n.data.action ? r.done_(n) : "gopInfo" === n.data.action ? r.appendGopInfo_(n) : "videoSegmentTimingInfo" === n.data.action ? r.videoSegmentTimingInfo_(n.data.videoSegmentTimingInfo) : void 0 }, Object.defineProperty(r, "timestampOffset", { get: function () { return this.timestampOffset_ }, set: function (n) { "number" == typeof n && 0 <= n && (this.timestampOffset_ = n, this.appendAudioInitSegment_ = !0, this.gopBuffer_.length = 0, this.timeMapping_ = 0, this.transmuxer_.postMessage({ action: "setTimestampOffset", timestampOffset: n })) } }), Object.defineProperty(r, "appendWindowStart", { get: function () { return (this.videoBuffer_ || this.audioBuffer_).appendWindowStart }, set: function (n) { this.videoBuffer_ && (this.videoBuffer_.appendWindowStart = n); this.audioBuffer_ && (this.audioBuffer_.appendWindowStart = n) } }), Object.defineProperty(r, "updating", { get: function () { return !!(this.bufferUpdating_ || !this.audioDisabled_ && this.audioBuffer_ && this.audioBuffer_.updating || this.videoBuffer_ && this.videoBuffer_.updating) } }), Object.defineProperty(r, "buffered", { get: function () { return function (n, t, r) { var e = null, o = null, c = 0, f = [], l = []; if (!n && !t) return i.createTimeRange(); if (!n) return t.buffered; if (!t || r) return n.buffered; if (0 === n.buffered.length && 0 === t.buffered.length) return i.createTimeRange(); for (var s = n.buffered, h = t.buffered, u = s.length; u--;)f.push({ time: s.start(u), type: "start" }), f.push({ time: s.end(u), type: "end" }); for (u = h.length; u--;)f.push({ time: h.start(u), type: "start" }), f.push({ time: h.end(u), type: "end" }); for (f.sort(function (n, t) { return n.time - t.time }), u = 0; u < f.length; u++)"start" === f[u].type ? 2 == ++c && (e = f[u].time) : "end" === f[u].type && 1 == --c && (o = f[u].time), null !== e && null !== o && (l.push([e, o]), o = e = null); return i.createTimeRanges(l) }(this.videoBuffer_, this.audioBuffer_, this.audioDisabled_) } }), r } function tu() { ii(this, tu); var r = si(this, (tu.__proto__ || Object.getPrototypeOf(tu)).call(this)); for (var u in r.nativeMediaSource_ = new n.MediaSource, r.nativeMediaSource_) u in tu.prototype || "function" != typeof r.nativeMediaSource_[u] || (r[u] = r.nativeMediaSource_[u].bind(r.nativeMediaSource_)); return r.duration_ = NaN, Object.defineProperty(r, "duration", { get: function () { return this.duration_ === 1 / 0 ? this.duration_ : this.nativeMediaSource_.duration }, set: function (n) { (this.duration_ = n) === 1 / 0 || (this.nativeMediaSource_.duration = n) } }), Object.defineProperty(r, "seekable", { get: function () { return this.duration_ === 1 / 0 ? i.createTimeRanges([[0, this.nativeMediaSource_.duration]]) : this.nativeMediaSource_.seekable } }), Object.defineProperty(r, "readyState", { get: function () { return this.nativeMediaSource_.readyState } }), Object.defineProperty(r, "activeSourceBuffers", { get: function () { return this.activeSourceBuffers_ } }), r.sourceBuffers = [], r.activeSourceBuffers_ = [], r.updateActiveSourceBuffers_ = function () { var n, u; if (r.activeSourceBuffers_.length = 0, 1 === r.sourceBuffers.length) return n = r.sourceBuffers[0], n.appendAudioInitSegment_ = !0, n.audioDisabled_ = !n.audioCodec_, void r.activeSourceBuffers_.push(n); for (var f = !1, t = !0, i = 0; i < r.player_.audioTracks().length; i++)if (u = r.player_.audioTracks()[i], u.enabled && "main" !== u.kind) { t = !(f = !0); break } r.sourceBuffers.forEach(function (n, i) { if (n.appendAudioInitSegment_ = !0, n.videoCodec_ && n.audioCodec_) n.audioDisabled_ = f; else if (n.videoCodec_ && !n.audioCodec_) n.audioDisabled_ = !0, t = !1; else if (!n.videoCodec_ && n.audioCodec_ && (n.audioDisabled_ = i ? t : !t, n.audioDisabled_)) return; r.activeSourceBuffers_.push(n) }) }, r.onPlayerMediachange_ = function () { r.sourceBuffers.forEach(function (n) { n.appendAudioInitSegment_ = !0 }) }, r.onHlsReset_ = function () { r.sourceBuffers.forEach(function (n) { n.transmuxer_ && n.transmuxer_.postMessage({ action: "resetCaptions" }) }) }, r.onHlsSegmentTimeMapping_ = function (n) { r.sourceBuffers.forEach(function (t) { return t.timeMapping_ = n.mapping }) }, ["sourceopen", "sourceclose", "sourceended"].forEach(function (n) { this.nativeMediaSource_.addEventListener(n, this.trigger.bind(this)) }, r), r.on("sourceopen", function () { var n = t.querySelector('[src="' + r.url_ + '"]'); n && (r.player_ = i(n.parentNode), r.player_ && (r.player_.tech_.on("hls-reset", r.onHlsReset_), r.player_.tech_.on("hls-segment-time-mapping", r.onHlsSegmentTimeMapping_), r.player_.audioTracks && r.player_.audioTracks() && (r.player_.audioTracks().on("change", r.updateActiveSourceBuffers_), r.player_.audioTracks().on("addtrack", r.updateActiveSourceBuffers_), r.player_.audioTracks().on("removetrack", r.updateActiveSourceBuffers_)), r.player_.on("mediachange", r.onPlayerMediachange_))) }), r.on("sourceended", function () { for (var i, n, u = pit(r.duration), t = 0; t < r.sourceBuffers.length; t++)i = r.sourceBuffers[t], n = i.metadataTrack_ && i.metadataTrack_.cues, n && n.length && (n[n.length - 1].endTime = u) }), r.on("sourceclose", function () { this.sourceBuffers.forEach(function (n) { n.transmuxer_ && n.transmuxer_.terminate() }); this.sourceBuffers.length = 0; this.player_ && (this.player_.audioTracks && this.player_.audioTracks() && (this.player_.audioTracks().off("change", this.updateActiveSourceBuffers_), this.player_.audioTracks().off("addtrack", this.updateActiveSourceBuffers_), this.player_.audioTracks().off("removetrack", this.updateActiveSourceBuffers_)), this.player_.el_ && this.player_.off("mediachange", this.onPlayerMediachange_), this.player_.tech_ && this.player_.tech_.el_ && (this.player_.tech_.off("hls-reset", this.onHlsReset_), this.player_.tech_.off("hls-segment-time-mapping", this.onHlsSegmentTimeMapping_))) }), r } function irt(n, t) { var r = i.mediaSources[n]; if (!r) throw new Error("Media Source not found (Video.js)"); r.trigger({ type: "sourceopen", swfId: t }) } function ay() { return !!n.MediaSource && !!n.MediaSource.isTypeSupported && n.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"') } function ke() { if (this.MediaSource = { open: irt, supportsNativeMediaSources: ay }, ay()) return new yh; throw new Error("Cannot use create a virtual MediaSource for this video"); } function rrt(n, t) { for (var f, r = void 0, i = py(n, { duration: t.duration, minimumUpdatePeriod: t.minimumUpdatePeriod }), u = 0; u < t.playlists.length; u++)f = ny(i, t.playlists[u]), f ? i = f : r = !0; return ch(t, function (n, t, u, f) { if (n.playlists && n.playlists.length) { var o = n.playlists[0].uri, e = ny(i, n.playlists[0]); e && ((i = e).mediaGroups[t][u][f].playlists[0] = i.playlists[o], r = !1) } }), r ? null : i } function yy(n) { var t = n.byterange.offset + n.byterange.length - 1; return n.uri + "-" + n.byterange.offset + "-" + t } function urt(n, t) { var i, r, e = {}, o, f, u, s; for (o in n) if (f = n[o].sidx, f) { if (u = yy(f), !t[u]) break; s = t[u].sidxInfo; i = s; r = f; (Boolean(!i.map && !r.map) || Boolean(i.map && r.map && i.map.byterange.offset === r.map.byterange.offset && i.map.byterange.length === r.map.byterange.length)) && i.uri === r.uri && i.byterange.offset === r.byterange.offset && i.byterange.length === r.byterange.length && (e[u] = t[u]) } return e } function frt(n, t, r, u, f) { var e = { uri: hh(u.handleManifestRedirects, n.resolvedUri), byterange: n.byterange, playlist: t }; return r(i.mergeOptions(e, { responseType: "arraybuffer", headers: uy(e) }), f) } function ff(n, t) { var r = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : {}, e = arguments[3]; ii(this, ff); var i = si(this, (ff.__proto__ || Object.getPrototypeOf(ff)).call(this)), u = r.withCredentials, o = void 0 !== u && u, f = r.handleManifestRedirects, s = void 0 !== f && f; if (i.hls_ = t, i.withCredentials = o, i.handleManifestRedirects = s, !n) throw new Error("A non-empty playlist URL or playlist is required"); return i.on("minimumUpdatePeriod", function () { i.refreshXml_() }), i.on("mediaupdatetimeout", function () { i.refreshMedia_(i.media().uri) }), i.state = "HAVE_NOTHING", i.loadedPlaylists_ = {}, "string" == typeof n ? (i.srcUrl = n, i.sidxMapping_ = {}, si(i)) : (i.setupChildLoader(e, n), i) } function de(n) { return i.log.debug ? i.log.debug.bind(i, "VHS:", n + " >") : function () { } } function ef() { } function wy(n, t, i, r) { ii(this, wy); this.callbacks_ = []; this.pendingCallback_ = null; this.timestampOffset_ = 0; this.mediaSource = n; this.processedAppend_ = !1; this.type_ = i; this.mimeType_ = t; this.logger_ = de("SourceUpdater[" + i + "][" + t + "]"); "closed" === n.readyState ? n.addEventListener("sourceopen", this.createSourceBuffer_.bind(this, t, r)) : this.createSourceBuffer_(t, r) } function ort(n) { n.forEach(function (n) { n.abort() }) } function by(n, t) { return t.timedout ? { status: t.status, message: "HLS request timed-out at URL: " + t.uri, code: crt, xhr: t } : t.aborted ? { status: t.status, message: "HLS request aborted at URL: " + t.uri, code: lrt, xhr: t } : n ? { status: t.status, message: "HLS request errored at URL: " + t.uri, code: wh, xhr: t } : null } function tct(n, t, i) { var u = 0, r = !1; return function (f, e) { if (!r) return f ? (r = !0, ort(n), i(f, e)) : (u += 1) === n.length ? (e.endOfAllRequests = Date.now(), e.encryptedBytes ? function (n, t, i) { n.addEventListener("message", function r(u) { if (u.data.source === t.requestId) { n.removeEventListener("message", r); var f = u.data.decrypted; return t.bytes = new Uint8Array(f.bytes, f.byteOffset, f.byteLength), i(null, t) } }); var r = void 0; r = t.key.bytes.slice ? t.key.bytes.slice() : new Uint32Array(Array.prototype.slice.call(t.key.bytes)); n.postMessage(oit({ source: t.requestId, encrypted: t.encryptedBytes, key: r, iv: t.key.iv }), [t.encryptedBytes.buffer, r.buffer]) }(t, e, i) : i(null, e)) : void 0 } } function ict(n, t) { return function (r) { return n.stats = i.mergeOptions(n.stats, function (n) { var i = n.target, t = { bandwidth: 1 / 0, bytesReceived: 0, roundTripTime: Date.now() - i.requestTime || 0 }; return t.bytesReceived = n.loaded, t.bandwidth = Math.floor(t.bytesReceived / t.roundTripTime * 8e3), t }(r)), !n.stats.firstBytesReceivedAt && n.stats.bytesReceived && (n.stats.firstBytesReceivedAt = Date.now()), t(r, n) } } function rct(n, t, r, u, f, e, o) { var s = [], h = tct(s, r, o), l, a, c; return f.key && !f.key.bytes && (l = n(i.mergeOptions(t, { uri: f.key.resolvedUri, responseType: "arraybuffer" }), function (n, t) { return function (i, r) { var f = r.response, e = by(i, r), u; return e ? t(e, n) : 16 !== f.byteLength ? t({ status: r.status, message: "Invalid HLS key at URL: " + r.uri, code: wh, xhr: r }, n) : (u = new DataView(f), n.key.bytes = new Uint32Array([u.getUint32(0), u.getUint32(4), u.getUint32(8), u.getUint32(12)]), t(null, n)) } }(f, h)), s.push(l)), f.map && !f.map.bytes && (a = n(i.mergeOptions(t, { uri: f.map.resolvedUri, responseType: "arraybuffer", headers: uy(f.map) }), function (n, t, i) { return function (r, u) { var e = u.response, f = by(r, u); return f ? i(f, n) : 0 === e.byteLength ? i({ status: u.status, message: "Empty HLS segment content at URL: " + u.uri, code: wh, xhr: u }, n) : (n.map.bytes = new Uint8Array(u.response), t && !t.isInitialized() && t.init(), n.map.timescales = oi.timescale(n.map.bytes), n.map.videoTrackIds = oi.videoTrackIds(n.map.bytes), i(null, n)) } }(f, u, h)), s.push(a)), c = n(i.mergeOptions(t, { uri: f.resolvedUri, responseType: "arraybuffer", headers: uy(f) }), function (n, t, i) { return function (r, u) { var o = u.response, e = by(r, u), f = void 0; return e ? i(e, n) : 0 === o.byteLength ? i({ status: u.status, message: "Empty HLS segment content at URL: " + u.uri, code: wh, xhr: u }, n) : (n.stats = function (n) { return { bandwidth: n.bandwidth, bytesReceived: n.bytesReceived || 0, roundTripTime: n.roundTripTime || 0 } }(u), n.key ? n.encryptedBytes = new Uint8Array(u.response) : n.bytes = new Uint8Array(u.response), t && n.map && n.map.bytes && (t.isInitialized() || t.init(), (f = t.parse(n.bytes, n.map.videoTrackIds, n.map.timescales)) && f.captions && (n.captionStreams = f.captionStreams, n.fmp4Captions = f.captions)), i(null, n)) } }(f, u, h)), c.addEventListener("progress", ict(f, e)), s.push(c), function () { return ort(s) } } function srt(t, i) { var r; return t && (r = n.getComputedStyle(t)) ? r[i] : "" } function ge(n, t) { var i = n.slice(); n.sort(function (n, r) { var u = t(n, r); return 0 === u ? i.indexOf(n) - i.indexOf(r) : u }) } function ky(t, i) { var r = void 0, u = void 0; return t.attributes.BANDWIDTH && (r = t.attributes.BANDWIDTH), r = r || n.Number.MAX_VALUE, i.attributes.BANDWIDTH && (u = i.attributes.BANDWIDTH), r - (u = u || n.Number.MAX_VALUE) } function hrt(n) { return "number" == typeof n && isFinite(n) } function of(n) { ii(this, of); var t = si(this, (of.__proto__ || Object.getPrototypeOf(of)).call(this)); if (!n) throw new TypeError("Initialization settings are required"); if ("function" != typeof n.currentTime) throw new TypeError("No currentTime getter specified"); if (!n.mediaSource) throw new TypeError("No MediaSource specified"); return t.bandwidth = n.bandwidth, t.throughput = { rate: 0, count: 0 }, t.roundTrip = NaN, t.resetStats_(), t.mediaIndex = null, t.hasPlayed_ = n.hasPlayed, t.currentTime_ = n.currentTime, t.seekable_ = n.seekable, t.seeking_ = n.seeking, t.duration_ = n.duration, t.mediaSource_ = n.mediaSource, t.hls_ = n.hls, t.loaderType_ = n.loaderType, t.startingMedia_ = void 0, t.segmentMetadataTrack_ = n.segmentMetadataTrack, t.goalBufferLength_ = n.goalBufferLength, t.sourceType_ = n.sourceType, t.inbandTextTracks_ = n.inbandTextTracks, t.state_ = "INIT", t.checkBufferTimeout_ = null, t.error_ = void 0, t.currentTimeline_ = -1, t.pendingSegment_ = null, t.mimeType_ = null, t.sourceUpdater_ = null, t.xhrOptions_ = null, t.activeInitSegmentId_ = null, t.initSegments_ = {}, t.cacheEncryptionKeys_ = n.cacheEncryptionKeys, t.keyCache_ = {}, t.captionParser_ = "main" === t.loaderType_ ? new yst : null, t.decrypter_ = n.decrypter, t.syncController_ = n.syncController, t.syncPoint_ = { segmentIndex: 0, time: 0 }, t.syncController_.on("syncinfoupdate", function () { return t.trigger("syncinfoupdate") }), t.mediaSource_.addEventListener("sourceopen", function () { return t.ended_ = !1 }), t.fetchAtBuffer_ = !1, t.logger_ = de("SegmentLoader[" + t.loaderType_ + "]"), Object.defineProperty(t, "state", { get: function () { return this.state_ }, set: function (n) { n !== this.state_ && (this.logger_(this.state_ + " -> " + n), this.state_ = n) } }), t } function art(n) { return decodeURIComponent(escape(String.fromCharCode.apply(null, n))) } function sf(n) { var i = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {}, t; return ii(this, sf), t = si(this, (sf.__proto__ || Object.getPrototypeOf(sf)).call(this, n, i)), t.mediaSource_ = null, t.subtitlesTrack_ = null, t } function uct(n, t) { for (var r, u = n.cues, i = 0; i < u.length; i++)if (r = u[i], t >= r.adStartTime && t <= r.adEndTime) return r; return null } function hf() { ii(this, hf); var n = si(this, (hf.__proto__ || Object.getPrototypeOf(hf)).call(this)); return n.inspectCache_ = void 0, n.timelines = [], n.discontinuities = [], n.datetimeToDisplayTime = null, n.logger_ = de("SyncController"), n } function bh(n, t) { n.abort(); n.pause(); t && t.activePlaylistLoader && (t.activePlaylistLoader.pause(), t.activePlaylistLoader = null) } function prt(n, t) { (t.activePlaylistLoader = n).load() } function oct(n) { function f() { t.AUDIO.onTrackChanged(); i.trigger({ type: "usage", name: "hls-audio-change" }) } var r, u, e;["AUDIO", "SUBTITLES", "CLOSED-CAPTIONS"].forEach(function (t) { hct[t](t, n) }); var t = n.mediaTypes, o = n.masterPlaylistLoader, i = n.tech, s = n.hls;["AUDIO", "SUBTITLES"].forEach(function (i) { t[i].activeGroup = function (n, t) { return function (i) { var e = t.masterPlaylistLoader, f = t.mediaTypes[n].groups, u = e.media(), r; return u ? (r = null, u.attributes[n] && (r = f[u.attributes[n]]), r = r || f.main, "undefined" == typeof i ? r : null === i ? null : r.filter(function (n) { return n.id === i.id })[0] || null) : null } }(i, n); t[i].activeTrack = cct[i](i, n); t[i].onGroupChanged = function (n, t) { return function () { var u = t.segmentLoaders, f = u[n], e = u.main, i = t.mediaTypes[n], o = i.activeTrack(), r = i.activeGroup(o), s = i.activePlaylistLoader; bh(f, i); r && (r.playlistLoader ? (f.resyncLoader(), prt(r.playlistLoader, i)) : s && e.resetEverything()) } }(i, n); t[i].onTrackChanged = function (n, t) { return function () { var f = t.segmentLoaders, r = f[n], o = f.main, i = t.mediaTypes[n], e = i.activeTrack(), u = i.activeGroup(e), s = i.activePlaylistLoader; bh(r, i); u && (u.playlistLoader ? (s !== u.playlistLoader && (r.track && r.track(e), r.resetEverything()), prt(u.playlistLoader, i)) : o.resetEverything()) } }(i, n) }); r = t.AUDIO.activeGroup(); u = (r.filter(function (n) { return n.default })[0] || r[0]).id; for (e in t.AUDIO.tracks[u].enabled = !0, t.AUDIO.onTrackChanged(), o.on("mediachange", function () { ["AUDIO", "SUBTITLES"].forEach(function (n) { return t[n].onGroupChanged() }) }), i.audioTracks().addEventListener("change", f), i.remoteTextTracks().addEventListener("change", t.SUBTITLES.onTrackChanged), s.on("dispose", function () { i.audioTracks().removeEventListener("change", f); i.remoteTextTracks().removeEventListener("change", t.SUBTITLES.onTrackChanged) }), i.clearTracks("audio"), t.AUDIO.tracks) i.audioTracks().addTrack(t.AUDIO.tracks[e]) } function cf(n) { var r; ii(this, cf); var t = si(this, (cf.__proto__ || Object.getPrototypeOf(cf)).call(this)), u = n.url, o = n.handleManifestRedirects, e = n.withCredentials, f = n.tech, s = n.bandwidth, h = n.externHls, c = n.useCueTags, l = n.blacklistDuration, a = n.enableLowInitialPlaylist, v = n.sourceType, y = n.seekTo, p = n.cacheEncryptionKeys; if (!u) throw new Error("A non-empty playlist URL is required"); return nr = h, t.withCredentials = e, t.tech_ = f, t.hls_ = f.hls, t.seekTo_ = y, t.sourceType_ = v, t.useCueTags_ = c, t.blacklistDuration = l, t.enableLowInitialPlaylist = a, t.useCueTags_ && (t.cueTagsTrack_ = t.tech_.addTextTrack("metadata", "ad-cues"), t.cueTagsTrack_.inBandMetadataTrackDispatchType = ""), t.requestOptions_ = { withCredentials: e, handleManifestRedirects: o, timeout: null }, t.mediaTypes_ = function () { var n = {}; return ["AUDIO", "SUBTITLES", "CLOSED-CAPTIONS"].forEach(function (t) { n[t] = { groups: {}, tracks: {}, activePlaylistLoader: null, activeGroup: ef, activeTrack: ef, onGroupChanged: ef, onTrackChanged: ef } }), n }(), t.mediaSource = new i.MediaSource, t.mediaSource.addEventListener("sourceopen", t.handleSourceOpen_.bind(t)), t.seekable_ = i.createTimeRanges(), t.hasPlayed_ = function () { return !1 }, t.syncController_ = new ect(n), t.segmentMetadataTrack_ = f.addRemoteTextTrack({ kind: "metadata", label: "segment-metadata" }, !1).track, t.decrypter_ = new sct, t.inbandTextTracks_ = {}, r = { hls: t.hls_, mediaSource: t.mediaSource, currentTime: t.tech_.currentTime.bind(t.tech_), seekable: function () { return t.seekable() }, seeking: function () { return t.tech_.seeking() }, duration: function () { return t.mediaSource.duration }, hasPlayed: function () { return t.hasPlayed_() }, goalBufferLength: function () { return t.goalBufferLength() }, bandwidth: s, syncController: t.syncController_, decrypter: t.decrypter_, sourceType: t.sourceType_, inbandTextTracks: t.inbandTextTracks_, cacheEncryptionKeys: p }, t.masterPlaylistLoader_ = "dash" === t.sourceType_ ? new ph(u, t.hls_, t.requestOptions_) : new lh(u, t.hls_, t.requestOptions_), t.setupMasterPlaylistLoaderListeners_(), t.mainSegmentLoader_ = new dy(i.mergeOptions(r, { segmentMetadataTrack: t.segmentMetadataTrack_, loaderType: "main" }), n), t.audioSegmentLoader_ = new dy(i.mergeOptions(r, { loaderType: "audio" }), n), t.subtitleSegmentLoader_ = new vrt(i.mergeOptions(r, { loaderType: "vtt" }), n), t.setupSegmentLoaderListeners_(), lct.forEach(function (n) { t[n + "_"] = function (n) { return this.audioSegmentLoader_[n] + this.mainSegmentLoader_[n] }.bind(t, n) }), t.logger_ = de("MPC"), t.masterPlaylistLoader_.load(), t } function brt(n, t, i) { var r, f, u; ii(this, brt); r = n.masterPlaylistController_; f = r[(n.options_.smoothQualityChange ? "smooth" : "fast") + "QualityChange_"].bind(r); t.attributes.RESOLUTION && (u = t.attributes.RESOLUTION, this.width = u.width, this.height = u.height); this.bandwidth = t.attributes.BANDWIDTH; this.id = i; this.enabled = function (n, t, i) { return function (r) { var u = n.master.playlists[t], e = iy(u), f = ah(u); return "undefined" == typeof r ? f : (r ? delete u.disabled : u.disabled = !0, r === f || e || (i(), r ? n.trigger("renditionenabled") : n.trigger("renditiondisabled")), r) } }(n.playlists, t.uri, f) } function tp(t) { function r() { return i.monitorCurrentTime_() } function u() { return i.techWaiting_() } function f() { return i.cancelTimer_() } function e() { return i.fixesBadSeeks_() } var i = this; ii(this, tp); this.tech_ = t.tech; this.seekable = t.seekable; this.seekTo = t.seekTo; this.allowSeeksWithinUnsafeLiveWindow = t.allowSeeksWithinUnsafeLiveWindow; this.media = t.media; this.consecutiveUpdates = 0; this.lastRecordedTime = null; this.timer_ = null; this.checkCurrentTimeTimeout_ = null; this.logger_ = de("PlaybackWatcher"); this.logger_("initialize"); this.tech_.on("seekablechanged", e); this.tech_.on("waiting", u); this.tech_.on(np, f); this.tech_.on("canplay", r); this.dispose = function () { i.logger_("dispose"); i.tech_.off("seekablechanged", e); i.tech_.off("waiting", u); i.tech_.off(np, f); i.tech_.off("canplay", r); i.checkCurrentTimeTimeout_ && n.clearTimeout(i.checkCurrentTimeTimeout_); i.cancelTimer_() } } function drt(n) { !function t(n, r) { function s() { f && n.currentTime(f) } function c(t) { null != t && (f = n.duration() !== 1 / 0 && n.currentTime() || 0, n.one("loadedmetadata", s), n.src(t), n.trigger({ type: "usage", name: "hls-error-reload" }), n.play()) } function h() { if (Date.now() - o < 1e3 * u.errorInterval) n.trigger({ type: "usage", name: "hls-error-reload-canceled" }); else { if (u.getSource && "function" == typeof u.getSource) return o = Date.now(), u.getSource.call(n, c); i.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!") } } function e() { n.off("loadedmetadata", s); n.off("error", h); n.off("dispose", e) } var o = 0, f = 0, u = i.mergeOptions(grt, r); n.ready(function () { n.trigger({ type: "usage", name: "hls-error-reload-initialized" }) }); n.on("error", h); n.on("dispose", e); n.reloadSourceOnError = function (i) { e(); t(n, i) } }(this, n) } function nut(n) { return /^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(n) ? "hls" : /^application\/dash\+xml/i.test(n) ? "dash" : null } function tut(n, t) { for (var u = t.media(), r = -1, i = 0; i < n.length; i++)if (n[i].id === u.uri) { r = i; break } n.selectedIndex_ = r; n.trigger({ selectedIndex: r, type: "change" }) } function vct(n) { var t, r; "dash" === n.options_.sourceType && (t = i.players[n.tech_.options_.playerId], t.eme && (r = function (n, t, r) { var f, u; if (!n) return n; f = {}; for (u in n) f[u] = { audioContentType: 'audio/mp4; codecs="' + r.attributes.CODECS + '"', videoContentType: 'video/mp4; codecs="' + t.attributes.CODECS + '"' }, t.contentProtection && t.contentProtection[u] && t.contentProtection[u].pssh && (f[u].pssh = t.contentProtection[u].pssh), "string" == typeof n[u] && (f[u].url = n[u]); return i.mergeOptions(n, f) }(n.source_.keySystems, n.playlists.media(), n.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media()), r && (t.currentSource().keySystems = r, t.eme.initializeMediaKeys && t.eme.initializeMediaKeys()))) } function iut() { if (!window.localStorage) return null; var n = window.localStorage.getItem(ip); if (!n) return null; try { return JSON.parse(n) } catch (n) { return null } } function tr(n, r, u) { var f, e; if (ii(this, tr), f = si(this, (tr.__proto__ || Object.getPrototypeOf(tr)).call(this, r, u.hls)), r.options_ && r.options_.playerId && (e = i(r.options_.playerId), e.hasOwnProperty("hls") || Object.defineProperty(e, "hls", { get: function () { return i.log.warn("player.hls is deprecated. Use player.tech().hls instead."), r.trigger({ type: "usage", name: "hls-player-access" }), f }, configurable: !0 }), e.vhs = f, (e.dash = f).player_ = e), f.tech_ = r, f.source_ = n, f.stats = {}, f.setOptions_(), f.options_.overrideNative && r.overrideNativeAudioTracks && r.overrideNativeVideoTracks) r.overrideNativeAudioTracks(!0), r.overrideNativeVideoTracks(!0); else if (f.options_.overrideNative && (r.featuresNativeVideoTracks || r.featuresNativeAudioTracks)) throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB"); return f.on(t, ["fullscreenchange", "webkitfullscreenchange", "mozfullscreenchange", "MSFullscreenChange"], function () { var n = t.fullscreenElement || t.webkitFullscreenElement || t.mozFullScreenElement || t.msFullscreenElement; n && n.contains(f.tech_.el()) && f.masterPlaylistController_.smoothQualityChange_() }), f.on(f.tech_, "seeking", function () { 0 === this.tech_.currentTime() && this.tech_.player_.loop() && this.setCurrentTime(0) }), f.on(f.tech_, "error", function () { this.masterPlaylistController_ && this.masterPlaylistController_.pauseLoading() }), f.on(f.tech_, "play", f.play), f } var ew, ow, rt, oc, hw, wf, lw, bi, pw, ww, r, df, fr, hb, lb, ab, er, vb, hu, pt, lu, ut, vo, kl, sd, hd, au, v, ad, yd, fe, pd, ee, wd, bd, kd, dt, ua, dd, fa, bo, cr, ko, go, ng, ns, tg, ea, ts, ig, rg, is, oa, rs, sa, ha, ca, ug, us, la, aa, va, fs, es, os, fg, yu, pu, ya, lr, pa, ss, hs, cs, ls, as, wa, vs, ba, ka, ys, da, ga, eg, oe, nv, bg, kg, dg, se, fv, tn, un, d, wu, sv, he, gs, hv, uh, htt, wt, ltt, dv, att, gv, ytt, ri, oy, sy, hy, yh, ly, vy, py, ph, ert, gy, vrt, np, krt, grt, ct, ip, rut, rp, dh; n = n && n.hasOwnProperty("default") ? n.default : n; t = t && t.hasOwnProperty("default") ? t.default : t; var up = "7.6.6", kt = [], fp = function (t, i) { return function (r, u, f) { var o = i.levels[u], s = new RegExp("^(" + o + ")$"), e; ("log" !== r && f.unshift(r.toUpperCase() + ":"), f.unshift(t + ":"), kt && kt.push([].concat(f)), n.console) && (e = n.console[r], e || "debug" !== r || (e = n.console.info || n.console.log), e && o && s.test(r) && e[Array.isArray(f) ? "apply" : "call"](n.console, f)) } }, c = function op(n) { function t() { for (var t = arguments.length, u = new Array(t), n = 0; n < t; n++)u[n] = arguments[n]; r("log", i, u) } var r, i = "info"; return r = fp(n, t), t.createLogger = function (t) { return op(n + ": " + t) }, t.levels = { all: "debug|log|warn|error", off: "", debug: "debug|log|warn|error", info: "log|warn|error", warn: "warn|error", error: "error", DEFAULT: i }, t.level = function (n) { if ("string" == typeof n) { if (!t.levels.hasOwnProperty(n)) throw new Error('"' + n + '" in not a valid log level'); i = n } return i }, (t.history = function () { return kt ? [].concat(kt) : [] }).filter = function (n) { return (kt || []).filter(function (t) { return new RegExp(".*" + n + ".*").test(t[0]) }) }, t.history.clear = function () { kt && (kt.length = 0) }, t.history.disable = function () { null !== kt && (kt.length = 0, kt = null) }, t.history.enable = function () { null === kt && (kt = []) }, t.error = function () { for (var t = arguments.length, u = new Array(t), n = 0; n < t; n++)u[n] = arguments[n]; return r("error", i, u) }, t.warn = function () { for (var t = arguments.length, u = new Array(t), n = 0; n < t; n++)u[n] = arguments[n]; return r("warn", i, u) }, t.debug = function () { for (var t = arguments.length, u = new Array(t), n = 0; n < t; n++)u[n] = arguments[n]; return r("debug", i, u) }, t }("VIDEOJS"), ep = c.createLogger, op = Object.prototype.toString, sp = function (n) { return vi(n) ? Object.keys(n) : [] }; var rc, yi = ap("querySelector"), tw = ap("querySelectorAll"), iw = Object.freeze({ isReal: ru, isEl: af, isInFrame: lp, createEl: k, textContent: uu, prependTo: gh, hasClass: ir, addClass: hi, removeClass: vf, toggleClass: vp, setAttributes: yp, getAttributes: ci, getAttribute: pp, setAttribute: yf, removeAttribute: to, blockTextSelection: wp, unblockTextSelection: bp, getBoundingClientRect: pf, findPosition: kp, getPointerPosition: nc, isTextNode: dp, emptyEl: tc, normalizeContent: gp, appendContent: ic, insertContent: nw, isSingleLeftClick: fu, $: yi, $$: tw }), rw = !1, uut = function () { var r, u, n; if (ru() && !1 !== rc.options.autoSetup) { var f = Array.prototype.slice.call(t.getElementsByTagName("video")), e = Array.prototype.slice.call(t.getElementsByTagName("audio")), o = Array.prototype.slice.call(t.getElementsByTagName("video-js")), i = f.concat(e, o); if (i && 0 < i.length) for (r = 0, u = i.length; r < u; r++) { if (n = i[r], !n || !n.getAttribute) { uc(1); break } void 0 === n.player && null !== n.getAttribute("data-setup") && rc(n) } else rw || uc(1) } }; ru() && ("complete" === t.readyState ? fc() : n.addEventListener("load", fc)); ow = 3; n.WeakMap || (ew = function () { function i() { this.vdata = "vdata" + Math.floor(n.performance && n.performance.now() || Date.now()); this.data = {} } var t = i.prototype; return t.set = function (n, t) { var i = n[this.vdata] || pi(); return n[this.vdata] || (n[this.vdata] = i), this.data[i] = t, this }, t.get = function (n) { var t = n[this.vdata]; if (t) return this.data[t]; c("We have no data for this element", n) }, t.has = function (n) { return n[this.vdata] in this.data }, t.delete = function (n) { var t = n[this.vdata]; t && (delete this.data[t], delete n[this.vdata]) }, i }()); rt = n.WeakMap ? new WeakMap : new ew; oc = !1; !function () { try { var t = Object.defineProperty({}, "passive", { get: function () { oc = !0 } }); n.addEventListener("test", null, t); n.removeEventListener("test", null, t) } catch (t) { } }(); hw = ["touchstart", "touchmove"]; lw = Object.freeze({ fixEvent: io, on: yt, off: nt, trigger: eu, one: ro, any: cw }); ft.prototype.allowedEvents_ = {}; ft.prototype.addEventListener = ft.prototype.on = function (n, t) { var i = this.addEventListener; this.addEventListener = function () { }; yt(this, n, t); this.addEventListener = i }; ft.prototype.removeEventListener = ft.prototype.off = function (n, t) { nt(this, n, t) }; ft.prototype.one = function (n, t) { var i = this.addEventListener; this.addEventListener = function () { }; ro(this, n, t); this.addEventListener = i }; ft.prototype.any = function (n, t) { var i = this.addEventListener; this.addEventListener = function () { }; cw(this, n, t); this.addEventListener = i }; ft.prototype.dispatchEvent = ft.prototype.trigger = function (n) { var t = n.type || n; "string" == typeof n && (n = { type: t }); n = io(n); this.allowedEvents_[t] && this["on" + t] && this["on" + t](n); eu(this, n) }; ft.prototype.queueTrigger = function (t) { var u = this, r, i, f, e; wf = wf || new Map; r = t.type || t; i = wf.get(this); i || (i = new Map, wf.set(this, i)); f = i.get(r); i.delete(r); n.clearTimeout(f); e = n.setTimeout(function () { 0 === i.size && (i = null, wf.delete(u)); u.trigger(t) }, 0); i.set(r, e) }; bi = function (n) { return n instanceof ft || !!n.eventBusEl_ && ["on", "one", "off", "trigger"].every(function (t) { return "function" == typeof n[t] }) }; pw = { on: function () { for (var u = this, f = arguments.length, e = new Array(f), n = 0; n < f; n++)e[n] = arguments[n]; var t = hc(this, e), s = t.isTargetingSelf, r = t.target, o = t.type, i = t.listener; if (rr(r, "on", o, i), !s) { function n() { return u.off(r, o, i) } n.guid = i.guid; function t() { return u.off("dispose", n) } t.guid = i.guid; rr(this, "on", "dispose", n); rr(r, "on", "dispose", t) } }, one: function () { for (var o = this, f = arguments.length, e = new Array(f), n = 0; n < f; n++)e[n] = arguments[n]; var t = hc(this, e), s = t.isTargetingSelf, i = t.target, r = t.type, u = t.listener; if (s) rr(i, "one", r, u); else { function n() { o.off(i, r, n); for (var f = arguments.length, e = new Array(f), t = 0; t < f; t++)e[t] = arguments[t]; u.apply(null, e) } n.guid = u.guid; rr(i, "one", r, n) } }, any: function () { for (var o = this, f = arguments.length, e = new Array(f), n = 0; n < f; n++)e[n] = arguments[n]; var t = hc(this, e), s = t.isTargetingSelf, i = t.target, r = t.type, u = t.listener; if (s) rr(i, "any", r, u); else { function n() { o.off(i, r, n); for (var f = arguments.length, e = new Array(f), t = 0; t < f; t++)e[t] = arguments[t]; u.apply(null, e) } n.guid = u.guid; rr(i, "any", r, n) } }, off: function (n, t, i) { if (!n || aw(n)) nt(this.eventBusEl_, n, t); else { var r = n, u = t; sc(r); vw(u); yw(i); i = h(this, i); this.off("dispose", i); r.nodeName ? (nt(r, u, i), nt(r, "dispose", i)) : bi(r) && (r.off(u, i), r.off("dispose", i)) } }, trigger: function (n, t) { return eu(this.eventBusEl_, n, t) } }; ww = { state: {}, setState: function (n) { var t, i = this; return "function" == typeof n && (n = n()), iu(n, function (n, r) { i.state[r] !== n && ((t = t || {})[r] = { from: i.state[r], to: n }); i.state[r] = n }), t && bi(this) && this.trigger({ changes: t, type: "statechanged" }), t } }; r = function () { function i(t, i, r) { var f, u; (this.player_ = !t && this.play ? t = this : t, this.parentComponent_ = null, this.options_ = a({}, this.options_), i = this.options_ = a(this.options_, i), this.id_ = i.id || i.el && i.el.id, this.id_) || (f = t && t.id && t.id() || "no_player", this.id_ = f + "_component_" + pi()); this.name_ = i.name || null; i.el ? this.el_ = i.el : !1 !== i.createEl && (this.el_ = this.createEl()); !1 !== i.evented && cc(this, { eventBusKey: this.el_ ? "el_" : null }); bw(this, this.constructor.defaultState); this.children_ = []; this.childIndex_ = {}; this.childNameIndex_ = {}; n.Set || (u = function () { function t() { this.set_ = {} } var n = t.prototype; return n.has = function (n) { return n in this.set_ }, n.delete = function (n) { var t = this.has(n); return delete this.set_[n], t }, n.add = function (n) { return this.set_[n] = 1, this }, n.forEach = function (n, t) { for (var i in this.set_) n.call(t, i, i, this) }, t }()); this.setTimeoutIds_ = n.Set ? new Set : new u; this.setIntervalIds_ = n.Set ? new Set : new u; this.rafIds_ = n.Set ? new Set : new u; (this.clearingTimersOnDispose_ = !1) !== i.initChildren && this.initChildren(); this.ready(r); !1 !== i.reportTouchActivity && this.enableTouchActivity() } var t = i.prototype; return t.dispose = function () { if (this.trigger({ type: "dispose", bubbles: !1 }), this.children_) for (var n = this.children_.length - 1; 0 <= n; n--)this.children_[n].dispose && this.children_[n].dispose(); this.children_ = null; this.childIndex_ = null; this.childNameIndex_ = null; this.parentComponent_ = null; this.el_ && (this.el_.parentNode && this.el_.parentNode.removeChild(this.el_), rt.has(this.el_) && rt.delete(this.el_), this.el_ = null); this.player_ = null }, t.player = function () { return this.player_ }, t.options = function (n) { return n && (this.options_ = a(this.options_, n)), this.options_ }, t.el = function () { return this.el_ }, t.createEl = function (n, t, i) { return k(n, t, i) }, t.localize = function (n, t, i) { void 0 === i && (i = n); var f = this.player_.language && this.player_.language(), u = this.player_.languages && this.player_.languages(), e = u && u[f], s = f && f.split("-")[0], o = u && u[s], r = i; return e && e[n] ? r = e[n] : o && o[n] && (r = o[n]), t && (r = r.replace(/\{(\d+)\}/g, function (n, i) { var r = t[i - 1], u = r; return "undefined" == typeof r && (u = n), u })), r }, t.contentEl = function () { return this.contentEl_ || this.el_ }, t.id = function () { return this.id_ }, t.name = function () { return this.name_ }, t.children = function () { return this.children_ }, t.getChildById = function (n) { return this.childIndex_[n] }, t.getChild = function (n) { if (n) return this.childNameIndex_[n] }, t.addChild = function (n, t, r) { var u, f, o, e, s; if (void 0 === t && (t = {}), void 0 === r && (r = this.children_.length), "string" == typeof n) { if (f = b(n), o = t.componentClass || f, t.name = f, e = i.getComponent(o), !e) throw new Error("Component " + o + " does not exist"); if ("function" != typeof e) return null; u = new e(this.player_ || this, t) } else u = n; return (u.parentComponent_ && u.parentComponent_.removeChild(u), this.children_.splice(r, 0, u), u.parentComponent_ = this, "function" == typeof u.id && (this.childIndex_[u.id()] = u), (f = f || u.name && b(u.name())) && (this.childNameIndex_[f] = u, this.childNameIndex_[uo(f)] = u), "function" == typeof u.el && u.el()) && (s = this.contentEl().children[r] || null, this.contentEl().insertBefore(u.el(), s)), u }, t.removeChild = function (n) { var i, t, r; if ("string" == typeof n && (n = this.getChild(n)), n && this.children_) { for (i = !1, t = this.children_.length - 1; 0 <= t; t--)if (this.children_[t] === n) { i = !0; this.children_.splice(t, 1); break } i && (n.parentComponent_ = null, this.childIndex_[n.id()] = null, this.childNameIndex_[b(n.name())] = null, this.childNameIndex_[uo(n.name())] = null, r = n.el(), r && r.parentNode === this.contentEl() && this.contentEl().removeChild(n.el())) } }, t.initChildren = function () { var t = this, n = this.options_.children, u, r, f; n && (r = this.options_, f = i.getComponent("Tech"), (u = Array.isArray(n) ? n : Object.keys(n)).concat(Object.keys(this.options_).filter(function (n) { return !u.some(function (t) { return "string" == typeof t ? n === t : n === t.name }) })).map(function (i) { var r, u; return u = "string" == typeof i ? n[r = i] || t.options_[r] || {} : (r = i.name, i), { name: r, opts: u } }).filter(function (n) { var t = i.getComponent(n.opts.componentClass || b(n.name)); return t && !f.isTech(t) }).forEach(function (n) { var u = n.name, i = n.opts, f; (void 0 !== r[u] && (i = r[u]), !1 !== i) && (!0 === i && (i = {}), i.playerOptions = t.options_.playerOptions, f = t.addChild(u, i), f && (t[u] = f)) })) }, t.buildCSSClass = function () { return "" }, t.ready = function (n, t) { if (void 0 === t && (t = !1), n) return this.isReady_ ? void (t ? n.call(this) : this.setTimeout(n, 1)) : (this.readyQueue_ = this.readyQueue_ || [], void this.readyQueue_.push(n)) }, t.triggerReady = function () { this.isReady_ = !0; this.setTimeout(function () { var n = this.readyQueue_; this.readyQueue_ = []; n && 0 < n.length && n.forEach(function (n) { n.call(this) }, this); this.trigger("ready") }, 1) }, t.$ = function (n, t) { return yi(n, t || this.contentEl()) }, t.$$ = function (n, t) { return tw(n, t || this.contentEl()) }, t.hasClass = function (n) { return ir(this.el_, n) }, t.addClass = function (n) { hi(this.el_, n) }, t.removeClass = function (n) { vf(this.el_, n) }, t.toggleClass = function (n, t) { vp(this.el_, n, t) }, t.show = function () { this.removeClass("vjs-hidden") }, t.hide = function () { this.addClass("vjs-hidden") }, t.lockShowing = function () { this.addClass("vjs-lock-showing") }, t.unlockShowing = function () { this.removeClass("vjs-lock-showing") }, t.getAttribute = function (n) { return pp(this.el_, n) }, t.setAttribute = function (n, t) { yf(this.el_, n, t) }, t.removeAttribute = function (n) { to(this.el_, n) }, t.width = function (n, t) { return this.dimension("width", n, t) }, t.height = function (n, t) { return this.dimension("height", n, t) }, t.dimensions = function (n, t) { this.width(n, !0); this.height(t) }, t.dimension = function (n, t, i) { if (void 0 !== t) return null !== t && t == t || (t = 0), this.el_.style[n] = -1 !== ("" + t).indexOf("%") || -1 !== ("" + t).indexOf("px") ? t : "auto" === t ? "" : t + "px", void (i || this.trigger("componentresize")); if (!this.el_) return 0; var r = this.el_.style[n], u = r.indexOf("px"); return -1 !== u ? parseInt(r.slice(0, u), 10) : parseInt(this.el_["offset" + b(n)], 10) }, t.currentDimension = function (n) { var t = 0, i; if ("width" !== n && "height" !== n) throw new Error("currentDimension only accepts width or height value"); return (t = no(this.el_, n), 0 === (t = parseFloat(t)) || isNaN(t)) && (i = "offset" + b(n), t = this.el_[i]), t }, t.currentDimensions = function () { return { width: this.currentDimension("width"), height: this.currentDimension("height") } }, t.currentWidth = function () { return this.currentDimension("width") }, t.currentHeight = function () { return this.currentDimension("height") }, t.focus = function () { this.el_.focus() }, t.blur = function () { this.el_.blur() }, t.handleKeyDown = function (n) { this.player_ && (n.stopPropagation(), this.player_.handleKeyDown(n)) }, t.handleKeyPress = function (n) { this.handleKeyDown(n) }, t.emitTapEvents = function () { function u() { t = !1 } var t, r = 0, i = null; this.on("touchstart", function (u) { 1 === u.touches.length && (i = { pageX: u.touches[0].pageX, pageY: u.touches[0].pageY }, r = n.performance.now(), t = !0) }); this.on("touchmove", function (n) { if (1 < n.touches.length) t = !1; else if (i) { var r = n.touches[0].pageX - i.pageX, u = n.touches[0].pageY - i.pageY; 10 < Math.sqrt(r * r + u * u) && (t = !1) } }); this.on("touchleave", u); this.on("touchcancel", u); this.on("touchend", function (u) { !(i = null) === t && n.performance.now() - r < 200 && (u.preventDefault(), this.trigger("tap")) }) }, t.enableTouchActivity = function () { if (this.player() && this.player().reportUserActivity) { var t, n = h(this.player(), this.player().reportUserActivity); this.on("touchstart", function () { n(); this.clearInterval(t); t = this.setInterval(n, 250) }); function i() { n(); this.clearInterval(t) } this.on("touchmove", n); this.on("touchend", i); this.on("touchcancel", i) } }, t.setTimeout = function (t, i) { var r, u = this; return t = h(this, t), this.clearTimersOnDispose_(), r = n.setTimeout(function () { u.setTimeoutIds_.has(r) && u.setTimeoutIds_.delete(r); t() }, i), this.setTimeoutIds_.add(r), r }, t.clearTimeout = function (t) { return this.setTimeoutIds_.has(t) && (this.setTimeoutIds_.delete(t), n.clearTimeout(t)), t }, t.setInterval = function (t, i) { t = h(this, t); this.clearTimersOnDispose_(); var r = n.setInterval(t, i); return this.setIntervalIds_.add(r), r }, t.clearInterval = function (t) { return this.setIntervalIds_.has(t) && (this.setIntervalIds_.delete(t), n.clearInterval(t)), t }, t.requestAnimationFrame = function (t) { var i, r = this; return this.supportsRaf_ ? (this.clearTimersOnDispose_(), t = h(this, t), i = n.requestAnimationFrame(function () { r.rafIds_.has(i) && r.rafIds_.delete(i); t() }), this.rafIds_.add(i), i) : this.setTimeout(t, 1e3 / 60) }, t.cancelAnimationFrame = function (t) { return this.supportsRaf_ ? (this.rafIds_.has(t) && (this.rafIds_.delete(t), n.cancelAnimationFrame(t)), t) : this.clearTimeout(t) }, t.clearTimersOnDispose_ = function () { var n = this; this.clearingTimersOnDispose_ || (this.clearingTimersOnDispose_ = !0, this.one("dispose", function () { [["rafIds_", "cancelAnimationFrame"], ["setTimeoutIds_", "clearTimeout"], ["setIntervalIds_", "clearInterval"]].forEach(function (t) { var i = t[0], r = t[1]; n[i].forEach(n[r], n) }); n.clearingTimersOnDispose_ = !1 })) }, i.registerComponent = function (n, t) { var r, u, f; if ("string" != typeof n || !n) throw new Error('Illegal component name, "' + n + '"; must be a non-empty string.'); var e, o = i.getComponent("Tech"), s = o && o.isTech(t), h = i === t || i.prototype.isPrototypeOf(t.prototype); if (s || !h) throw e = s ? "techs must be registered using Tech.registerTech()" : "must be a Component subclass", new Error('Illegal component, "' + n + '"; ' + e + "."); if (n = b(n), i.components_ || (i.components_ = {}), r = i.getComponent("Player"), "Player" === n && r && r.players && (u = r.players, f = Object.keys(u), u && 0 < f.length && f.map(function (n) { return u[n] }).every(Boolean))) throw new Error("Can not register Player component after player has been created."); return i.components_[n] = t, i.components_[uo(n)] = t }, i.getComponent = function (n) { if (n && i.components_) return i.components_[n] }, i }(); r.prototype.supportsRaf_ = "function" == typeof n.requestAnimationFrame && "function" == typeof n.cancelAnimationFrame; r.registerComponent("Component", r); for (var lc, ac, vc, yc, tt = n.navigator && n.navigator.userAgent || "", gw = /AppleWebKit\/([\d.]+)/i.exec(tt), fut = gw ? parseFloat(gw.pop()) : null, pc = /iPad/i.test(tt), wc = /iPhone/i.test(tt) && !pc, nb = /iPod/i.test(tt), ui = wc || pc || nb, eut = (lc = tt.match(/OS (\d+)_/i)) && lc[1] ? lc[1] : null, ki = /Android/i.test(tt), bc = function () { var n = tt.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i), t, i; return n ? (t = n[1] && parseFloat(n[1]), i = n[2] && parseFloat(n[2]), t && i ? parseFloat(n[1] + "." + n[2]) : t || null) : null }(), tb = ki && bc < 5 && fut < 537, ib = /Firefox/i.test(tt), kc = /Edge/i.test(tt), li = !kc && (/Chrome/i.test(tt) || /CriOS/i.test(tt)), rb = (ac = tt.match(/(Chrome|CriOS)\/(\d+)/)) && ac[2] ? parseFloat(ac[2]) : null, dc = (vc = /MSIE\s(\d+)\.\d/.exec(tt), !(yc = vc && parseFloat(vc[1])) && /Trident\/7.0/i.test(tt) && /rv:11.0/.test(tt) && (yc = 11), yc), ub = /Safari/i.test(tt) && !li && !ki && !kc, gc = (ub || ui) && !li, fb = /Windows/i.test(tt), bf = ru() && (("ontouchstart" in n) || n.navigator.maxTouchPoints || n.DocumentTouch && n.document instanceof n.DocumentTouch), out = Object.freeze({ IS_IPAD: pc, IS_IPHONE: wc, IS_IPOD: nb, IS_IOS: ui, IOS_VERSION: eut, IS_ANDROID: ki, ANDROID_VERSION: bc, IS_NATIVE_ANDROID: tb, IS_FIREFOX: ib, IS_EDGE: kc, IS_CHROME: li, CHROME_VERSION: rb, IE_VERSION: dc, IS_SAFARI: ub, IS_ANY_SAFARI: gc, IS_WINDOWS: fb, TOUCH_ENABLED: bf }), kf, tl = { prefixed: !0 }, fo = [["requestFullscreen", "exitFullscreen", "fullscreenElement", "fullscreenEnabled", "fullscreenchange", "fullscreenerror", "fullscreen"], ["webkitRequestFullscreen", "webkitExitFullscreen", "webkitFullscreenElement", "webkitFullscreenEnabled", "webkitfullscreenchange", "webkitfullscreenerror", "-webkit-full-screen"], ["mozRequestFullScreen", "mozCancelFullScreen", "mozFullScreenElement", "mozFullScreenEnabled", "mozfullscreenchange", "mozfullscreenerror", "-moz-full-screen"], ["msRequestFullscreen", "msExitFullscreen", "msFullscreenElement", "msFullscreenEnabled", "MSFullscreenChange", "MSFullscreenError", "-ms-fullscreen"]], sb = fo[0], eo = 0; eo < fo.length; eo++)if (fo[eo][1] in t) { kf = fo[eo]; break } if (kf) { for (df = 0; df < kf.length; df++)tl[sb[df]] = kf[df]; tl.prefixed = kf[0] !== sb[0] } for (et.prototype.code = 0, et.prototype.message = "", et.prototype.status = null, et.errorTypes = ["MEDIA_ERR_CUSTOM", "MEDIA_ERR_ABORTED", "MEDIA_ERR_NETWORK", "MEDIA_ERR_DECODE", "MEDIA_ERR_SRC_NOT_SUPPORTED", "MEDIA_ERR_ENCRYPTED"], et.defaultMessages = { 1: "You aborted the media playback", 2: "A network error caused the media download to fail part-way.", 3: "The media playback was aborted due to a corruption problem or because the media used features your browser did not support.", 4: "The media could not be loaded, either because the server or network failed or because the format is not supported.", 5: "The media is encrypted and we do not have the keys to decrypt it." }, fr = 0; fr < et.errorTypes.length; fr++)et[et.errorTypes[fr]] = fr, et.prototype[et.errorTypes[fr]] = fr; hb = function (n, t) { var i, r = null; try { i = JSON.parse(n, t) } catch (n) { r = n } return [r, i] }; lb = function (n) { var t = n.$$("track"), i = Array.prototype.map.call(t, function (n) { return n.track }); return Array.prototype.map.call(t, function (n) { var t = cb(n.track); return n.src && (t.src = n.src), t }).concat(Array.prototype.filter.call(n.textTracks(), function (n) { return -1 === i.indexOf(n) }).map(cb)) }; ab = function (n, t) { return n.forEach(function (n) { var i = t.addRemoteTextTrack(n).track; !n.src && n.cues && n.cues.forEach(function (n) { return i.addCue(n) }) }), t.textTracks() }; var o = il(function (n, t) { function o(n) { var i, e, t; return (n && "object" == typeof n && (i = n.which || n.keyCode || n.charCode, i && (n = i)), "number" == typeof n) ? f[n] : (t = String(n), (e = r[t.toLowerCase()]) ? e : (e = u[t.toLowerCase()]) || (1 === t.length ? t.charCodeAt(0) : void 0)) } var r, u, i, f, e; for (o.isEventKey = function (n, t) { var i, f; if (n && "object" == typeof n) { if (i = n.which || n.keyCode || n.charCode, null == i) return !1; if ("string" == typeof t) { if ((f = r[t.toLowerCase()]) || (f = u[t.toLowerCase()])) return f === i } else if ("number" == typeof t) return t === i; return !1 } }, r = (t = n.exports = o).code = t.codes = { backspace: 8, tab: 9, enter: 13, shift: 16, ctrl: 17, alt: 18, "pause/break": 19, "caps lock": 20, esc: 27, space: 32, "page up": 33, "page down": 34, end: 35, home: 36, left: 37, up: 38, right: 39, down: 40, insert: 45, "delete": 46, command: 91, "left command": 91, "right command": 93, "numpad *": 106, "numpad +": 107, "numpad -": 109, "numpad .": 110, "numpad /": 111, "num lock": 144, "scroll lock": 145, "my computer": 182, "my calculator": 183, ";": 186, "=": 187, ",": 188, "-": 189, ".": 190, "/": 191, "`": 192, "[": 219, "\\": 220, "]": 221, "'": 222 }, u = t.aliases = { windows: 91, "⇧": 16, "⌥": 18, "⌃": 17, "⌘": 91, ctl: 17, control: 17, option: 18, pause: 19, "break": 19, caps: 20, "return": 13, escape: 27, spc: 32, spacebar: 32, pgup: 33, pgdn: 34, ins: 45, del: 46, cmd: 91 }, i = 97; i < 123; i++)r[String.fromCharCode(i)] = i - 32; for (i = 48; i < 58; i++)r[i - 48] = i; for (i = 1; i < 13; i++)r["f" + i] = i + 111; for (i = 0; i < 10; i++)r["numpad " + i] = i + 96; f = t.names = t.title = {}; for (i in r) f[r[i]] = i; for (e in u) r[e] = u[e] }), rl = (o.code, o.codes, o.aliases, o.names, o.title, "vjs-modal-dialog"), ou = function (i) { function u(n, t) { var r; return (r = i.call(this, n, t) || this).opened_ = r.hasBeenOpened_ = r.hasBeenFilled_ = !1, r.closeable(!r.options_.uncloseable), r.content(r.options_.content), r.contentEl_ = k("div", { className: rl + "-content" }, { role: "document" }), r.descEl_ = k("p", { className: rl + "-description vjs-control-text", id: r.el().getAttribute("aria-describedby") }), uu(r.descEl_, r.description()), r.el_.appendChild(r.descEl_), r.el_.appendChild(r.contentEl_), r } f(u, i); var r = u.prototype; return r.createEl = function () { return i.prototype.createEl.call(this, "div", { className: this.buildCSSClass(), tabIndex: -1 }, { "aria-describedby": this.id() + "_description", "aria-hidden": "true", "aria-label": this.label(), role: "dialog" }) }, r.dispose = function () { this.contentEl_ = null; this.descEl_ = null; this.previouslyActiveEl_ = null; i.prototype.dispose.call(this) }, r.buildCSSClass = function () { return rl + " vjs-hidden " + i.prototype.buildCSSClass.call(this) }, r.label = function () { return this.localize(this.options_.label || "Modal Window") }, r.description = function () { var n = this.options_.description || this.localize("This is a modal window."); return this.closeable() && (n += " " + this.localize("This modal can be closed by pressing the Escape key or activating the close button.")), n }, r.open = function () { if (!this.opened_) { var n = this.player(); this.trigger("beforemodalopen"); this.opened_ = !0; !this.options_.fillAlways && (this.hasBeenOpened_ || this.hasBeenFilled_) || this.fill(); this.wasPlaying_ = !n.paused(); this.options_.pauseOnOpen && this.wasPlaying_ && n.pause(); this.on("keydown", this.handleKeyDown); this.hadControls_ = n.controls(); n.controls(!1); this.show(); this.conditionalFocus_(); this.el().setAttribute("aria-hidden", "false"); this.trigger("modalopen"); this.hasBeenOpened_ = !0 } }, r.opened = function (n) { return "boolean" == typeof n && this[n ? "open" : "close"](), this.opened_ }, r.close = function () { if (this.opened_) { var n = this.player(); this.trigger("beforemodalclose"); this.opened_ = !1; this.wasPlaying_ && this.options_.pauseOnOpen && n.play(); this.off("keydown", this.handleKeyDown); this.hadControls_ && n.controls(!0); this.hide(); this.el().setAttribute("aria-hidden", "true"); this.trigger("modalclose"); this.conditionalBlur_(); this.options_.temporary && this.dispose() } }, r.closeable = function (n) { var i, t, r; return "boolean" == typeof n && (i = this.closeable_ = !!n, t = this.getChild("closeButton"), i && !t && (r = this.contentEl_, this.contentEl_ = this.el_, t = this.addChild("closeButton", { controlText: "Close Modal Dialog" }), this.contentEl_ = r, this.on(t, "close", this.close)), !i && t && (this.off(t, "close", this.close), this.removeChild(t), t.dispose())), this.closeable_ }, r.fill = function () { this.fillWith(this.content()) }, r.fillWith = function (n) { var t = this.contentEl(), i = t.parentNode, u = t.nextSibling, r; this.trigger("beforemodalfill"); this.hasBeenFilled_ = !0; i.removeChild(t); this.empty(); nw(t, n); this.trigger("modalfill"); u ? i.insertBefore(t, u) : i.appendChild(t); r = this.getChild("closeButton"); r && i.appendChild(r.el_) }, r.empty = function () { this.trigger("beforemodalempty"); tc(this.contentEl()); this.trigger("modalempty") }, r.content = function (n) { return "undefined" != typeof n && (this.content_ = n), this.content_ }, r.conditionalFocus_ = function () { var n = t.activeElement, i = this.player_.el_; this.previouslyActiveEl_ = null; (i.contains(n) || i === n) && (this.previouslyActiveEl_ = n, this.focus()) }, r.conditionalBlur_ = function () { this.previouslyActiveEl_ && (this.previouslyActiveEl_.focus(), this.previouslyActiveEl_ = null) }, r.handleKeyDown = function (n) { if (n.stopPropagation(), o.isEventKey(n, "Escape") && this.closeable()) return n.preventDefault(), void this.close(); if (o.isEventKey(n, "Tab")) { for (var r, i = this.focusableEls_(), f = this.el_.querySelector(":focus"), u = 0; u < i.length; u++)if (f === i[u]) { r = u; break } t.activeElement === this.el_ && (r = 0); n.shiftKey && 0 === r ? (i[i.length - 1].focus(), n.preventDefault()) : n.shiftKey || r !== i.length - 1 || (i[0].focus(), n.preventDefault()) } }, r.focusableEls_ = function () { var t = this.el_.querySelectorAll("*"); return Array.prototype.filter.call(t, function (t) { return (t instanceof n.HTMLAnchorElement || t instanceof n.HTMLAreaElement) && t.hasAttribute("href") || (t instanceof n.HTMLInputElement || t instanceof n.HTMLSelectElement || t instanceof n.HTMLTextAreaElement || t instanceof n.HTMLButtonElement) && !t.hasAttribute("disabled") || t instanceof n.HTMLIFrameElement || t instanceof n.HTMLObjectElement || t instanceof n.HTMLEmbedElement || t.hasAttribute("tabindex") && -1 !== t.getAttribute("tabindex") || t.hasAttribute("contenteditable") }) }, u }(r); ou.prototype.options_ = { pauseOnOpen: !0, temporary: !0 }; r.registerComponent("ModalDialog", ou); er = function (n) { function t(t) { var i, r; for (void 0 === t && (t = []), (i = n.call(this) || this).tracks_ = [], Object.defineProperty(s(i), "length", { get: function () { return this.tracks_.length } }), r = 0; r < t.length; r++)i.addTrack(t[r]); return i } f(t, n); var i = t.prototype; return i.addTrack = function (n) { var t = this.tracks_.length; "" + t in this || Object.defineProperty(this, t, { get: function () { return this.tracks_[t] } }); -1 === this.tracks_.indexOf(n) && (this.tracks_.push(n), this.trigger({ track: n, type: "addtrack", target: this })) }, i.removeTrack = function (n) { for (var i, t = 0, r = this.length; t < r; t++)if (this[t] === n) { (i = this[t]).off && i.off(); this.tracks_.splice(t, 1); break } i && this.trigger({ track: i, type: "removetrack", target: this }) }, i.getTrackById = function (n) { for (var i, r = null, t = 0, u = this.length; t < u; t++)if (i = this[t], i.id === n) { r = i; break } return r }, t }(ft); for (vb in er.prototype.allowedEvents_ = { change: "change", addtrack: "addtrack", removetrack: "removetrack" }, er.prototype.allowedEvents_) er.prototype["on" + vb] = null; var sut = function (n) { function t(t) { var r, i; for (void 0 === t && (t = []), i = t.length - 1; 0 <= i; i--)if (t[i].enabled) { ul(t, t[i]); break } return (r = n.call(this, t) || this).changing_ = !1, r } f(t, n); var i = t.prototype; return i.addTrack = function (t) { var i = this; t.enabled && ul(this, t); n.prototype.addTrack.call(this, t); t.addEventListener && (t.enabledChange_ = function () { i.changing_ || (i.changing_ = !0, ul(i, t), i.changing_ = !1, i.trigger("change")) }, t.addEventListener("enabledchange", t.enabledChange_)) }, i.removeTrack = function (t) { n.prototype.removeTrack.call(this, t); t.removeEventListener && t.enabledChange_ && (t.removeEventListener("enabledchange", t.enabledChange_), t.enabledChange_ = null) }, t }(er), hut = function (n) { function t(t) { var r, i; for (void 0 === t && (t = []), i = t.length - 1; 0 <= i; i--)if (t[i].selected) { fl(t, t[i]); break } return (r = n.call(this, t) || this).changing_ = !1, Object.defineProperty(s(r), "selectedIndex", { get: function () { for (var n = 0; n < this.length; n++)if (this[n].selected) return n; return -1 }, set: function () { } }), r } f(t, n); var i = t.prototype; return i.addTrack = function (t) { var i = this; t.selected && fl(this, t); n.prototype.addTrack.call(this, t); t.addEventListener && (t.selectedChange_ = function () { i.changing_ || (i.changing_ = !0, fl(i, t), i.changing_ = !1, i.trigger("change")) }, t.addEventListener("selectedchange", t.selectedChange_)) }, i.removeTrack = function (t) { n.prototype.removeTrack.call(this, t); t.removeEventListener && t.selectedChange_ && (t.removeEventListener("selectedchange", t.selectedChange_), t.selectedChange_ = null) }, t }(er), pb = function (n) { function t() { return n.apply(this, arguments) || this } f(t, n); var i = t.prototype; return i.addTrack = function (t) { var i = this; n.prototype.addTrack.call(this, t); this.queueChange_ || (this.queueChange_ = function () { return i.queueTrigger("change") }); this.triggerSelectedlanguagechange || (this.triggerSelectedlanguagechange_ = function () { return i.trigger("selectedlanguagechange") }); t.addEventListener("modechange", this.queueChange_); -1 === ["metadata", "chapters"].indexOf(t.kind) && t.addEventListener("modechange", this.triggerSelectedlanguagechange_) }, i.removeTrack = function (t) { n.prototype.removeTrack.call(this, t); t.removeEventListener && (this.queueChange_ && t.removeEventListener("modechange", this.queueChange_), this.selectedlanguagechange_ && t.removeEventListener("modechange", this.triggerSelectedlanguagechange_)) }, t }(er), cut = function () { function t(n) { void 0 === n && (n = []); this.trackElements_ = []; Object.defineProperty(this, "length", { get: function () { return this.trackElements_.length } }); for (var t = 0, i = n.length; t < i; t++)this.addTrackElement_(n[t]) } var n = t.prototype; return n.addTrackElement_ = function (n) { var t = this.trackElements_.length; "" + t in this || Object.defineProperty(this, t, { get: function () { return this.trackElements_[t] } }); -1 === this.trackElements_.indexOf(n) && this.trackElements_.push(n) }, n.getTrackElementByTrack_ = function (n) { for (var i, t = 0, r = this.trackElements_.length; t < r; t++)if (n === this.trackElements_[t].track) { i = this.trackElements_[t]; break } return i }, n.removeTrackElement_ = function (n) { for (var t = 0, i = this.trackElements_.length; t < i; t++)if (n === this.trackElements_[t]) { this.trackElements_[t].track && "function" == typeof this.trackElements_[t].track.off && this.trackElements_[t].track.off(); "function" == typeof this.trackElements_[t].off && this.trackElements_[t].off(); this.trackElements_.splice(t, 1); break } }, t }(), wb = function () { function n(t) { n.prototype.setCues_.call(this, t); Object.defineProperty(this, "length", { get: function () { return this.length_ } }) } var t = n.prototype; return t.setCues_ = function (n) { function u(n) { "" + n in this || Object.defineProperty(this, "" + n, { get: function () { return this.cues_[n] } }) } var i = this.length || 0, t = 0, r = n.length; if (this.cues_ = n, this.length_ = n.length, i < r) for (t = i; t < r; t++)u.call(this, t) }, t.getCueById = function (n) { for (var i, r = null, t = 0, u = this.length; t < u; t++)if (i = this[t], i.id === n) { r = i; break } return r }, n }(), lut = { alternative: "alternative", captions: "captions", main: "main", sign: "sign", subtitles: "subtitles", commentary: "commentary" }, aut = { alternative: "alternative", descriptions: "descriptions", main: "main", "main-desc": "main-desc", translation: "translation", commentary: "commentary" }, vut = { subtitles: "subtitles", captions: "captions", descriptions: "descriptions", chapters: "chapters", metadata: "metadata" }, bb = { disabled: "disabled", hidden: "hidden", showing: "showing" }, sl = function (n) { function t(t) { function f(n) { Object.defineProperty(s(i), n, { get: function () { return r[n] }, set: function () { } }) } var i, r, u; void 0 === t && (t = {}); i = n.call(this) || this; r = { id: t.id || "vjs_track_" + pi(), kind: t.kind || "", label: t.label || "", language: t.language || "" }; for (u in r) f(u); return i } return f(t, n), t }(ft), yut = Object.freeze({ parseUrl: el, getAbsoluteURL: yb, getFileExtension: ol, isCrossOrigin: oo }), put = function (n) { var t = wut.call(n); return "[object Function]" === t || "function" == typeof n && "[object RegExp]" !== t || "undefined" != typeof window && (n === window.setTimeout || n === window.alert || n === window.confirm || n === window.prompt) }, wut = Object.prototype.toString; var db, hl = Array.prototype.slice, but = Object.prototype.toString, cl = Function.prototype.bind || function (n) { var t = this; if ("function" != typeof t || "[object Function]" !== but.call(t)) throw new TypeError("Function.prototype.bind called on incompatible " + t); for (var i, r = hl.call(arguments, 1), e = Math.max(0, t.length - r.length), f = [], u = 0; u < e; u++)f.push("$" + u); if (i = Function("binder", "return function (" + f.join(",") + "){ return binder.apply(this,arguments); }")(function () { if (this instanceof i) { var u = t.apply(this, r.concat(hl.call(arguments))); return Object(u) === u ? u : this } return t.apply(n, r.concat(hl.call(arguments))) }), t.prototype) { function n() { } n.prototype = t.prototype; i.prototype = new n; n.prototype = null } return i }, gb = Object.prototype.toString; if (!Object.keys) { function n(n) { var t = n.constructor; return t && t.prototype === n } var so = Object.prototype.hasOwnProperty, nk = Object.prototype.toString, kut = kb, tk = Object.prototype.propertyIsEnumerable, dut = !tk.call({ toString: null }, "toString"), gut = tk.call(function () { }, "prototype"), ho = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"], nft = { $applicationCache: !0, $console: !0, $external: !0, $frame: !0, $frameElement: !0, $frames: !0, $innerHeight: !0, $innerWidth: !0, $onmozfullscreenchange: !0, $onmozfullscreenerror: !0, $outerHeight: !0, $outerWidth: !0, $pageXOffset: !0, $pageYOffset: !0, $parent: !0, $scrollLeft: !0, $scrollTop: !0, $scrollX: !0, $scrollY: !0, $self: !0, $webkitIndexedDB: !0, $webkitStorageInfo: !0, $window: !0 }, tft = function () { if ("undefined" == typeof window) return !1; for (var t in window) try { if (!nft["$" + t] && so.call(window, t) && null !== window[t] && "object" == typeof window[t]) try { n(window[t]) } catch (t) { return !0 } } catch (t) { return !0 } return !1 }(); db = function (t) { var o = null !== t && "object" == typeof t, s = "[object Function]" === nk.call(t), h = kut(t), a = o && "[object String]" === nk.call(t), r = [], c, u, f, e, l, i; if (!o && !s && !h) throw new TypeError("Object.keys called on a non-object"); if (c = gut && s, a && 0 < t.length && !so.call(t, 0)) for (u = 0; u < t.length; ++u)r.push(String(u)); if (h && 0 < t.length) for (f = 0; f < t.length; ++f)r.push(String(f)); else for (e in t) c && "prototype" === e || !so.call(t, e) || r.push(String(e)); if (dut) for (l = function (t) { if ("undefined" == typeof window || !tft) return n(t); try { return n(t) } catch (t) { return !1 } }(t), i = 0; i < ho.length; ++i)l && "constructor" === ho[i] || !so.call(t, ho[i]) || r.push(ho[i]); return r } } var ift = db, rft = Array.prototype.slice, ik = Object.keys, co = ik ? function (n) { return ik(n) } : ift, rk = Object.keys; co.shim = function () { return Object.keys ? function () { var n = Object.keys(arguments); return n && n.length === arguments.length }(1, 2) || (Object.keys = function (n) { return kb(n) ? rk(rft.call(n)) : rk(n) }) : Object.keys = co, Object.keys || co }; var fft = co, eft = "function" == typeof Symbol && "symbol" == typeof Symbol("foo"), oft = Object.prototype.toString, sft = Array.prototype.concat, ll = Object.defineProperty, fk = ll && function () { var n = {}, t; try { for (t in ll(n, "x", { enumerable: !1, value: n }), n) return !1; return n.x === n } catch (n) { return !1 } }(); uk.supportsDescriptors = !!fk; var e, ck = uk, hft = Object.getOwnPropertyDescriptor ? function () { return Object.getOwnPropertyDescriptor(arguments, "callee").get }() : function () { throw new TypeError; }, or = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator, sr = Object.getPrototypeOf || function (n) { return n.__proto__ }, yl = "undefined" == typeof Uint8Array ? e : sr(Uint8Array), pl = { "$ %Array%": Array, "$ %ArrayBuffer%": "undefined" == typeof ArrayBuffer ? e : ArrayBuffer, "$ %ArrayBufferPrototype%": "undefined" == typeof ArrayBuffer ? e : ArrayBuffer.prototype, "$ %ArrayIteratorPrototype%": or ? sr([][Symbol.iterator]()) : e, "$ %ArrayPrototype%": Array.prototype, "$ %ArrayProto_entries%": Array.prototype.entries, "$ %ArrayProto_forEach%": Array.prototype.forEach, "$ %ArrayProto_keys%": Array.prototype.keys, "$ %ArrayProto_values%": Array.prototype.values, "$ %AsyncFromSyncIteratorPrototype%": e, "$ %AsyncFunction%": void 0, "$ %AsyncFunctionPrototype%": e, "$ %AsyncGenerator%": e, "$ %AsyncGeneratorFunction%": void 0, "$ %AsyncGeneratorPrototype%": e, "$ %AsyncIteratorPrototype%": e, "$ %Atomics%": "undefined" == typeof Atomics ? e : Atomics, "$ %Boolean%": Boolean, "$ %BooleanPrototype%": Boolean.prototype, "$ %DataView%": "undefined" == typeof DataView ? e : DataView, "$ %DataViewPrototype%": "undefined" == typeof DataView ? e : DataView.prototype, "$ %Date%": Date, "$ %DatePrototype%": Date.prototype, "$ %decodeURI%": decodeURI, "$ %decodeURIComponent%": decodeURIComponent, "$ %encodeURI%": encodeURI, "$ %encodeURIComponent%": encodeURIComponent, "$ %Error%": Error, "$ %ErrorPrototype%": Error.prototype, "$ %eval%": eval, "$ %EvalError%": EvalError, "$ %EvalErrorPrototype%": EvalError.prototype, "$ %Float32Array%": "undefined" == typeof Float32Array ? e : Float32Array, "$ %Float32ArrayPrototype%": "undefined" == typeof Float32Array ? e : Float32Array.prototype, "$ %Float64Array%": "undefined" == typeof Float64Array ? e : Float64Array, "$ %Float64ArrayPrototype%": "undefined" == typeof Float64Array ? e : Float64Array.prototype, "$ %Function%": Function, "$ %FunctionPrototype%": Function.prototype, "$ %Generator%": e, "$ %GeneratorFunction%": void 0, "$ %GeneratorPrototype%": e, "$ %Int8Array%": "undefined" == typeof Int8Array ? e : Int8Array, "$ %Int8ArrayPrototype%": "undefined" == typeof Int8Array ? e : Int8Array.prototype, "$ %Int16Array%": "undefined" == typeof Int16Array ? e : Int16Array, "$ %Int16ArrayPrototype%": "undefined" == typeof Int16Array ? e : Int8Array.prototype, "$ %Int32Array%": "undefined" == typeof Int32Array ? e : Int32Array, "$ %Int32ArrayPrototype%": "undefined" == typeof Int32Array ? e : Int32Array.prototype, "$ %isFinite%": isFinite, "$ %isNaN%": isNaN, "$ %IteratorPrototype%": or ? sr(sr([][Symbol.iterator]())) : e, "$ %JSON%": JSON, "$ %JSONParse%": JSON.parse, "$ %Map%": "undefined" == typeof Map ? e : Map, "$ %MapIteratorPrototype%": "undefined" != typeof Map && or ? sr((new Map)[Symbol.iterator]()) : e, "$ %MapPrototype%": "undefined" == typeof Map ? e : Map.prototype, "$ %Math%": Math, "$ %Number%": Number, "$ %NumberPrototype%": Number.prototype, "$ %Object%": Object, "$ %ObjectPrototype%": Object.prototype, "$ %ObjProto_toString%": Object.prototype.toString, "$ %ObjProto_valueOf%": Object.prototype.valueOf, "$ %parseFloat%": parseFloat, "$ %parseInt%": parseInt, "$ %Promise%": "undefined" == typeof Promise ? e : Promise, "$ %PromisePrototype%": "undefined" == typeof Promise ? e : Promise.prototype, "$ %PromiseProto_then%": "undefined" == typeof Promise ? e : Promise.prototype.then, "$ %Promise_all%": "undefined" == typeof Promise ? e : Promise.all, "$ %Promise_reject%": "undefined" == typeof Promise ? e : Promise.reject, "$ %Promise_resolve%": "undefined" == typeof Promise ? e : Promise.resolve, "$ %Proxy%": "undefined" == typeof Proxy ? e : Proxy, "$ %RangeError%": RangeError, "$ %RangeErrorPrototype%": RangeError.prototype, "$ %ReferenceError%": ReferenceError, "$ %ReferenceErrorPrototype%": ReferenceError.prototype, "$ %Reflect%": "undefined" == typeof Reflect ? e : Reflect, "$ %RegExp%": RegExp, "$ %RegExpPrototype%": RegExp.prototype, "$ %Set%": "undefined" == typeof Set ? e : Set, "$ %SetIteratorPrototype%": "undefined" != typeof Set && or ? sr((new Set)[Symbol.iterator]()) : e, "$ %SetPrototype%": "undefined" == typeof Set ? e : Set.prototype, "$ %SharedArrayBuffer%": "undefined" == typeof SharedArrayBuffer ? e : SharedArrayBuffer, "$ %SharedArrayBufferPrototype%": "undefined" == typeof SharedArrayBuffer ? e : SharedArrayBuffer.prototype, "$ %String%": String, "$ %StringIteratorPrototype%": or ? sr(""[Symbol.iterator]()) : e, "$ %StringPrototype%": String.prototype, "$ %Symbol%": or ? Symbol : e, "$ %SymbolPrototype%": or ? Symbol.prototype : e, "$ %SyntaxError%": SyntaxError, "$ %SyntaxErrorPrototype%": SyntaxError.prototype, "$ %ThrowTypeError%": hft, "$ %TypedArray%": yl, "$ %TypedArrayPrototype%": yl ? yl.prototype : e, "$ %TypeError%": TypeError, "$ %TypeErrorPrototype%": TypeError.prototype, "$ %Uint8Array%": "undefined" == typeof Uint8Array ? e : Uint8Array, "$ %Uint8ArrayPrototype%": "undefined" == typeof Uint8Array ? e : Uint8Array.prototype, "$ %Uint8ClampedArray%": "undefined" == typeof Uint8ClampedArray ? e : Uint8ClampedArray, "$ %Uint8ClampedArrayPrototype%": "undefined" == typeof Uint8ClampedArray ? e : Uint8ClampedArray.prototype, "$ %Uint16Array%": "undefined" == typeof Uint16Array ? e : Uint16Array, "$ %Uint16ArrayPrototype%": "undefined" == typeof Uint16Array ? e : Uint16Array.prototype, "$ %Uint32Array%": "undefined" == typeof Uint32Array ? e : Uint32Array, "$ %Uint32ArrayPrototype%": "undefined" == typeof Uint32Array ? e : Uint32Array.prototype, "$ %URIError%": URIError, "$ %URIErrorPrototype%": URIError.prototype, "$ %WeakMap%": "undefined" == typeof WeakMap ? e : WeakMap, "$ %WeakMapPrototype%": "undefined" == typeof WeakMap ? e : WeakMap.prototype, "$ %WeakSet%": "undefined" == typeof WeakSet ? e : WeakSet, "$ %WeakSetPrototype%": "undefined" == typeof WeakSet ? e : WeakSet.prototype }, p = cl.call(Function.call, Object.prototype.hasOwnProperty), lk = ne("%TypeError%"), cft = ne("%SyntaxError%"), lft = { "Property Descriptor": function (n, t) { var r, i, u, f; if ("Object" !== n.Type(t)) return !1; r = { "[[Configurable]]": !0, "[[Enumerable]]": !0, "[[Get]]": !0, "[[Set]]": !0, "[[Value]]": !0, "[[Writable]]": !0 }; for (i in t) if (p(t, i) && !r[i]) return !1; if (u = p(t, "[[Value]]"), f = p(t, "[[Get]]") || p(t, "[[Set]]"), u && f) throw new lk("Property Descriptors may not be both accessor and data descriptors"); return !0 } }, ao = Number.isNaN || function (n) { return n != n }, aft = Number.isNaN || function (n) { return n != n }, ak = Number.isFinite || function (n) { return "number" == typeof n && !aft(n) && n !== 1 / 0 && n !== -1 / 0 }, vk = Function.prototype.toString, vft = /^\s*class\b/, yft = Object.prototype.toString, pft = "function" == typeof Symbol && "symbol" == typeof Symbol.toStringTag, wft = Object.prototype.toString, yk = function (n, t) { var u, f, i, r; if ((u = 1 < arguments.length ? t : "[object Date]" === wft.call(n) ? String : Number) !== String && u !== Number) throw new TypeError("invalid [[DefaultValue]] hint supplied"); for (r = u === String ? ["toString", "valueOf"] : ["valueOf", "toString"], i = 0; i < r.length; ++i)if (al(n[r[i]]) && (f = n[r[i]](), sk(f))) return f; throw new TypeError("No default value"); }, bft = ne("%Object%"), su = ne("%TypeError%"), kft = ne("%String%"), pk = { ToPrimitive: function (n, t) { return sk(n) ? n : 1 < arguments.length ? yk(n, t) : yk(n) }, ToBoolean: function (n) { return !!n }, ToNumber: function (n) { return +n }, ToInteger: function (n) { var t = this.ToNumber(n); return ao(t) ? 0 : 0 !== t && ak(t) ? ek(t) * Math.floor(Math.abs(t)) : t }, ToInt32: function (n) { return this.ToNumber(n) >> 0 }, ToUint32: function (n) { return this.ToNumber(n) >>> 0 }, ToUint16: function (n) { var t = this.ToNumber(n); return ao(t) || 0 === t || !ak(t) ? 0 : function (n, t) { var i = n % t; return Math.floor(0 <= i ? i : i + t) }(ek(t) * Math.floor(Math.abs(t)), 65536) }, ToString: function (n) { return kft(n) }, ToObject: function (n) { return this.CheckObjectCoercible(n), bft(n) }, CheckObjectCoercible: function (n, t) { if (null == n) throw new su(t || "Cannot call method on " + n); return n }, IsCallable: al, SameValue: function (n, t) { return n === t ? 0 !== n || 1 / n == 1 / t : ao(n) && ao(t) }, Type: function (n) { return null === n ? "Null" : "undefined" == typeof n ? "Undefined" : "function" == typeof n || "object" == typeof n ? "Object" : "number" == typeof n ? "Number" : "boolean" == typeof n ? "Boolean" : "string" == typeof n ? "String" : void 0 }, IsPropertyDescriptor: function (n) { var i, t, r, u; if ("Object" !== this.Type(n)) return !1; i = { "[[Configurable]]": !0, "[[Enumerable]]": !0, "[[Get]]": !0, "[[Set]]": !0, "[[Value]]": !0, "[[Writable]]": !0 }; for (t in n) if (p(n, t) && !i[t]) return !1; if (r = p(n, "[[Value]]"), u = p(n, "[[Get]]") || p(n, "[[Set]]"), r && u) throw new su("Property Descriptors may not be both accessor and data descriptors"); return !0 }, IsAccessorDescriptor: function (n) { return "undefined" != typeof n && (lo(this, "Property Descriptor", "Desc", n), !(!p(n, "[[Get]]") && !p(n, "[[Set]]"))) }, IsDataDescriptor: function (n) { return "undefined" != typeof n && (lo(this, "Property Descriptor", "Desc", n), !(!p(n, "[[Value]]") && !p(n, "[[Writable]]"))) }, IsGenericDescriptor: function (n) { return "undefined" != typeof n && (lo(this, "Property Descriptor", "Desc", n), !this.IsAccessorDescriptor(n) && !this.IsDataDescriptor(n)) }, FromPropertyDescriptor: function (n) { if ("undefined" == typeof n) return n; if (lo(this, "Property Descriptor", "Desc", n), this.IsDataDescriptor(n)) return { value: n["[[Value]]"], writable: !!n["[[Writable]]"], enumerable: !!n["[[Enumerable]]"], configurable: !!n["[[Configurable]]"] }; if (this.IsAccessorDescriptor(n)) return { get: n["[[Get]]"], set: n["[[Set]]"], enumerable: !!n["[[Enumerable]]"], configurable: !!n["[[Configurable]]"] }; throw new su("FromPropertyDescriptor must be called with a fully populated Property Descriptor"); }, ToPropertyDescriptor: function (n) { var t, i, r; if ("Object" !== this.Type(n)) throw new su("ToPropertyDescriptor requires an object"); if (t = {}, p(n, "enumerable") && (t["[[Enumerable]]"] = this.ToBoolean(n.enumerable)), p(n, "configurable") && (t["[[Configurable]]"] = this.ToBoolean(n.configurable)), p(n, "value") && (t["[[Value]]"] = n.value), p(n, "writable") && (t["[[Writable]]"] = this.ToBoolean(n.writable)), p(n, "get")) { if (i = n.get, "undefined" != typeof i && !this.IsCallable(i)) throw new TypeError("getter must be a function"); t["[[Get]]"] = i } if (p(n, "set")) { if (r = n.set, "undefined" != typeof r && !this.IsCallable(r)) throw new su("setter must be a function"); t["[[Set]]"] = r } if ((p(t, "[[Get]]") || p(t, "[[Set]]")) && (p(t, "[[Value]]") || p(t, "[[Writable]]"))) throw new su("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute"); return t } }, wk = cl.call(Function.call, String.prototype.replace), dft = /^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/, gft = /[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/, bk = cl.call(Function.call, vl()); ck(bk, { getPolyfill: vl, implementation: hk, shim: function () { var n = vl(); return ck(String.prototype, { trim: n }, { trim: function () { return String.prototype.trim !== n } }), n } }); var wl = bk, net = Object.prototype.toString, kk = Object.prototype.hasOwnProperty, tet = function (n, t, i) { if (!al(t)) throw new TypeError("iterator must be a function"); var r; 3 <= arguments.length && (r = i); "[object Array]" === net.call(n) ? function (n, t, i) { for (var r = 0, u = n.length; r < u; r++)kk.call(n, r) && (null == i ? t(n[r], r, n) : t.call(i, n[r], r, n)) }(n, t, r) : "string" == typeof n ? function (n, t, i) { for (var r = 0, u = n.length; r < u; r++)null == i ? t(n.charAt(r), r, n) : t.call(i, n.charAt(r), r, n) }(n, t, r) : function (n, t, i) { for (var r in n) kk.call(n, r) && (null == i ? t(n[r], r, n) : t.call(i, n[r], r, n)) }(n, t, r) }, iet = function (n) { if (!n) return {}; var t = {}; return tet(wl(n).split("\n"), function (n) { var u = n.indexOf(":"), i = wl(n.slice(0, u)).toLowerCase(), r = wl(n.slice(u + 1)); "undefined" == typeof t[i] ? t[i] = r : function (n) { return "[object Array]" === Object.prototype.toString.call(n) }(t[i]) ? t[i].push(r) : t[i] = [t[i], r] }), t }, ret = function () { for (var t, i, r = {}, n = 0; n < arguments.length; n++) { t = arguments[n]; for (i in t) uet.call(t, i) && (r[i] = t[i]) } return r }, uet = Object.prototype.hasOwnProperty, dk = gi; gi.XMLHttpRequest = n.XMLHttpRequest || function () { }; gi.XDomainRequest = "withCredentials" in new gi.XMLHttpRequest ? gi.XMLHttpRequest : n.XDomainRequest, function (n, t) { for (var i = 0; i < n.length; i++)t(n[i]) }(["get", "put", "post", "patch", "head", "delete"], function (n) { gi["delete" === n ? "del" : n] = function (t, i, r) { return (i = gk(t, i, r)).method = n.toUpperCase(), nd(i) } }); hu = function (t) { function i(i) { var r; if (void 0 === i && (i = {}), !i.tech) throw new Error("A tech was not provided."); var u = a(i, { kind: vut[i.kind] || "subtitles", language: i.language || i.srclang || "" }), e = bb[u.mode] || "disabled", v = u.default; "metadata" !== u.kind && "chapters" !== u.kind || (e = "hidden"); (r = t.call(this, u) || this).tech_ = u.tech; r.cues_ = []; r.activeCues_ = []; var y = new wb(r.cues_), o = new wb(r.activeCues_), f = !1, l = h(s(r), function () { this.activeCues = this.activeCues; f && (this.trigger("cuechange"), f = !1) }); return "disabled" !== e && r.tech_.ready(function () { r.tech_.on("timeupdate", l) }, !0), Object.defineProperties(s(r), { "default": { get: function () { return v }, set: function () { } }, mode: { get: function () { return e }, set: function (n) { var t = this; bb[n] && ("disabled" !== (e = n) ? this.tech_.ready(function () { t.tech_.on("timeupdate", l) }, !0) : this.tech_.off("timeupdate", l), this.trigger("modechange")) } }, cues: { get: function () { return this.loaded_ ? y : null }, set: function () { } }, activeCues: { get: function () { var n, r; if (!this.loaded_) return null; if (0 === this.cues.length) return o; for (var i = this.tech_.currentTime(), t = [], u = 0, e = this.cues.length; u < e; u++)n = this.cues[u], n.startTime <= i && n.endTime >= i ? t.push(n) : n.startTime === n.endTime && n.startTime <= i && n.startTime + .5 >= i && t.push(n); if (f = !1, t.length !== this.activeCues_.length) f = !0; else for (r = 0; r < t.length; r++)-1 === this.activeCues_.indexOf(t[r]) && (f = !0); return this.activeCues_ = t, o.setCues_(this.activeCues_), o }, set: function () { } } }), u.src ? (r.src = u.src, function (t, i) { var r = { uri: t }, u = oo(t); u && (r.cors = u); dk(r, h(this, function (t, r, u) { if (t) return c.error(t, r); i.loaded_ = !0; "function" != typeof n.WebVTT ? i.tech_ && i.tech_.any(["vttjsloaded", "vttjserror"], function (n) { if ("vttjserror" !== n.type) return td(u, i); c.error("vttjs failed to load, stopping trying to process " + i.src) }) : td(u, i) })) }(u.src, s(r))) : r.loaded_ = !0, r } f(i, t); var r = i.prototype; return r.addCue = function (t) { var i = t, u, f, r; if (n.vttjs && !(t instanceof n.vttjs.VTTCue)) { for (u in i = new n.vttjs.VTTCue(t.startTime, t.endTime, t.text), t) u in i || (i[u] = t[u]); i.id = t.id; i.originalCue_ = t } for (f = this.tech_.textTracks(), r = 0; r < f.length; r++)f[r] !== this && f[r].removeCue(i); this.cues_.push(i); this.cues.setCues_(this.cues_) }, r.removeCue = function (n) { for (var i, t = this.cues_.length; t--;)if (i = this.cues_[t], i === n || i.originalCue_ && i.originalCue_ === n) { this.cues_.splice(t, 1); this.cues.setCues_(this.cues_); break } }, i }(sl); hu.prototype.allowedEvents_ = { cuechange: "cuechange" }; var id = function (n) { function t(t) { var i, r, u; return void 0 === t && (t = {}), r = a(t, { kind: aut[t.kind] || "" }), i = n.call(this, r) || this, u = !1, Object.defineProperty(s(i), "enabled", { get: function () { return u }, set: function (n) { "boolean" == typeof n && n !== u && (u = n, this.trigger("enabledchange")) } }), r.enabled && (i.enabled = r.enabled), i.loaded_ = !0, i } return f(t, n), t }(sl), rd = function (n) { function t(t) { var i, r, u; return void 0 === t && (t = {}), r = a(t, { kind: lut[t.kind] || "" }), i = n.call(this, r) || this, u = !1, Object.defineProperty(s(i), "selected", { get: function () { return u }, set: function (n) { "boolean" == typeof n && n !== u && (u = n, this.trigger("selectedchange")) } }), r.selected && (i.selected = r.selected), i } return f(t, n), t }(sl), cu = function (n) { function t(t) { var i, u, r; return void 0 === t && (t = {}), i = n.call(this) || this, r = new hu(t), i.kind = r.kind, i.src = r.src, i.srclang = r.language, i.label = r.label, i.default = r.default, Object.defineProperties(s(i), { readyState: { get: function () { return u } }, track: { get: function () { return r } } }), u = 0, r.addEventListener("loadeddata", function () { u = 2; i.trigger({ type: "load", target: s(i) }) }), i } return f(t, n), t }(ft); cu.prototype.allowedEvents_ = { load: "load" }; cu.NONE = 0; cu.LOADING = 1; cu.LOADED = 2; cu.ERROR = 3; pt = { audio: { ListClass: sut, TrackClass: id, capitalName: "Audio" }, video: { ListClass: hut, TrackClass: rd, capitalName: "Video" }, text: { ListClass: pb, TrackClass: hu, capitalName: "Text" } }; Object.keys(pt).forEach(function (n) { pt[n].getterName = n + "Tracks"; pt[n].privateName = n + "Tracks_" }); lu = { remoteText: { ListClass: pb, TrackClass: hu, capitalName: "RemoteText", getterName: "remoteTextTracks", privateName: "remoteTextTracks_" }, remoteTextEl: { ListClass: cut, TrackClass: cu, capitalName: "RemoteTextTrackEls", getterName: "remoteTextTrackEls", privateName: "remoteTextTrackEls_" } }; ut = a(pt, lu); lu.names = Object.keys(lu); pt.names = Object.keys(pt); ut.names = [].concat(lu.names).concat(pt.names); vo = Object.create || function (n) { if (1 !== arguments.length) throw new Error("Object.create shim only accepts one parameter."); return ud.prototype = n, new ud }; ((fi.prototype = vo(Error.prototype)).constructor = fi).Errors = { BadSignature: { code: 0, message: "Malformed WebVTT signature." }, BadTimeStamp: { code: 1, message: "Malformed time stamp." } }; te.prototype = { set: function (n, t) { this.get(n) || "" === t || (this.values[n] = t) }, get: function (n, t, i) { return i ? this.has(n) ? this.values[n] : t[i] : this.has(n) ? this.values[n] : t }, has: function (n) { return n in this.values }, alt: function (n, t, i) { for (var r = 0; r < i.length; ++r)if (t === i[r]) { this.set(n, t); break } }, integer: function (n, t) { /^-?\d+$/.test(t) && this.set(n, parseInt(t, 10)) }, percent: function (n, t) { return !!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/) && 0 <= (t = parseFloat(t)) && t <= 100) && (this.set(n, t), !0) } }; var eet = { "&amp;": "&", "&lt;": "<", "&gt;": ">", "&lrm;": "‎", "&rlm;": "‏", "&nbsp;": " " }, oet = { c: "span", i: "i", b: "b", u: "u", ruby: "ruby", rt: "rt", v: "span", lang: "span" }, set = { v: "title", lang: "lang" }, fd = { rt: "ruby" }; kl = [[1470, 1470], [1472, 1472], [1475, 1475], [1478, 1478], [1488, 1514], [1520, 1524], [1544, 1544], [1547, 1547], [1549, 1549], [1563, 1563], [1566, 1610], [1645, 1647], [1649, 1749], [1765, 1766], [1774, 1775], [1786, 1805], [1807, 1808], [1810, 1839], [1869, 1957], [1969, 1969], [1984, 2026], [2036, 2037], [2042, 2042], [2048, 2069], [2074, 2074], [2084, 2084], [2088, 2088], [2096, 2110], [2112, 2136], [2142, 2142], [2208, 2208], [2210, 2220], [8207, 8207], [64285, 64285], [64287, 64296], [64298, 64310], [64312, 64316], [64318, 64318], [64320, 64321], [64323, 64324], [64326, 64449], [64467, 64829], [64848, 64911], [64914, 64967], [65008, 65020], [65136, 65140], [65142, 65276], [67584, 67589], [67592, 67592], [67594, 67637], [67639, 67640], [67644, 67644], [67647, 67669], [67671, 67679], [67840, 67867], [67872, 67897], [67903, 67903], [67968, 68023], [68030, 68031], [68096, 68096], [68112, 68115], [68117, 68119], [68121, 68147], [68160, 68167], [68176, 68184], [68192, 68223], [68352, 68405], [68416, 68437], [68440, 68466], [68472, 68479], [68608, 68680], [126464, 126467], [126469, 126495], [126497, 126498], [126500, 126500], [126503, 126503], [126505, 126514], [126516, 126519], [126521, 126521], [126523, 126523], [126530, 126530], [126535, 126535], [126537, 126537], [126539, 126539], [126541, 126543], [126545, 126546], [126548, 126548], [126551, 126551], [126553, 126553], [126555, 126555], [126557, 126557], [126559, 126559], [126561, 126562], [126564, 126564], [126567, 126570], [126572, 126578], [126580, 126583], [126585, 126588], [126590, 126590], [126592, 126601], [126603, 126619], [126625, 126627], [126629, 126633], [126635, 126651], [1114109, 1114109]]; yo.prototype.applyStyles = function (n, t) { for (var i in t = t || this.div, n) n.hasOwnProperty(i) && (t.style[i] = n[i]) }; yo.prototype.formatStyle = function (n, t) { return 0 === n ? 0 : n + t }; (dl.prototype = vo(yo.prototype)).constructor = dl; ot.prototype.move = function (n, t) { switch (t = void 0 !== t ? t : this.lineHeight, n) { case "+x": this.left += t; this.right += t; break; case "-x": this.left -= t; this.right -= t; break; case "+y": this.top += t; this.bottom += t; break; case "-y": this.top -= t; this.bottom -= t } }; ot.prototype.overlaps = function (n) { return this.left < n.right && this.right > n.left && this.top < n.bottom && this.bottom > n.top }; ot.prototype.overlapsAny = function (n) { for (var t = 0; t < n.length; t++)if (this.overlaps(n[t])) return !0; return !1 }; ot.prototype.within = function (n) { return this.top >= n.top && this.bottom <= n.bottom && this.left >= n.left && this.right <= n.right }; ot.prototype.overlapsOppositeAxis = function (n, t) { switch (t) { case "+x": return this.left < n.left; case "-x": return this.right > n.right; case "+y": return this.top < n.top; case "-y": return this.bottom > n.bottom } }; ot.prototype.intersectPercentage = function (n) { return Math.max(0, Math.min(this.right, n.right) - Math.max(this.left, n.left)) * Math.max(0, Math.min(this.bottom, n.bottom) - Math.max(this.top, n.top)) / (this.height * this.width) }; ot.prototype.toCSSCompatValues = function (n) { return { top: this.top - n.top, bottom: n.bottom - this.bottom, left: this.left - n.left, right: n.right - this.right, height: this.height, width: this.width } }; ot.getSimpleBoxPosition = function (n) { var t = n.div ? n.div.offsetHeight : n.tagName ? n.offsetHeight : 0, r = n.div ? n.div.offsetWidth : n.tagName ? n.offsetWidth : 0, i = n.div ? n.div.offsetTop : n.tagName ? n.offsetTop : 0; return { left: (n = n.div ? n.div.getBoundingClientRect() : n.tagName ? n.getBoundingClientRect() : n).left, right: n.right, top: n.top || i, height: n.height || t, bottom: n.bottom || i + (n.height || t), width: n.width || r } }; re.StringDecoder = function () { return { decode: function (n) { if (!n) return ""; if ("string" != typeof n) throw new Error("Error - expected string data."); return decodeURIComponent(encodeURIComponent(n)) } } }; re.convertCueToDOMTree = function (n, t) { return n && t ? ed(n, t) : null }; re.processCues = function (n, t, i) { var r, u; if (!n || !t || !i) return null; for (; i.firstChild;)i.removeChild(i.firstChild); if (r = n.document.createElement("div"), r.style.position = "absolute", r.style.left = "0", r.style.right = "0", r.style.top = "0", r.style.bottom = "0", r.style.margin = "1.5%", i.appendChild(r), function (n) { for (var t = 0; t < n.length; t++)if (n[t].hasBeenReset || !n[t].displayState) return !0; return !1 }(t)) { var f = [], e = ot.getSimpleBoxPosition(r), o = { font: Math.round(.05 * e.height * 100) / 100 + "px sans-serif" }; !function () { for (var i, u, s = 0; s < t.length; s++)u = t[s], i = new dl(n, u, o), r.appendChild(i.div), cet(0, i, e, f), u.displayState = i.div, f.push(ot.getSimpleBoxPosition(i)) }() } else for (u = 0; u < t.length; u++)r.appendChild(t[u].displayState) }; (re.Parser = function (n, t, i) { i || (i = t, t = {}); t = t || {}; this.window = n; this.vttjs = t; this.state = "INITIAL"; this.buffer = ""; this.decoder = i || new TextDecoder("utf8"); this.regionList = [] }).prototype = { reportOrThrowError: function (n) { if (!(n instanceof fi)) throw n; this.onparsingerror && this.onparsingerror(n) }, parse: function (n) { function f() { for (var r, i = t.buffer, n = 0; n < i.length && "\r" !== i[n] && "\n" !== i[n];)++n; return r = i.substr(0, n), "\r" === i[n] && ++n, "\n" === i[n] && ++n, t.buffer = i.substr(n), r } function o(n) { n.match(/X-TIMESTAMP-MAP/) ? ie(n, function (n, i) { switch (n) { case "X-TIMESTAMP-MAP": !function (n) { var i = new te; ie(n, function (n, t) { switch (n) { case "MPEGT": i.integer(n + "S", t); break; case "LOCA": i.set(n + "L", bl(t)) } }, /[^\d]:/, /,/); t.ontimestampmap && t.ontimestampmap({ MPEGTS: i.get("MPEGTS"), LOCAL: i.get("LOCAL") }) }(i) } }, /=/) : ie(n, function (n, i) { switch (n) { case "Region": !function (n) { var i = new te, r; (ie(n, function (n, t) { var u, r; switch (n) { case "id": i.set(n, t); break; case "width": i.percent(n, t); break; case "lines": i.integer(n, t); break; case "regionanchor": case "viewportanchor": if (u = t.split(","), 2 !== u.length) break; if (r = new te, r.percent("x", u[0]), r.percent("y", u[1]), !r.has("x") || !r.has("y")) break; i.set(n + "X", r.get("x")); i.set(n + "Y", r.get("y")); break; case "scroll": i.alt(n, t, ["up"]) } }, /=/, /\s/), i.has("id")) && (r = new (t.vttjs.VTTRegion || t.window.VTTRegion), r.width = i.get("width", 100), r.lines = i.get("lines", 3), r.regionAnchorX = i.get("regionanchorX", 0), r.regionAnchorY = i.get("regionanchorY", 100), r.viewportAnchorX = i.get("viewportanchorX", 0), r.viewportAnchorY = i.get("viewportanchorY", 100), r.scroll = i.get("scroll", ""), t.onregion && t.onregion(r), t.regionList.push({ id: i.get("id"), region: r })) }(i) } }, /:/) } var t = this, i, u, r, e; n && (t.buffer += t.decoder.decode(n, { stream: !0 })); try { if ("INITIAL" === t.state) { if (!/\r\n|\n/.test(t.buffer)) return this; if (u = (i = f()).match(/^WEBVTT([ \t].*)?$/), !u || !u[0]) throw new fi(fi.Errors.BadSignature); t.state = "HEADER" } for (r = !1; t.buffer;) { if (!/\r\n|\n/.test(t.buffer)) return this; switch (r ? r = !1 : i = f(), t.state) { case "HEADER": /:/.test(i) ? o(i) : i || (t.state = "ID"); continue; case "NOTE": i || (t.state = "ID"); continue; case "ID": if (/^NOTE($|[ \t])/.test(i)) { t.state = "NOTE"; break } if (!i) continue; if (t.cue = new (t.vttjs.VTTCue || t.window.VTTCue)(0, 0, ""), t.state = "CUE", -1 === i.indexOf("-->")) { t.cue.id = i; continue } case "CUE": try { fet(i, t.cue, t.regionList) } catch (n) { t.reportOrThrowError(n); t.cue = null; t.state = "BADCUE"; continue } t.state = "CUETEXT"; continue; case "CUETEXT": if (e = -1 !== i.indexOf("-->"), !i || e && (r = !0)) { t.oncue && t.oncue(t.cue); t.cue = null; t.state = "ID"; continue } t.cue.text && (t.cue.text += "\n"); t.cue.text += i; continue; case "BADCUE": i || (t.state = "ID"); continue } } } catch (n) { t.reportOrThrowError(n); "CUETEXT" === t.state && t.cue && t.oncue && t.oncue(t.cue); t.cue = null; t.state = "INITIAL" === t.state ? "BADWEBVTT" : "BADCUE" } return this }, flush: function () { var n = this; try { if (n.buffer += n.decoder.decode(), !n.cue && "HEADER" !== n.state || (n.buffer += "\n\n", n.parse()), "INITIAL" === n.state) throw new fi(fi.Errors.BadSignature); } catch (t) { n.reportOrThrowError(t) } return n.onflush && n.onflush(), this } }; var aet = re, vet = { "": 1, lr: 1, rl: 1 }, yet = { start: 1, middle: 1, end: 1, left: 1, right: 1 }; od.prototype.getCueAsHTML = function () { return WebVTT.convertCueToDOMTree(window, this.text) }; sd = od; hd = { "": !0, up: !0 }; au = il(function (t) { var i = t.exports = { WebVTT: aet, VTTCue: sd, VTTRegion: pet }; n.vttjs = i; n.WebVTT = i.WebVTT; var r = i.VTTCue, u = i.VTTRegion, f = n.VTTCue, e = n.VTTRegion; i.shim = function () { n.VTTCue = r; n.VTTRegion = u }; i.restore = function () { n.VTTCue = f; n.VTTRegion = e }; n.VTTCue || i.shim() }); au.WebVTT; au.VTTCue; au.VTTRegion; v = function (i) { function u(n, t) { var r; return void 0 === n && (n = {}), void 0 === t && (t = function () { }), n.reportTouchActivity = !1, (r = i.call(this, null, n, t) || this).hasStarted_ = !1, r.on("playing", function () { this.hasStarted_ = !0 }), r.on("loadstart", function () { this.hasStarted_ = !1 }), ut.names.forEach(function (t) { var i = ut[t]; n && n[i.getterName] && (r[i.privateName] = n[i.getterName]) }), r.featuresProgressEvents || r.manualProgressOn(), r.featuresTimeupdateEvents || r.manualTimeUpdatesOn(), ["Text", "Audio", "Video"].forEach(function (t) { !1 === n["native" + t + "Tracks"] && (r["featuresNative" + t + "Tracks"] = !1) }), !1 === n.nativeCaptions || !1 === n.nativeTextTracks ? r.featuresNativeTextTracks = !1 : !0 !== n.nativeCaptions && !0 !== n.nativeTextTracks || (r.featuresNativeTextTracks = !0), r.featuresNativeTextTracks || r.emulateTextTracks(), r.autoRemoteTextTracks_ = new ut.text.ListClass, r.initTrackListeners(), n.nativeControlsForTouch || r.emitTapEvents(), r.constructor && (r.name_ = r.constructor.name || "Unknown Tech"), r } f(u, i); var r = u.prototype; return r.triggerSourceset = function (n) { var t = this; this.isReady_ || this.one("ready", function () { return t.setTimeout(function () { return t.triggerSourceset(n) }, 1) }); this.trigger({ src: n, type: "sourceset" }) }, r.manualProgressOn = function () { this.on("durationchange", this.onDurationChange); this.manualProgress = !0; this.one("ready", this.trackProgress) }, r.manualProgressOff = function () { this.manualProgress = !1; this.stopTrackingProgress(); this.off("durationchange", this.onDurationChange) }, r.trackProgress = function () { this.stopTrackingProgress(); this.progressInterval = this.setInterval(h(this, function () { var n = this.bufferedPercent(); this.bufferedPercent_ !== n && this.trigger("progress"); 1 === (this.bufferedPercent_ = n) && this.stopTrackingProgress() }), 500) }, r.onDurationChange = function () { this.duration_ = this.duration() }, r.buffered = function () { return ur(0, 0) }, r.bufferedPercent = function () { return ob(this.buffered(), this.duration_) }, r.stopTrackingProgress = function () { this.clearInterval(this.progressInterval) }, r.manualTimeUpdatesOn = function () { this.manualTimeUpdates = !0; this.on("play", this.trackCurrentTime); this.on("pause", this.stopTrackingCurrentTime) }, r.manualTimeUpdatesOff = function () { this.manualTimeUpdates = !1; this.stopTrackingCurrentTime(); this.off("play", this.trackCurrentTime); this.off("pause", this.stopTrackingCurrentTime) }, r.trackCurrentTime = function () { this.currentTimeInterval && this.stopTrackingCurrentTime(); this.currentTimeInterval = this.setInterval(function () { this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, 250) }, r.stopTrackingCurrentTime = function () { this.clearInterval(this.currentTimeInterval); this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, r.dispose = function () { this.clearTracks(pt.names); this.manualProgress && this.manualProgressOff(); this.manualTimeUpdates && this.manualTimeUpdatesOff(); i.prototype.dispose.call(this) }, r.clearTracks = function (n) { var t = this; (n = [].concat(n)).forEach(function (n) { for (var u, i = t[n + "Tracks"]() || [], r = i.length; r--;)u = i[r], "text" === n && t.removeRemoteTextTrack(u), i.removeTrack(u) }) }, r.cleanupAutoTextTracks = function () { for (var i, n = this.autoRemoteTextTracks_ || [], t = n.length; t--;)i = n[t], this.removeRemoteTextTrack(i) }, r.reset = function () { }, r.error = function (n) { return void 0 !== n && (this.error_ = new et(n), this.trigger("error")), this.error_ }, r.played = function () { return this.hasStarted_ ? ur(0, 0) : ur() }, r.setCurrentTime = function () { this.manualTimeUpdates && this.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }) }, r.initTrackListeners = function () { var n = this; pt.names.forEach(function (t) { function i() { n.trigger(t + "trackchange") } var u = pt[t], r = n[u.getterName](); r.addEventListener("removetrack", i); r.addEventListener("addtrack", i); n.on("dispose", function () { r.removeEventListener("removetrack", i); r.removeEventListener("addtrack", i) }) }) }, r.addWebVttScript_ = function () { var r = this, i; if (!n.WebVTT) if (t.body.contains(this.el())) { if (!this.options_["vtt.js"] && lf(au) && 0 < Object.keys(au).length) return void this.trigger("vttjsloaded"); i = t.createElement("script"); i.src = this.options_["vtt.js"] || "https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js"; i.onload = function () { r.trigger("vttjsloaded") }; i.onerror = function () { r.trigger("vttjserror") }; this.on("dispose", function () { i.onload = null; i.onerror = null }); n.WebVTT = !0; this.el().parentNode.appendChild(i) } else this.ready(this.addWebVttScript_) }, r.emulateTextTracks = function () { function u(t) { return n.addTrack(t.track) } function f(t) { return n.removeTrack(t.track) } function r() { return e.trigger("texttrackchange") } function t() { var t, i; for (r(), t = 0; t < n.length; t++)i = n[t], i.removeEventListener("cuechange", r), "showing" === i.mode && i.addEventListener("cuechange", r) } var e = this, n = this.textTracks(), i = this.remoteTextTracks(); i.on("addtrack", u); i.on("removetrack", f); this.addWebVttScript_(); t(); n.addEventListener("change", t); n.addEventListener("addtrack", t); n.addEventListener("removetrack", t); this.on("dispose", function () { i.off("addtrack", u); i.off("removetrack", f); n.removeEventListener("change", t); n.removeEventListener("addtrack", t); n.removeEventListener("removetrack", t); for (var e = 0; e < n.length; e++)n[e].removeEventListener("cuechange", r) }) }, r.addTextTrack = function (n, t, i) { if (!n) throw new Error("TextTrack kind is required but was not provided"); return function (n, t, i, r, u) { var e, f; return void 0 === u && (u = {}), e = n.textTracks(), u.kind = t, i && (u.label = i), r && (u.language = r), u.tech = n, f = new ut.text.TrackClass(u), e.addTrack(f), f }(this, n, t, i) }, r.createRemoteTextTrack = function (n) { var t = a(n, { tech: this }); return new lu.remoteTextEl.TrackClass(t) }, r.addRemoteTextTrack = function (n, t) { var r = this, i; return void 0 === n && (n = {}), i = this.createRemoteTextTrack(n), !0 !== t && !1 !== t && (c.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'), t = !0), this.remoteTextTrackEls().addTrackElement_(i), this.remoteTextTracks().addTrack(i.track), !0 !== t && this.ready(function () { return r.autoRemoteTextTracks_.addTrack(i.track) }), i }, r.removeRemoteTextTrack = function (n) { var t = this.remoteTextTrackEls().getTrackElementByTrack_(n); this.remoteTextTrackEls().removeTrackElement_(t); this.remoteTextTracks().removeTrack(n); this.autoRemoteTextTracks_.removeTrack(n) }, r.getVideoPlaybackQuality = function () { return {} }, r.requestPictureInPicture = function () { var t = this.options_.Promise || n.Promise; if (t) return t.reject() }, r.setPoster = function () { }, r.playsinline = function () { }, r.setPlaysinline = function () { }, r.overrideNativeAudioTracks = function () { }, r.overrideNativeVideoTracks = function () { }, r.canPlayType = function () { return "" }, u.canPlayType = function () { return "" }, u.canPlaySource = function (n) { return u.canPlayType(n.type) }, u.isTech = function (n) { return n.prototype instanceof u || n instanceof u || n === u }, u.registerTech = function (n, t) { if (u.techs_ || (u.techs_ = {}), !u.isTech(t)) throw new Error("Tech " + n + " must be a Tech"); if (!u.canPlayType) throw new Error("Techs must have a static canPlayType method on them"); if (!u.canPlaySource) throw new Error("Techs must have a static canPlaySource method on them"); return n = b(n), u.techs_[n] = t, u.techs_[uo(n)] = t, "Tech" !== n && u.defaultTechOrder_.push(n), t }, u.getTech = function (t) { if (t) return u.techs_ && u.techs_[t] ? u.techs_[t] : (t = b(t), n && n.videojs && n.videojs[t] ? (c.warn("The " + t + " tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"), n.videojs[t]) : void 0) }, u }(r); ut.names.forEach(function (n) { var t = ut[n]; v.prototype[t.getterName] = function () { return this[t.privateName] = this[t.privateName] || new t.ListClass, this[t.privateName] } }); v.prototype.featuresVolumeControl = !0; v.prototype.featuresMuteControl = !0; v.prototype.featuresFullscreenResize = !1; v.prototype.featuresPlaybackRate = !1; v.prototype.featuresProgressEvents = !1; v.prototype.featuresSourceset = !1; v.prototype.featuresTimeupdateEvents = !1; v.prototype.featuresNativeTextTracks = !1; v.withSourceHandlers = function (n) { n.registerSourceHandler = function (t, i) { var r = n.sourceHandlers; r = r || (n.sourceHandlers = []); void 0 === i && (i = r.length); r.splice(i, 0, t) }; n.canPlayType = function (t) { for (var r, u = n.sourceHandlers || [], i = 0; i < u.length; i++)if (r = u[i].canPlayType(t)) return r; return "" }; n.selectSourceHandler = function (t, i) { for (var u = n.sourceHandlers || [], r = 0; r < u.length; r++)if (u[r].canHandleSource(t, i)) return u[r]; return null }; n.canPlaySource = function (t, i) { var r = n.selectSourceHandler(t, i); return r ? r.canHandleSource(t, i) : "" };["seekable", "seeking", "duration"].forEach(function (n) { var t = this[n]; "function" == typeof t && (this[n] = function () { return this.sourceHandler_ && this.sourceHandler_[n] ? this.sourceHandler_[n].apply(this.sourceHandler_, arguments) : t.apply(this, arguments) }) }, n.prototype); n.prototype.setSource = function (t) { var i = n.selectSourceHandler(t, this.options_); i || (n.nativeSourceHandler ? i = n.nativeSourceHandler : c.error("No source handler found for the current source.")); this.disposeSourceHandler(); this.off("dispose", this.disposeSourceHandler); i !== n.nativeSourceHandler && (this.currentSource_ = t); this.sourceHandler_ = i.handleSource(t, this, this.options_); this.one("dispose", this.disposeSourceHandler) }; n.prototype.disposeSourceHandler = function () { this.currentSource_ && (this.clearTracks(["audio", "video"]), this.currentSource_ = null); this.cleanupAutoTextTracks(); this.sourceHandler_ && (this.sourceHandler_.dispose && this.sourceHandler_.dispose(), this.sourceHandler_ = null) } }; r.registerComponent("Tech", v); v.registerTech("Tech", v); v.defaultTechOrder_ = []; var hr = {}, na = {}, po = {}; var bet = { buffered: 1, currentTime: 1, duration: 1, seekable: 1, played: 1, paused: 1, volume: 1 }, ket = { setCurrentTime: 1, setVolume: 1 }, ld = { play: 1, pause: 1 }; ad = { opus: "video/ogg", ogv: "video/ogg", mp4: "video/mp4", mov: "video/mp4", m4v: "video/mp4", mkv: "video/x-matroska", m4a: "audio/mp4", mp3: "audio/mpeg", aac: "audio/aac", oga: "audio/ogg", m3u8: "application/x-mpegURL", jpg: "image/jpeg", jpeg: "image/jpeg", gif: "image/gif", png: "image/png", svg: "image/svg+xml", webp: "image/webp" }; yd = function (n) { function t(t, i, u) { var h, c = a({ createEl: !1 }, i), e, s, f, o; if (h = n.call(this, t, c, u) || this, i.playerOptions.sources && 0 !== i.playerOptions.sources.length) t.src(i.playerOptions.sources); else for (e = 0, s = i.playerOptions.techOrder; e < s.length; e++)if (f = b(s[e]), o = v.getTech(f), f || (o = r.getComponent(f)), o && o.isSupported()) { t.loadTech_(f); break } return h } return f(t, n), t }(r); r.registerComponent("MediaLoader", yd); fe = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).emitTapEvents(), r.enable(), r } f(i, n); var t = i.prototype; return t.createEl = function (t, i, r) { void 0 === t && (t = "div"); void 0 === i && (i = {}); void 0 === r && (r = {}); i = y({ innerHTML: '<span aria-hidden="true" class="vjs-icon-placeholder"><\/span>', className: this.buildCSSClass(), tabIndex: 0 }, i); "button" === t && c.error("Creating a ClickableComponent with an HTML element of " + t + " is not supported; use a Button instead."); r = y({ role: "button" }, r); this.tabIndex_ = i.tabIndex; var u = n.prototype.createEl.call(this, t, i, r); return this.createControlTextEl(u), u }, t.dispose = function () { this.controlTextEl_ = null; n.prototype.dispose.call(this) }, t.createControlTextEl = function (n) { return this.controlTextEl_ = k("span", { className: "vjs-control-text" }, { "aria-live": "polite" }), n && n.appendChild(this.controlTextEl_), this.controlText(this.controlText_, n), this.controlTextEl_ }, t.controlText = function (n, t) { if (void 0 === t && (t = this.el()), void 0 === n) return this.controlText_ || "Need Text"; var i = this.localize(n); this.controlText_ = n; uu(this.controlTextEl_, i); this.nonIconControl || t.setAttribute("title", i) }, t.buildCSSClass = function () { return "vjs-control vjs-button " + n.prototype.buildCSSClass.call(this) }, t.enable = function () { this.enabled_ || (this.enabled_ = !0, this.removeClass("vjs-disabled"), this.el_.setAttribute("aria-disabled", "false"), "undefined" != typeof this.tabIndex_ && this.el_.setAttribute("tabIndex", this.tabIndex_), this.on(["tap", "click"], this.handleClick), this.on("keydown", this.handleKeyDown)) }, t.disable = function () { this.enabled_ = !1; this.addClass("vjs-disabled"); this.el_.setAttribute("aria-disabled", "true"); "undefined" != typeof this.tabIndex_ && this.el_.removeAttribute("tabIndex"); this.off("mouseover", this.handleMouseOver); this.off("mouseout", this.handleMouseOut); this.off(["tap", "click"], this.handleClick); this.off("keydown", this.handleKeyDown) }, t.handleClick = function () { }, t.handleKeyDown = function (t) { o.isEventKey(t, "Space") || o.isEventKey(t, "Enter") ? (t.preventDefault(), t.stopPropagation(), this.trigger("click")) : n.prototype.handleKeyDown.call(this, t) }, i }(r); r.registerComponent("ClickableComponent", fe); pd = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).update(), t.on("posterchange", h(s(r), r.update)), r } f(i, n); var t = i.prototype; return t.dispose = function () { this.player().off("posterchange", this.update); n.prototype.dispose.call(this) }, t.createEl = function () { return k("div", { className: "vjs-poster", tabIndex: -1 }) }, t.update = function () { var n = this.player().poster(); this.setSrc(n); n ? this.show() : this.hide() }, t.setSrc = function (n) { var t = ""; n && (t = 'url("' + n + '")'); this.el_.style.backgroundImage = t }, t.handleClick = function () { this.player_.controls() && (this.player_.tech(!0) && this.player_.tech(!0).focus(), this.player_.paused() ? di(this.player_.play()) : this.player_.pause()) }, i }(fe); r.registerComponent("PosterImage", pd); ee = "#222"; wd = { monospace: "monospace", sansSerif: "sans-serif", serif: "serif", monospaceSansSerif: '"Andale Mono", "Lucida Console", monospace', monospaceSerif: '"Courier New", monospace', proportionalSansSerif: "sans-serif", proportionalSerif: "serif", casual: '"Comic Sans MS", Impact, fantasy', script: '"Monotype Corsiva", cursive', smallcaps: '"Andale Mono", "Lucida Console", monospace, sans-serif' }; bd = function (t) { function r(i, r, u) { var f, e; return f = t.call(this, i, r, u) || this, e = h(s(f), f.updateDisplay), i.on("loadstart", h(s(f), f.toggleDisplay)), i.on("texttrackchange", e), i.on("loadedmetadata", h(s(f), f.preselectTrack)), i.ready(h(s(f), function () { if (i.tech_ && i.tech_.featuresNativeTextTracks) this.hide(); else { i.on("fullscreenchange", e); i.on("playerresize", e); n.addEventListener("orientationchange", e); i.on("dispose", function () { return n.removeEventListener("orientationchange", e) }); for (var r = this.options_.playerOptions.tracks || [], t = 0; t < r.length; t++)this.player_.addRemoteTextTrack(r[t], !0); this.preselectTrack() } })), f } f(r, t); var i = r.prototype; return i.preselectTrack = function () { for (var n, i, r, u, e = { captions: 1, subtitles: 1 }, o = this.player_.textTracks(), t = this.player_.cache_.selectedLanguage, f = 0; f < o.length; f++)n = o[f], t && t.enabled && t.language && t.language === n.language && n.kind in e ? u = n.kind === t.kind ? n : u || n : t && !t.enabled ? r = i = u = null : n.default && ("descriptions" !== n.kind || i ? n.kind in e && !r && (r = n) : i = n); u ? u.mode = "showing" : r ? r.mode = "showing" : i && (i.mode = "showing") }, i.toggleDisplay = function () { this.player_.tech_ && this.player_.tech_.featuresNativeTextTracks ? this.hide() : this.show() }, i.createEl = function () { return t.prototype.createEl.call(this, "div", { className: "vjs-text-track-display" }, { "aria-live": "off", "aria-atomic": "true" }) }, i.clearDisplay = function () { "function" == typeof n.WebVTT && n.WebVTT.processCues(n, [], this.el_) }, i.updateDisplay = function () { var t = this.player_.textTracks(), s = this.options_.allowMultipleShowingTracks, r, i, u, n; if (this.clearDisplay(), s) { for (r = [], i = 0; i < t.length; ++i)u = t[i], "showing" === u.mode && r.push(u); this.updateForTrack(r) } else { for (var f = null, e = null, o = t.length; o--;)n = t[o], "showing" === n.mode && ("descriptions" === n.kind ? f = n : e = n); e ? ("off" !== this.getAttribute("aria-live") && this.setAttribute("aria-live", "off"), this.updateForTrack(e)) : f && ("assertive" !== this.getAttribute("aria-live") && this.setAttribute("aria-live", "assertive"), this.updateForTrack(f)) } }, i.updateDisplayState = function (t) { for (var u, r, o, i = this.player_.textTrackSettings.getValues(), f = t.activeCues, e = f.length; e--;)u = f[e], u && (r = u.displayState, (i.color && (r.firstChild.style.color = i.color), i.textOpacity && ra(r.firstChild, "color", ia(i.color || "#fff", i.textOpacity)), i.backgroundColor && (r.firstChild.style.backgroundColor = i.backgroundColor), i.backgroundOpacity && ra(r.firstChild, "backgroundColor", ia(i.backgroundColor || "#000", i.backgroundOpacity)), i.windowColor && (i.windowOpacity ? ra(r, "backgroundColor", ia(i.windowColor, i.windowOpacity)) : r.style.backgroundColor = i.windowColor), i.edgeStyle && ("dropshadow" === i.edgeStyle ? r.firstChild.style.textShadow = "2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px " + ee : "raised" === i.edgeStyle ? r.firstChild.style.textShadow = "1px 1px #222, 2px 2px #222, 3px 3px " + ee : "depressed" === i.edgeStyle ? r.firstChild.style.textShadow = "1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px " + ee : "uniform" === i.edgeStyle && (r.firstChild.style.textShadow = "0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px " + ee)), i.fontPercent && 1 !== i.fontPercent) && (o = n.parseFloat(r.style.fontSize), r.style.fontSize = o * i.fontPercent + "px", r.style.height = "auto", r.style.top = "auto", r.style.bottom = "2px"), i.fontFamily && "default" !== i.fontFamily && ("small-caps" === i.fontFamily ? r.firstChild.style.fontVariant = "small-caps" : r.firstChild.style.fontFamily = wd[i.fontFamily])) }, i.updateForTrack = function (t) { var o, u, s, f, r, i, e, h; if (Array.isArray(t) || (t = [t]), "function" == typeof n.WebVTT && !t.every(function (n) { return !n.activeCues })) { for (o = [], u = 0; u < t.length; ++u)for (s = t[u], f = 0; f < s.activeCues.length; ++f)o.push(s.activeCues[f]); for (n.WebVTT.processCues(n, o, this.el_), r = 0; r < t.length; ++r) { for (i = t[r], e = 0; e < i.activeCues.length; ++e)h = i.activeCues[e].displayState, hi(h, "vjs-text-track-cue"), hi(h, "vjs-text-track-cue-" + (i.language ? i.language : r)); this.player_.textTrackSettings && this.updateDisplayState(i) } } }, r }(r); r.registerComponent("TextTrackDisplay", bd); kd = function (n) { function t() { return n.apply(this, arguments) || this } return f(t, n), t.prototype.createEl = function () { var i = this.player_.isAudio(), r = this.localize(i ? "Audio Player" : "Video Player"), u = k("span", { className: "vjs-control-text", innerHTML: this.localize("{1} is loading.", [r]) }), t = n.prototype.createEl.call(this, "div", { className: "vjs-loading-spinner", dir: "ltr" }); return t.appendChild(u), t }, t }(r); r.registerComponent("LoadingSpinner", kd); dt = function (n) { function i() { return n.apply(this, arguments) || this } f(i, n); var t = i.prototype; return t.createEl = function (n, t, i) { void 0 === t && (t = {}); void 0 === i && (i = {}); t = y({ innerHTML: '<span aria-hidden="true" class="vjs-icon-placeholder"><\/span>', className: this.buildCSSClass() }, t); i = y({ type: "button" }, i); var u = r.prototype.createEl.call(this, "button", t, i); return this.createControlTextEl(u), u }, t.addChild = function (n, t) { void 0 === t && (t = {}); var i = this.constructor.name; return c.warn("Adding an actionable (user controllable) child to a Button (" + i + ") is not supported; use a ClickableComponent instead."), r.prototype.addChild.call(this, n, t) }, t.enable = function () { n.prototype.enable.call(this); this.el_.removeAttribute("disabled") }, t.disable = function () { n.prototype.disable.call(this); this.el_.setAttribute("disabled", "disabled") }, t.handleKeyDown = function (t) { o.isEventKey(t, "Space") || o.isEventKey(t, "Enter") ? t.stopPropagation() : n.prototype.handleKeyDown.call(this, t) }, i }(fe); r.registerComponent("Button", dt); ua = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).mouseused_ = !1, r.on("mousedown", r.handleMouseDown), r } f(i, n); var t = i.prototype; return t.buildCSSClass = function () { return "vjs-big-play-button" }, t.handleClick = function (n) { var t = this.player_.play(), i, r; if (this.mouseused_ && n.clientX && n.clientY) return di(t), void (this.player_.tech(!0) && this.player_.tech(!0).focus()); if (i = this.player_.getChild("controlBar"), r = i && i.getChild("playToggle"), r) { function n() { return r.focus() } gf(t) ? t.then(n, function () { }) : this.setTimeout(n, 1) } else this.player_.tech(!0).focus() }, t.handleKeyDown = function (t) { this.mouseused_ = !1; n.prototype.handleKeyDown.call(this, t) }, t.handleMouseDown = function () { this.mouseused_ = !0 }, i }(dt); ua.prototype.controlText_ = "Play Video"; r.registerComponent("BigPlayButton", ua); dd = function (n) { function t(t, i) { var r; return (r = n.call(this, t, i) || this).controlText(i && i.controlText || r.localize("Close")), r } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-close-button " + n.prototype.buildCSSClass.call(this) }, i.handleClick = function () { this.trigger({ type: "close", bubbles: !1 }) }, i.handleKeyDown = function (t) { o.isEventKey(t, "Esc") ? (t.preventDefault(), t.stopPropagation(), this.trigger("click")) : n.prototype.handleKeyDown.call(this, t) }, t }(dt); r.registerComponent("CloseButton", dd); fa = function (n) { function i(t, i) { var r; return void 0 === i && (i = {}), r = n.call(this, t, i) || this, i.replay = void 0 === i.replay || i.replay, r.on(t, "play", r.handlePlay), r.on(t, "pause", r.handlePause), i.replay && r.on(t, "ended", r.handleEnded), r } f(i, n); var t = i.prototype; return t.buildCSSClass = function () { return "vjs-play-control " + n.prototype.buildCSSClass.call(this) }, t.handleClick = function () { this.player_.paused() ? this.player_.play() : this.player_.pause() }, t.handleSeeked = function (n) { this.removeClass("vjs-ended"); this.player_.paused() ? this.handlePause(n) : this.handlePlay(n) }, t.handlePlay = function () { this.removeClass("vjs-ended"); this.removeClass("vjs-paused"); this.addClass("vjs-playing"); this.controlText("Pause") }, t.handlePause = function () { this.removeClass("vjs-playing"); this.addClass("vjs-paused"); this.controlText("Play") }, t.handleEnded = function () { this.removeClass("vjs-playing"); this.addClass("vjs-ended"); this.controlText("Replay"); this.one(this.player_, "seeked", this.handleSeeked) }, i }(dt); fa.prototype.controlText_ = "Play"; r.registerComponent("PlayToggle", fa); bo = gd; cr = function (n) { function r(t, i) { var r; return (r = n.call(this, t, i) || this).throttledUpdateContent = wi(h(s(r), r.updateContent), 30), r.on(t, "timeupdate", r.throttledUpdateContent), r } f(r, n); var i = r.prototype; return i.createEl = function () { var t = this.buildCSSClass(), i = n.prototype.createEl.call(this, "div", { className: t + " vjs-time-control vjs-control", innerHTML: '<span class="vjs-control-text" role="presentation">' + this.localize(this.labelText_) + " <\/span>" }); return this.contentEl_ = k("span", { className: t + "-display" }, { "aria-live": "off", role: "presentation" }), this.updateTextNode_(), i.appendChild(this.contentEl_), i }, i.dispose = function () { this.contentEl_ = null; this.textNode_ = null; n.prototype.dispose.call(this) }, i.updateTextNode_ = function () { if (this.contentEl_) { for (; this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild); this.textNode_ = t.createTextNode(this.formattedTime_ || this.formatTime_(0)); this.contentEl_.appendChild(this.textNode_) } }, i.formatTime_ = function (n) { return vu(n) }, i.updateFormattedTime_ = function (n) { var t = this.formatTime_(n); t !== this.formattedTime_ && (this.formattedTime_ = t, this.requestAnimationFrame(this.updateTextNode_)) }, i.updateContent = function () { }, r }(r); cr.prototype.labelText_ = "Time"; cr.prototype.controlText_ = "Time"; r.registerComponent("TimeDisplay", cr); ko = function (n) { function t(t, i) { var r; return (r = n.call(this, t, i) || this).on(t, "ended", r.handleEnded), r } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-current-time" }, i.updateContent = function () { var n = this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime(); this.updateFormattedTime_(n) }, i.handleEnded = function () { this.player_.duration() && this.updateFormattedTime_(this.player_.duration()) }, t }(cr); ko.prototype.labelText_ = "Current Time"; ko.prototype.controlText_ = "Current Time"; r.registerComponent("CurrentTimeDisplay", ko); go = function (n) { function t(t, i) { var r; return (r = n.call(this, t, i) || this).on(t, "durationchange", r.updateContent), r.on(t, "loadstart", r.updateContent), r.on(t, "loadedmetadata", r.throttledUpdateContent), r } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-duration" }, i.updateContent = function () { var n = this.player_.duration(); this.duration_ !== n && (this.duration_ = n, this.updateFormattedTime_(n)) }, t }(cr); go.prototype.labelText_ = "Duration"; go.prototype.controlText_ = "Duration"; r.registerComponent("DurationDisplay", go); ng = function (n) { function t() { return n.apply(this, arguments) || this } return f(t, n), t.prototype.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-time-control vjs-time-divider", innerHTML: "<div><span>/<\/span><\/div>" }, { "aria-hidden": !0 }) }, t }(r); r.registerComponent("TimeDivider", ng); ns = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).on(t, "durationchange", r.throttledUpdateContent), r.on(t, "ended", r.handleEnded), r } f(i, n); var t = i.prototype; return t.buildCSSClass = function () { return "vjs-remaining-time" }, t.createEl = function () { var t = n.prototype.createEl.call(this); return t.insertBefore(k("span", {}, { "aria-hidden": !0 }, "-"), this.contentEl_), t }, t.updateContent = function () { "number" == typeof this.player_.duration() && (this.player_.remainingTimeDisplay ? this.updateFormattedTime_(this.player_.remainingTimeDisplay()) : this.updateFormattedTime_(this.player_.remainingTime())) }, t.handleEnded = function () { this.player_.duration() && this.updateFormattedTime_(0) }, i }(cr); ns.prototype.labelText_ = "Remaining Time"; ns.prototype.controlText_ = "Remaining Time"; r.registerComponent("RemainingTimeDisplay", ns); tg = function (n) { function t(t, i) { var r; return (r = n.call(this, t, i) || this).updateShowing(), r.on(r.player(), "durationchange", r.updateShowing), r } f(t, n); var i = t.prototype; return i.createEl = function () { var t = n.prototype.createEl.call(this, "div", { className: "vjs-live-control vjs-control" }); return this.contentEl_ = k("div", { className: "vjs-live-display", innerHTML: '<span class="vjs-control-text">' + this.localize("Stream Type") + " <\/span>" + this.localize("LIVE") }, { "aria-live": "off" }), t.appendChild(this.contentEl_), t }, i.dispose = function () { this.contentEl_ = null; n.prototype.dispose.call(this) }, i.updateShowing = function () { this.player().duration() === 1 / 0 ? this.show() : this.hide() }, t }(r); r.registerComponent("LiveDisplay", tg); ea = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).updateLiveEdgeStatus(), r.player_.liveTracker && r.on(r.player_.liveTracker, "liveedgechange", r.updateLiveEdgeStatus), r } f(i, n); var t = i.prototype; return t.createEl = function () { var t = n.prototype.createEl.call(this, "button", { className: "vjs-seek-to-live-control vjs-control" }); return this.textEl_ = k("span", { className: "vjs-seek-to-live-text", innerHTML: this.localize("LIVE") }, { "aria-hidden": "true" }), t.appendChild(this.textEl_), t }, t.updateLiveEdgeStatus = function () { !this.player_.liveTracker || this.player_.liveTracker.atLiveEdge() ? (this.setAttribute("aria-disabled", !0), this.addClass("vjs-at-live-edge"), this.controlText("Seek to live, currently playing live")) : (this.setAttribute("aria-disabled", !1), this.removeClass("vjs-at-live-edge"), this.controlText("Seek to live, currently behind live")) }, t.handleClick = function () { this.player_.liveTracker.seekToLiveEdge() }, t.dispose = function () { this.player_.liveTracker && this.off(this.player_.liveTracker, "liveedgechange", this.updateLiveEdgeStatus); this.textEl_ = null; n.prototype.dispose.call(this) }, i }(dt); ea.prototype.controlText_ = "Seek to live, currently playing live"; r.registerComponent("SeekToLive", ea); ts = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).bar = r.getChild(r.options_.barName), r.vertical(!!r.options_.vertical), r.enable(), r } f(i, n); var t = i.prototype; return t.enabled = function () { return this.enabled_ }, t.enable = function () { this.enabled() || (this.on("mousedown", this.handleMouseDown), this.on("touchstart", this.handleMouseDown), this.on("keydown", this.handleKeyDown), this.on("click", this.handleClick), this.on(this.player_, "controlsvisible", this.update), this.playerEvent && this.on(this.player_, this.playerEvent, this.update), this.removeClass("disabled"), this.setAttribute("tabindex", 0), this.enabled_ = !0) }, t.disable = function () { if (this.enabled()) { var n = this.bar.el_.ownerDocument; this.off("mousedown", this.handleMouseDown); this.off("touchstart", this.handleMouseDown); this.off("keydown", this.handleKeyDown); this.off("click", this.handleClick); this.off(this.player_, "controlsvisible", this.update); this.off(n, "mousemove", this.handleMouseMove); this.off(n, "mouseup", this.handleMouseUp); this.off(n, "touchmove", this.handleMouseMove); this.off(n, "touchend", this.handleMouseUp); this.removeAttribute("tabindex"); this.addClass("disabled"); this.playerEvent && this.off(this.player_, this.playerEvent, this.update); this.enabled_ = !1 } }, t.createEl = function (t, i, r) { return void 0 === i && (i = {}), void 0 === r && (r = {}), i.className = i.className + " vjs-slider", i = y({ tabIndex: 0 }, i), r = y({ role: "slider", "aria-valuenow": 0, "aria-valuemin": 0, "aria-valuemax": 100, tabIndex: 0 }, r), n.prototype.createEl.call(this, t, i, r) }, t.handleMouseDown = function (n) { var t = this.bar.el_.ownerDocument; "mousedown" === n.type && n.preventDefault(); "touchstart" !== n.type || li || n.preventDefault(); wp(); this.addClass("vjs-sliding"); this.trigger("slideractive"); this.on(t, "mousemove", this.handleMouseMove); this.on(t, "mouseup", this.handleMouseUp); this.on(t, "touchmove", this.handleMouseMove); this.on(t, "touchend", this.handleMouseUp); this.handleMouseMove(n) }, t.handleMouseMove = function () { }, t.handleMouseUp = function () { var n = this.bar.el_.ownerDocument; bp(); this.removeClass("vjs-sliding"); this.trigger("sliderinactive"); this.off(n, "mousemove", this.handleMouseMove); this.off(n, "mouseup", this.handleMouseUp); this.off(n, "touchmove", this.handleMouseMove); this.off(n, "touchend", this.handleMouseUp); this.update() }, t.update = function () { var n, t; if (this.el_ && (n = this.getPercent(), t = this.bar, t)) { ("number" != typeof n || n != n || n < 0 || n === 1 / 0) && (n = 0); var i = (100 * n).toFixed(2) + "%", r = t.el().style, u = this.vertical() ? "height" : "width"; return r[u] !== i && (r[u] = i), n } }, t.calculateDistance = function (n) { var t = nc(this.el_, n); return this.vertical() ? t.y : t.x }, t.handleKeyDown = function (t) { o.isEventKey(t, "Left") || o.isEventKey(t, "Down") ? (t.preventDefault(), t.stopPropagation(), this.stepBack()) : o.isEventKey(t, "Right") || o.isEventKey(t, "Up") ? (t.preventDefault(), t.stopPropagation(), this.stepForward()) : n.prototype.handleKeyDown.call(this, t) }, t.handleClick = function (n) { n.stopPropagation(); n.preventDefault() }, t.vertical = function (n) { if (void 0 === n) return this.vertical_ || !1; this.vertical_ = !!n; this.vertical_ ? this.addClass("vjs-slider-vertical") : this.addClass("vjs-slider-horizontal") }, i }(r); r.registerComponent("Slider", ts); ig = function (n) { function t(t, i) { var r; return (r = n.call(this, t, i) || this).partEls_ = [], r.on(t, "progress", r.update), r } f(t, n); var i = t.prototype; return i.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-load-progress", innerHTML: '<span class="vjs-control-text"><span>' + this.localize("Loaded") + '<\/span>: <span class="vjs-control-text-loaded-percentage">0%<\/span><\/span>' }) }, i.dispose = function () { this.partEls_ = null; n.prototype.dispose.call(this) }, i.update = function () { function u(n, t, i) { var r = n / t || 0; return r = 100 * (1 <= r ? 1 : r), i && (r = r.toFixed(2)), r + "%" } var o = this.player_.liveTracker, t = this.player_.buffered(), s = o && o.isLive() ? o.seekableEnd() : this.player_.duration(), f = this.player_.bufferedEnd(), i = this.partEls_, c = this.$(".vjs-control-text-loaded-percentage"), n, e; for (this.el_.style.width = u(f, s), uu(c, u(f, s, !0)), n = 0; n < t.length; n++) { var h = t.start(n), l = t.end(n), r = i[n]; r || (r = this.el_.appendChild(k()), i[n] = r); r.style.left = u(h, f); r.style.width = u(l - h, f) } for (e = i.length; e > t.length; e--)this.el_.removeChild(i[e - 1]); i.length = t.length }, t }(r); r.registerComponent("LoadProgressBar", ig); rg = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).update = wi(h(s(r), r.update), 30), r } f(i, n); var t = i.prototype; return t.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-time-tooltip" }, { "aria-hidden": "true" }) }, t.update = function (n, t, i) { var u = pf(this.el_), f = pf(this.player_.el()), e = n.width * t; if (f && u) { var o = n.left - f.left + e, s = n.width - e + (f.right - n.right), r = u.width / 2; o < r ? r += r - o : s < r && (r = s); r < 0 ? r = 0 : r > u.width && (r = u.width); this.el_.style.right = "-" + r + "px"; this.write(i) } }, t.write = function (n) { uu(this.el_, n) }, t.updateTime = function (n, t, i, r) { var u = this; this.rafId_ && this.cancelAnimationFrame(this.rafId_); this.rafId_ = this.requestAnimationFrame(function () { var e, s = u.player_.duration(), f, o; u.player_.liveTracker && u.player_.liveTracker.isLive() ? (f = u.player_.liveTracker.liveWindow(), o = f - t * f, e = (o < 1 ? "" : "-") + vu(o, f)) : e = vu(i, s); u.update(n, t, e); r && r() }) }, i }(r); r.registerComponent("TimeTooltip", rg); is = function (n) { function t(t, i) { var r; return (r = n.call(this, t, i) || this).update = wi(h(s(r), r.update), 30), r } f(t, n); var i = t.prototype; return i.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-play-progress vjs-slider-bar" }, { "aria-hidden": "true" }) }, i.update = function (n, t) { var i = this.getChild("timeTooltip"), r; i && (r = this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime(), i.updateTime(n, t, r)) }, t }(r); is.prototype.options_ = { children: [] }; ui || ki || is.prototype.options_.children.push("timeTooltip"); r.registerComponent("PlayProgressBar", is); oa = function (n) { function t(t, i) { var r; return (r = n.call(this, t, i) || this).update = wi(h(s(r), r.update), 30), r } f(t, n); var i = t.prototype; return i.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-mouse-display" }) }, i.update = function (n, t) { var i = this, r = t * this.player_.duration(); this.getChild("timeTooltip").updateTime(n, t, r, function () { i.el_.style.left = n.width * t + "px" }) }, t }(r); oa.prototype.options_ = { children: ["timeTooltip"] }; r.registerComponent("MouseTimeDisplay", oa); rs = function (n) { function r(t, i) { var r; return (r = n.call(this, t, i) || this).setEventHandlers_(), r } f(r, n); var i = r.prototype; return i.setEventHandlers_ = function () { this.update = wi(h(this, this.update), 30); this.on(this.player_, "timeupdate", this.update); this.on(this.player_, "ended", this.handleEnded); this.on(this.player_, "durationchange", this.update); this.player_.liveTracker && this.on(this.player_.liveTracker, "liveedgechange", this.update); this.updateInterval = null; this.on(this.player_, ["playing"], this.enableInterval_); this.on(this.player_, ["ended", "pause", "waiting"], this.disableInterval_); "hidden" in t && "visibilityState" in t && this.on(t, "visibilitychange", this.toggleVisibility_) }, i.toggleVisibility_ = function (n) { t.hidden ? this.disableInterval_(n) : (this.enableInterval_(), this.requestAnimationFrame(this.update)) }, i.enableInterval_ = function () { var n = this; this.clearInterval(this.updateInterval); this.updateInterval = this.setInterval(function () { n.requestAnimationFrame(n.update) }, 30) }, i.disableInterval_ = function (n) { this.player_.liveTracker && this.player_.liveTracker.isLive() && "ended" !== n.type || this.clearInterval(this.updateInterval) }, i.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-progress-holder" }, { "aria-label": this.localize("Progress Bar") }) }, i.update_ = function (n, t) { var r = this.player_.liveTracker, i = this.player_.duration(); r && r.isLive() && (i = this.player_.liveTracker.liveCurrentTime()); this.el_.setAttribute("aria-valuenow", (100 * t).toFixed(2)); this.el_.setAttribute("aria-valuetext", this.localize("progress bar timing: currentTime={1} duration={2}", [vu(n, i), vu(i, i)], "{1} of {2}")); this.bar && this.bar.update(pf(this.el_), t) }, i.update = function () { if (null !== this.el().offsetParent) { var t = n.prototype.update.call(this); return this.update_(this.getCurrentTime_(), t), t } }, i.getCurrentTime_ = function () { return this.player_.scrubbing() ? this.player_.getCache().currentTime : this.player_.currentTime() }, i.handleEnded = function () { this.update_(this.player_.duration(), 1) }, i.getPercent = function () { var n, i = this.getCurrentTime_(), t = this.player_.liveTracker; return t && t.isLive() ? (n = (i - t.seekableStart()) / t.liveWindow(), t.atLiveEdge() && (n = 1)) : n = i / this.player_.duration(), 1 <= n ? 1 : n || 0 }, i.handleMouseDown = function (t) { fu(t) && (t.stopPropagation(), this.player_.scrubbing(!0), this.videoWasPlaying = !this.player_.paused(), this.player_.pause(), n.prototype.handleMouseDown.call(this, t)) }, i.handleMouseMove = function (n) { var t, u, i, r, f; if (fu(n)) { if (u = this.calculateDistance(n), i = this.player_.liveTracker, i && i.isLive()) { if (r = i.seekableStart(), f = i.liveCurrentTime(), f <= (t = r + u * i.liveWindow()) && (t = f), t <= r && (t = r + .1), t === 1 / 0) return } else (t = u * this.player_.duration()) === this.player_.duration() && (t -= .1); this.player_.currentTime(t) } }, i.enable = function () { n.prototype.enable.call(this); var t = this.getChild("mouseTimeDisplay"); t && t.show() }, i.disable = function () { n.prototype.disable.call(this); var t = this.getChild("mouseTimeDisplay"); t && t.hide() }, i.handleMouseUp = function (t) { n.prototype.handleMouseUp.call(this, t); t && t.stopPropagation(); this.player_.scrubbing(!1); this.player_.trigger({ type: "timeupdate", target: this, manuallyTriggered: !0 }); this.videoWasPlaying && di(this.player_.play()) }, i.stepForward = function () { this.player_.currentTime(this.player_.currentTime() + 5) }, i.stepBack = function () { this.player_.currentTime(this.player_.currentTime() - 5) }, i.handleAction = function () { this.player_.paused() ? this.player_.play() : this.player_.pause() }, i.handleKeyDown = function (t) { if (o.isEventKey(t, "Space") || o.isEventKey(t, "Enter")) t.preventDefault(), t.stopPropagation(), this.handleAction(t); else if (o.isEventKey(t, "Home")) t.preventDefault(), t.stopPropagation(), this.player_.currentTime(0); else if (o.isEventKey(t, "End")) t.preventDefault(), t.stopPropagation(), this.player_.currentTime(this.player_.duration()); else if (/^[0-9]$/.test(o(t))) { t.preventDefault(); t.stopPropagation(); var i = (o.codes[o(t)] - o.codes[0]) / 10; this.player_.currentTime(this.player_.duration() * i) } else o.isEventKey(t, "PgDn") ? (t.preventDefault(), t.stopPropagation(), this.player_.currentTime(this.player_.currentTime() - 60)) : o.isEventKey(t, "PgUp") ? (t.preventDefault(), t.stopPropagation(), this.player_.currentTime(this.player_.currentTime() + 60)) : n.prototype.handleKeyDown.call(this, t) }, r }(ts); rs.prototype.options_ = { children: ["loadProgressBar", "playProgressBar"], barName: "playProgressBar" }; ui || ki || rs.prototype.options_.children.splice(1, 0, "mouseTimeDisplay"); r.registerComponent("SeekBar", rs); sa = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).handleMouseMove = wi(h(s(r), r.handleMouseMove), 30), r.throttledHandleMouseSeek = wi(h(s(r), r.handleMouseSeek), 30), r.enable(), r } f(i, n); var t = i.prototype; return t.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-progress-control vjs-control" }) }, t.handleMouseMove = function (n) { var i = this.getChild("seekBar"); if (i) { var r = i.getChild("mouseTimeDisplay"), u = i.el(), f = pf(u), t = nc(u, n).x; 1 < t ? t = 1 : t < 0 && (t = 0); r && r.update(f, t) } }, t.handleMouseSeek = function (n) { var t = this.getChild("seekBar"); t && t.handleMouseMove(n) }, t.enabled = function () { return this.enabled_ }, t.disable = function () { this.children().forEach(function (n) { return n.disable && n.disable() }); this.enabled() && (this.off(["mousedown", "touchstart"], this.handleMouseDown), this.off(this.el_, "mousemove", this.handleMouseMove), this.handleMouseUp(), this.addClass("disabled"), this.enabled_ = !1) }, t.enable = function () { this.children().forEach(function (n) { return n.enable && n.enable() }); this.enabled() || (this.on(["mousedown", "touchstart"], this.handleMouseDown), this.on(this.el_, "mousemove", this.handleMouseMove), this.removeClass("disabled"), this.enabled_ = !0) }, t.handleMouseDown = function (n) { var t = this.el_.ownerDocument, i = this.getChild("seekBar"); i && i.handleMouseDown(n); this.on(t, "mousemove", this.throttledHandleMouseSeek); this.on(t, "touchmove", this.throttledHandleMouseSeek); this.on(t, "mouseup", this.handleMouseUp); this.on(t, "touchend", this.handleMouseUp) }, t.handleMouseUp = function (n) { var t = this.el_.ownerDocument, i = this.getChild("seekBar"); i && i.handleMouseUp(n); this.off(t, "mousemove", this.throttledHandleMouseSeek); this.off(t, "touchmove", this.throttledHandleMouseSeek); this.off(t, "mouseup", this.handleMouseUp); this.off(t, "touchend", this.handleMouseUp) }, i }(r); sa.prototype.options_ = { children: ["seekBar"] }; r.registerComponent("ProgressControl", sa); ha = function (n) { function i(i, r) { var u; return (u = n.call(this, i, r) || this).on(i, ["enterpictureinpicture", "leavepictureinpicture"], u.handlePictureInPictureChange), t.pictureInPictureEnabled || u.disable(), u } f(i, n); var r = i.prototype; return r.buildCSSClass = function () { return "vjs-picture-in-picture-control " + n.prototype.buildCSSClass.call(this) }, r.handlePictureInPictureChange = function () { this.player_.isInPictureInPicture() ? this.controlText("Exit Picture-in-Picture") : this.controlText("Picture-in-Picture") }, r.handleClick = function () { this.player_.isInPictureInPicture() ? this.player_.exitPictureInPicture() : this.player_.requestPictureInPicture() }, i }(dt); ha.prototype.controlText_ = "Picture-in-Picture"; r.registerComponent("PictureInPictureToggle", ha); ca = function (n) { function i(i, r) { var u; return (u = n.call(this, i, r) || this).on(i, "fullscreenchange", u.handleFullscreenChange), !1 === t[i.fsApi_.fullscreenEnabled] && u.disable(), u } f(i, n); var r = i.prototype; return r.buildCSSClass = function () { return "vjs-fullscreen-control " + n.prototype.buildCSSClass.call(this) }, r.handleFullscreenChange = function () { this.player_.isFullscreen() ? this.controlText("Non-Fullscreen") : this.controlText("Fullscreen") }, r.handleClick = function () { this.player_.isFullscreen() ? this.player_.exitFullscreen() : this.player_.requestFullscreen() }, i }(dt); ca.prototype.controlText_ = "Fullscreen"; r.registerComponent("FullscreenToggle", ca); ug = function (n) { function t() { return n.apply(this, arguments) || this } return f(t, n), t.prototype.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-volume-level", innerHTML: '<span class="vjs-control-text"><\/span>' }) }, t }(r); r.registerComponent("VolumeLevel", ug); us = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).on("slideractive", r.updateLastVolume_), r.on(t, "volumechange", r.updateARIAAttributes), t.ready(function () { return r.updateARIAAttributes() }), r } f(i, n); var t = i.prototype; return t.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-volume-bar vjs-slider-bar" }, { "aria-label": this.localize("Volume Level"), "aria-live": "polite" }) }, t.handleMouseDown = function (t) { fu(t) && n.prototype.handleMouseDown.call(this, t) }, t.handleMouseMove = function (n) { fu(n) && (this.checkMuted(), this.player_.volume(this.calculateDistance(n))) }, t.checkMuted = function () { this.player_.muted() && this.player_.muted(!1) }, t.getPercent = function () { return this.player_.muted() ? 0 : this.player_.volume() }, t.stepForward = function () { this.checkMuted(); this.player_.volume(this.player_.volume() + .1) }, t.stepBack = function () { this.checkMuted(); this.player_.volume(this.player_.volume() - .1) }, t.updateARIAAttributes = function () { var n = this.player_.muted() ? 0 : this.volumeAsPercentage_(); this.el_.setAttribute("aria-valuenow", n); this.el_.setAttribute("aria-valuetext", n + "%") }, t.volumeAsPercentage_ = function () { return Math.round(100 * this.player_.volume()) }, t.updateLastVolume_ = function () { var n = this, t = this.player_.volume(); this.one("sliderinactive", function () { 0 === n.player_.volume() && n.player_.lastVolume_(t) }) }, i }(ts); us.prototype.options_ = { children: ["volumeLevel"], barName: "volumeLevel" }; us.prototype.playerEvent = "volumechange"; r.registerComponent("VolumeBar", us); la = function (n) { function i(t, i) { var r; return void 0 === i && (i = {}), i.vertical = i.vertical || !1, "undefined" != typeof i.volumeBar && !lf(i.volumeBar) || (i.volumeBar = i.volumeBar || {}, i.volumeBar.vertical = i.vertical), function (n, t) { t.tech_ && !t.tech_.featuresVolumeControl && n.addClass("vjs-hidden"); n.on(t, "loadstart", function () { t.tech_.featuresVolumeControl ? n.removeClass("vjs-hidden") : n.addClass("vjs-hidden") }) }(s(r = n.call(this, t, i) || this), t), r.throttledHandleMouseMove = wi(h(s(r), r.handleMouseMove), 30), r.on("mousedown", r.handleMouseDown), r.on("touchstart", r.handleMouseDown), r.on(r.volumeBar, ["focus", "slideractive"], function () { r.volumeBar.addClass("vjs-slider-active"); r.addClass("vjs-slider-active"); r.trigger("slideractive") }), r.on(r.volumeBar, ["blur", "sliderinactive"], function () { r.volumeBar.removeClass("vjs-slider-active"); r.removeClass("vjs-slider-active"); r.trigger("sliderinactive") }), r } f(i, n); var t = i.prototype; return t.createEl = function () { var t = "vjs-volume-horizontal"; return this.options_.vertical && (t = "vjs-volume-vertical"), n.prototype.createEl.call(this, "div", { className: "vjs-volume-control vjs-control " + t }) }, t.handleMouseDown = function () { var n = this.el_.ownerDocument; this.on(n, "mousemove", this.throttledHandleMouseMove); this.on(n, "touchmove", this.throttledHandleMouseMove); this.on(n, "mouseup", this.handleMouseUp); this.on(n, "touchend", this.handleMouseUp) }, t.handleMouseUp = function () { var n = this.el_.ownerDocument; this.off(n, "mousemove", this.throttledHandleMouseMove); this.off(n, "touchmove", this.throttledHandleMouseMove); this.off(n, "mouseup", this.handleMouseUp); this.off(n, "touchend", this.handleMouseUp) }, t.handleMouseMove = function (n) { this.volumeBar.handleMouseMove(n) }, i }(r); la.prototype.options_ = { children: ["volumeBar"] }; r.registerComponent("VolumeControl", la); aa = function (n) { function i(t, i) { var r; return function (n, t) { t.tech_ && !t.tech_.featuresMuteControl && n.addClass("vjs-hidden"); n.on(t, "loadstart", function () { t.tech_.featuresMuteControl ? n.removeClass("vjs-hidden") : n.addClass("vjs-hidden") }) }(s(r = n.call(this, t, i) || this), t), r.on(t, ["loadstart", "volumechange"], r.update), r } f(i, n); var t = i.prototype; return t.buildCSSClass = function () { return "vjs-mute-control " + n.prototype.buildCSSClass.call(this) }, t.handleClick = function () { var i = this.player_.volume(), n = this.player_.lastVolume_(), t; 0 === i ? (t = n < .1 ? .1 : n, this.player_.volume(t), this.player_.muted(!1)) : this.player_.muted(!this.player_.muted()) }, t.update = function () { this.updateIcon_(); this.updateControlText_() }, t.updateIcon_ = function () { var i = this.player_.volume(), n = 3, t; for (ui && this.player_.tech_ && this.player_.tech_.el_ && this.player_.muted(this.player_.tech_.el_.muted), 0 === i || this.player_.muted() ? n = 0 : i < .33 ? n = 1 : i < .67 && (n = 2), t = 0; t < 4; t++)vf(this.el_, "vjs-vol-" + t); hi(this.el_, "vjs-vol-" + n) }, t.updateControlText_ = function () { var n = this.player_.muted() || 0 === this.player_.volume() ? "Unmute" : "Mute"; this.controlText() !== n && this.controlText(n) }, i }(dt); aa.prototype.controlText_ = "Mute"; r.registerComponent("MuteToggle", aa); va = function (n) { function r(t, i) { var r; return void 0 === i && (i = {}), i.inline = "undefined" != typeof i.inline ? i.inline : !0, "undefined" != typeof i.volumeControl && !lf(i.volumeControl) || (i.volumeControl = i.volumeControl || {}, i.volumeControl.vertical = !i.inline), (r = n.call(this, t, i) || this).on(t, ["loadstart"], r.volumePanelState_), r.on(r.muteToggle, "keyup", r.handleKeyPress), r.on(r.volumeControl, "keyup", r.handleVolumeControlKeyUp), r.on("keydown", r.handleKeyPress), r.on("mouseover", r.handleMouseOver), r.on("mouseout", r.handleMouseOut), r.on(r.volumeControl, ["slideractive"], r.sliderActive_), r.on(r.volumeControl, ["sliderinactive"], r.sliderInactive_), r } f(r, n); var i = r.prototype; return i.sliderActive_ = function () { this.addClass("vjs-slider-active") }, i.sliderInactive_ = function () { this.removeClass("vjs-slider-active") }, i.volumePanelState_ = function () { this.volumeControl.hasClass("vjs-hidden") && this.muteToggle.hasClass("vjs-hidden") && this.addClass("vjs-hidden"); this.volumeControl.hasClass("vjs-hidden") && !this.muteToggle.hasClass("vjs-hidden") && this.addClass("vjs-mute-toggle-only") }, i.createEl = function () { var t = "vjs-volume-panel-horizontal"; return this.options_.inline || (t = "vjs-volume-panel-vertical"), n.prototype.createEl.call(this, "div", { className: "vjs-volume-panel vjs-control " + t }) }, i.dispose = function () { this.handleMouseOut(); n.prototype.dispose.call(this) }, i.handleVolumeControlKeyUp = function (n) { o.isEventKey(n, "Esc") && this.muteToggle.focus() }, i.handleMouseOver = function () { this.addClass("vjs-hover"); yt(t, "keyup", h(this, this.handleKeyPress)) }, i.handleMouseOut = function () { this.removeClass("vjs-hover"); nt(t, "keyup", h(this, this.handleKeyPress)) }, i.handleKeyPress = function (n) { o.isEventKey(n, "Esc") && this.handleMouseOut() }, r }(r); va.prototype.options_ = { children: ["muteToggle", "volumeControl"] }; r.registerComponent("VolumePanel", va); fs = function (n) { function u(t, i) { var r; return r = n.call(this, t, i) || this, i && (r.menuButton_ = i.menuButton), r.focusedChild_ = -1, r.on("keydown", r.handleKeyDown), r.boundHandleBlur_ = h(s(r), r.handleBlur), r.boundHandleTapClick_ = h(s(r), r.handleTapClick), r } f(u, n); var i = u.prototype; return i.addEventListenerForItem = function (n) { n instanceof r && (this.on(n, "blur", this.boundHandleBlur_), this.on(n, ["tap", "click"], this.boundHandleTapClick_)) }, i.removeEventListenerForItem = function (n) { n instanceof r && (this.off(n, "blur", this.boundHandleBlur_), this.off(n, ["tap", "click"], this.boundHandleTapClick_)) }, i.removeChild = function (t) { "string" == typeof t && (t = this.getChild(t)); this.removeEventListenerForItem(t); n.prototype.removeChild.call(this, t) }, i.addItem = function (n) { var t = this.addChild(n); t && this.addEventListenerForItem(t) }, i.createEl = function () { var i = this.options_.contentElType || "ul", t; return this.contentEl_ = k(i, { className: "vjs-menu-content" }), this.contentEl_.setAttribute("role", "menu"), t = n.prototype.createEl.call(this, "div", { append: this.contentEl_, className: "vjs-menu" }), t.appendChild(this.contentEl_), yt(t, "click", function (n) { n.preventDefault(); n.stopImmediatePropagation() }), t }, i.dispose = function () { this.contentEl_ = null; this.boundHandleBlur_ = null; this.boundHandleTapClick_ = null; n.prototype.dispose.call(this) }, i.handleBlur = function (n) { var r = n.relatedTarget || t.activeElement, i; this.children().some(function (n) { return n.el() === r }) || (i = this.menuButton_, i && i.buttonPressed_ && r !== i.el().firstChild && i.unpressButton()) }, i.handleTapClick = function (n) { var t, i; if (this.menuButton_) { if (this.menuButton_.unpressButton(), t = this.children(), !Array.isArray(t)) return; if (i = t.filter(function (t) { return t.el() === n.target })[0], !i) return; "CaptionSettingsMenuItem" !== i.name() && this.menuButton_.focus() } }, i.handleKeyDown = function (n) { o.isEventKey(n, "Left") || o.isEventKey(n, "Down") ? (n.preventDefault(), n.stopPropagation(), this.stepForward()) : (o.isEventKey(n, "Right") || o.isEventKey(n, "Up")) && (n.preventDefault(), n.stopPropagation(), this.stepBack()) }, i.stepForward = function () { var n = 0; void 0 !== this.focusedChild_ && (n = this.focusedChild_ + 1); this.focus(n) }, i.stepBack = function () { var n = 0; void 0 !== this.focusedChild_ && (n = this.focusedChild_ - 1); this.focus(n) }, i.focus = function (n) { void 0 === n && (n = 0); var t = this.children().slice(); t.length && t[0].className && /vjs-menu-title/.test(t[0].className) && t.shift(); 0 < t.length && (n < 0 ? n = 0 : n >= t.length && (n = t.length - 1), t[this.focusedChild_ = n].el_.focus()) }, u }(r); r.registerComponent("Menu", fs); es = function (n) { function u(i, r) { var u, f; return void 0 === r && (r = {}), (u = n.call(this, i, r) || this).menuButton_ = new dt(i, r), u.menuButton_.controlText(u.controlText_), u.menuButton_.el_.setAttribute("aria-haspopup", "true"), f = dt.prototype.buildCSSClass(), u.menuButton_.el_.className = u.buildCSSClass() + " " + f, u.menuButton_.removeClass("vjs-control"), u.addChild(u.menuButton_), u.update(), u.enabled_ = !0, u.on(u.menuButton_, "tap", u.handleClick), u.on(u.menuButton_, "click", u.handleClick), u.on(u.menuButton_, "keydown", u.handleKeyDown), u.on(u.menuButton_, "mouseenter", function () { u.addClass("vjs-hover"); u.menu.show(); yt(t, "keyup", h(s(u), u.handleMenuKeyUp)) }), u.on("mouseleave", u.handleMouseLeave), u.on("keydown", u.handleSubmenuKeyDown), u } f(u, n); var i = u.prototype; return i.update = function () { var n = this.createMenu(); this.menu && (this.menu.dispose(), this.removeChild(this.menu)); this.menu = n; this.addChild(n); this.buttonPressed_ = !1; this.menuButton_.el_.setAttribute("aria-expanded", "false"); this.items && this.items.length <= this.hideThreshold_ ? this.hide() : this.show() }, i.createMenu = function () { var t = new fs(this.player_, { menuButton: this }), i, u, n; if ((this.hideThreshold_ = 0, this.options_.title) && (i = k("li", { className: "vjs-menu-title", innerHTML: b(this.options_.title), tabIndex: -1 }), this.hideThreshold_ += 1, u = new r(this.player_, { el: i }), t.addItem(u)), this.items = this.createItems(), this.items) for (n = 0; n < this.items.length; n++)t.addItem(this.items[n]); return t }, i.createItems = function () { }, i.createEl = function () { return n.prototype.createEl.call(this, "div", { className: this.buildWrapperCSSClass() }, {}) }, i.buildWrapperCSSClass = function () { var t = "vjs-menu-button"; return t += !0 === this.options_.inline ? "-inline" : "-popup", "vjs-menu-button " + t + " " + dt.prototype.buildCSSClass() + " " + n.prototype.buildCSSClass.call(this) }, i.buildCSSClass = function () { var t = "vjs-menu-button"; return t += !0 === this.options_.inline ? "-inline" : "-popup", "vjs-menu-button " + t + " " + n.prototype.buildCSSClass.call(this) }, i.controlText = function (n, t) { return void 0 === t && (t = this.menuButton_.el()), this.menuButton_.controlText(n, t) }, i.dispose = function () { this.handleMouseLeave(); n.prototype.dispose.call(this) }, i.handleClick = function () { this.buttonPressed_ ? this.unpressButton() : this.pressButton() }, i.handleMouseLeave = function () { this.removeClass("vjs-hover"); nt(t, "keyup", h(this, this.handleMenuKeyUp)) }, i.focus = function () { this.menuButton_.focus() }, i.blur = function () { this.menuButton_.blur() }, i.handleKeyDown = function (n) { o.isEventKey(n, "Esc") || o.isEventKey(n, "Tab") ? (this.buttonPressed_ && this.unpressButton(), o.isEventKey(n, "Tab") || (n.preventDefault(), this.menuButton_.focus())) : (o.isEventKey(n, "Up") || o.isEventKey(n, "Down")) && (this.buttonPressed_ || (n.preventDefault(), this.pressButton())) }, i.handleMenuKeyUp = function (n) { (o.isEventKey(n, "Esc") || o.isEventKey(n, "Tab")) && this.removeClass("vjs-hover") }, i.handleSubmenuKeyPress = function (n) { this.handleSubmenuKeyDown(n) }, i.handleSubmenuKeyDown = function (n) { (o.isEventKey(n, "Esc") || o.isEventKey(n, "Tab")) && (this.buttonPressed_ && this.unpressButton(), o.isEventKey(n, "Tab") || (n.preventDefault(), this.menuButton_.focus())) }, i.pressButton = function () { if (this.enabled_) { if (this.buttonPressed_ = !0, this.menu.show(), this.menu.lockShowing(), this.menuButton_.el_.setAttribute("aria-expanded", "true"), ui && lp()) return; this.menu.focus() } }, i.unpressButton = function () { this.enabled_ && (this.buttonPressed_ = !1, this.menu.unlockShowing(), this.menu.hide(), this.menuButton_.el_.setAttribute("aria-expanded", "false")) }, i.disable = function () { this.unpressButton(); this.enabled_ = !1; this.addClass("vjs-disabled"); this.menuButton_.disable() }, i.enable = function () { this.enabled_ = !0; this.removeClass("vjs-disabled"); this.menuButton_.enable() }, u }(r); r.registerComponent("MenuButton", es); os = function (n) { function t(t, i) { var r, f = i.tracks, u; return ((r = n.call(this, t, i) || this).items.length <= 1 && r.hide(), !f) ? s(r) : (u = h(s(r), r.update), f.addEventListener("removetrack", u), f.addEventListener("addtrack", u), r.player_.on("ready", u), r.player_.on("dispose", function () { f.removeEventListener("removetrack", u); f.removeEventListener("addtrack", u) }), r) } return f(t, n), t }(es); r.registerComponent("TrackButton", os); fg = ["Tab", "Esc", "Up", "Down", "Right", "Left"]; yu = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).selectable = i.selectable, r.isSelected_ = i.selected || !1, r.multiSelectable = i.multiSelectable, r.selected(r.isSelected_), r.selectable ? r.multiSelectable ? r.el_.setAttribute("role", "menuitemcheckbox") : r.el_.setAttribute("role", "menuitemradio") : r.el_.setAttribute("role", "menuitem"), r } f(i, n); var t = i.prototype; return t.createEl = function (t, i, r) { return this.nonIconControl = !0, n.prototype.createEl.call(this, "li", y({ className: "vjs-menu-item", innerHTML: '<span class="vjs-menu-item-text">' + this.localize(this.options_.label) + "<\/span>", tabIndex: -1 }, i), r) }, t.handleKeyDown = function (t) { fg.some(function (n) { return o.isEventKey(t, n) }) || n.prototype.handleKeyDown.call(this, t) }, t.handleClick = function () { this.selected(!0) }, t.selected = function (n) { this.selectable && (n ? (this.addClass("vjs-selected"), this.el_.setAttribute("aria-checked", "true"), this.controlText(", selected"), this.isSelected_ = !0) : (this.removeClass("vjs-selected"), this.el_.setAttribute("aria-checked", "false"), this.controlText(""), this.isSelected_ = !1)) }, i }(fe); r.registerComponent("MenuItem", yu); pu = function (i) { function u(r, u) { function h() { for (var t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; f.handleTracksChange.apply(s(f), i) } function l() { for (var t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; f.handleSelectedLanguageChange.apply(s(f), i) } var f, o = u.track, e = r.textTracks(), c; return u.label = o.label || o.language || "Unknown", u.selected = "showing" === o.mode, (f = i.call(this, r, u) || this).track = o, f.kinds = (u.kinds || [u.kind || f.track.kind]).filter(Boolean), r.on(["loadstart", "texttrackchange"], h), e.addEventListener("change", h), e.addEventListener("selectedlanguagechange", l), f.on("dispose", function () { r.off(["loadstart", "texttrackchange"], h); e.removeEventListener("change", h); e.removeEventListener("selectedlanguagechange", l) }), void 0 === e.onchange && f.on(["tap", "click"], function () { if ("object" != typeof n.Event) try { c = new n.Event("change") } catch (i) { } c || (c = t.createEvent("Event")).initEvent("change", !0, !0); e.dispatchEvent(c) }), f.handleTracksChange(), f } f(u, i); var r = u.prototype; return r.handleClick = function (n) { var f = this.track, u = this.player_.textTracks(), r, t; if (i.prototype.handleClick.call(this, n), u) for (r = 0; r < u.length; r++)t = u[r], -1 !== this.kinds.indexOf(t.kind) && (t === f ? "showing" !== t.mode && (t.mode = "showing") : "disabled" !== t.mode && (t.mode = "disabled")) }, r.handleTracksChange = function () { var n = "showing" === this.track.mode; n !== this.isSelected_ && this.selected(n) }, r.handleSelectedLanguageChange = function () { if ("showing" === this.track.mode) { var n = this.player_.cache_.selectedLanguage; if (n && n.enabled && n.language === this.track.language && n.kind !== this.track.kind) return; this.player_.cache_.selectedLanguage = { enabled: !0, language: this.track.language, kind: this.track.kind } } }, r.dispose = function () { this.track = null; i.prototype.dispose.call(this) }, u }(yu); r.registerComponent("TextTrackMenuItem", pu); ya = function (n) { function t(t, i) { return i.track = { player: t, kind: i.kind, kinds: i.kinds, "default": !1, mode: "disabled" }, i.kinds || (i.kinds = [i.kind]), i.track.label = i.label ? i.label : i.kinds.join(" and ") + " off", i.selectable = !0, i.multiSelectable = !1, n.call(this, t, i) || this } f(t, n); var i = t.prototype; return i.handleTracksChange = function () { for (var i, r = this.player().textTracks(), n = !0, t = 0, u = r.length; t < u; t++)if (i = r[t], -1 < this.options_.kinds.indexOf(i.kind) && "showing" === i.mode) { n = !1; break } n !== this.isSelected_ && this.selected(n) }, i.handleSelectedLanguageChange = function () { for (var t, i = this.player().textTracks(), r = !0, n = 0, u = i.length; n < u; n++)if (t = i[n], -1 < ["captions", "descriptions", "subtitles"].indexOf(t.kind) && "showing" === t.mode) { r = !1; break } r && (this.player_.cache_.selectedLanguage = { enabled: !1 }) }, t }(pu); r.registerComponent("OffTextTrackMenuItem", ya); lr = function (n) { function t(t, i) { return void 0 === i && (i = {}), i.tracks = t.textTracks(), n.call(this, t, i) || this } return f(t, n), t.prototype.createItems = function (n, t) { var e, u, i, r, f; for (void 0 === n && (n = []), void 0 === t && (t = pu), this.label_ && (e = this.label_ + " off"), n.push(new ya(this.player_, { kinds: this.kinds_, kind: this.kind_, label: e })), this.hideThreshold_ += 1, u = this.player_.textTracks(), Array.isArray(this.kinds_) || (this.kinds_ = [this.kind_]), i = 0; i < u.length; i++)r = u[i], -1 < this.kinds_.indexOf(r.kind) && (f = new t(this.player_, { track: r, kinds: this.kinds_, kind: this.kind_, selectable: !0, multiSelectable: !1 }), f.addClass("vjs-" + r.kind + "-menu-item"), n.push(f)); return n }, t }(os); r.registerComponent("TextTrackButton", lr); pa = function (n) { function t(t, i) { var r, f = i.track, u = i.cue, e = t.currentTime(); return i.selectable = !0, i.multiSelectable = !1, i.label = u.text, i.selected = u.startTime <= e && e < u.endTime, (r = n.call(this, t, i) || this).track = f, r.cue = u, f.addEventListener("cuechange", h(s(r), r.update)), r } f(t, n); var i = t.prototype; return i.handleClick = function () { n.prototype.handleClick.call(this); this.player_.currentTime(this.cue.startTime); this.update(this.cue.startTime) }, i.update = function () { var n = this.cue, t = this.player_.currentTime(); this.selected(n.startTime <= t && t < n.endTime) }, t }(yu); r.registerComponent("ChaptersTrackMenuItem", pa); ss = function (n) { function i(t, i, r) { return n.call(this, t, i, r) || this } f(i, n); var t = i.prototype; return t.buildCSSClass = function () { return "vjs-chapters-button " + n.prototype.buildCSSClass.call(this) }, t.buildWrapperCSSClass = function () { return "vjs-chapters-button " + n.prototype.buildWrapperCSSClass.call(this) }, t.update = function (t) { this.track_ && (!t || "addtrack" !== t.type && "removetrack" !== t.type) || this.setTrack(this.findChaptersTrack()); n.prototype.update.call(this) }, t.setTrack = function (n) { var t, i; this.track_ !== n && ((this.updateHandler_ || (this.updateHandler_ = this.update.bind(this)), this.track_) && (t = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_), t && t.removeEventListener("load", this.updateHandler_), this.track_ = null), (this.track_ = n, this.track_) && (this.track_.mode = "hidden", i = this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_), i && i.addEventListener("load", this.updateHandler_))) }, t.findChaptersTrack = function () { for (var i, t = this.player_.textTracks() || [], n = t.length - 1; 0 <= n; n--)if (i = t[n], i.kind === this.kind_) return i }, t.getMenuCaption = function () { return this.track_ && this.track_.label ? this.track_.label : this.localize(b(this.kind_)) }, t.createMenu = function () { return this.options_.title = this.getMenuCaption(), n.prototype.createMenu.call(this) }, t.createItems = function () { var i = [], n, t, r, u, f; if (!this.track_ || (n = this.track_.cues, !n)) return i; for (t = 0, r = n.length; t < r; t++)u = n[t], f = new pa(this.player_, { track: this.track_, cue: u }), i.push(f); return i }, i }(lr); ss.prototype.kind_ = "chapters"; ss.prototype.controlText_ = "Chapters"; r.registerComponent("ChaptersButton", ss); hs = function (n) { function t(t, i, r) { var u, f, e; return u = n.call(this, t, i, r) || this, f = t.textTracks(), e = h(s(u), u.handleTracksChange), f.addEventListener("change", e), u.on("dispose", function () { f.removeEventListener("change", e) }), u } f(t, n); var i = t.prototype; return i.handleTracksChange = function () { for (var t, i = this.player().textTracks(), r = !1, n = 0, u = i.length; n < u; n++)if (t = i[n], t.kind !== this.kind_ && "showing" === t.mode) { r = !0; break } r ? this.disable() : this.enable() }, i.buildCSSClass = function () { return "vjs-descriptions-button " + n.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-descriptions-button " + n.prototype.buildWrapperCSSClass.call(this) }, t }(lr); hs.prototype.kind_ = "descriptions"; hs.prototype.controlText_ = "Descriptions"; r.registerComponent("DescriptionsButton", hs); cs = function (n) { function t(t, i, r) { return n.call(this, t, i, r) || this } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-subtitles-button " + n.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-subtitles-button " + n.prototype.buildWrapperCSSClass.call(this) }, t }(lr); cs.prototype.kind_ = "subtitles"; cs.prototype.controlText_ = "Subtitles"; r.registerComponent("SubtitlesButton", cs); ls = function (n) { function t(t, i) { var r; return i.track = { player: t, kind: i.kind, label: i.kind + " settings", selectable: !1, "default": !1, mode: "disabled" }, i.selectable = !1, i.name = "CaptionSettingsMenuItem", (r = n.call(this, t, i) || this).addClass("vjs-texttrack-settings"), r.controlText(", opens " + i.kind + " settings dialog"), r } return f(t, n), t.prototype.handleClick = function () { this.player().getChild("textTrackSettings").open() }, t }(pu); r.registerComponent("CaptionSettingsMenuItem", ls); as = function (n) { function t(t, i, r) { return n.call(this, t, i, r) || this } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-captions-button " + n.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-captions-button " + n.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function () { var t = []; return this.player().tech_ && this.player().tech_.featuresNativeTextTracks || !this.player().getChild("textTrackSettings") || (t.push(new ls(this.player_, { kind: this.kind_ })), this.hideThreshold_ += 1), n.prototype.createItems.call(this, t) }, t }(lr); as.prototype.kind_ = "captions"; as.prototype.controlText_ = "Captions"; r.registerComponent("CaptionsButton", as); wa = function (n) { function t() { return n.apply(this, arguments) || this } return f(t, n), t.prototype.createEl = function (t, i, r) { var u = '<span class="vjs-menu-item-text">' + this.localize(this.options_.label); return "captions" === this.options_.track.kind && (u += '\n        <span aria-hidden="true" class="vjs-icon-placeholder"><\/span>\n        <span class="vjs-control-text"> ' + this.localize("Captions") + "<\/span>\n      "), u += "<\/span>", n.prototype.createEl.call(this, t, y({ innerHTML: u }, i), r) }, t }(pu); r.registerComponent("SubsCapsMenuItem", wa); vs = function (n) { function t(t, i) { var r; return void 0 === i && (i = {}), (r = n.call(this, t, i) || this).label_ = "subtitles", -1 < ["en", "en-us", "en-ca", "fr-ca"].indexOf(r.player_.language_) && (r.label_ = "captions"), r.menuButton_.controlText(b(r.label_)), r } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-subs-caps-button " + n.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-subs-caps-button " + n.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function () { var t = []; return this.player().tech_ && this.player().tech_.featuresNativeTextTracks || !this.player().getChild("textTrackSettings") || (t.push(new ls(this.player_, { kind: this.label_ })), this.hideThreshold_ += 1), t = n.prototype.createItems.call(this, t, wa) }, t }(lr); vs.prototype.kinds_ = ["captions", "subtitles"]; vs.prototype.controlText_ = "Subtitles"; r.registerComponent("SubsCapsButton", vs); ba = function (n) { function t(t, i) { function e() { for (var t = arguments.length, i = new Array(t), n = 0; n < t; n++)i[n] = arguments[n]; r.handleTracksChange.apply(s(r), i) } var r, u = i.track, f = t.audioTracks(); return i.label = u.label || u.language || "Unknown", i.selected = u.enabled, (r = n.call(this, t, i) || this).track = u, r.addClass("vjs-" + u.kind + "-menu-item"), f.addEventListener("change", e), r.on("dispose", function () { f.removeEventListener("change", e) }), r } f(t, n); var i = t.prototype; return i.createEl = function (t, i, r) { var u = '<span class="vjs-menu-item-text">' + this.localize(this.options_.label); return "main-desc" === this.options_.track.kind && (u += '\n        <span aria-hidden="true" class="vjs-icon-placeholder"><\/span>\n        <span class="vjs-control-text"> ' + this.localize("Descriptions") + "<\/span>\n      "), u += "<\/span>", n.prototype.createEl.call(this, t, y({ innerHTML: u }, i), r) }, i.handleClick = function (t) { var u = this.player_.audioTracks(), i, r; for (n.prototype.handleClick.call(this, t), i = 0; i < u.length; i++)r = u[i], r.enabled = r === this.track }, i.handleTracksChange = function () { this.selected(this.track.enabled) }, t }(yu); r.registerComponent("AudioTrackMenuItem", ba); ka = function (n) { function t(t, i) { return void 0 === i && (i = {}), i.tracks = t.audioTracks(), n.call(this, t, i) || this } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-audio-button " + n.prototype.buildCSSClass.call(this) }, i.buildWrapperCSSClass = function () { return "vjs-audio-button " + n.prototype.buildWrapperCSSClass.call(this) }, i.createItems = function (n) { var i, t, r; for (void 0 === n && (n = []), this.hideThreshold_ = 1, i = this.player_.audioTracks(), t = 0; t < i.length; t++)r = i[t], n.push(new ba(this.player_, { track: r, selectable: !0, multiSelectable: !1 })); return n }, t }(os); ka.prototype.controlText_ = "Audio Track"; r.registerComponent("AudioTrackButton", ka); ys = function (n) { function t(t, i) { var r, u = i.rate, f = parseFloat(u, 10); return i.label = u, i.selected = 1 === f, i.selectable = !0, i.multiSelectable = !1, (r = n.call(this, t, i) || this).label = u, r.rate = f, r.on(t, "ratechange", r.update), r } f(t, n); var i = t.prototype; return i.handleClick = function () { n.prototype.handleClick.call(this); this.player().playbackRate(this.rate) }, i.update = function () { this.selected(this.player().playbackRate() === this.rate) }, t }(yu); ys.prototype.contentElType = "button"; r.registerComponent("PlaybackRateMenuItem", ys); da = function (n) { function i(t, i) { var r; return (r = n.call(this, t, i) || this).updateVisibility(), r.updateLabel(), r.on(t, "loadstart", r.updateVisibility), r.on(t, "ratechange", r.updateLabel), r } f(i, n); var t = i.prototype; return t.createEl = function () { var t = n.prototype.createEl.call(this); return this.labelEl_ = k("div", { className: "vjs-playback-rate-value", innerHTML: "1x" }), t.appendChild(this.labelEl_), t }, t.dispose = function () { this.labelEl_ = null; n.prototype.dispose.call(this) }, t.buildCSSClass = function () { return "vjs-playback-rate " + n.prototype.buildCSSClass.call(this) }, t.buildWrapperCSSClass = function () { return "vjs-playback-rate " + n.prototype.buildWrapperCSSClass.call(this) }, t.createMenu = function () { var i = new fs(this.player()), t = this.playbackRates(), n; if (t) for (n = t.length - 1; 0 <= n; n--)i.addChild(new ys(this.player(), { rate: t[n] + "x" })); return i }, t.updateARIAAttributes = function () { this.el().setAttribute("aria-valuenow", this.player().playbackRate()) }, t.handleClick = function () { for (var r = this.player().playbackRate(), n = this.playbackRates(), i = n[0], t = 0; t < n.length; t++)if (n[t] > r) { i = n[t]; break } this.player().playbackRate(i) }, t.playbackRates = function () { return this.options_.playbackRates || this.options_.playerOptions && this.options_.playerOptions.playbackRates }, t.playbackRateSupported = function () { return this.player().tech_ && this.player().tech_.featuresPlaybackRate && this.playbackRates() && 0 < this.playbackRates().length }, t.updateVisibility = function () { this.playbackRateSupported() ? this.removeClass("vjs-hidden") : this.addClass("vjs-hidden") }, t.updateLabel = function () { this.playbackRateSupported() && (this.labelEl_.innerHTML = this.player().playbackRate() + "x") }, i }(es); da.prototype.controlText_ = "Playback Rate"; r.registerComponent("PlaybackRateMenuButton", da); ga = function (n) { function t() { return n.apply(this, arguments) || this } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-spacer " + n.prototype.buildCSSClass.call(this) }, i.createEl = function () { return n.prototype.createEl.call(this, "div", { className: this.buildCSSClass() }) }, t }(r); r.registerComponent("Spacer", ga); eg = function (n) { function t() { return n.apply(this, arguments) || this } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-custom-control-spacer " + n.prototype.buildCSSClass.call(this) }, i.createEl = function () { var t = n.prototype.createEl.call(this, { className: this.buildCSSClass() }); return t.innerHTML = " ", t }, t }(ga); r.registerComponent("CustomControlSpacer", eg); oe = function (n) { function t() { return n.apply(this, arguments) || this } return f(t, n), t.prototype.createEl = function () { return n.prototype.createEl.call(this, "div", { className: "vjs-control-bar", dir: "ltr" }) }, t }(r); oe.prototype.options_ = { children: ["playToggle", "volumePanel", "currentTimeDisplay", "timeDivider", "durationDisplay", "progressControl", "liveDisplay", "seekToLive", "remainingTimeDisplay", "customControlSpacer", "playbackRateMenuButton", "chaptersButton", "descriptionsButton", "subsCapsButton", "audioTrackButton", "fullscreenToggle"] }; "exitPictureInPicture" in t && oe.prototype.options_.children.splice(oe.prototype.options_.children.length - 1, 0, "pictureInPictureToggle"); r.registerComponent("ControlBar", oe); nv = function (n) { function t(t, i) { var r; return (r = n.call(this, t, i) || this).on(t, "error", r.open), r } f(t, n); var i = t.prototype; return i.buildCSSClass = function () { return "vjs-error-display " + n.prototype.buildCSSClass.call(this) }, i.content = function () { var n = this.player().error(); return n ? this.localize(n.message) : "" }, t }(ou); nv.prototype.options_ = a(ou.prototype.options_, { pauseOnOpen: !1, fillAlways: !0, temporary: !1, uncloseable: !0 }); r.registerComponent("ErrorDisplay", nv); var tv = "vjs-text-track-settings", og = ["#000", "Black"], sg = ["#00F", "Blue"], hg = ["#0FF", "Cyan"], cg = ["#0F0", "Green"], lg = ["#F0F", "Magenta"], ag = ["#F00", "Red"], vg = ["#FFF", "White"], yg = ["#FF0", "Yellow"], iv = ["1", "Opaque"], rv = ["0.5", "Semi-Transparent"], pg = ["0", "Transparent"], ar = { backgroundColor: { selector: ".vjs-bg-color > select", id: "captions-background-color-%s", label: "Color", options: [og, vg, ag, cg, sg, yg, lg, hg] }, backgroundOpacity: { selector: ".vjs-bg-opacity > select", id: "captions-background-opacity-%s", label: "Transparency", options: [iv, rv, pg] }, color: { selector: ".vjs-fg-color > select", id: "captions-foreground-color-%s", label: "Color", options: [vg, og, ag, cg, sg, yg, lg, hg] }, edgeStyle: { selector: ".vjs-edge-style > select", id: "%s", label: "Text Edge Style", options: [["none", "None"], ["raised", "Raised"], ["depressed", "Depressed"], ["uniform", "Uniform"], ["dropshadow", "Dropshadow"]] }, fontFamily: { selector: ".vjs-font-family > select", id: "captions-font-family-%s", label: "Font Family", options: [["proportionalSansSerif", "Proportional Sans-Serif"], ["monospaceSansSerif", "Monospace Sans-Serif"], ["proportionalSerif", "Proportional Serif"], ["monospaceSerif", "Monospace Serif"], ["casual", "Casual"], ["script", "Script"], ["small-caps", "Small Caps"]] }, fontPercent: { selector: ".vjs-font-percent > select", id: "captions-font-size-%s", label: "Font Size", options: [["0.50", "50%"], ["0.75", "75%"], ["1.00", "100%"], ["1.25", "125%"], ["1.50", "150%"], ["1.75", "175%"], ["2.00", "200%"], ["3.00", "300%"], ["4.00", "400%"]], "default": 2, parser: function (n) { return "1.00" === n ? null : Number(n) } }, textOpacity: { selector: ".vjs-text-opacity > select", id: "captions-foreground-opacity-%s", label: "Transparency", options: [iv, rv] }, windowColor: { selector: ".vjs-window-color > select", id: "captions-window-color-%s", label: "Color" }, windowOpacity: { selector: ".vjs-window-opacity > select", id: "captions-window-opacity-%s", label: "Transparency", options: [pg, rv, iv] } }; ar.windowColor.options = ar.backgroundColor.options; bg = function (t) { function r(n, i) { var r; return i.temporary = !1, (r = t.call(this, n, i) || this).updateDisplay = h(s(r), r.updateDisplay), r.fill(), r.hasBeenOpened_ = r.hasBeenFilled_ = !0, r.endDialog = k("p", { className: "vjs-control-text", textContent: r.localize("End of dialog window.") }), r.el().appendChild(r.endDialog), r.setDefaults(), void 0 === i.persistTextTrackSettings && (r.options_.persistTextTrackSettings = r.options_.playerOptions.persistTextTrackSettings), r.on(r.$(".vjs-done-button"), "click", function () { r.saveSettings(); r.close() }), r.on(r.$(".vjs-default-button"), "click", function () { r.setDefaults(); r.updateDisplay() }), iu(ar, function (n) { r.on(r.$(n.selector), "change", r.updateDisplay) }), r.options_.persistTextTrackSettings && r.restoreSettings(), r } f(r, t); var i = r.prototype; return i.dispose = function () { this.endDialog = null; t.prototype.dispose.call(this) }, i.createElSelect_ = function (n, t, i) { var e = this; void 0 === t && (t = ""); void 0 === i && (i = "label"); var r = ar[n], u = r.id.replace("%s", this.id_), f = [t, u].join(" ").trim(); return ["<" + i + ' id="' + u + '" class="' + ("label" === i ? "vjs-label" : "") + '">', this.localize(r.label), "<\/" + i + ">", '<select aria-labelledby="' + f + '">'].concat(r.options.map(function (n) { var t = u + "-" + n[1].replace(/\W+/g, ""); return ['<option id="' + t + '" value="' + n[0] + '" ', 'aria-labelledby="' + f + " " + t + '">', e.localize(n[1]), "<\/option>"].join("") })).concat("<\/select>").join("") }, i.createElFgColor_ = function () { var n = "captions-text-legend-" + this.id_; return ['<fieldset class="vjs-fg-color vjs-track-setting">', '<legend id="' + n + '">', this.localize("Text"), "<\/legend>", this.createElSelect_("color", n), '<span class="vjs-text-opacity vjs-opacity">', this.createElSelect_("textOpacity", n), "<\/span>", "<\/fieldset>"].join("") }, i.createElBgColor_ = function () { var n = "captions-background-" + this.id_; return ['<fieldset class="vjs-bg-color vjs-track-setting">', '<legend id="' + n + '">', this.localize("Background"), "<\/legend>", this.createElSelect_("backgroundColor", n), '<span class="vjs-bg-opacity vjs-opacity">', this.createElSelect_("backgroundOpacity", n), "<\/span>", "<\/fieldset>"].join("") }, i.createElWinColor_ = function () { var n = "captions-window-" + this.id_; return ['<fieldset class="vjs-window-color vjs-track-setting">', '<legend id="' + n + '">', this.localize("Window"), "<\/legend>", this.createElSelect_("windowColor", n), '<span class="vjs-window-opacity vjs-opacity">', this.createElSelect_("windowOpacity", n), "<\/span>", "<\/fieldset>"].join("") }, i.createElColors_ = function () { return k("div", { className: "vjs-track-settings-colors", innerHTML: [this.createElFgColor_(), this.createElBgColor_(), this.createElWinColor_()].join("") }) }, i.createElFont_ = function () { return k("div", { className: "vjs-track-settings-font", innerHTML: ['<fieldset class="vjs-font-percent vjs-track-setting">', this.createElSelect_("fontPercent", "", "legend"), "<\/fieldset>", '<fieldset class="vjs-edge-style vjs-track-setting">', this.createElSelect_("edgeStyle", "", "legend"), "<\/fieldset>", '<fieldset class="vjs-font-family vjs-track-setting">', this.createElSelect_("fontFamily", "", "legend"), "<\/fieldset>"].join("") }) }, i.createElControls_ = function () { var n = this.localize("restore all settings to the default values"); return k("div", { className: "vjs-track-settings-controls", innerHTML: ['<button type="button" class="vjs-default-button" title="' + n + '">', this.localize("Reset"), '<span class="vjs-control-text"> ' + n + "<\/span>", "<\/button>", '<button type="button" class="vjs-done-button">' + this.localize("Done") + "<\/button>"].join("") }) }, i.content = function () { return [this.createElColors_(), this.createElFont_(), this.createElControls_()] }, i.label = function () { return this.localize("Caption Settings Dialog") }, i.description = function () { return this.localize("Beginning of dialog window. Escape will cancel and close the window.") }, i.buildCSSClass = function () { return t.prototype.buildCSSClass.call(this) + " vjs-text-track-settings" }, i.getValues = function () { var n = this; return function (n, t, i) { return void 0 === i && (i = 0), sp(n).reduce(function (i, r) { return t(i, n[r], r) }, i) }(ar, function (t, i, r) { var u = function (n, t) { return wg(n.options[n.options.selectedIndex].value, t) }(n.$(i.selector), i.parser); return void 0 !== u && (t[r] = u), t }, {}) }, i.setValues = function (n) { var t = this; iu(ar, function (i, r) { !function (n, t, i) { if (t) for (var r = 0; r < n.options.length; r++)if (wg(n.options[r].value, i) === t) { n.selectedIndex = r; break } }(t.$(i.selector), n[r], i.parser) }) }, i.setDefaults = function () { var n = this; iu(ar, function (t) { var i = t.hasOwnProperty("default") ? t.default : 0; n.$(t.selector).selectedIndex = i }) }, i.restoreSettings = function () { var t; try { t = JSON.parse(n.localStorage.getItem(tv)) } catch (t) { c.warn(t) } t && this.setValues(t) }, i.saveSettings = function () { if (this.options_.persistTextTrackSettings) { var t = this.getValues(); try { Object.keys(t).length ? n.localStorage.setItem(tv, JSON.stringify(t)) : n.localStorage.removeItem(tv) } catch (t) { c.warn(t) } } }, i.updateDisplay = function () { var n = this.player_.getChild("textTrackDisplay"); n && n.updateDisplay() }, i.conditionalBlur_ = function () { this.previouslyActiveEl_ = null; var n = this.player_.controlBar, t = n && n.subsCapsButton, i = n && n.captionsButton; t ? t.focus() : i && i.focus() }, r }(ou); r.registerComponent("TextTrackSettings", bg); kg = function (t) { function i(i, r) { var u, f = r.ResizeObserver || n.ResizeObserver, e; return null === r.ResizeObserver && (f = !1), e = a({ createEl: !f, reportTouchActivity: !1 }, r), (u = t.call(this, i, e) || this).ResizeObserver = r.ResizeObserver || n.ResizeObserver, u.loadListener_ = null, u.resizeObserver_ = null, u.debouncedHandler_ = function (t, i, r, u) { function e() { var n = this, e = arguments, o = function () { o = f = null; r || t.apply(n, e) }; !f && r && t.apply(n, e); u.clearTimeout(f); f = u.setTimeout(o, i) } var f; return void 0 === u && (u = n), e.cancel = function () { u.clearTimeout(f); f = null }, e }(function () { u.resizeHandler() }, 100, !1, s(u)), f ? (u.resizeObserver_ = new u.ResizeObserver(u.debouncedHandler_), u.resizeObserver_.observe(i.el())) : (u.loadListener_ = function () { if (u.el_ && u.el_.contentWindow) { var t = u.debouncedHandler_, n = u.unloadListener_ = function () { nt(this, "resize", t); nt(this, "unload", n); n = null }; yt(u.el_.contentWindow, "unload", n); yt(u.el_.contentWindow, "resize", t) } }, u.one("load", u.loadListener_)), u } f(i, t); var r = i.prototype; return r.createEl = function () { return t.prototype.createEl.call(this, "iframe", { className: "vjs-resize-manager", tabIndex: -1 }, { "aria-hidden": "true" }) }, r.resizeHandler = function () { this.player_ && this.player_.trigger && this.player_.trigger("playerresize") }, r.dispose = function () { this.debouncedHandler_ && this.debouncedHandler_.cancel(); this.resizeObserver_ && (this.player_.el() && this.resizeObserver_.unobserve(this.player_.el()), this.resizeObserver_.disconnect()); this.loadListener_ && this.off("load", this.loadListener_); this.el_ && this.el_.contentWindow && this.unloadListener_ && this.unloadListener_.call(this.el_.contentWindow); this.ResizeObserver = null; this.resizeObserver = null; this.debouncedHandler_ = null; this.loadListener_ = null; t.prototype.dispose.call(this) }, i }(r); r.registerComponent("ResizeManager", kg); dg = function (n) { function r(i, r) { var u, f = a({ createEl: !1 }, r); return (u = n.call(this, i, f) || this).reset_(), u.on(u.player_, "durationchange", u.handleDurationchange), dc && "hidden" in t && "visibilityState" in t && u.on(t, "visibilitychange", u.handleVisibilityChange), u } f(r, n); var i = r.prototype; return i.handleVisibilityChange = function () { this.player_.duration() === 1 / 0 && (t.hidden ? this.stopTracking() : this.startTracking()) }, i.isBehind_ = function () { if (!this.timeupdateSeen_) return !1; var n = this.liveCurrentTime(), t = this.player_.currentTime(), i = 2 * this.seekableIncrement_ + .07; return n !== 1 / 0 && t <= n - i }, i.trackLive_ = function () { var t, n; this.pastSeekEnd_ = this.pastSeekEnd_; t = this.player_.seekable(); t && t.length && (n = this.seekableEnd(), n !== this.lastSeekEnd_ && (this.lastSeekEnd_ && (this.seekableIncrementList_ = this.seekableIncrementList_.slice(-11), this.seekableIncrementList_.push(Math.abs(n - this.lastSeekEnd_)), 3 < this.seekableIncrementList_.length && (this.seekableIncrement_ = function (n) { var t = Math.floor(n.length / 2), i = [].concat(n).sort(function (n, t) { return n - t }); return n.length % 2 != 0 ? i[t] : (i[t - 1] + i[t]) / 2 }(this.seekableIncrementList_))), this.pastSeekEnd_ = 0, this.lastSeekEnd_ = n, this.trigger("seekableendchange")), this.pastSeekEnd_ = this.pastSeekEnd() + .03, this.isBehind_() !== this.behindLiveEdge() && (this.behindLiveEdge_ = this.isBehind_(), this.trigger("liveedgechange"))) }, i.handleDurationchange = function () { this.player_.duration() === 1 / 0 ? this.startTracking() : this.stopTracking() }, i.startTracking = function () { var n = this; this.isTracking() || (this.timeupdateSeen_ || (this.timeupdateSeen_ = this.player_.hasStarted()), this.trackingInterval_ = this.setInterval(this.trackLive_, 30), this.trackLive_(), this.on(this.player_, "play", this.trackLive_), this.on(this.player_, "pause", this.trackLive_), this.timeupdateSeen_ || (this.one(this.player_, "play", this.handlePlay), this.handleTimeupdate = function () { n.timeupdateSeen_ = !0; n.handleTimeupdate = null }, this.one(this.player_, "timeupdate", this.handleTimeupdate))) }, i.handlePlay = function () { this.one(this.player_, "timeupdate", this.seekToLiveEdge) }, i.reset_ = function () { this.pastSeekEnd_ = 0; this.lastSeekEnd_ = null; this.behindLiveEdge_ = null; this.timeupdateSeen_ = !1; this.clearInterval(this.trackingInterval_); this.trackingInterval_ = null; this.seekableIncrement_ = 12; this.seekableIncrementList_ = []; this.off(this.player_, "play", this.trackLive_); this.off(this.player_, "pause", this.trackLive_); this.off(this.player_, "play", this.handlePlay); this.off(this.player_, "timeupdate", this.seekToLiveEdge); this.handleTimeupdate && (this.off(this.player_, "timeupdate", this.handleTimeupdate), this.handleTimeupdate = null) }, i.stopTracking = function () { this.isTracking() && this.reset_() }, i.seekableEnd = function () { for (var t = this.player_.seekable(), n = [], i = t ? t.length : 0; i--;)n.push(t.end(i)); return n.length ? n.sort()[n.length - 1] : 1 / 0 }, i.seekableStart = function () { for (var n = this.player_.seekable(), t = [], i = n ? n.length : 0; i--;)t.push(n.start(i)); return t.length ? t.sort()[0] : 0 }, i.liveWindow = function () { var n = this.liveCurrentTime(); return n === 1 / 0 ? 1 / 0 : n - this.seekableStart() }, i.isLive = function () { return this.isTracking() }, i.atLiveEdge = function () { return !this.behindLiveEdge() }, i.liveCurrentTime = function () { return this.pastSeekEnd() + this.seekableEnd() }, i.pastSeekEnd = function () { return this.pastSeekEnd_ }, i.behindLiveEdge = function () { return this.behindLiveEdge_ }, i.isTracking = function () { return "number" == typeof this.trackingInterval_ }, i.seekToLiveEdge = function () { this.atLiveEdge() || (this.player_.currentTime(this.liveCurrentTime()), this.player_.paused() && this.player_.play()) }, i.dispose = function () { this.stopTracking(); n.prototype.dispose.call(this) }, r }(r); r.registerComponent("LiveTracker", dg); var not = Object.defineProperty({}, "innerHTML", { get: function () { return this.cloneNode(!0).innerHTML }, set: function (i) { var r = t.createElement(this.nodeName.toLowerCase()), u; for (r.innerHTML = i, u = t.createDocumentFragment(); r.childNodes.length;)u.appendChild(r.childNodes[0]); return this.innerText = "", n.Element.prototype.appendChild.call(this, u), this.innerHTML } }), tot = Object.defineProperty({}, "src", { get: function () { return this.hasAttribute("src") ? yb(n.Element.prototype.getAttribute.call(this, "src")) : "" }, set: function (t) { return n.Element.prototype.setAttribute.call(this, "src", t), t } }), u = function (i) { function u(n, t) { var r, f, e, u, o; if (r = i.call(this, n, t) || this, f = n.source, e = !1, f && (r.el_.currentSrc !== f.src || n.tag && 3 === n.tag.initNetworkState_) ? r.setSource(f) : r.handleLateInit_(r.el_), n.enableSourceset && r.setupSourcesetHandling_(), r.el_.hasChildNodes()) { for (var h = r.el_.childNodes, l = h.length, s = []; l--;)u = h[l], "track" === u.nodeName.toLowerCase() && (r.featuresNativeTextTracks ? (r.remoteTextTrackEls().addTrackElement_(u), r.remoteTextTracks().addTrack(u.track), r.textTracks().addTrack(u.track), e || r.el_.hasAttribute("crossorigin") || !oo(u.src) || (e = !0)) : s.push(u)); for (o = 0; o < s.length; o++)r.el_.removeChild(s[o]) } return r.proxyNativeTracks_(), r.featuresNativeTextTracks && e && c.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."), r.restoreMetadataTracksInIOSNativePlayer_(), (bf || wc || tb) && !0 === n.nativeControlsForTouch && r.setControls(!0), r.proxyWebkitFullscreen_(), r.triggerReady(), r } f(u, i); var r = u.prototype; return r.dispose = function () { this.el_ && this.el_.resetSourceset_ && this.el_.resetSourceset_(); u.disposeMediaElement(this.el_); this.options_ = null; i.prototype.dispose.call(this) }, r.setupSourcesetHandling_ = function () { get(this) }, r.restoreMetadataTracksInIOSNativePlayer_ = function () { function t() { var t, r; for (i = [], t = 0; t < n.length; t++)r = n[t], "metadata" === r.kind && i.push({ track: r, storedMode: r.mode }) } function r() { for (var t, u = 0; u < i.length; u++)t = i[u], "disabled" === t.track.mode && t.track.mode !== t.storedMode && (t.track.mode = t.storedMode); n.removeEventListener("change", r) } var i, n = this.textTracks(); t(); n.addEventListener("change", t); this.on("dispose", function () { return n.removeEventListener("change", t) }); this.on("webkitbeginfullscreen", function () { n.removeEventListener("change", t); n.removeEventListener("change", r); n.addEventListener("change", r) }); this.on("webkitendfullscreen", function () { n.removeEventListener("change", t); n.addEventListener("change", t); n.removeEventListener("change", r) }) }, r.overrideNative_ = function (n, t) { var r = this, i; t === this["featuresNative" + n + "Tracks"] && (i = n.toLowerCase(), this[i + "TracksListeners_"] && Object.keys(this[i + "TracksListeners_"]).forEach(function (n) { r.el()[i + "Tracks"].removeEventListener(n, r[i + "TracksListeners_"][n]) }), this["featuresNative" + n + "Tracks"] = !t, this[i + "TracksListeners_"] = null, this.proxyNativeTracksForType_(i)) }, r.overrideNativeAudioTracks = function (n) { this.overrideNative_("Audio", n) }, r.overrideNativeVideoTracks = function (n) { this.overrideNative_("Video", n) }, r.proxyNativeTracksForType_ = function (n) { var f = this, r = pt[n], i = this.el()[r.getterName], t = this[r.getterName](), u; if (this["featuresNative" + r.capitalName + "Tracks"] && i && i.addEventListener) { function n() { for (var f, u, r = [], n = 0; n < t.length; n++) { for (f = !1, u = 0; u < i.length; u++)if (i[u] === t[n]) { f = !0; break } f || r.push(t[n]) } for (; r.length;)t.removeTrack(r.shift()) } u = { change: function () { t.trigger({ type: "change", target: t, currentTarget: t, srcElement: t }) }, addtrack: function (n) { t.addTrack(n.track) }, removetrack: function (n) { t.removeTrack(n.track) } }; this[r.getterName + "Listeners_"] = u; Object.keys(u).forEach(function (n) { var t = u[n]; i.addEventListener(n, t); f.on("dispose", function () { return i.removeEventListener(n, t) }) }); this.on("loadstart", n); this.on("dispose", function () { return f.off("loadstart", n) }) } }, r.proxyNativeTracks_ = function () { var n = this; pt.names.forEach(function (t) { n.proxyNativeTracksForType_(t) }) }, r.createEl = function () { var n = this.options_.tag, e, o, s, r, i, f; for (n && (this.options_.playerElIngest || this.movingMediaElementInDOM) || (n ? (e = n.cloneNode(!0), n.parentNode && n.parentNode.insertBefore(e, n), u.disposeMediaElement(n), n = e) : (n = t.createElement("video"), o = a({}, this.options_.tag && ci(this.options_.tag)), bf && !0 === this.options_.nativeControlsForTouch || delete o.controls, yp(n, y(o, { id: this.options_.techId, "class": "vjs-tech" }))), n.playerId = this.options_.playerId), "undefined" != typeof this.options_.preload && yf(n, "preload", this.options_.preload), s = ["loop", "muted", "playsinline", "autoplay"], r = 0; r < s.length; r++)i = s[r], f = this.options_[i], "undefined" != typeof f && (f ? yf(n, i, i) : to(n, i), n[i] = f); return n }, r.handleLateInit_ = function (n) { var i, t; if (0 !== n.networkState && 3 !== n.networkState) { if (0 === n.readyState) { function n() { i = !0 } i = !1; this.on("loadstart", n); function t() { i || this.trigger("loadstart") } return this.on("loadedmetadata", t), void this.ready(function () { this.off("loadstart", n); this.off("loadedmetadata", t); i || this.trigger("loadstart") }) } t = ["loadstart"]; t.push("loadedmetadata"); 2 <= n.readyState && t.push("loadeddata"); 3 <= n.readyState && t.push("canplay"); 4 <= n.readyState && t.push("canplaythrough"); this.ready(function () { t.forEach(function (n) { this.trigger(n) }, this) }) } }, r.setCurrentTime = function (n) { try { this.el_.currentTime = n } catch (n) { c(n, "Video is not ready. (Video.js)") } }, r.duration = function () { var n = this; return this.el_.duration === 1 / 0 && ki && li && 0 === this.el_.currentTime ? (this.on("timeupdate", function t() { 0 < n.el_.currentTime && (n.el_.duration === 1 / 0 && n.trigger("durationchange"), n.off("timeupdate", t)) }), NaN) : this.el_.duration || NaN }, r.width = function () { return this.el_.offsetWidth }, r.height = function () { return this.el_.offsetHeight }, r.proxyWebkitFullscreen_ = function () { var n = this; if ("webkitDisplayingFullscreen" in this.el_) { function t() { this.trigger("fullscreenchange", { isFullscreen: !1 }) } function i() { "webkitPresentationMode" in this.el_ && "picture-in-picture" !== this.el_.webkitPresentationMode && (this.one("webkitendfullscreen", t), this.trigger("fullscreenchange", { isFullscreen: !0 })) } this.on("webkitbeginfullscreen", i); this.on("dispose", function () { n.off("webkitbeginfullscreen", i); n.off("webkitendfullscreen", t) }) } }, r.supportsFullScreen = function () { if ("function" == typeof this.el_.webkitEnterFullScreen) { var t = n.navigator && n.navigator.userAgent || ""; if (/Android/.test(t) || !/Chrome|Mac OS X 10.5/.test(t)) return !0 } return !1 }, r.enterFullScreen = function () { var n = this.el_; n.paused && n.networkState <= n.HAVE_METADATA ? (this.el_.play(), this.setTimeout(function () { n.pause(); n.webkitEnterFullScreen() }, 0)) : n.webkitEnterFullScreen() }, r.exitFullScreen = function () { this.el_.webkitExitFullScreen() }, r.requestPictureInPicture = function () { return this.el_.requestPictureInPicture() }, r.src = function (n) { if (void 0 === n) return this.el_.src; this.setSrc(n) }, r.reset = function () { u.resetMediaElement(this.el_) }, r.currentSrc = function () { return this.currentSource_ ? this.currentSource_.src : this.el_.currentSrc }, r.setControls = function (n) { this.el_.controls = !!n }, r.addTextTrack = function (n, t, r) { return this.featuresNativeTextTracks ? this.el_.addTextTrack(n, t, r) : i.prototype.addTextTrack.call(this, n, t, r) }, r.createRemoteTextTrack = function (n) { if (!this.featuresNativeTextTracks) return i.prototype.createRemoteTextTrack.call(this, n); var r = t.createElement("track"); return n.kind && (r.kind = n.kind), n.label && (r.label = n.label), (n.language || n.srclang) && (r.srclang = n.language || n.srclang), n.default && (r.default = n.default), n.id && (r.id = n.id), n.src && (r.src = n.src), r }, r.addRemoteTextTrack = function (n, t) { var r = i.prototype.addRemoteTextTrack.call(this, n, t); return this.featuresNativeTextTracks && this.el().appendChild(r), r }, r.removeRemoteTextTrack = function (n) { if (i.prototype.removeRemoteTextTrack.call(this, n), this.featuresNativeTextTracks) for (var t = this.$$("track"), r = t.length; r--;)n !== t[r] && n !== t[r].track || this.el().removeChild(t[r]) }, r.getVideoPlaybackQuality = function () { if ("function" == typeof this.el().getVideoPlaybackQuality) return this.el().getVideoPlaybackQuality(); var t = {}; return "undefined" != typeof this.el().webkitDroppedFrameCount && "undefined" != typeof this.el().webkitDecodedFrameCount && (t.droppedVideoFrames = this.el().webkitDroppedFrameCount, t.totalVideoFrames = this.el().webkitDecodedFrameCount), n.performance && "function" == typeof n.performance.now ? t.creationTime = n.performance.now() : n.performance && n.performance.timing && "number" == typeof n.performance.timing.navigationStart && (t.creationTime = n.Date.now() - n.performance.timing.navigationStart), t }, u }(v); ru() && (u.TEST_VID = t.createElement("video"), se = t.createElement("track"), se.kind = "captions", se.srclang = "en", se.label = "English", u.TEST_VID.appendChild(se)); u.isSupported = function () { try { u.TEST_VID.volume = .5 } catch (n) { return !1 } return !(!u.TEST_VID || !u.TEST_VID.canPlayType) }; u.canPlayType = function (n) { return u.TEST_VID.canPlayType(n) }; u.canPlaySource = function (n) { return u.canPlayType(n.type) }; u.canControlVolume = function () { try { var n = u.TEST_VID.volume; return u.TEST_VID.volume = n / 2 + .1, n !== u.TEST_VID.volume } catch (n) { return !1 } }; u.canMuteVolume = function () { try { var n = u.TEST_VID.muted; return u.TEST_VID.muted = !n, u.TEST_VID.muted ? yf(u.TEST_VID, "muted", "muted") : to(u.TEST_VID, "muted"), n !== u.TEST_VID.muted } catch (n) { return !1 } }; u.canControlPlaybackRate = function () { if (ki && li && rb < 58) return !1; try { var n = u.TEST_VID.playbackRate; return u.TEST_VID.playbackRate = n / 2 + .1, n !== u.TEST_VID.playbackRate } catch (n) { return !1 } }; u.canOverrideAttributes = function () { try { function n() { } Object.defineProperty(t.createElement("video"), "src", { get: n, set: n }); Object.defineProperty(t.createElement("audio"), "src", { get: n, set: n }); Object.defineProperty(t.createElement("video"), "innerHTML", { get: n, set: n }); Object.defineProperty(t.createElement("audio"), "innerHTML", { get: n, set: n }) } catch (n) { return !1 } return !0 }; u.supportsNativeTextTracks = function () { return gc || ui && li }; u.supportsNativeVideoTracks = function () { return !(!u.TEST_VID || !u.TEST_VID.videoTracks) }; u.supportsNativeAudioTracks = function () { return !(!u.TEST_VID || !u.TEST_VID.audioTracks) }; u.Events = ["loadstart", "suspend", "abort", "error", "emptied", "stalled", "loadedmetadata", "loadeddata", "canplay", "canplaythrough", "playing", "waiting", "seeking", "seeked", "ended", "durationchange", "timeupdate", "progress", "play", "pause", "ratechange", "resize", "volumechange"]; u.prototype.featuresVolumeControl = u.canControlVolume(); u.prototype.featuresMuteControl = u.canMuteVolume(); u.prototype.featuresPlaybackRate = u.canControlPlaybackRate(); u.prototype.featuresSourceset = u.canOverrideAttributes(); u.prototype.movingMediaElementInDOM = !ui; u.prototype.featuresFullscreenResize = !0; u.prototype.featuresProgressEvents = !0; u.prototype.featuresTimeupdateEvents = !0; u.prototype.featuresNativeTextTracks = u.supportsNativeTextTracks(); u.prototype.featuresNativeVideoTracks = u.supportsNativeVideoTracks(); u.prototype.featuresNativeAudioTracks = u.supportsNativeAudioTracks(); fv = u.TEST_VID && u.TEST_VID.constructor.prototype.canPlayType; tn = /^application\/(?:x-|vnd\.apple\.)mpegurl/i; u.patchCanPlayType = function () { 4 <= bc && !ib && !li && (u.TEST_VID.constructor.prototype.canPlayType = function (n) { return n && tn.test(n) ? "maybe" : fv.call(this, n) }) }; u.unpatchCanPlayType = function () { var n = u.TEST_VID.constructor.prototype.canPlayType; return u.TEST_VID.constructor.prototype.canPlayType = fv, n }; u.patchCanPlayType(); u.disposeMediaElement = function (n) { if (n) { for (n.parentNode && n.parentNode.removeChild(n); n.hasChildNodes();)n.removeChild(n.firstChild); n.removeAttribute("src"); "function" == typeof n.load && function () { try { n.load() } catch (n) { } }() } }; u.resetMediaElement = function (n) { if (n) { for (var t = n.querySelectorAll("source"), i = t.length; i--;)n.removeChild(t[i]); n.removeAttribute("src"); "function" == typeof n.load && function () { try { n.load() } catch (n) { } }() } };["muted", "defaultMuted", "autoplay", "controls", "loop", "playsinline"].forEach(function (n) { u.prototype[n] = function () { return this.el_[n] || this.el_.hasAttribute(n) } });["muted", "defaultMuted", "autoplay", "loop", "playsinline"].forEach(function (n) { u.prototype["set" + b(n)] = function (t) { (this.el_[n] = t) ? this.el_.setAttribute(n, n) : this.el_.removeAttribute(n) } });["paused", "currentTime", "buffered", "volume", "poster", "preload", "error", "seeking", "seekable", "ended", "playbackRate", "defaultPlaybackRate", "played", "networkState", "readyState", "videoWidth", "videoHeight"].forEach(function (n) { u.prototype[n] = function () { return this.el_[n] } });["volume", "src", "poster", "preload", "playbackRate", "defaultPlaybackRate"].forEach(function (n) { u.prototype["set" + b(n)] = function (t) { this.el_[n] = t } });["pause", "load", "play"].forEach(function (n) { u.prototype[n] = function () { return this.el_[n]() } }); v.withSourceHandlers(u); u.nativeSourceHandler = {}; u.nativeSourceHandler.canPlayType = function (n) { try { return u.TEST_VID.canPlayType(n) } catch (n) { return "" } }; u.nativeSourceHandler.canHandleSource = function (n) { if (n.type) return u.nativeSourceHandler.canPlayType(n.type); if (n.src) { var t = ol(n.src); return u.nativeSourceHandler.canPlayType("video/" + t) } return "" }; u.nativeSourceHandler.handleSource = function (n, t) { t.setSrc(n.src) }; u.nativeSourceHandler.dispose = function () { }; u.registerSourceHandler(u.nativeSourceHandler); v.registerTech("Html5", u); var rn = ["progress", "abort", "suspend", "emptied", "stalled", "loadedmetadata", "loadeddata", "timeupdate", "resize", "volumechange", "texttrackchange"], ev = { canplay: "CanPlay", canplaythrough: "CanPlayThrough", playing: "Playing", seeked: "Seeked" }, ov = ["tiny", "xsmall", "small", "medium", "large", "xlarge", "huge"], ps = {}; ov.forEach(function (n) { var t = "x" === n.charAt(0) ? "x-" + n.substring(1) : n; ps[n] = "vjs-layout-" + t }); un = { tiny: 210, xsmall: 320, small: 425, medium: 768, large: 1440, xlarge: 2560, huge: 1 / 0 }; d = function (i) { function e(n, t, r) { var u, o, f, c, l, v; if (n.id = n.id || t.id || "vjs_video_" + pi(), (t = y(e.getTagSettings(n), t)).initChildren = !1, t.createEl = !1, t.evented = !1, t.reportTouchActivity = !1, !t.language) if ("function" == typeof n.closest) o = n.closest("[lang]"), o && o.getAttribute && (t.language = o.getAttribute("lang")); else for (f = n; f && 1 === f.nodeType;) { if (ci(f).hasOwnProperty("lang")) { t.language = f.getAttribute("lang"); break } f = f.parentNode } if ((u = i.call(this, null, t, r) || this).boundDocumentFullscreenChange_ = h(s(u), u.documentFullscreenChange_), u.boundFullWindowOnEscKey_ = h(s(u), u.fullWindowOnEscKey), u.log = ep(u.id_), u.fsApi_ = tl, u.isPosterFromTech_ = !1, u.queuedCallbacks_ = [], u.isReady_ = !1, u.hasStarted_ = !1, u.userActive_ = !1, !u.options_ || !u.options_.techOrder || !u.options_.techOrder.length) throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?"); return (u.tag = n, u.tagAttributes = n && ci(n), u.language(u.options_.language), t.languages) ? (c = {}, Object.getOwnPropertyNames(t.languages).forEach(function (n) { c[n.toLowerCase()] = t.languages[n] }), u.languages_ = c) : u.languages_ = e.prototype.options_.languages, u.resetCache_(), u.poster_ = t.poster || "", u.controls_ = !!t.controls, n.controls = !1, n.removeAttribute("controls"), u.changingSrc_ = !1, u.playCallbacks_ = [], u.playTerminatedQueue_ = [], n.hasAttribute("autoplay") ? u.autoplay(!0) : u.autoplay(u.options_.autoplay), t.plugins && Object.keys(t.plugins).forEach(function (n) { if ("function" != typeof u[n]) throw new Error('plugin "' + n + '" does not exist'); }), u.scrubbing_ = !1, u.el_ = u.createEl(), cc(s(u), { eventBusKey: "el_" }), u.fluid_ && u.on("playerreset", u.updateStyleEl_), l = a(u.options_), t.plugins && Object.keys(t.plugins).forEach(function (n) { u[n](t.plugins[n]) }), u.options_.playerOptions = l, u.middleware_ = [], u.initChildren(), u.isAudio("audio" === n.nodeName.toLowerCase()), u.controls() ? u.addClass("vjs-controls-enabled") : u.addClass("vjs-controls-disabled"), u.el_.setAttribute("role", "region"), u.isAudio() ? u.el_.setAttribute("aria-label", u.localize("Audio Player")) : u.el_.setAttribute("aria-label", u.localize("Video Player")), u.isAudio() && u.addClass("vjs-audio"), u.flexNotSupported_() && u.addClass("vjs-no-flex"), bf && u.addClass("vjs-touch-enabled"), ui || u.addClass("vjs-workinghover"), e.players[u.id_] = s(u), v = up.split(".")[0], u.addClass("vjs-v" + v), u.userActive(!0), u.reportUserActivity(), u.one("play", u.listenForUserActivity_), u.on("stageclick", u.handleStageClick_), u.on("keydown", u.handleKeyDown), u.breakpoints(u.options_.breakpoints), u.responsive(u.options_.responsive), u } f(e, i); var u = e.prototype; return u.dispose = function () { var n = this; this.trigger("dispose"); this.off("dispose"); nt(t, this.fsApi_.fullscreenchange, this.boundDocumentFullscreenChange_); nt(t, "keydown", this.boundFullWindowOnEscKey_); this.styleEl_ && this.styleEl_.parentNode && (this.styleEl_.parentNode.removeChild(this.styleEl_), this.styleEl_ = null); e.players[this.id_] = null; this.tag && this.tag.player && (this.tag.player = null); this.el_ && this.el_.player && (this.el_.player = null); this.tech_ && (this.tech_.dispose(), this.isPosterFromTech_ = !1, this.poster_ = ""); this.playerElIngest_ && (this.playerElIngest_ = null); this.tag && (this.tag = null), function (n) { na[n.id()] = null }(this); ut.names.forEach(function (t) { var r = ut[t], i = n[r.getterName](); i && i.off && i.off() }); i.prototype.dispose.call(this) }, u.createEl = function () { var u, r = this.tag, s = this.playerElIngest_ = r.parentNode && r.parentNode.hasAttribute && r.parentNode.hasAttribute("data-vjs-player"), e = "video-js" === this.tag.tagName.toLowerCase(), f, h, c, l, o, a; if (s ? u = this.el_ = r.parentNode : e || (u = this.el_ = i.prototype.createEl.call(this, "div")), f = ci(r), e) { for (u = this.el_ = r, r = this.tag = t.createElement("video"); u.children.length;)r.appendChild(u.firstChild); ir(u, "video-js") || hi(u, "video-js"); u.appendChild(r); s = this.playerElIngest_ = u; Object.keys(u).forEach(function (n) { try { r[n] = u[n] } catch (n) { } }) } for ((r.setAttribute("tabindex", "-1"), f.tabindex = "-1", (dc || li && fb) && (r.setAttribute("role", "application"), f.role = "application"), r.removeAttribute("width"), r.removeAttribute("height"), "width" in f && delete f.width, "height" in f && delete f.height, Object.getOwnPropertyNames(f).forEach(function (n) { e && "class" === n || u.setAttribute(n, f[n]); e && r.setAttribute(n, f[n]) }), r.playerId = r.id, r.id += "_html5_api", r.className = "vjs-tech", r.player = u.player = this, this.addClass("vjs-paused"), !0 !== n.VIDEOJS_NO_DYNAMIC_STYLE) && (this.styleEl_ = uw("vjs-styles-dimensions"), h = yi(".vjs-styles-defaults"), c = yi("head"), c.insertBefore(this.styleEl_, h ? h.nextSibling : c.firstChild)), this.fill_ = !1, this.fluid_ = !1, this.width(this.options_.width), this.height(this.options_.height), this.fill(this.options_.fill), this.fluid(this.options_.fluid), this.aspectRatio(this.options_.aspectRatio), l = r.getElementsByTagName("a"), o = 0; o < l.length; o++)a = l.item(o), hi(a, "vjs-hidden"), a.setAttribute("hidden", "hidden"); return r.initNetworkState_ = r.networkState, r.parentNode && !s && r.parentNode.insertBefore(u, r), gh(r, u), this.children_.unshift(r), this.el_.setAttribute("lang", this.language_), this.el_ = u }, u.width = function (n) { return this.dimension("width", n) }, u.height = function (n) { return this.dimension("height", n) }, u.dimension = function (n, t) { var i = n + "_", r; if (void 0 === t) return this[i] || 0; if ("" === t) return this[i] = void 0, void this.updateStyleEl_(); r = parseFloat(t); isNaN(r) ? c.error('Improper value "' + t + '" supplied for for ' + n) : (this[i] = r, this.updateStyleEl_()) }, u.fluid = function (n) { if (void 0 === n) return !!this.fluid_; this.fluid_ = !!n; bi(this) && this.off("playerreset", this.updateStyleEl_); n ? (this.addClass("vjs-fluid"), this.fill(!1), function (n, t) { bi(n) ? t() : (n.eventedCallbacks || (n.eventedCallbacks = []), n.eventedCallbacks.push(t)) }(function () { this.on("playerreset", this.updateStyleEl_) })) : this.removeClass("vjs-fluid"); this.updateStyleEl_() }, u.fill = function (n) { if (void 0 === n) return !!this.fill_; this.fill_ = !!n; n ? (this.addClass("vjs-fill"), this.fluid(!1)) : this.removeClass("vjs-fill") }, u.aspectRatio = function (n) { if (void 0 === n) return this.aspectRatio_; if (!/^\d+\:\d+$/.test(n)) throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9."); this.aspectRatio_ = n; this.fluid(!0); this.updateStyleEl_() }, u.updateStyleEl_ = function () { var r, e, t, u, i; if (!0 !== n.VIDEOJS_NO_DYNAMIC_STYLE) u = (void 0 !== this.aspectRatio_ && "auto" !== this.aspectRatio_ ? this.aspectRatio_ : 0 < this.videoWidth() ? this.videoWidth() + ":" + this.videoHeight() : "16:9").split(":"), i = u[1] / u[0], r = void 0 !== this.width_ ? this.width_ : void 0 !== this.height_ ? this.height_ / i : this.videoWidth() || 300, e = void 0 !== this.height_ ? this.height_ : r * i, t = /^[^a-zA-Z]/.test(this.id()) ? "dimensions-" + this.id() : this.id() + "-dimensions", this.addClass(t), fw(this.styleEl_, "\n      ." + t + " {\n        width: " + r + "px;\n        height: " + e + "px;\n      }\n\n      ." + t + ".vjs-fluid {\n        padding-top: " + 100 * i + "%;\n      }\n    "); else { var o = "number" == typeof this.width_ ? this.width_ : this.options_.width, s = "number" == typeof this.height_ ? this.height_ : this.options_.height, f = this.tech_ && this.tech_.el(); f && (0 <= o && (f.width = o), 0 <= s && (f.height = s)) } }, u.loadTech_ = function (n, t) { var i = this, u, f, r, e; if (this.tech_ && this.unloadTech_(), u = b(n), f = n.charAt(0).toLowerCase() + n.slice(1), "Html5" !== u && this.tag && (v.getTech("Html5").disposeMediaElement(this.tag), this.tag.player = null, this.tag = null), this.techName_ = u, this.isReady_ = !1, r = { source: t, autoplay: "string" != typeof this.autoplay() && this.autoplay(), nativeControlsForTouch: this.options_.nativeControlsForTouch, playerId: this.id(), techId: this.id() + "_" + f + "_api", playsinline: this.options_.playsinline, preload: this.options_.preload, loop: this.options_.loop, muted: this.options_.muted, poster: this.poster(), language: this.language(), playerElIngest: this.playerElIngest_ || !1, "vtt.js": this.options_["vtt.js"], canOverridePoster: !!this.options_.techCanOverridePoster, enableSourceset: this.options_.enableSourceset, Promise: this.options_.Promise }, ut.names.forEach(function (n) { var t = ut[n]; r[t.getterName] = i[t.privateName] }), y(r, this.options_[u]), y(r, this.options_[f]), y(r, this.options_[n.toLowerCase()]), this.tag && (r.tag = this.tag), t && t.src === this.cache_.src && 0 < this.cache_.currentTime && (r.startTime = this.cache_.currentTime), e = v.getTech(n), !e) throw new Error("No Tech named '" + u + "' exists! '" + u + "' should be registered using videojs.registerTech()'"); this.tech_ = new e(r); this.tech_.ready(h(this, this.handleTechReady_), !0); ab(this.textTracksJson_ || [], this.tech_); rn.forEach(function (n) { i.on(i.tech_, n, i["handleTech" + b(n) + "_"]) }); Object.keys(ev).forEach(function (n) { i.on(i.tech_, n, function (t) { 0 === i.tech_.playbackRate() && i.tech_.seeking() ? i.queuedCallbacks_.push({ callback: i["handleTech" + ev[n] + "_"].bind(i), event: t }) : i["handleTech" + ev[n] + "_"](t) }) }); this.on(this.tech_, "loadstart", this.handleTechLoadStart_); this.on(this.tech_, "sourceset", this.handleTechSourceset_); this.on(this.tech_, "waiting", this.handleTechWaiting_); this.on(this.tech_, "ended", this.handleTechEnded_); this.on(this.tech_, "seeking", this.handleTechSeeking_); this.on(this.tech_, "play", this.handleTechPlay_); this.on(this.tech_, "firstplay", this.handleTechFirstPlay_); this.on(this.tech_, "pause", this.handleTechPause_); this.on(this.tech_, "durationchange", this.handleTechDurationChange_); this.on(this.tech_, "fullscreenchange", this.handleTechFullscreenChange_); this.on(this.tech_, "enterpictureinpicture", this.handleTechEnterPictureInPicture_); this.on(this.tech_, "leavepictureinpicture", this.handleTechLeavePictureInPicture_); this.on(this.tech_, "error", this.handleTechError_); this.on(this.tech_, "loadedmetadata", this.updateStyleEl_); this.on(this.tech_, "posterchange", this.handleTechPosterChange_); this.on(this.tech_, "textdata", this.handleTechTextData_); this.on(this.tech_, "ratechange", this.handleTechRateChange_); this.usingNativeControls(this.techGet_("controls")); this.controls() && !this.usingNativeControls() && this.addTechControlsListeners_(); this.tech_.el().parentNode === this.el() || "Html5" === u && this.tag || gh(this.tech_.el(), this.el()); this.tag && (this.tag.player = null, this.tag = null) }, u.unloadTech_ = function () { var n = this; ut.names.forEach(function (t) { var i = ut[t]; n[i.privateName] = n[i.getterName]() }); this.textTracksJson_ = lb(this.tech_); this.isReady_ = !1; this.tech_.dispose(); this.tech_ = !1; this.isPosterFromTech_ && (this.poster_ = "", this.trigger("posterchange")); this.isPosterFromTech_ = !1 }, u.tech = function (n) { return void 0 === n && c.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"), this.tech_ }, u.addTechControlsListeners_ = function () { this.removeTechControlsListeners_(); this.on(this.tech_, "mouseup", this.handleTechClick_); this.on(this.tech_, "dblclick", this.handleTechDoubleClick_); this.on(this.tech_, "touchstart", this.handleTechTouchStart_); this.on(this.tech_, "touchmove", this.handleTechTouchMove_); this.on(this.tech_, "touchend", this.handleTechTouchEnd_); this.on(this.tech_, "tap", this.handleTechTap_) }, u.removeTechControlsListeners_ = function () { this.off(this.tech_, "tap", this.handleTechTap_); this.off(this.tech_, "touchstart", this.handleTechTouchStart_); this.off(this.tech_, "touchmove", this.handleTechTouchMove_); this.off(this.tech_, "touchend", this.handleTechTouchEnd_); this.off(this.tech_, "mouseup", this.handleTechClick_); this.off(this.tech_, "dblclick", this.handleTechDoubleClick_) }, u.handleTechReady_ = function () { this.triggerReady(); this.cache_.volume && this.techCall_("setVolume", this.cache_.volume); this.handleTechPosterChange_(); this.handleTechDurationChange_() }, u.handleTechLoadStart_ = function () { this.removeClass("vjs-ended"); this.removeClass("vjs-seeking"); this.error(null); this.handleTechDurationChange_(); this.paused() ? (this.hasStarted(!1), this.trigger("loadstart")) : (this.trigger("loadstart"), this.trigger("firstplay")); this.manualAutoplay_(this.autoplay()) }, u.manualAutoplay_ = function (n) { var t = this, i; if (this.tech_ && "string" == typeof n) { function r() { function i() { t.muted(r) } var r = t.muted(), n; return t.muted(!0), t.playTerminatedQueue_.push(i), n = t.play(), gf(n) ? n.catch(i) : void 0 } if ("any" === n && !0 !== this.muted() ? gf(i = this.play()) && (i = i.catch(r)) : i = "muted" === n && !0 !== this.muted() ? r() : this.play(), gf(i)) return i.then(function () { t.trigger({ type: "autoplay-success", autoplay: n }) }).catch(function () { t.trigger({ type: "autoplay-failure", autoplay: n }) }) } }, u.updateSourceCaches_ = function (n) { var t, i, r; void 0 === n && (n = ""); t = n; i = ""; "string" != typeof t && (t = n.src, i = n.type); this.cache_.source = this.cache_.source || {}; this.cache_.sources = this.cache_.sources || []; t && !i && (i = function (n, t) { var u, f, r, i; if (!t) return ""; if (n.cache_.source.src === t && n.cache_.source.type) return n.cache_.source.type; if (u = n.cache_.sources.filter(function (n) { return n.src === t }), u.length) return u[0].type; for (f = n.$$("source"), r = 0; r < f.length; r++)if (i = f[r], i.type && i.src && i.src === t) return i.type; return wo(t) }(this, t)); this.cache_.source = a({}, n, { src: t, type: i }); for (var f = this.cache_.sources.filter(function (n) { return n.src && n.src === t }), e = [], o = this.$$("source"), s = [], u = 0; u < o.length; u++)r = ci(o[u]), e.push(r), r.src && r.src === t && s.push(r.src); s.length && !f.length ? this.cache_.sources = e : f.length || (this.cache_.sources = [this.cache_.source]); this.cache_.src = t }, u.handleTechSourceset_ = function (n) { var t = this; if (!this.changingSrc_) { var u = function (n) { return t.updateSourceCaches_(n) }, i = this.currentSource().src, r = n.src; i && !/^blob:/.test(i) && /^blob:/.test(r) && (this.lastSource_ && (this.lastSource_.tech === r || this.lastSource_.player === i) || (u = function () { })); u(r); n.src || this.tech_.any(["sourceset", "loadstart"], function (n) { if ("sourceset" !== n.type) { var i = t.techGet("currentSrc"); t.lastSource_.tech = i; t.updateSourceCaches_(i) } }) } this.lastSource_ = { player: this.currentSource().src, tech: n.src }; this.trigger({ src: n.src, type: "sourceset" }) }, u.hasStarted = function (n) { if (void 0 === n) return this.hasStarted_; n !== this.hasStarted_ && (this.hasStarted_ = n, this.hasStarted_ ? (this.addClass("vjs-has-started"), this.trigger("firstplay")) : this.removeClass("vjs-has-started")) }, u.handleTechPlay_ = function () { this.removeClass("vjs-ended"); this.removeClass("vjs-paused"); this.addClass("vjs-playing"); this.hasStarted(!0); this.trigger("play") }, u.handleTechRateChange_ = function () { 0 < this.tech_.playbackRate() && 0 === this.cache_.lastPlaybackRate && (this.queuedCallbacks_.forEach(function (n) { return n.callback(n.event) }), this.queuedCallbacks_ = []); this.cache_.lastPlaybackRate = this.tech_.playbackRate(); this.trigger("ratechange") }, u.handleTechWaiting_ = function () { var n = this, t; this.addClass("vjs-waiting"); this.trigger("waiting"); t = this.currentTime(); this.on("timeupdate", function i() { t !== n.currentTime() && (n.removeClass("vjs-waiting"), n.off("timeupdate", i)) }) }, u.handleTechCanPlay_ = function () { this.removeClass("vjs-waiting"); this.trigger("canplay") }, u.handleTechCanPlayThrough_ = function () { this.removeClass("vjs-waiting"); this.trigger("canplaythrough") }, u.handleTechPlaying_ = function () { this.removeClass("vjs-waiting"); this.trigger("playing") }, u.handleTechSeeking_ = function () { this.addClass("vjs-seeking"); this.trigger("seeking") }, u.handleTechSeeked_ = function () { this.removeClass("vjs-seeking"); this.removeClass("vjs-ended"); this.trigger("seeked") }, u.handleTechFirstPlay_ = function () { this.options_.starttime && (c.warn("Passing the `starttime` option to the player will be deprecated in 6.0"), this.currentTime(this.options_.starttime)); this.addClass("vjs-has-started"); this.trigger("firstplay") }, u.handleTechPause_ = function () { this.removeClass("vjs-playing"); this.addClass("vjs-paused"); this.trigger("pause") }, u.handleTechEnded_ = function () { this.addClass("vjs-ended"); this.options_.loop ? (this.currentTime(0), this.play()) : this.paused() || this.pause(); this.trigger("ended") }, u.handleTechDurationChange_ = function () { this.duration(this.techGet_("duration")) }, u.handleTechClick_ = function (n) { fu(n) && this.controls_ && (this.paused() ? di(this.play()) : this.pause()) }, u.handleTechDoubleClick_ = function (n) { this.controls_ && (Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"), function (t) { return t.contains(n.target) }) || void 0 !== this.options_ && void 0 !== this.options_.userActions && void 0 !== this.options_.userActions.doubleClick && !1 === this.options_.userActions.doubleClick || (void 0 !== this.options_ && void 0 !== this.options_.userActions && "function" == typeof this.options_.userActions.doubleClick ? this.options_.userActions.doubleClick.call(this, n) : this.isFullscreen() ? this.exitFullscreen() : this.requestFullscreen())) }, u.handleTechTap_ = function () { this.userActive(!this.userActive()) }, u.handleTechTouchStart_ = function () { this.userWasActive = this.userActive() }, u.handleTechTouchMove_ = function () { this.userWasActive && this.reportUserActivity() }, u.handleTechTouchEnd_ = function (n) { n.preventDefault() }, u.handleStageClick_ = function () { this.reportUserActivity() }, u.toggleFullscreenClass_ = function () { this.isFullscreen() ? this.addClass("vjs-fullscreen") : this.removeClass("vjs-fullscreen") }, u.documentFullscreenChange_ = function () { var n = this.el(), i = t[this.fsApi_.fullscreenElement] === n; !i && n.matches ? i = n.matches(":" + this.fsApi_.fullscreen) : !i && n.msMatchesSelector && (i = n.msMatchesSelector(":" + this.fsApi_.fullscreen)); this.isFullscreen(i); !1 === this.isFullscreen() && nt(t, this.fsApi_.fullscreenchange, this.boundDocumentFullscreenChange_); this.fsApi_.prefixed && this.trigger("fullscreenchange") }, u.handleTechFullscreenChange_ = function (n, t) { t && this.isFullscreen(t.isFullscreen); this.trigger("fullscreenchange") }, u.togglePictureInPictureClass_ = function () { this.isInPictureInPicture() ? this.addClass("vjs-picture-in-picture") : this.removeClass("vjs-picture-in-picture") }, u.handleTechEnterPictureInPicture_ = function () { this.isInPictureInPicture(!0) }, u.handleTechLeavePictureInPicture_ = function () { this.isInPictureInPicture(!1) }, u.handleTechError_ = function () { var n = this.tech_.error(); this.error(n) }, u.handleTechTextData_ = function (n, t) { var i = null; 1 < arguments.length && (i = t); this.trigger("textdata", i) }, u.getCache = function () { return this.cache_ }, u.resetCache_ = function () { this.cache_ = { currentTime: 0, inactivityTimeout: this.options_.inactivityTimeout, duration: NaN, lastVolume: 1, lastPlaybackRate: this.defaultPlaybackRate(), media: null, src: "", source: {}, sources: [], volume: 1 } }, u.techCall_ = function (n, t) { this.ready(function () { if (n in ket) return function (n, t, i, r) { return t[i](n.reduce(ta(i), r)) }(this.middleware_, this.tech_, n, t); if (n in ld) return cd(this.middleware_, this.tech_, n, t); try { this.tech_ && this.tech_[n](t) } catch (n) { throw c(n), n; } }, !0) }, u.techGet_ = function (n) { if (this.tech_ && this.tech_.isReady_) { if (n in bet) return function (n, t, i) { return n.reduceRight(ta(i), t[i]()) }(this.middleware_, this.tech_, n); if (n in ld) return cd(this.middleware_, this.tech_, n); try { return this.tech_[n]() } catch (t) { if (void 0 === this.tech_[n]) throw c("Video.js: " + n + " method not defined for " + this.techName_ + " playback technology.", t), t; if ("TypeError" === t.name) throw c("Video.js: " + n + " unavailable on " + this.techName_ + " playback technology element.", t), this.tech_.isReady_ = !1, t; throw c(t), t; } } }, u.play = function () { var i = this, t = this.options_.Promise || n.Promise; return t ? new t(function (n) { i.play_(n) }) : this.play_() }, u.play_ = function (n) { var r = this, t, i; if (void 0 === n && (n = di), this.playCallbacks_.push(n), t = Boolean(!this.changingSrc_ && (this.src() || this.currentSrc())), this.waitToPlay_ && (this.off(["ready", "loadstart"], this.waitToPlay_), this.waitToPlay_ = null), !this.isReady_ || !t) return this.waitToPlay_ = function () { r.play_() }, this.one(["ready", "loadstart"], this.waitToPlay_), void (t || !gc && !ui || this.load()); i = this.techGet_("play"); null === i ? this.runPlayTerminatedQueue_() : this.runPlayCallbacks_(i) }, u.runPlayTerminatedQueue_ = function () { var n = this.playTerminatedQueue_.slice(0); this.playTerminatedQueue_ = []; n.forEach(function (n) { n() }) }, u.runPlayCallbacks_ = function (n) { var t = this.playCallbacks_.slice(0); this.playCallbacks_ = []; this.playTerminatedQueue_ = []; t.forEach(function (t) { t(n) }) }, u.pause = function () { this.techCall_("pause") }, u.paused = function () { return !1 !== this.techGet_("paused") }, u.played = function () { return this.techGet_("played") || ur(0, 0) }, u.scrubbing = function (n) { if ("undefined" == typeof n) return this.scrubbing_; this.scrubbing_ = !!n; n ? this.addClass("vjs-scrubbing") : this.removeClass("vjs-scrubbing") }, u.currentTime = function (n) { return "undefined" != typeof n ? (n < 0 && (n = 0), void this.techCall_("setCurrentTime", n)) : (this.cache_.currentTime = this.techGet_("currentTime") || 0, this.cache_.currentTime) }, u.duration = function (n) { if (void 0 === n) return void 0 !== this.cache_.duration ? this.cache_.duration : NaN; (n = parseFloat(n)) < 0 && (n = 1 / 0); n !== this.cache_.duration && ((this.cache_.duration = n) === 1 / 0 ? (this.addClass("vjs-live"), this.options_.liveui && this.player_.liveTracker && this.addClass("vjs-liveui")) : (this.removeClass("vjs-live"), this.removeClass("vjs-liveui")), isNaN(n) || this.trigger("durationchange")) }, u.remainingTime = function () { return this.duration() - this.currentTime() }, u.remainingTimeDisplay = function () { return Math.floor(this.duration()) - Math.floor(this.currentTime()) }, u.buffered = function () { var n = this.techGet_("buffered"); return n && n.length || (n = ur(0, 0)), n }, u.bufferedPercent = function () { return ob(this.buffered(), this.duration()) }, u.bufferedEnd = function () { var t = this.buffered(), i = this.duration(), n = t.end(t.length - 1); return i < n && (n = i), n }, u.volume = function (n) { var t; return void 0 !== n ? (t = Math.max(0, Math.min(1, parseFloat(n))), this.cache_.volume = t, this.techCall_("setVolume", t), void (0 < t && this.lastVolume_(t))) : (t = parseFloat(this.techGet_("volume")), isNaN(t) ? 1 : t) }, u.muted = function (n) { if (void 0 === n) return this.techGet_("muted") || !1; this.techCall_("setMuted", n) }, u.defaultMuted = function (n) { return void 0 !== n ? this.techCall_("setDefaultMuted", n) : this.techGet_("defaultMuted") || !1 }, u.lastVolume_ = function (n) { if (void 0 === n || 0 === n) return this.cache_.lastVolume; this.cache_.lastVolume = n }, u.supportsFullScreen = function () { return this.techGet_("supportsFullScreen") || !1 }, u.isFullscreen = function (n) { return void 0 !== n ? (this.isFullscreen_ = !!n, void this.toggleFullscreenClass_()) : !!this.isFullscreen_ }, u.requestFullscreen = function (n) { var i; this.isFullscreen(!0); this.fsApi_.requestFullscreen ? (yt(t, this.fsApi_.fullscreenchange, this.boundDocumentFullscreenChange_), this.fsApi_.prefixed || (i = this.options_.fullscreen && this.options_.fullscreen.options || {}, void 0 !== n && (i = n)), di(this.el_[this.fsApi_.requestFullscreen](i))) : this.tech_.supportsFullScreen() ? this.techCall_("enterFullScreen") : (this.enterFullWindow(), this.trigger("fullscreenchange")) }, u.exitFullscreen = function () { this.isFullscreen(!1); this.fsApi_.requestFullscreen ? di(t[this.fsApi_.exitFullscreen]()) : this.tech_.supportsFullScreen() ? this.techCall_("exitFullScreen") : (this.exitFullWindow(), this.trigger("fullscreenchange")) }, u.enterFullWindow = function () { this.isFullWindow = !0; this.docOrigOverflow = t.documentElement.style.overflow; yt(t, "keydown", this.boundFullWindowOnEscKey_); t.documentElement.style.overflow = "hidden"; hi(t.body, "vjs-full-window"); this.trigger("enterFullWindow") }, u.fullWindowOnEscKey = function (n) { o.isEventKey(n, "Esc") && (!0 === this.isFullscreen() ? this.exitFullscreen() : this.exitFullWindow()) }, u.exitFullWindow = function () { this.isFullWindow = !1; nt(t, "keydown", this.boundFullWindowOnEscKey_); t.documentElement.style.overflow = this.docOrigOverflow; vf(t.body, "vjs-full-window"); this.trigger("exitFullWindow") }, u.isInPictureInPicture = function (n) { return void 0 !== n ? (this.isInPictureInPicture_ = !!n, void this.togglePictureInPictureClass_()) : !!this.isInPictureInPicture_ }, u.requestPictureInPicture = function () { if ("pictureInPictureEnabled" in t) return this.techGet_("requestPictureInPicture") }, u.exitPictureInPicture = function () { if ("pictureInPictureEnabled" in t) return t.exitPictureInPicture() }, u.handleKeyDown = function (n) { var t = this.options_.userActions; t && t.hotkeys && (function (n) { var t = n.tagName.toLowerCase(); return n.isContentEditable ? !0 : "input" === t ? -1 === ["button", "checkbox", "hidden", "radio", "reset", "submit"].indexOf(n.type) : -1 !== ["textarea"].indexOf(t) }(this.el_.ownerDocument.activeElement) || ("function" == typeof t.hotkeys ? t.hotkeys.call(this, n) : this.handleHotkeys(n))) }, u.handleHotkeys = function (n) { var i = this.options_.userActions ? this.options_.userActions.hotkeys : {}, u = i.fullscreenKey, h = void 0 === u ? function (n) { return o.isEventKey(n, "f") } : u, f = i.muteKey, c = void 0 === f ? function (n) { return o.isEventKey(n, "m") } : f, e = i.playPauseKey, l = void 0 === e ? function (n) { return o.isEventKey(n, "k") || o.isEventKey(n, "Space") } : e, s; h.call(this, n) ? (n.preventDefault(), n.stopPropagation(), s = r.getComponent("FullscreenToggle"), !1 !== t[this.fsApi_.fullscreenEnabled] && s.prototype.handleClick.call(this, n)) : c.call(this, n) ? (n.preventDefault(), n.stopPropagation(), r.getComponent("MuteToggle").prototype.handleClick.call(this, n)) : l.call(this, n) && (n.preventDefault(), n.stopPropagation(), r.getComponent("PlayToggle").prototype.handleClick.call(this, n)) }, u.canPlayType = function (n) { for (var e, u, t, i = 0, f = this.options_.techOrder; i < f.length; i++)if (u = f[i], t = v.getTech(u), t = t || r.getComponent(u)) { if (t.isSupported() && (e = t.canPlayType(n))) return e } else c.error('The "' + u + '" tech is undefined. Skipped browser support check for that tech.'); return "" }, u.selectSource = function (n) { function t(n, t, i) { var r; return n.some(function (n) { return t.some(function (t) { if (r = i(n, t)) return !0 }) }), r } function i(n, t) { var i = n[0]; if (n[1].canPlaySource(t, f.options_[i.toLowerCase()])) return { source: t, tech: i } } var r, f = this, u = this.options_.techOrder.map(function (n) { return [n, v.getTech(n)] }).filter(function (n) { var i = n[0], t = n[1]; return t ? t.isSupported() : (c.error('The "' + i + '" tech is undefined. Skipped browser support check for that tech.'), !1) }); return (this.options_.sourceOrder ? t(n, u, (r = i, function (n, t) { return r(t, n) })) : t(u, n, i)) || !1 }, u.src = function (n) { var t = this, i; if ("undefined" == typeof n) return this.cache_.src || ""; i = function r(n) { if (Array.isArray(n)) { var t = []; n.forEach(function (n) { n = r(n); Array.isArray(n) ? t = t.concat(n) : vi(n) && t.push(n) }); n = t } else n = "string" == typeof n && n.trim() ? [vd({ src: n })] : vi(n) && "string" == typeof n.src && n.src && n.src.trim() ? [vd(n)] : []; return n }(n); i.length ? (this.changingSrc_ = !0, this.cache_.sources = i, this.updateSourceCaches_(i[0]), wet(this, i[0], function (n, r) { if (t.middleware_ = r, t.cache_.sources = i, t.updateSourceCaches_(n), t.src_(n)) return 1 < i.length ? t.src(i.slice(1)) : (t.changingSrc_ = !1, t.setTimeout(function () { this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) }) }, 0), void t.triggerReady()); !function (n, t) { n.forEach(function (n) { return n.setTech && n.setTech(t) }) }(r, t.tech_) })) : this.setTimeout(function () { this.error({ code: 4, message: this.localize(this.options_.notSupportedMessage) }) }, 0) }, u.src_ = function (n) { var i = this, t = this.selectSource([n]); return !t || (function (n, t) { return b(n) === b(t) }(t.tech, this.techName_) ? this.ready(function () { this.tech_.constructor.prototype.hasOwnProperty("setSource") ? this.techCall_("setSource", n) : this.techCall_("src", n.src); this.changingSrc_ = !1 }, !0) : (this.changingSrc_ = !0, this.loadTech_(t.tech, t.source), this.tech_.ready(function () { i.changingSrc_ = !1 })), !1) }, u.load = function () { this.techCall_("load") }, u.reset = function () { var t = this, i = this.options_.Promise || n.Promise; this.paused() || !i ? this.doReset_() : di(this.play().then(function () { return t.doReset_() })) }, u.doReset_ = function () { this.tech_ && this.tech_.clearTracks("text"); this.resetCache_(); this.poster(""); this.loadTech_(this.options_.techOrder[0], null); this.techCall_("reset"); this.resetControlBarUI_(); bi(this) && this.trigger("playerreset") }, u.resetControlBarUI_ = function () { this.resetProgressBar_(); this.resetPlaybackRate_(); this.resetVolumeBar_() }, u.resetProgressBar_ = function () { this.currentTime(0); var n = this.controlBar, t = n.durationDisplay, i = n.remainingTimeDisplay; t && t.updateContent(); i && i.updateContent() }, u.resetPlaybackRate_ = function () { this.playbackRate(this.defaultPlaybackRate()); this.handleTechRateChange_() }, u.resetVolumeBar_ = function () { this.volume(1); this.trigger("volumechange") }, u.currentSources = function () { var n = this.currentSource(), t = []; return 0 !== Object.keys(n).length && t.push(n), this.cache_.sources || t }, u.currentSource = function () { return this.cache_.source || {} }, u.currentSrc = function () { return this.currentSource() && this.currentSource().src || "" }, u.currentType = function () { return this.currentSource() && this.currentSource().type || "" }, u.preload = function (n) { return void 0 !== n ? (this.techCall_("setPreload", n), void (this.options_.preload = n)) : this.techGet_("preload") }, u.autoplay = function (n) { if (void 0 === n) return this.options_.autoplay || !1; var t; "string" == typeof n && /(any|play|muted)/.test(n) ? (this.options_.autoplay = n, this.manualAutoplay_(n), t = !1) : this.options_.autoplay = !!n; t = "undefined" == typeof t ? this.options_.autoplay : t; this.tech_ && this.techCall_("setAutoplay", t) }, u.playsinline = function (n) { return void 0 !== n ? (this.techCall_("setPlaysinline", n), this.options_.playsinline = n, this) : this.techGet_("playsinline") }, u.loop = function (n) { return void 0 !== n ? (this.techCall_("setLoop", n), void (this.options_.loop = n)) : this.techGet_("loop") }, u.poster = function (n) { if (void 0 === n) return this.poster_; (n = n || "") !== this.poster_ && (this.poster_ = n, this.techCall_("setPoster", n), this.isPosterFromTech_ = !1, this.trigger("posterchange")) }, u.handleTechPosterChange_ = function () { if ((!this.poster_ || this.options_.techCanOverridePoster) && this.tech_ && this.tech_.poster) { var n = this.tech_.poster() || ""; n !== this.poster_ && (this.poster_ = n, this.isPosterFromTech_ = !0, this.trigger("posterchange")) } }, u.controls = function (n) { if (void 0 === n) return !!this.controls_; n = !!n; this.controls_ !== n && (this.controls_ = n, this.usingNativeControls() && this.techCall_("setControls", n), this.controls_ ? (this.removeClass("vjs-controls-disabled"), this.addClass("vjs-controls-enabled"), this.trigger("controlsenabled"), this.usingNativeControls() || this.addTechControlsListeners_()) : (this.removeClass("vjs-controls-enabled"), this.addClass("vjs-controls-disabled"), this.trigger("controlsdisabled"), this.usingNativeControls() || this.removeTechControlsListeners_())) }, u.usingNativeControls = function (n) { if (void 0 === n) return !!this.usingNativeControls_; n = !!n; this.usingNativeControls_ !== n && (this.usingNativeControls_ = n, this.usingNativeControls_ ? (this.addClass("vjs-using-native-controls"), this.trigger("usingnativecontrols")) : (this.removeClass("vjs-using-native-controls"), this.trigger("usingcustomcontrols"))) }, u.error = function (n) { if (void 0 === n) return this.error_ || null; if (this.options_.suppressNotSupportedError && n && n.message && n.message === this.localize(this.options_.notSupportedMessage)) { function t() { this.error(n) } return this.options_.suppressNotSupportedError = !1, this.any(["click", "touchstart"], t), void this.one("loadstart", function () { this.off(["click", "touchstart"], t) }) } if (null === n) return this.error_ = n, this.removeClass("vjs-error"), void (this.errorDisplay && this.errorDisplay.close()); this.error_ = new et(n); this.addClass("vjs-error"); c.error("(CODE:" + this.error_.code + " " + et.errorTypes[this.error_.code] + ")", this.error_.message, this.error_); this.trigger("error") }, u.reportUserActivity = function () { this.userActivity_ = !0 }, u.userActive = function (n) { if (void 0 === n) return this.userActive_; if ((n = !!n) !== this.userActive_) { if (this.userActive_ = n, this.userActive_) return this.userActivity_ = !0, this.removeClass("vjs-user-inactive"), this.addClass("vjs-user-active"), void this.trigger("useractive"); this.tech_ && this.tech_.one("mousemove", function (n) { n.stopPropagation(); n.preventDefault() }); this.userActivity_ = !1; this.removeClass("vjs-user-active"); this.addClass("vjs-user-inactive"); this.trigger("userinactive") } }, u.listenForUserActivity_ = function () { var i, r, u, n = h(this, this.reportUserActivity), f, t; this.on("mousedown", function () { n(); this.clearInterval(i); i = this.setInterval(n, 250) }); this.on("mousemove", function (t) { t.screenX === r && t.screenY === u || (r = t.screenX, u = t.screenY, n()) }); this.on("mouseup", function () { n(); this.clearInterval(i) }); t = this.getChild("controlBar"); !t || ui || ki || (t.on("mouseenter", function () { this.player().cache_.inactivityTimeout = this.player().options_.inactivityTimeout; this.player().options_.inactivityTimeout = 0 }), t.on("mouseleave", function () { this.player().options_.inactivityTimeout = this.player().cache_.inactivityTimeout })); this.on("keydown", n); this.on("keyup", n); this.setInterval(function () { if (this.userActivity_) { this.userActivity_ = !1; this.userActive(!0); this.clearTimeout(f); var n = this.options_.inactivityTimeout; n <= 0 || (f = this.setTimeout(function () { this.userActivity_ || this.userActive(!1) }, n)) } }, 250) }, u.playbackRate = function (n) { if (void 0 === n) return this.tech_ && this.tech_.featuresPlaybackRate ? this.cache_.lastPlaybackRate || this.techGet_("playbackRate") : 1; this.techCall_("setPlaybackRate", n) }, u.defaultPlaybackRate = function (n) { return void 0 !== n ? this.techCall_("setDefaultPlaybackRate", n) : this.tech_ && this.tech_.featuresPlaybackRate ? this.techGet_("defaultPlaybackRate") : 1 }, u.isAudio = function (n) { if (void 0 === n) return !!this.isAudio_; this.isAudio_ = !!n }, u.addTextTrack = function (n, t, i) { if (this.tech_) return this.tech_.addTextTrack(n, t, i) }, u.addRemoteTextTrack = function (n, t) { if (this.tech_) return this.tech_.addRemoteTextTrack(n, t) }, u.removeRemoteTextTrack = function (n) { void 0 === n && (n = {}); var t = n.track; if (t = t || n, this.tech_) return this.tech_.removeRemoteTextTrack(t) }, u.getVideoPlaybackQuality = function () { return this.techGet_("getVideoPlaybackQuality") }, u.videoWidth = function () { return this.tech_ && this.tech_.videoWidth && this.tech_.videoWidth() || 0 }, u.videoHeight = function () { return this.tech_ && this.tech_.videoHeight && this.tech_.videoHeight() || 0 }, u.language = function (n) { if (void 0 === n) return this.language_; this.language_ = String(n).toLowerCase() }, u.languages = function () { return a(e.prototype.options_.languages, this.languages_) }, u.toJSON = function () { var t = a(this.options_), r = t.tracks, n, i; for (t.tracks = [], n = 0; n < r.length; n++)i = r[n], (i = a(i)).player = void 0, t.tracks[n] = i; return t }, u.createModal = function (n, t) { var r = this, i; return (t = t || {}).content = n || "", i = new ou(this, t), this.addChild(i), i.on("dispose", function () { r.removeChild(i) }), i.open(), i }, u.updateCurrentBreakpoint_ = function () { var n; if (this.responsive()) for (var t = this.currentBreakpoint(), r = this.currentWidth(), i = 0; i < ov.length; i++)if (n = ov[i], r <= this.breakpoints_[n]) { if (t === n) return; t && this.removeClass(ps[t]); this.addClass(ps[n]); this.breakpoint_ = n; break } }, u.removeCurrentBreakpoint_ = function () { var n = this.currentBreakpointClass(); this.breakpoint_ = ""; n && this.removeClass(n) }, u.breakpoints = function (n) { return void 0 === n || (this.breakpoint_ = "", this.breakpoints_ = y({}, un, n), this.updateCurrentBreakpoint_()), y(this.breakpoints_) }, u.responsive = function (n) { return void 0 === n ? this.responsive_ : (n = Boolean(n)) !== this.responsive_ ? ((this.responsive_ = n) ? (this.on("playerresize", this.updateCurrentBreakpoint_), this.updateCurrentBreakpoint_()) : (this.off("playerresize", this.updateCurrentBreakpoint_), this.removeCurrentBreakpoint_()), n) : void 0 }, u.currentBreakpoint = function () { return this.breakpoint_ }, u.currentBreakpointClass = function () { return ps[this.breakpoint_] || "" }, u.loadMedia = function (n, t) { var e = this; if (n && "object" == typeof n) { this.reset(); this.cache_.media = a(n); var r = this.cache_.media, o = r.artwork, i = r.poster, u = r.src, f = r.textTracks; !o && i && (this.cache_.media.artwork = [{ src: i, type: wo(i) }]); u && this.src(u); i && this.poster(i); Array.isArray(f) && f.forEach(function (n) { return e.addRemoteTextTrack(n, !1) }); this.ready(t) } }, u.getMedia = function () { if (this.cache_.media) return a(this.cache_.media); var t = this.poster(), n = { src: this.currentSources(), textTracks: Array.prototype.map.call(this.remoteTextTracks(), function (n) { return { kind: n.kind, label: n.label, language: n.language, src: n.src } }) }; return t && (n.poster = t, n.artwork = [{ src: n.poster, type: wo(n.poster) }]), n }, e.getTagSettings = function (n) { var i = { sources: [], tracks: [] }, t = ci(n), e = t["data-setup"], r, f; if (ir(n, "vjs-fill") && (t.fill = !0), ir(n, "vjs-fluid") && (t.fluid = !0), null !== e) { var o = hb(e || "{}"), s = o[0], l = o[1]; s && c.error(s); y(t, l) } if (y(i, t), n.hasChildNodes()) for (var h = n.childNodes, u = 0, a = h.length; u < a; u++)r = h[u], f = r.nodeName.toLowerCase(), "source" === f ? i.sources.push(ci(r)) : "track" === f && i.tracks.push(ci(r)); return i }, u.flexNotSupported_ = function () { var n = t.createElement("i"); return !("flexBasis" in n.style || "webkitFlexBasis" in n.style || "mozFlexBasis" in n.style || "msFlexBasis" in n.style || "msFlexOrder" in n.style) }, e }(r); ut.names.forEach(function (n) { var t = ut[n]; d.prototype[t.getterName] = function () { return this.tech_ ? this.tech_[t.getterName]() : (this[t.privateName] = this[t.privateName] || new t.ListClass, this[t.privateName]) } }); d.players = {}; wu = n.navigator; d.prototype.options_ = { techOrder: v.defaultTechOrder_, html5: {}, flash: {}, inactivityTimeout: 2e3, playbackRates: [], liveui: !1, children: ["mediaLoader", "posterImage", "textTrackDisplay", "loadingSpinner", "bigPlayButton", "liveTracker", "controlBar", "errorDisplay", "textTrackSettings", "resizeManager"], language: wu && (wu.languages && wu.languages[0] || wu.userLanguage || wu.language) || "en", languages: {}, notSupportedMessage: "No compatible source was found for this media.", fullscreen: { options: { navigationUI: "hide" } }, breakpoints: {}, responsive: !1 };["ended", "seeking", "seekable", "networkState", "readyState"].forEach(function (n) { d.prototype[n] = function () { return this.techGet_(n) } }); rn.forEach(function (n) { d.prototype["handleTech" + b(n) + "_"] = function () { return this.trigger(n) } }); r.registerComponent("Player", d); var ds = "plugin", bu = "activePlugins_", ku = {}, ei = function () { function n(t) { if (this.constructor === n) throw new Error("Plugin must be sub-classed; not directly instantiated."); this.player = t; cc(this); delete this.trigger; bw(this, this.constructor.defaultState); fn(t, this.name); this.dispose = h(this, this.dispose); t.on("dispose", this.dispose) } var t = n.prototype; return t.version = function () { return this.constructor.VERSION }, t.getEventHash = function (n) { return void 0 === n && (n = {}), n.name = this.name, n.plugin = this.constructor, n.instance = this, n }, t.trigger = function (n, t) { return void 0 === t && (t = {}), eu(this.eventBusEl_, n, this.getEventHash(t)) }, t.handleStateChanged = function () { }, t.dispose = function () { var n = this.name, t = this.player; this.trigger("dispose"); this.off(); t.off("dispose", this.dispose); t[bu][n] = !1; this.player = this.state = null; t[n] = en(n, ku[n]) }, n.isBasic = function (t) { var i = "string" == typeof t ? bs(t) : t; return "function" == typeof i && !n.prototype.isPrototypeOf(i.prototype) }, n.registerPlugin = function (t, i) { if ("string" != typeof t) throw new Error('Illegal plugin name, "' + t + '", must be a string, was ' + typeof t + "."); if (ws(t)) c.warn('A plugin named "' + t + '" already exists. You may want to avoid re-registering plugins!'); else if (d.prototype.hasOwnProperty(t)) throw new Error('Illegal plugin name, "' + t + '", cannot share a name with an existing player method!'); if ("function" != typeof i) throw new Error('Illegal plugin for "' + t + '", must be a function, was ' + typeof i + "."); return ku[t] = i, t !== ds && (d.prototype[t] = n.isBasic(i) ? function (n, t) { function i() { ks(this, { name: n, plugin: t, instance: null }, !0); var i = t.apply(this, arguments); return fn(this, n), ks(this, { name: n, plugin: t, instance: i }), i } return Object.keys(t).forEach(function (n) { i[n] = t[n] }), i }(t, i) : en(t, i)), i }, n.deregisterPlugin = function (n) { if (n === ds) throw new Error("Cannot de-register base plugin."); ws(n) && (delete ku[n], delete d.prototype[n]) }, n.getPlugins = function (n) { var t; return void 0 === n && (n = Object.keys(ku)), n.forEach(function (n) { var i = bs(n); i && ((t = t || {})[n] = i) }), t }, n.getPluginVersion = function (n) { var t = bs(n); return t && t.VERSION || "" }, n }(); ei.getPlugin = bs; ei.BASE_PLUGIN_NAME = ds; ei.registerPlugin(ds, ei); d.prototype.usingPlugin = function (n) { return !!this[bu] && !0 === this[bu][n] }; d.prototype.hasPlugin = function (n) { return !!ws(n) }; sv = function (n) { return 0 === n.indexOf("#") ? n.slice(1) : n }; (i.hooks_ = {}, i.hooks = function (n, t) { return i.hooks_[n] = i.hooks_[n] || [], t && (i.hooks_[n] = i.hooks_[n].concat(t)), i.hooks_[n] }, i.hook = function (n, t) { i.hooks(n, t) }, i.hookOnce = function (n, t) { i.hooks(n, [].concat(t).map(function (t) { return function r() { return i.removeHook(n, r), t.apply(void 0, arguments) } })) }, i.removeHook = function (n, t) { var r = i.hooks(n).indexOf(t); return !(r <= -1) && (i.hooks_[n] = i.hooks_[n].slice(), i.hooks_[n].splice(r, 1), !0) }, !0 !== n.VIDEOJS_NO_DYNAMIC_STYLE && ru()) && (he = yi(".vjs-styles-defaults"), he || (he = uw("vjs-styles-defaults"), gs = yi("head"), gs && gs.insertBefore(he, gs.firstChild), fw(he, "\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    "))); uc(1, i); i.VERSION = up; i.options = d.prototype.options_; i.getPlayers = function () { return d.players }; i.getPlayer = function (n) { var t, i = d.players, r, u; if ("string" == typeof n) { if (r = sv(n), u = i[r], u) return u; t = yi("#" + r) } else t = n; if (af(t)) { var f = t, e = f.player, o = f.playerId; if (e || i[o]) return e || i[o] } }; i.getAllPlayers = function () { return Object.keys(d.players).map(function (n) { return d.players[n] }).filter(Boolean) }; i.players = d.players; i.getComponent = r.getComponent; i.registerComponent = function (n, t) { v.isTech(t) && c.warn("The " + n + " tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"); r.registerComponent.call(r, n, t) }; i.getTech = v.getTech; i.registerTech = v.registerTech; i.use = function (n, t) { hr[n] = hr[n] || []; hr[n].push(t) }; Object.defineProperty(i, "middleware", { value: {}, writeable: !1, enumerable: !0 }); Object.defineProperty(i.middleware, "TERMINATOR", { value: po, writeable: !1, enumerable: !0 }); i.browser = out; i.TOUCH_ENABLED = bf; i.extend = function (n, t) { var i, r, u; void 0 === t && (t = {}); i = function () { n.apply(this, arguments) }; r = {}; for (u in "object" == typeof t ? (t.constructor !== Object.prototype.constructor && (i = t.constructor), r = t) : "function" == typeof t && (i = t), function (n, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); n.prototype = Object.create(t && t.prototype, { constructor: { value: n, enumerable: !1, writable: !0, configurable: !0 } }); t && (n.super_ = t) }(i, n), r) r.hasOwnProperty(u) && (i.prototype[u] = r[u]); return i }; i.mergeOptions = a; i.bind = h; i.registerPlugin = ei.registerPlugin; i.deregisterPlugin = ei.deregisterPlugin; i.plugin = function (n, t) { return c.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"), ei.registerPlugin(n, t) }; i.getPlugins = ei.getPlugins; i.getPlugin = ei.getPlugin; i.getPluginVersion = ei.getPluginVersion; i.addLanguage = function (n, t) { var r; return n = ("" + n).toLowerCase(), i.options.languages = a(i.options.languages, ((r = {})[n] = t, r)), i.options.languages[n] }; i.log = c; i.createLogger = ep; i.createTimeRange = i.createTimeRanges = ur; i.formatTime = vu; i.setFormatTime = function (n) { bo = n }; i.resetFormatTime = function () { bo = gd }; i.parseUrl = el; i.isCrossOrigin = oo; i.EventTarget = ft; i.on = yt; i.one = ro; i.off = nt; i.trigger = eu; i.xhr = dk; i.TextTrack = hu; i.AudioTrack = id; i.VideoTrack = rd;["isEl", "isTextNode", "createEl", "hasClass", "addClass", "removeClass", "toggleClass", "setAttributes", "getAttributes", "emptyEl", "appendContent", "insertContent"].forEach(function (n) { i[n] = function () { return c.warn("videojs." + n + "() is deprecated; use videojs.dom." + n + "() instead"), iw[n].apply(null, arguments) } }); i.computedStyle = no; i.dom = iw; i.url = yut; hv = il(function (n) { var i, r, u, f, t; i = /^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/; r = /^([^\/?#]*)(.*)$/; u = /(?:\/|^)\.(?=\/)/g; f = /(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g; t = { buildAbsoluteURL: function (n, i, u) { var s, f, e, h, o, c, l; if (u = u || {}, n = n.trim(), !(i = i.trim())) { if (!u.alwaysNormalize) return n; if (s = t.parseURL(n), !s) throw new Error("Error trying to parse base URL."); return s.path = t.normalizePath(s.path), t.buildURLFromParts(s) } if (f = t.parseURL(i), !f) throw new Error("Error trying to parse relative URL."); if (f.scheme) return u.alwaysNormalize ? (f.path = t.normalizePath(f.path), t.buildURLFromParts(f)) : i; if (e = t.parseURL(n), !e) throw new Error("Error trying to parse base URL."); return !e.netLoc && e.path && "/" !== e.path[0] && (h = r.exec(e.path), e.netLoc = h[1], e.path = h[2]), e.netLoc && !e.path && (e.path = "/"), o = { scheme: e.scheme, netLoc: f.netLoc, path: null, params: f.params, query: f.query, fragment: f.fragment }, f.netLoc || (o.netLoc = e.netLoc, "/" === f.path[0]) || (f.path ? (c = e.path, l = c.substring(0, c.lastIndexOf("/") + 1) + f.path, o.path = t.normalizePath(l)) : (o.path = e.path, f.params || (o.params = e.params, f.query || (o.query = e.query)))), null === o.path && (o.path = u.alwaysNormalize ? t.normalizePath(f.path) : f.path), t.buildURLFromParts(o) }, parseURL: function (n) { var t = i.exec(n); return t ? { scheme: t[1] || "", netLoc: t[2] || "", path: t[3] || "", params: t[4] || "", query: t[5] || "", fragment: t[6] || "" } : null }, normalizePath: function (n) { for (n = n.split("").reverse().join("").replace(u, ""); n.length !== (n = n.replace(f, "")).length;); return n.split("").reverse().join("") }, buildURLFromParts: function (n) { return n.scheme + n.netLoc + n.path + n.params + n.query + n.fragment } }; n.exports = t });
    /*! @name m3u8-parser @version 4.4.0 @license Apache-2.0 */
    var lv = function () { function t() { this.listeners = {} } var n = t.prototype; return n.on = function (n, t) { this.listeners[n] || (this.listeners[n] = []); this.listeners[n].push(t) }, n.off = function (n, t) { if (!this.listeners[n]) return !1; var i = this.listeners[n].indexOf(t); return this.listeners[n].splice(i, 1), -1 < i }, n.trigger = function (n, t) { var i, u, f, r = this.listeners[n]; if (r) if (2 === arguments.length) for (u = r.length, i = 0; i < u; ++i)r[i].call(this, t); else for (f = Array.prototype.slice.call(arguments, 1), u = r.length, i = 0; i < u; ++i)r[i].apply(this, f) }, n.dispose = function () { this.listeners = {} }, n.pipe = function (n) { this.on("data", function (t) { n.push(t) }) }, t }(), iot = function (n) { function t() { var t; return (t = n.call(this) || this).buffer = "", t } return cv(t, n), t.prototype.push = function (n) { var t; for (this.buffer += n, t = this.buffer.indexOf("\n"); -1 < t; t = this.buffer.indexOf("\n"))this.trigger("data", this.buffer.substring(0, t)), this.buffer = this.buffer.substring(t + 1) }, t }(lv), rot = function (n) { function t() { var t; return (t = n.call(this) || this).customParsers = [], t.tagMappers = [], t } cv(t, n); var i = t.prototype; return i.push = function (n) { var i, t, r = this; 0 !== (n = n.trim()).length && ("#" === n[0] ? this.tagMappers.reduce(function (t, i) { var r = i(n); return r === n ? t : t.concat([r]) }, [n]).forEach(function (n) { for (var u, f, o, e = 0; e < r.customParsers.length; e++)if (r.customParsers[e].call(r, n)) return; if (0 === n.indexOf("#EXT")) if (n = n.replace("\r", ""), i = /^#EXTM3U/.exec(n)) r.trigger("data", { type: "tag", tagType: "m3u" }); else { if (i = /^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(n)) return t = { type: "tag", tagType: "inf" }, i[1] && (t.duration = parseFloat(i[1])), i[2] && (t.title = i[2]), void r.trigger("data", t); if (i = /^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(n)) return t = { type: "tag", tagType: "targetduration" }, i[1] && (t.duration = parseInt(i[1], 10)), void r.trigger("data", t); if (i = /^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(n)) return t = { type: "tag", tagType: "totalduration" }, i[1] && (t.duration = parseInt(i[1], 10)), void r.trigger("data", t); if (i = /^#EXT-X-VERSION:?([0-9.]*)?/.exec(n)) return t = { type: "tag", tagType: "version" }, i[1] && (t.version = parseInt(i[1], 10)), void r.trigger("data", t); if (i = /^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(n)) return t = { type: "tag", tagType: "media-sequence" }, i[1] && (t.number = parseInt(i[1], 10)), void r.trigger("data", t); if (i = /^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(n)) return t = { type: "tag", tagType: "discontinuity-sequence" }, i[1] && (t.number = parseInt(i[1], 10)), void r.trigger("data", t); if (i = /^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(n)) return t = { type: "tag", tagType: "playlist-type" }, i[1] && (t.playlistType = i[1]), void r.trigger("data", t); if (i = /^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(n)) return t = { type: "tag", tagType: "byterange" }, i[1] && (t.length = parseInt(i[1], 10)), i[2] && (t.offset = parseInt(i[2], 10)), void r.trigger("data", t); if (i = /^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(n)) return t = { type: "tag", tagType: "allow-cache" }, i[1] && (t.allowed = !/NO/.test(i[1])), void r.trigger("data", t); if (i = /^#EXT-X-MAP:?(.*)$/.exec(n)) { if ((t = { type: "tag", tagType: "map" }, i[1]) && (u = ce(i[1]), u.URI && (t.uri = u.URI), u.BYTERANGE)) { var s = u.BYTERANGE.split("@"), h = s[0], c = s[1]; t.byterange = {}; h && (t.byterange.length = parseInt(h, 10)); c && (t.byterange.offset = parseInt(c, 10)) } r.trigger("data", t) } else if (i = /^#EXT-X-STREAM-INF:?(.*)$/.exec(n)) (t = { type: "tag", tagType: "stream-inf" }, i[1]) && ((t.attributes = ce(i[1]), t.attributes.RESOLUTION) && (f = t.attributes.RESOLUTION.split("x"), o = {}, f[0] && (o.width = parseInt(f[0], 10)), f[1] && (o.height = parseInt(f[1], 10)), t.attributes.RESOLUTION = o), t.attributes.BANDWIDTH && (t.attributes.BANDWIDTH = parseInt(t.attributes.BANDWIDTH, 10)), t.attributes["PROGRAM-ID"] && (t.attributes["PROGRAM-ID"] = parseInt(t.attributes["PROGRAM-ID"], 10))), r.trigger("data", t); else { if (i = /^#EXT-X-MEDIA:?(.*)$/.exec(n)) return t = { type: "tag", tagType: "media" }, i[1] && (t.attributes = ce(i[1])), void r.trigger("data", t); if (i = /^#EXT-X-ENDLIST/.exec(n)) r.trigger("data", { type: "tag", tagType: "endlist" }); else if (i = /^#EXT-X-DISCONTINUITY/.exec(n)) r.trigger("data", { type: "tag", tagType: "discontinuity" }); else { if (i = /^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(n)) return t = { type: "tag", tagType: "program-date-time" }, i[1] && (t.dateTimeString = i[1], t.dateTimeObject = new Date(i[1])), void r.trigger("data", t); if (i = /^#EXT-X-KEY:?(.*)$/.exec(n)) return t = { type: "tag", tagType: "key" }, i[1] && (t.attributes = ce(i[1]), t.attributes.IV && ("0x" === t.attributes.IV.substring(0, 2).toLowerCase() && (t.attributes.IV = t.attributes.IV.substring(2)), t.attributes.IV = t.attributes.IV.match(/.{8}/g), t.attributes.IV[0] = parseInt(t.attributes.IV[0], 16), t.attributes.IV[1] = parseInt(t.attributes.IV[1], 16), t.attributes.IV[2] = parseInt(t.attributes.IV[2], 16), t.attributes.IV[3] = parseInt(t.attributes.IV[3], 16), t.attributes.IV = new Uint32Array(t.attributes.IV))), void r.trigger("data", t); if (i = /^#EXT-X-START:?(.*)$/.exec(n)) return t = { type: "tag", tagType: "start" }, i[1] && (t.attributes = ce(i[1]), t.attributes["TIME-OFFSET"] = parseFloat(t.attributes["TIME-OFFSET"]), t.attributes.PRECISE = /YES/.test(t.attributes.PRECISE)), void r.trigger("data", t); if (i = /^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(n)) return t = { type: "tag", tagType: "cue-out-cont" }, t.data = i[1] ? i[1] : "", void r.trigger("data", t); if (i = /^#EXT-X-CUE-OUT:?(.*)?$/.exec(n)) return t = { type: "tag", tagType: "cue-out" }, t.data = i[1] ? i[1] : "", void r.trigger("data", t); if (i = /^#EXT-X-CUE-IN:?(.*)?$/.exec(n)) return t = { type: "tag", tagType: "cue-in" }, t.data = i[1] ? i[1] : "", void r.trigger("data", t); r.trigger("data", { type: "tag", data: n.slice(4) }) } } } else r.trigger("data", { type: "comment", text: n.slice(1) }) }) : this.trigger("data", { type: "uri", uri: n })) }, i.addParser = function (n) { var i = this, r = n.expression, u = n.customType, t = n.dataParser, f = n.segment; "function" != typeof t && (t = function (n) { return n }); this.customParsers.push(function (n) { if (r.exec(n)) return i.trigger("data", { type: "custom", data: t(n), customType: u, segment: f }), !0 }) }, i.addTagMapper = function (n) { var t = n.expression, i = n.map; this.tagMappers.push(function (n) { return t.test(n) ? i(n) : n }) }, t }(lv); var cn = function (t) { function r() { var r; (r = t.call(this) || this).lineStream = new iot; r.parseStream = new rot; r.lineStream.pipe(r.parseStream); var u, f, s = function (n) { if (void 0 === n) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return n }(r), e = [], i = {}, h = { AUDIO: {}, VIDEO: {}, "CLOSED-CAPTIONS": {}, SUBTITLES: {} }, o = 0; return r.manifest = { allowCache: !0, discontinuityStarts: [], segments: [] }, r.parseStream.on("data", function (t) { var c, r; ({ tag: function () { ({ "allow-cache": function () { this.manifest.allowCache = t.allowed; "allowed" in t || (this.trigger("info", { message: "defaulting allowCache to YES" }), this.manifest.allowCache = !0) }, byterange: function () { var n = {}; "length" in t && ((i.byterange = n).length = t.length, "offset" in t || (this.trigger("info", { message: "defaulting offset to zero" }), t.offset = 0)); "offset" in t && ((i.byterange = n).offset = t.offset) }, endlist: function () { this.manifest.endList = !0 }, inf: function () { "mediaSequence" in this.manifest || (this.manifest.mediaSequence = 0, this.trigger("info", { message: "defaulting media sequence to zero" })); "discontinuitySequence" in this.manifest || (this.manifest.discontinuitySequence = 0, this.trigger("info", { message: "defaulting discontinuity sequence to zero" })); 0 < t.duration && (i.duration = t.duration); 0 === t.duration && (i.duration = .01, this.trigger("info", { message: "updating zero segment duration to a small value" })); this.manifest.segments = e }, key: function () { if (t.attributes) if ("NONE" !== t.attributes.METHOD) if (t.attributes.URI) { if ("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed" === t.attributes.KEYFORMAT) return -1 === ["SAMPLE-AES", "SAMPLE-AES-CTR", "SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD) ? void this.trigger("warn", { message: "invalid key method provided for Widevine" }) : ("SAMPLE-AES-CENC" === t.attributes.METHOD && this.trigger("warn", { message: "SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead" }), "data:text/plain;base64," !== t.attributes.URI.substring(0, 23) ? void this.trigger("warn", { message: "invalid key URI provided for Widevine" }) : t.attributes.KEYID && "0x" === t.attributes.KEYID.substring(0, 2) ? void (this.manifest.contentProtection = { "com.widevine.alpha": { attributes: { schemeIdUri: t.attributes.KEYFORMAT, keyId: t.attributes.KEYID.substring(2) }, pssh: function (t) { for (var r = n.atob(t || ""), u = new Uint8Array(r.length), i = 0; i < r.length; i++)u[i] = r.charCodeAt(i); return u }(t.attributes.URI.split(",")[1]) } }) : void this.trigger("warn", { message: "invalid key ID provided for Widevine" })); t.attributes.METHOD || this.trigger("warn", { message: "defaulting key method to AES-128" }); f = { method: t.attributes.METHOD || "AES-128", uri: t.attributes.URI }; "undefined" != typeof t.attributes.IV && (f.iv = t.attributes.IV) } else this.trigger("warn", { message: "ignoring key declaration without URI" }); else f = null; else this.trigger("warn", { message: "ignoring key declaration without attribute list" }) }, "media-sequence": function () { isFinite(t.number) ? this.manifest.mediaSequence = t.number : this.trigger("warn", { message: "ignoring invalid media sequence: " + t.number }) }, "discontinuity-sequence": function () { isFinite(t.number) ? (this.manifest.discontinuitySequence = t.number, o = t.number) : this.trigger("warn", { message: "ignoring invalid discontinuity sequence: " + t.number }) }, "playlist-type": function () { /VOD|EVENT/.test(t.playlistType) ? this.manifest.playlistType = t.playlistType : this.trigger("warn", { message: "ignoring unknown playlist type: " + t.playlist }) }, map: function () { u = {}; t.uri && (u.uri = t.uri); t.byterange && (u.byterange = t.byterange) }, "stream-inf": function () { this.manifest.playlists = e; this.manifest.mediaGroups = this.manifest.mediaGroups || h; t.attributes ? (i.attributes || (i.attributes = {}), on(i.attributes, t.attributes)) : this.trigger("warn", { message: "ignoring empty stream-inf attributes" }) }, media: function () { if (this.manifest.mediaGroups = this.manifest.mediaGroups || h, t.attributes && t.attributes.TYPE && t.attributes["GROUP-ID"] && t.attributes.NAME) { var n = this.manifest.mediaGroups[t.attributes.TYPE]; n[t.attributes["GROUP-ID"]] = n[t.attributes["GROUP-ID"]] || {}; c = n[t.attributes["GROUP-ID"]]; r.autoselect = (r = { "default": /yes/i.test(t.attributes.DEFAULT) }).default ? !0 : /yes/i.test(t.attributes.AUTOSELECT); t.attributes.LANGUAGE && (r.language = t.attributes.LANGUAGE); t.attributes.URI && (r.uri = t.attributes.URI); t.attributes["INSTREAM-ID"] && (r.instreamId = t.attributes["INSTREAM-ID"]); t.attributes.CHARACTERISTICS && (r.characteristics = t.attributes.CHARACTERISTICS); t.attributes.FORCED && (r.forced = /yes/i.test(t.attributes.FORCED)); c[t.attributes.NAME] = r } else this.trigger("warn", { message: "ignoring incomplete or missing media group" }) }, discontinuity: function () { o += 1; i.discontinuity = !0; this.manifest.discontinuityStarts.push(e.length) }, "program-date-time": function () { "undefined" == typeof this.manifest.dateTimeString && (this.manifest.dateTimeString = t.dateTimeString, this.manifest.dateTimeObject = t.dateTimeObject); i.dateTimeString = t.dateTimeString; i.dateTimeObject = t.dateTimeObject }, targetduration: function () { !isFinite(t.duration) || t.duration < 0 ? this.trigger("warn", { message: "ignoring invalid target duration: " + t.duration }) : this.manifest.targetDuration = t.duration }, totalduration: function () { !isFinite(t.duration) || t.duration < 0 ? this.trigger("warn", { message: "ignoring invalid total duration: " + t.duration }) : this.manifest.totalDuration = t.duration }, start: function () { t.attributes && !isNaN(t.attributes["TIME-OFFSET"]) ? this.manifest.start = { timeOffset: t.attributes["TIME-OFFSET"], precise: t.attributes.PRECISE } : this.trigger("warn", { message: "ignoring start declaration without appropriate attribute list" }) }, "cue-out": function () { i.cueOut = t.data }, "cue-out-cont": function () { i.cueOutCont = t.data }, "cue-in": function () { i.cueIn = t.data } }[t.tagType] || function () { }).call(s) }, uri: function () { i.uri = t.uri; e.push(i); !this.manifest.targetDuration || "duration" in i || (this.trigger("warn", { message: "defaulting segment duration to the target duration" }), i.duration = this.manifest.targetDuration); f && (i.key = f); i.timeline = o; u && (i.map = u); i = {} }, comment: function () { }, custom: function () { t.segment ? (i.custom = i.custom || {}, i.custom[t.customType] = t.data) : (this.manifest.custom = this.manifest.custom || {}, this.manifest.custom[t.customType] = t.data) } })[t.type].call(s) }), r } cv(r, t); var i = r.prototype; return i.push = function (n) { this.lineStream.push(n) }, i.end = function () { this.lineStream.push("\n") }, i.addParser = function (n) { this.parseStream.addParser(n) }, i.addTagMapper = function (n) { this.parseStream.addTagMapper(n) }, r }(lv), uot = "INVALID_NUMBER_OF_PERIOD", fot = "DASH_EMPTY_MANIFEST", eot = "DASH_INVALID_XML", oot = "NO_BASE_URL", sot = "SEGMENT_TIME_UNSPECIFIED", hot = "UNSUPPORTED_UTC_TIMING_SCHEME";
    /*! @name mpd-parser @version 0.8.1 @license Apache-2.0 */
    var pv, wn = (function (n) { var i, r, u, f, t; i = /^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/; r = /^([^\/?#]*)(.*)$/; u = /(?:\/|^)\.(?=\/)/g; f = /(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g; t = { buildAbsoluteURL: function (n, i, u) { var s, f, e, h, o, c, l; if (u = u || {}, n = n.trim(), !(i = i.trim())) { if (!u.alwaysNormalize) return n; if (s = t.parseURL(n), !s) throw new Error("Error trying to parse base URL."); return s.path = t.normalizePath(s.path), t.buildURLFromParts(s) } if (f = t.parseURL(i), !f) throw new Error("Error trying to parse relative URL."); if (f.scheme) return u.alwaysNormalize ? (f.path = t.normalizePath(f.path), t.buildURLFromParts(f)) : i; if (e = t.parseURL(n), !e) throw new Error("Error trying to parse base URL."); return !e.netLoc && e.path && "/" !== e.path[0] && (h = r.exec(e.path), e.netLoc = h[1], e.path = h[2]), e.netLoc && !e.path && (e.path = "/"), o = { scheme: e.scheme, netLoc: f.netLoc, path: null, params: f.params, query: f.query, fragment: f.fragment }, f.netLoc || (o.netLoc = e.netLoc, "/" === f.path[0]) || (f.path ? (c = e.path, l = c.substring(0, c.lastIndexOf("/") + 1) + f.path, o.path = t.normalizePath(l)) : (o.path = e.path, f.params || (o.params = e.params, f.query || (o.query = e.query)))), null === o.path && (o.path = u.alwaysNormalize ? t.normalizePath(f.path) : f.path), t.buildURLFromParts(o) }, parseURL: function (n) { var t = i.exec(n); return t ? { scheme: t[1] || "", netLoc: t[2] || "", path: t[3] || "", params: t[4] || "", query: t[5] || "", fragment: t[6] || "" } : null }, normalizePath: function (n) { for (n = n.split("").reverse().join("").replace(u, ""); n.length !== (n = n.replace(f, "")).length;); return n.split("").reverse().join("") }, buildURLFromParts: function (n) { return n.scheme + n.netLoc + n.path + n.params + n.query + n.fragment } }; n.exports = t }(pv = { exports: {} }, pv.exports), pv.exports), wot = { static: function (n) { var i = n.duration, t = n.timescale, r = void 0 === t ? 1 : t, u = n.sourceDuration; return { start: 0, end: Math.ceil(u / (i / r)) } }, dynamic: function (n) { var h = n.NOW, c = n.clientOffset, l = n.availabilityStartTime, f = n.timescale, t = void 0 === f ? 1 : f, i = n.duration, e = n.start, a = void 0 === e ? 0 : e, o = n.minimumUpdatePeriod, v = void 0 === o ? 0 : o, s = n.timeShiftBufferDepth, y = void 0 === s ? 1 / 0 : s, r = (h + c) / 1e3, u = l + a, p = r + v - u, w = Math.ceil(p * t / i), b = Math.floor((r - u - y) * t / i), k = Math.floor((r - u) * t / i); return { start: Math.max(0, b), end: Math.min(w, k) } } }, bot = /\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g, bn = { mediaPresentationDuration: function (n) { return ae(n) }, availabilityStartTime: function (n) { return function (n) { return /^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(n) && (n += "Z"), Date.parse(n) }(n) / 1e3 }, minimumUpdatePeriod: function (n) { return ae(n) }, timeShiftBufferDepth: function (n) { return ae(n) }, start: function (n) { return ae(n) }, width: function (n) { return parseInt(n, 10) }, height: function (n) { return parseInt(n, 10) }, bandwidth: function (n) { return parseInt(n, 10) }, startNumber: function (n) { return parseInt(n, 10) }, timescale: function (n) { return parseInt(n, 10) }, duration: function (n) { var t = parseInt(n, 10); return isNaN(t) ? ae(n) : t }, d: function (n) { return parseInt(n, 10) }, t: function (n) { return parseInt(n, 10) }, r: function (n) { return parseInt(n, 10) }, DEFAULT: function (n) { return n } }; var it, vr, gn, ntt, ttt, itt, tst = { "urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b": "org.w3.clearkey", "urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed": "com.widevine.alpha", "urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95": "com.microsoft.playready", "urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb": "com.adobe.primetime" }, yr = function (n) { return n >>> 0 }, ve = function (n) { return ("00" + n.toString(16)).slice(-2) }; gn = function (n) { return it(n, ["moov", "trak"]).reduce(function (n, t) { var r, f, i, e, u; return (r = it(t, ["tkhd"])[0]) ? (f = r[0], e = yr(r[i = 0 === f ? 12 : 20] << 24 | r[i + 1] << 16 | r[i + 2] << 8 | r[i + 3]), (u = it(t, ["mdia", "mdhd"])[0]) ? (i = 0 === (f = u[0]) ? 12 : 20, n[e] = yr(u[i] << 24 | u[i + 1] << 16 | u[i + 2] << 8 | u[i + 3]), n) : null) : null }, {}) }; ntt = function (n, t) { var r, u, i; return r = it(t, ["moof", "traf"]), u = [].concat.apply([], r.map(function (t) { return it(t, ["tfhd"]).map(function (i) { var r, u; return r = yr(i[4] << 24 | i[5] << 16 | i[6] << 8 | i[7]), u = n[r] || 9e4, (it(t, ["tfdt"]).map(function (n) { var i, t; return i = n[0], t = yr(n[4] << 24 | n[5] << 16 | n[6] << 8 | n[7]), 1 === i && (t *= Math.pow(2, 32), t += yr(n[8] << 24 | n[9] << 16 | n[10] << 8 | n[11])), t })[0] || 1 / 0) / u }) })), i = Math.min.apply(null, u), isFinite(i) ? i : 0 }; ttt = function (n) { var i = it(n, ["moov", "trak"]), t = []; return i.forEach(function (n) { var i = it(n, ["mdia", "hdlr"]), r = it(n, ["tkhd"]); i.forEach(function (n, i) { var u, e, o = vr(n.subarray(8, 12)), f = r[i]; "vide" === o && (e = 0 === (u = new DataView(f.buffer, f.byteOffset, f.byteLength)).getUint8(0) ? u.getUint32(12) : u.getUint32(20), t.push(e)) }) }), t }; itt = function (n) { var i = it(n, ["moov", "trak"]), t = []; return i.forEach(function (n) { var h, c, i = {}, f = it(n, ["tkhd"])[0], l, o, a, v, r, s, u, e; f && (c = (h = new DataView(f.buffer, f.byteOffset, f.byteLength)).getUint8(0), i.id = 0 === c ? h.getUint32(12) : h.getUint32(20)); l = it(n, ["mdia", "hdlr"])[0]; l && (o = vr(l.subarray(8, 12)), i.type = "vide" === o ? "video" : "soun" === o ? "audio" : o); a = it(n, ["mdia", "minf", "stbl", "stsd"])[0]; a && (v = a.subarray(8), i.codec = vr(v.subarray(4, 8)), s = it(v, [i.codec])[0], s && (/^[a-z]vc[1-9]$/i.test(i.codec) ? (r = s.subarray(78), "avcC" === vr(r.subarray(4, 8)) && 11 < r.length ? (i.codec += ".", i.codec += ve(r[9]), i.codec += ve(r[10]), i.codec += ve(r[11])) : i.codec = "avc1.4d400d") : /^mp4[a,v]$/i.test(i.codec) && (r = s.subarray(28), "esds" === vr(r.subarray(4, 8)) && 20 < r.length && 0 !== r[19] ? (i.codec += "." + ve(r[19]), i.codec += "." + ve(r[20] >>> 2 & 63).replace(/^0/, "")) : i.codec = "mp4a.40.2"))); u = it(n, ["mdia", "mdhd"])[0]; u && f && (e = 0 === c ? 12 : 20, i.timescale = yr(u[e] << 24 | u[1 + e] << 16 | u[2 + e] << 8 | u[3 + e])); t.push(i) }), t }; var at, utt, oi = { findBox: it = function (n, t) { var i, f, e, r, o, u = []; if (!t.length) return null; for (i = 0; i < n.byteLength;)f = yr(n[i] << 24 | n[i + 1] << 16 | n[i + 2] << 8 | n[i + 3]), e = vr(n.subarray(i + 4, i + 8)), r = 1 < f ? i + f : n.byteLength, e === t[0] && (1 === t.length ? u.push(n.subarray(i + 8, r)) : (o = it(n.subarray(i + 8, r), t.slice(1))).length && (u = u.concat(o))), i = r; return u }, parseType: vr = function (n) { var t = ""; return t += String.fromCharCode(n[0]), t += String.fromCharCode(n[1]), t += String.fromCharCode(n[2]), t + String.fromCharCode(n[3]) }, timescale: gn, startTime: ntt, videoTrackIds: ttt, tracks: itt }, ih = oi.parseType, wr = { avc1: function (n) { var t = new DataView(n.buffer, n.byteOffset, n.byteLength); return { dataReferenceIndex: t.getUint16(6), width: t.getUint16(24), height: t.getUint16(26), horizresolution: t.getUint16(28) + t.getUint16(30) / 16, vertresolution: t.getUint16(32) + t.getUint16(34) / 16, frameCount: t.getUint16(40), depth: t.getUint16(74), config: at(n.subarray(78, n.byteLength)) } }, avcC: function (n) { for (var f, i, e = new DataView(n.buffer, n.byteOffset, n.byteLength), u = { configurationVersion: n[0], avcProfileIndication: n[1], profileCompatibility: n[2], avcLevelIndication: n[3], lengthSizeMinusOne: 3 & n[4], sps: [], pps: [] }, o = 31 & n[5], t = 6, r = 0; r < o; r++)i = e.getUint16(t), t += 2, u.sps.push(new Uint8Array(n.subarray(t, t + i))), t += i; for (f = n[t], t++, r = 0; r < f; r++)i = e.getUint16(t), t += 2, u.pps.push(new Uint8Array(n.subarray(t, t + i))), t += i; return u }, btrt: function (n) { var t = new DataView(n.buffer, n.byteOffset, n.byteLength); return { bufferSizeDB: t.getUint32(0), maxBitrate: t.getUint32(4), avgBitrate: t.getUint32(8) } }, esds: function (n) { return { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), esId: n[6] << 8 | n[7], streamPriority: 31 & n[8], decoderConfig: { objectProfileIndication: n[11], streamType: n[12] >>> 2 & 63, bufferSize: n[13] << 16 | n[14] << 8 | n[15], maxBitrate: n[16] << 24 | n[17] << 16 | n[18] << 8 | n[19], avgBitrate: n[20] << 24 | n[21] << 16 | n[22] << 8 | n[23], decoderConfigDescriptor: { tag: n[24], length: n[25], audioObjectType: n[26] >>> 3 & 31, samplingFrequencyIndex: (7 & n[26]) << 1 | n[27] >>> 7 & 1, channelConfiguration: n[27] >>> 3 & 15 } } } }, ftyp: function (n) { for (var r = new DataView(n.buffer, n.byteOffset, n.byteLength), i = { majorBrand: ih(n.subarray(0, 4)), minorVersion: r.getUint32(4), compatibleBrands: [] }, t = 8; t < n.byteLength;)i.compatibleBrands.push(ih(n.subarray(t, t + 4))), t += 4; return i }, dinf: function (n) { return { boxes: at(n) } }, dref: function (n) { return { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), dataReferences: at(n.subarray(8)) } }, hdlr: function (n) { for (var i = { version: new DataView(n.buffer, n.byteOffset, n.byteLength).getUint8(0), flags: new Uint8Array(n.subarray(1, 4)), handlerType: ih(n.subarray(8, 12)), name: "" }, t = 8, t = 24; t < n.byteLength; t++) { if (0 === n[t]) { t++; break } i.name += String.fromCharCode(n[t]) } return i.name = decodeURIComponent(escape(i.name)), i }, mdat: function (n) { return { byteLength: n.byteLength, nals: function (n) { for (var r, u = new DataView(n.buffer, n.byteOffset, n.byteLength), t = [], i = 0; i + 4 < n.length; i += r)if (r = u.getUint32(i), i += 4, r <= 0) t.push("<span style='color:red;'>MALFORMED DATA<\/span>"); else switch (31 & n[i]) { case 1: t.push("slice_layer_without_partitioning_rbsp"); break; case 5: t.push("slice_layer_without_partitioning_rbsp_idr"); break; case 6: t.push("sei_rbsp"); break; case 7: t.push("seq_parameter_set_rbsp"); break; case 8: t.push("pic_parameter_set_rbsp"); break; case 9: t.push("access_unit_delimiter_rbsp"); break; default: t.push("UNKNOWN NAL - " + n[i] & 31) }return t }(n) } }, mdhd: function (n) { var u, r = new DataView(n.buffer, n.byteOffset, n.byteLength), t = 4, i = { version: r.getUint8(0), flags: new Uint8Array(n.subarray(1, 4)), language: "" }; return 1 === i.version ? (t += 4, i.creationTime = gt(r.getUint32(t)), t += 8, i.modificationTime = gt(r.getUint32(t)), t += 4, i.timescale = r.getUint32(t), t += 8) : (i.creationTime = gt(r.getUint32(t)), t += 4, i.modificationTime = gt(r.getUint32(t)), t += 4, i.timescale = r.getUint32(t), t += 4), i.duration = r.getUint32(t), t += 4, u = r.getUint16(t), i.language += String.fromCharCode(96 + (u >> 10)), i.language += String.fromCharCode(96 + ((992 & u) >> 5)), i.language += String.fromCharCode(96 + (31 & u)), i }, mdia: function (n) { return { boxes: at(n) } }, mfhd: function (n) { return { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), sequenceNumber: n[4] << 24 | n[5] << 16 | n[6] << 8 | n[7] } }, minf: function (n) { return { boxes: at(n) } }, mp4a: function (n) { var t = new DataView(n.buffer, n.byteOffset, n.byteLength), i = { dataReferenceIndex: t.getUint16(6), channelcount: t.getUint16(16), samplesize: t.getUint16(18), samplerate: t.getUint16(24) + t.getUint16(26) / 65536 }; return 28 < n.byteLength && (i.streamDescriptor = at(n.subarray(28))[0]), i }, moof: function (n) { return { boxes: at(n) } }, moov: function (n) { return { boxes: at(n) } }, mvex: function (n) { return { boxes: at(n) } }, mvhd: function (n) { var i = new DataView(n.buffer, n.byteOffset, n.byteLength), t = 4, r = { version: i.getUint8(0), flags: new Uint8Array(n.subarray(1, 4)) }; return 1 === r.version ? (t += 4, r.creationTime = gt(i.getUint32(t)), t += 8, r.modificationTime = gt(i.getUint32(t)), t += 4, r.timescale = i.getUint32(t), t += 8) : (r.creationTime = gt(i.getUint32(t)), t += 4, r.modificationTime = gt(i.getUint32(t)), t += 4, r.timescale = i.getUint32(t), t += 4), r.duration = i.getUint32(t), t += 4, r.rate = i.getUint16(t) + i.getUint16(t + 2) / 16, t += 4, r.volume = i.getUint8(t) + i.getUint8(t + 1) / 8, t += 2, t += 2, t += 8, r.matrix = new Uint32Array(n.subarray(t, t + 36)), t += 36, t += 24, r.nextTrackId = i.getUint32(t), r }, pdin: function (n) { var t = new DataView(n.buffer, n.byteOffset, n.byteLength); return { version: t.getUint8(0), flags: new Uint8Array(n.subarray(1, 4)), rate: t.getUint32(4), initialDelay: t.getUint32(8) } }, sdtp: function (n) { for (var i = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), samples: [] }, t = 4; t < n.byteLength; t++)i.samples.push({ dependsOn: (48 & n[t]) >> 4, isDependedOn: (12 & n[t]) >> 2, hasRedundancy: 3 & n[t] }); return i }, sidx: function (n) { for (var i = new DataView(n.buffer, n.byteOffset, n.byteLength), r = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), references: [], referenceId: i.getUint32(4), timescale: i.getUint32(8), earliestPresentationTime: i.getUint32(12), firstOffset: i.getUint32(16) }, u = i.getUint16(22), t = 24; u; t += 12, u--)r.references.push({ referenceType: (128 & n[t]) >>> 7, referencedSize: 2147483647 & i.getUint32(t), subsegmentDuration: i.getUint32(t + 4), startsWithSap: !!(128 & n[t + 8]), sapType: (112 & n[t + 8]) >>> 4, sapDeltaTime: 268435455 & i.getUint32(t + 8) }); return r }, smhd: function (n) { return { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), balance: n[4] + n[5] / 256 } }, stbl: function (n) { return { boxes: at(n) } }, stco: function (n) { for (var i = new DataView(n.buffer, n.byteOffset, n.byteLength), r = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), chunkOffsets: [] }, u = i.getUint32(4), t = 8; u; t += 4, u--)r.chunkOffsets.push(i.getUint32(t)); return r }, stsc: function (n) { for (var i = new DataView(n.buffer, n.byteOffset, n.byteLength), r = i.getUint32(4), u = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), sampleToChunks: [] }, t = 8; r; t += 12, r--)u.sampleToChunks.push({ firstChunk: i.getUint32(t), samplesPerChunk: i.getUint32(t + 4), sampleDescriptionIndex: i.getUint32(t + 8) }); return u }, stsd: function (n) { return { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), sampleDescriptions: at(n.subarray(8)) } }, stsz: function (n) { for (var i = new DataView(n.buffer, n.byteOffset, n.byteLength), r = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), sampleSize: i.getUint32(4), entries: [] }, t = 12; t < n.byteLength; t += 4)r.entries.push(i.getUint32(t)); return r }, stts: function (n) { for (var i = new DataView(n.buffer, n.byteOffset, n.byteLength), r = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), timeToSamples: [] }, u = i.getUint32(4), t = 8; u; t += 8, u--)r.timeToSamples.push({ sampleCount: i.getUint32(t), sampleDelta: i.getUint32(t + 4) }); return r }, styp: function (n) { return wr.ftyp(n) }, tfdt: function (n) { var t = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), baseMediaDecodeTime: n[4] << 24 | n[5] << 16 | n[6] << 8 | n[7] }; return 1 === t.version && (t.baseMediaDecodeTime *= Math.pow(2, 32), t.baseMediaDecodeTime += n[8] << 24 | n[9] << 16 | n[10] << 8 | n[11]), t }, tfhd: function (n) { var i, r = new DataView(n.buffer, n.byteOffset, n.byteLength), t = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), trackId: r.getUint32(4) }, u = 1 & t.flags[2], f = 2 & t.flags[2], e = 8 & t.flags[2], o = 16 & t.flags[2], s = 32 & t.flags[2], h = 65536 & t.flags[0], c = 131072 & t.flags[0]; return i = 8, u && (i += 4, t.baseDataOffset = r.getUint32(12), i += 4), f && (t.sampleDescriptionIndex = r.getUint32(i), i += 4), e && (t.defaultSampleDuration = r.getUint32(i), i += 4), o && (t.defaultSampleSize = r.getUint32(i), i += 4), s && (t.defaultSampleFlags = r.getUint32(i)), h && (t.durationIsEmpty = !0), !u && c && (t.baseDataOffsetIsMoof = !0), t }, tkhd: function (n) { var i = new DataView(n.buffer, n.byteOffset, n.byteLength), t = 4, r = { version: i.getUint8(0), flags: new Uint8Array(n.subarray(1, 4)) }; return 1 === r.version ? (t += 4, r.creationTime = gt(i.getUint32(t)), t += 8, r.modificationTime = gt(i.getUint32(t)), t += 4, r.trackId = i.getUint32(t), t += 4, t += 8) : (r.creationTime = gt(i.getUint32(t)), t += 4, r.modificationTime = gt(i.getUint32(t)), t += 4, r.trackId = i.getUint32(t), t += 4, t += 4), r.duration = i.getUint32(t), t += 4, t += 8, r.layer = i.getUint16(t), t += 2, r.alternateGroup = i.getUint16(t), t += 2, r.volume = i.getUint8(t) + i.getUint8(t + 1) / 8, t += 2, t += 2, r.matrix = new Uint32Array(n.subarray(t, t + 36)), t += 36, r.width = i.getUint16(t) + i.getUint16(t + 2) / 16, t += 4, r.height = i.getUint16(t) + i.getUint16(t + 2) / 16, r }, traf: function (n) { return { boxes: at(n) } }, trak: function (n) { return { boxes: at(n) } }, trex: function (n) { var t = new DataView(n.buffer, n.byteOffset, n.byteLength); return { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), trackId: t.getUint32(4), defaultSampleDescriptionIndex: t.getUint32(8), defaultSampleDuration: t.getUint32(12), defaultSampleSize: t.getUint32(16), sampleDependsOn: 3 & n[20], sampleIsDependedOn: (192 & n[21]) >> 6, sampleHasRedundancy: (48 & n[21]) >> 4, samplePaddingValue: (14 & n[21]) >> 1, sampleIsDifferenceSample: !!(1 & n[21]), sampleDegradationPriority: t.getUint16(22) } }, trun: function (n) { var i, r = { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), samples: [] }, u = new DataView(n.buffer, n.byteOffset, n.byteLength), h = 1 & r.flags[2], c = 4 & r.flags[2], e = 1 & r.flags[1], o = 2 & r.flags[1], l = 4 & r.flags[1], s = 8 & r.flags[1], f = u.getUint32(4), t = 8; for (h && (r.dataOffset = u.getInt32(t), t += 4), c && f && (i = { flags: rtt(n.subarray(t, t + 4)) }, t += 4, e && (i.duration = u.getUint32(t), t += 4), o && (i.size = u.getUint32(t), t += 4), s && (i.compositionTimeOffset = u.getUint32(t), t += 4), r.samples.push(i), f--); f--;)i = {}, e && (i.duration = u.getUint32(t), t += 4), o && (i.size = u.getUint32(t), t += 4), l && (i.flags = rtt(n.subarray(t, t + 4)), t += 4), s && (i.compositionTimeOffset = u.getUint32(t), t += 4), r.samples.push(i); return r }, "url ": function (n) { return { version: n[0], flags: new Uint8Array(n.subarray(1, 4)) } }, vmhd: function (n) { var t = new DataView(n.buffer, n.byteOffset, n.byteLength); return { version: n[0], flags: new Uint8Array(n.subarray(1, 4)), graphicsmode: t.getUint16(4), opcolor: new Uint16Array([t.getUint16(6), t.getUint16(8), t.getUint16(10)]) } } }, rh = { inspect: at = function (n) { for (var o, i, u, f, e, t = 0, s = [], h = new ArrayBuffer(n.length), c = new Uint8Array(h), r = 0; r < n.length; ++r)c[r] = n[r]; for (o = new DataView(h); t < n.byteLength;)i = o.getUint32(t), u = ih(n.subarray(t + 4, t + 8)), f = 1 < i ? t + i : n.byteLength, (e = (wr[u] || function (n) { return { data: n } })(n.subarray(t + 8, f))).size = i, e.type = u, s.push(e), t = f; return s }, textify: utt = function (n, t) { var i; return t = t || 0, i = new Array(2 * t + 1).join(" "), n.map(function (n) { return i + n.type + "\n" + Object.keys(n).filter(function (n) { return "type" !== n && "boxes" !== n }).map(function (t) { var f = i + "  " + t + ": ", r = n[t], u; return r instanceof Uint8Array || r instanceof Uint32Array ? (u = Array.prototype.slice.call(new Uint8Array(r.buffer, r.byteOffset, r.byteLength)).map(function (n) { return " " + ("00" + n.toString(16)).slice(-2) }).join("").match(/.{1,24}/g), u ? 1 === u.length ? f + "<" + u.join("").slice(1) + ">" : f + "<\n" + u.map(function (n) { return i + "  " + n }).join("\n") + "\n" + i + "  >" : f + "<>") : f + JSON.stringify(r, null, 2).split("\n").map(function (n, t) { return 0 === t ? n : i + "  " + n }).join("\n") }).join("\n") + (n.boxes ? "\n" + utt(n.boxes, t + 1) : "") }).join("\n") }, parseTfdt: wr.tfdt, parseHdlr: wr.hdlr, parseTfhd: wr.tfhd, parseTrun: wr.trun, parseSidx: wr.sidx }, ist = function (n) { for (var t = 0, r = { payloadType: -1, payloadSize: 0 }, u = 0, i = 0; t < n.byteLength && 128 !== n[t];) { for (; 255 === n[t];)u += 255, t++; for (u += n[t++]; 255 === n[t];)i += 255, t++; if (i += n[t++], !r.payload && 4 === u) { r.payloadType = u; r.payloadSize = i; r.payload = n.subarray(t, t + i); break } t += i; i = u = 0 } return r }, rst = function (n) { return 181 !== n.payload[0] ? null : 49 != (n.payload[1] << 8 | n.payload[2]) ? null : "GA94" !== String.fromCharCode(n.payload[3], n.payload[4], n.payload[5], n.payload[6]) ? null : 3 !== n.payload[7] ? null : n.payload.subarray(8, n.payload.length - 1) }, ust = function (n, t) { var i, e, r, u, f = []; if (!(64 & t[0])) return f; for (e = 31 & t[0], i = 0; i < e; i++)u = { type: 3 & t[2 + (r = 3 * i)], pts: n }, 4 & t[2 + r] && (u.ccData = t[3 + r] << 8 | t[4 + r], f.push(u)); return f }, fst = function (n) { for (var r, u, f, e = n.byteLength, i = [], t = 1; t < e - 2;)0 === n[t] && 0 === n[t + 1] && 3 === n[t + 2] ? (i.push(t + 2), t += 2) : t++; if (0 === i.length) return n; for (u = e - i.length, f = new Uint8Array(u), r = 0, t = 0; t < u; r++, t++)r === i[0] && (r++, i.shift()), f[t] = n[r]; return f }, est = 4; pr.prototype.pipe = function (n) { return this.on("data", function (t) { n.push(t) }), this.on("done", function (t) { n.flush(t) }), this.on("partialdone", function (t) { n.partialFlush(t) }), this.on("endedtimeline", function (t) { n.endTimeline(t) }), this.on("reset", function (t) { n.reset(t) }), n }; pr.prototype.push = function (n) { this.trigger("data", n) }; pr.prototype.flush = function (n) { this.trigger("done", n) }; pr.prototype.partialFlush = function (n) { this.trigger("partialdone", n) }; pr.prototype.endTimeline = function (n) { this.trigger("endedtimeline", n) }; pr.prototype.reset = function (n) { this.trigger("reset", n) }; uh = pr; (ni.prototype = new uh).push = function (n) { var t, i, r; if ("sei_rbsp" === n.nalUnitType && (t = ist(n.escapedRBSP)).payloadType === est && (i = rst(t))) if (n.dts < this.latestDts_) this.ignoreNextEqualDts_ = !0; else { if (n.dts === this.latestDts_ && this.ignoreNextEqualDts_) return this.numSameDts_--, void (this.numSameDts_ || (this.ignoreNextEqualDts_ = !1)); r = ust(n.pts, i); this.captionPackets_ = this.captionPackets_.concat(r); this.latestDts_ !== n.dts && (this.numSameDts_ = 0); this.numSameDts_++; this.latestDts_ = n.dts } }; ni.prototype.flushCCStreams = function (n) { this.ccStreams_.forEach(function (t) { return "flush" === n ? t.flush() : t.partialFlush() }, this) }; ni.prototype.flushStream = function (n) { this.captionPackets_.length && (this.captionPackets_.forEach(function (n, t) { n.presortIndex = t }), this.captionPackets_.sort(function (n, t) { return n.pts === t.pts ? n.presortIndex - t.presortIndex : n.pts - t.pts }), this.captionPackets_.forEach(function (n) { n.type < 2 && this.dispatchCea608Packet(n) }, this), this.captionPackets_.length = 0); this.flushCCStreams(n) }; ni.prototype.flush = function () { return this.flushStream("flush") }; ni.prototype.partialFlush = function () { return this.flushStream("partialFlush") }; ni.prototype.reset = function () { this.latestDts_ = null; this.ignoreNextEqualDts_ = !1; this.numSameDts_ = 0; this.activeCea608Channel_ = [null, null]; this.ccStreams_.forEach(function (n) { n.reset() }) }; ni.prototype.dispatchCea608Packet = function (n) { this.setsTextOrXDSActive(n) ? this.activeCea608Channel_[n.type] = null : this.setsChannel1Active(n) ? this.activeCea608Channel_[n.type] = 0 : this.setsChannel2Active(n) && (this.activeCea608Channel_[n.type] = 1); null !== this.activeCea608Channel_[n.type] && this.ccStreams_[(n.type << 1) + this.activeCea608Channel_[n.type]].push(n) }; ni.prototype.setsChannel1Active = function (n) { return 4096 == (30720 & n.ccData) }; ni.prototype.setsChannel2Active = function (n) { return 6144 == (30720 & n.ccData) }; ni.prototype.setsTextOrXDSActive = function (n) { return 256 == (28928 & n.ccData) || 4138 == (30974 & n.ccData) || 6186 == (30974 & n.ccData) }; var ost = { 42: 225, 92: 233, 94: 237, 95: 243, 96: 250, 123: 231, 124: 247, 125: 209, 126: 241, 127: 9608, 304: 174, 305: 176, 306: 189, 307: 191, 308: 8482, 309: 162, 310: 163, 311: 9834, 312: 224, 313: 160, 314: 232, 315: 226, 316: 234, 317: 238, 318: 244, 319: 251, 544: 193, 545: 201, 546: 211, 547: 218, 548: 220, 549: 252, 550: 8216, 551: 161, 552: 42, 553: 39, 554: 8212, 555: 169, 556: 8480, 557: 8226, 558: 8220, 559: 8221, 560: 192, 561: 194, 562: 199, 563: 200, 564: 202, 565: 203, 566: 235, 567: 206, 568: 207, 569: 239, 570: 212, 571: 217, 572: 249, 573: 219, 574: 171, 575: 187, 800: 195, 801: 227, 802: 205, 803: 204, 804: 236, 805: 210, 806: 242, 807: 213, 808: 245, 809: 123, 810: 125, 811: 92, 812: 94, 813: 95, 814: 124, 815: 126, 816: 196, 817: 228, 818: 214, 819: 246, 820: 223, 821: 165, 822: 164, 823: 9474, 824: 197, 825: 229, 826: 216, 827: 248, 828: 9484, 829: 9488, 830: 9492, 831: 9496 }, sst = [4352, 4384, 4608, 4640, 5376, 5408, 5632, 5664, 5888, 5920, 4096, 4864, 4896, 5120, 5152], w = function fp(n, t) { fp.prototype.init.call(this); this.field_ = n || 0; this.dataChannel_ = t || 0; this.name_ = "CC" + (1 + (this.field_ << 1 | this.dataChannel_)); this.setConstants(); this.reset(); this.push = function (n) { var t, e, r, i, u, f; (t = 32639 & n.ccData) !== this.lastControlCode_ ? (4096 == (61440 & t) ? this.lastControlCode_ = t : t !== this.PADDING_ && (this.lastControlCode_ = null), r = t >>> 8, i = 255 & t, t !== this.PADDING_) && (t === this.RESUME_CAPTION_LOADING_ ? this.mode_ = "popOn" : t === this.END_OF_CAPTION_ ? (this.mode_ = "popOn", this.clearFormatting(n.pts), this.flushDisplayed(n.pts), e = this.displayed_, this.displayed_ = this.nonDisplayed_, this.nonDisplayed_ = e, this.startPts_ = n.pts) : t === this.ROLL_UP_2_ROWS_ ? (this.rollUpRows_ = 2, this.setRollUp(n.pts)) : t === this.ROLL_UP_3_ROWS_ ? (this.rollUpRows_ = 3, this.setRollUp(n.pts)) : t === this.ROLL_UP_4_ROWS_ ? (this.rollUpRows_ = 4, this.setRollUp(n.pts)) : t === this.CARRIAGE_RETURN_ ? (this.clearFormatting(n.pts), this.flushDisplayed(n.pts), this.shiftRowsUp_(), this.startPts_ = n.pts) : t === this.BACKSPACE_ ? "popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[this.row_] = this.displayed_[this.row_].slice(0, -1) : t === this.ERASE_DISPLAYED_MEMORY_ ? (this.flushDisplayed(n.pts), this.displayed_ = br()) : t === this.ERASE_NON_DISPLAYED_MEMORY_ ? this.nonDisplayed_ = br() : t === this.RESUME_DIRECT_CAPTIONING_ ? ("paintOn" !== this.mode_ && (this.flushDisplayed(n.pts), this.displayed_ = br()), this.mode_ = "paintOn", this.startPts_ = n.pts) : this.isSpecialCharacter(r, i) ? (u = fh((r = (3 & r) << 8) | i), this[this.mode_](n.pts, u), this.column_++) : this.isExtCharacter(r, i) ? ("popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[this.row_] = this.displayed_[this.row_].slice(0, -1), u = fh((r = (3 & r) << 8) | i), this[this.mode_](n.pts, u), this.column_++) : this.isMidRowCode(r, i) ? (this.clearFormatting(n.pts), this[this.mode_](n.pts, " "), this.column_++, 14 == (14 & i) && this.addFormatting(n.pts, ["i"]), 1 == (1 & i) && this.addFormatting(n.pts, ["u"])) : this.isOffsetControlCode(r, i) ? this.column_ += 3 & i : this.isPAC(r, i) ? (f = sst.indexOf(7968 & t), "rollUp" === this.mode_ && (f - this.rollUpRows_ + 1 < 0 && (f = this.rollUpRows_ - 1), this.setRollUp(n.pts, f)), f !== this.row_ && (this.clearFormatting(n.pts), this.row_ = f), 1 & i && -1 === this.formatting_.indexOf("u") && this.addFormatting(n.pts, ["u"]), 16 == (16 & t) && (this.column_ = 4 * ((14 & t) >> 1)), this.isColorPAC(i) && 14 == (14 & i) && this.addFormatting(n.pts, ["i"])) : this.isNormalChar(r) && (0 === i && (i = null), u = fh(r), u += fh(i), this[this.mode_](n.pts, u), this.column_ += u.length)) : this.lastControlCode_ = null } }; w.prototype = new uh; w.prototype.flushDisplayed = function (n) { var t = this.displayed_.map(function (n) { try { return n.trim() } catch (n) { return "" } }).join("\n").replace(/^\n+|\n+$/g, ""); t.length && this.trigger("data", { startPts: this.startPts_, endPts: n, text: t, stream: this.name_ }) }; w.prototype.reset = function () { this.mode_ = "popOn"; this.topRow_ = 0; this.startPts_ = 0; this.displayed_ = br(); this.nonDisplayed_ = br(); this.lastControlCode_ = null; this.column_ = 0; this.row_ = 14; this.rollUpRows_ = 2; this.formatting_ = [] }; w.prototype.setConstants = function () { 0 === this.dataChannel_ ? (this.BASE_ = 16, this.EXT_ = 17, this.CONTROL_ = (20 | this.field_) << 8, this.OFFSET_ = 23) : 1 === this.dataChannel_ && (this.BASE_ = 24, this.EXT_ = 25, this.CONTROL_ = (28 | this.field_) << 8, this.OFFSET_ = 31); this.PADDING_ = 0; this.RESUME_CAPTION_LOADING_ = 32 | this.CONTROL_; this.END_OF_CAPTION_ = 47 | this.CONTROL_; this.ROLL_UP_2_ROWS_ = 37 | this.CONTROL_; this.ROLL_UP_3_ROWS_ = 38 | this.CONTROL_; this.ROLL_UP_4_ROWS_ = 39 | this.CONTROL_; this.CARRIAGE_RETURN_ = 45 | this.CONTROL_; this.RESUME_DIRECT_CAPTIONING_ = 41 | this.CONTROL_; this.BACKSPACE_ = 33 | this.CONTROL_; this.ERASE_DISPLAYED_MEMORY_ = 44 | this.CONTROL_; this.ERASE_NON_DISPLAYED_MEMORY_ = 46 | this.CONTROL_ }; w.prototype.isSpecialCharacter = function (n, t) { return n === this.EXT_ && 48 <= t && t <= 63 }; w.prototype.isExtCharacter = function (n, t) { return (n === this.EXT_ + 1 || n === this.EXT_ + 2) && 32 <= t && t <= 63 }; w.prototype.isMidRowCode = function (n, t) { return n === this.EXT_ && 32 <= t && t <= 47 }; w.prototype.isOffsetControlCode = function (n, t) { return n === this.OFFSET_ && 33 <= t && t <= 35 }; w.prototype.isPAC = function (n, t) { return n >= this.BASE_ && n < this.BASE_ + 8 && 64 <= t && t <= 127 }; w.prototype.isColorPAC = function (n) { return 64 <= n && n <= 79 || 96 <= n && n <= 127 }; w.prototype.isNormalChar = function (n) { return 32 <= n && n <= 127 }; w.prototype.setRollUp = function (n, t) { if ("rollUp" !== this.mode_ && (this.row_ = 14, this.mode_ = "rollUp", this.flushDisplayed(n), this.nonDisplayed_ = br(), this.displayed_ = br()), void 0 !== t && t !== this.row_) for (var i = 0; i < this.rollUpRows_; i++)this.displayed_[t - i] = this.displayed_[this.row_ - i], this.displayed_[this.row_ - i] = ""; void 0 === t && (t = this.row_); this.topRow_ = t - this.rollUpRows_ + 1 }; w.prototype.addFormatting = function (n, t) { this.formatting_ = this.formatting_.concat(t); var i = t.reduce(function (n, t) { return n + "<" + t + ">" }, ""); this[this.mode_](n, i) }; w.prototype.clearFormatting = function (n) { if (this.formatting_.length) { var t = this.formatting_.reverse().reduce(function (n, t) { return n + "<\/" + t + ">" }, ""); this.formatting_ = []; this[this.mode_](n, t) } }; w.prototype.popOn = function (n, t) { var i = this.nonDisplayed_[this.row_]; i += t; this.nonDisplayed_[this.row_] = i }; w.prototype.rollUp = function (n, t) { var i = this.displayed_[this.row_]; i += t; this.displayed_[this.row_] = i }; w.prototype.shiftRowsUp_ = function () { for (var n = 0; n < this.topRow_; n++)this.displayed_[n] = ""; for (n = this.row_ + 1; n < 15; n++)this.displayed_[n] = ""; for (n = this.topRow_; n < this.row_; n++)this.displayed_[n] = this.displayed_[n + 1]; this.displayed_[this.row_] = "" }; w.prototype.paintOn = function (n, t) { var i = this.displayed_[this.row_]; i += t; this.displayed_[this.row_] = i }; var ast = fst, vst = ni, yst = function () { var r, u, n, t, i, f, e = !1; this.isInitialized = function () { return e }; this.init = function (n) { r = new vst; e = !0; f = !!n && n.isPartial; r.on("data", function (n) { n.startTime = n.startPts / t; n.endTime = n.endPts / t; i.captions.push(n); i.captionStreams[n.stream] = !0 }) }; this.isNewInit = function (i, r) { return !(i && 0 === i.length || r && "object" == typeof r && 0 === Object.keys(r).length) && (n !== i[0] || t !== r[n]) }; this.parse = function (r, f, e) { var o, s; if (!this.isInitialized() || !f || !e) return null; if (this.isNewInit(f, e)) n = f[0], t = e[n]; else if (null === n || !t) return u.push(r), null; for (; 0 < u.length;)s = u.shift(), this.parse(s, f, e); return null !== (o = function (n, t, i) { return null === t ? null : { seiNals: cst(n, t)[t], timescale: i } }(r, n, t)) && o.seiNals ? (this.pushNals(o.seiNals), this.flushStream(), i) : null }; this.pushNals = function (n) { if (!this.isInitialized() || !n || 0 === n.length) return null; n.forEach(function (n) { r.push(n) }) }; this.flushStream = function () { if (!this.isInitialized()) return null; f ? r.partialFlush() : r.flush() }; this.clearParsedCaptions = function () { i.captions = []; i.captionStreams = {} }; this.resetCaptionStream = function () { if (!this.isInitialized()) return null; r.reset() }; this.clearAllCaptions = function () { this.clearParsedCaptions(); this.resetCaptionStream() }; this.reset = function () { u = []; t = n = null; i ? this.clearParsedCaptions() : i = { captions: [], captionStreams: {} }; this.resetCaptionStream() }; this.reset() }, ftt = 27, ett = 15, pst = 21; new uh; var wst, bst, kst, dst, gst = { parseType: function (n, t) { var i = ott(n); return 0 === i ? "pat" : i === t ? "pmt" : t ? "pes" : null }, parsePat: function (n) { var i = eh(n), t = 4 + oh(n); return i && (t += n[t] + 1), (31 & n[t + 10]) << 8 | n[t + 11] }, parsePmt: function (n) { var u = {}, e = eh(n), t = 4 + oh(n), f, r, i; if (e && (t += n[t] + 1), 1 & n[t + 5]) { for (f = 3 + ((15 & n[t + 1]) << 8 | n[t + 2]) - 4, r = 12 + ((15 & n[t + 10]) << 8 | n[t + 11]); r < f;)i = t + r, u[(31 & n[i + 1]) << 8 | n[i + 2]] = n[i], r += 5 + ((15 & n[i + 3]) << 8 | n[i + 4]); return u } }, parsePayloadUnitStartIndicator: eh, parsePesType: function (n, t) { switch (t[ott(n)]) { case ftt: return "video"; case ett: return "audio"; case pst: return "timed-metadata"; default: return null } }, parsePesTime: function (n) { var t, r, i; return eh(n) ? (t = 4 + oh(n), t >= n.byteLength) ? null : (i = null, 192 & (r = n[t + 7]) && ((i = {}).pts = (14 & n[t + 9]) << 27 | (255 & n[t + 10]) << 20 | (254 & n[t + 11]) << 12 | (255 & n[t + 12]) << 5 | (254 & n[t + 13]) >>> 3, i.pts *= 4, i.pts += (6 & n[t + 13]) >>> 1, i.dts = i.pts, 64 & r && (i.dts = (14 & n[t + 14]) << 27 | (255 & n[t + 15]) << 20 | (254 & n[t + 16]) << 12 | (255 & n[t + 17]) << 5 | (254 & n[t + 18]) >>> 3, i.dts *= 4, i.dts += (6 & n[t + 18]) >>> 1)), i) : null }, videoPacketContainsKeyFrame: function (n) { for (var f = 4 + oh(n), i = n.subarray(f), t = 0, r = 0, u = !1; r < i.byteLength - 3; r++)if (1 === i[r + 2]) { t = r + 5; break } for (; t < i.byteLength;)switch (i[t]) { case 0: if (0 !== i[t - 1]) { t += 2; break } if (0 !== i[t - 2]) { t++; break } for (r + 3 !== t - 2 && "slice_layer_without_partitioning_rbsp_idr" === bv(31 & i[r + 3]) && (u = !0); 1 !== i[++t] && t < i.length;); r = t - 2; t += 3; break; case 1: if (0 !== i[t - 1] || 0 !== i[t - 2]) { t += 3; break } "slice_layer_without_partitioning_rbsp_idr" === bv(31 & i[r + 3]) && (u = !0); r = t - 2; t += 3; break; default: t += 3 }return i = i.subarray(r), t -= r, r = 0, i && 3 < i.byteLength && "slice_layer_without_partitioning_rbsp_idr" === bv(31 & i[r + 3]) && (u = !0), u } }, nht = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350], tht = { isLikelyAacData: function (n) { return n[0] === "I".charCodeAt(0) && n[1] === "D".charCodeAt(0) && n[2] === "3".charCodeAt(0) }, parseId3TagSize: function (n, t) { var i = n[t + 6] << 21 | n[t + 7] << 14 | n[t + 8] << 7 | n[t + 9]; return (16 & n[t + 5]) >> 4 ? 20 + i : 10 + i }, parseAdtsSize: function (n, t) { var i = (224 & n[t + 5]) >> 5, r = n[t + 4] << 3; return 6144 & n[t + 3] | r | i }, parseType: function (n, t) { return n[t] === "I".charCodeAt(0) && n[t + 1] === "D".charCodeAt(0) && n[t + 2] === "3".charCodeAt(0) ? "timed-metadata" : !0 & n[t] && 240 == (240 & n[t + 1]) ? "audio" : null }, parseSampleRate: function (n) { for (var t = 0; t + 5 < n.length;) { if (255 === n[t] && 240 == (246 & n[t + 1])) return nht[(60 & n[t + 2]) >>> 2]; t++ } return null }, parseAacTimestamp: function (n) { var t, f, u, r, i, e; t = 10; 64 & n[5] && (t += 4, t += stt(n.subarray(10, 14))); do { if ((f = stt(n.subarray(t + 4, t + 8))) < 1) return null; if ("PRIV" === String.fromCharCode(n[t], n[t + 1], n[t + 2], n[t + 3])) for (u = n.subarray(t + 10, t + f + 10), r = 0; r < u.byteLength; r++)if (0 === u[r]) { if ("com.apple.streaming.transportStreamTimestamp" !== unescape(function (n, t, i) { for (var u = "", r = t; r < i; r++)u += "%" + ("00" + n[r].toString(16)).slice(-2); return u }(u, 0, r))) break; return i = u.subarray(r + 1), e = (1 & i[3]) << 30 | i[4] << 22 | i[5] << 14 | i[6] << 6 | i[7] >>> 2, e *= 4, e + (3 & i[7]) } t += 10; t += f } while (t < n.byteLength); return null } }, du = (wst = function (n) { return 9e4 * n }, bst = function (n, t) { return n * t }, kst = function (n) { return n / 9e4 }, dst = function (n, t) { return n / t }, lst), l = {}; l.ts = gst; l.aac = tht; var kr = 9e4, ht = 188, fht = function (n, t) { var i; return (i = l.aac.isLikelyAacData(n) ? function (n) { for (var s, f, u = !1, o = 0, e = null, i = null, r = 0, t = 0; 3 <= n.length - t;) { switch (l.aac.parseType(n, t)) { case "timed-metadata": if (n.length - t < 10) { u = !0; break } if ((r = l.aac.parseId3TagSize(n, t)) > n.length) { u = !0; break } null === i && (f = n.subarray(t, t + r), i = l.aac.parseAacTimestamp(f)); t += r; break; case "audio": if (n.length - t < 7) { u = !0; break } if ((r = l.aac.parseAdtsSize(n, t)) > n.length) { u = !0; break } null === e && (f = n.subarray(t, t + r), e = l.aac.parseSampleRate(f)); o++; t += r; break; default: t++ }if (u) return null } return null === e || null === i ? null : (s = kr / e, { audio: [{ type: "audio", dts: i, pts: i }, { type: "audio", dts: i + 1024 * o * s, pts: i + 1024 * o * s }] }) }(n) : uht(n)) && (i.audio || i.video) ? (function (n, t) { var u, r, i; n.audio && n.audio.length && (u = t, "undefined" == typeof u && (u = n.audio[0].dts), n.audio.forEach(function (n) { n.dts = du(n.dts, u); n.pts = du(n.pts, u); n.dtsTime = n.dts / kr; n.ptsTime = n.pts / kr })); n.video && n.video.length && (r = t, ("undefined" == typeof r && (r = n.video[0].dts), n.video.forEach(function (n) { n.dts = du(n.dts, r); n.pts = du(n.pts, r); n.dtsTime = n.dts / kr; n.ptsTime = n.pts / kr }), n.firstKeyFrame) && (i = n.firstKeyFrame, i.dts = du(i.dts, r), i.pts = du(i.pts, r), i.dtsTime = i.dts / kr, i.ptsTime = i.dts / kr)) }(i, t), i) : null }; htt = function (n, t, i) { return t && ctt(n.prototype, t), i && ctt(n, i), n }; wt = null; ltt = (kv.prototype.decrypt = function (n, t, i, r, u, f) { for (var e = this._key[1], o = n ^ e[0], s = r ^ e[1], h = i ^ e[2], c = t ^ e[3], y = void 0, g = void 0, nt = void 0, tt = e.length / 4 - 2, l = void 0, a = 4, v = this._tables[1], p = v[0], w = v[1], b = v[2], k = v[3], d = v[4], l = 0; l < tt; l++)y = p[o >>> 24] ^ w[s >> 16 & 255] ^ b[h >> 8 & 255] ^ k[255 & c] ^ e[a], g = p[s >>> 24] ^ w[h >> 16 & 255] ^ b[c >> 8 & 255] ^ k[255 & o] ^ e[a + 1], nt = p[h >>> 24] ^ w[c >> 16 & 255] ^ b[o >> 8 & 255] ^ k[255 & s] ^ e[a + 2], c = p[c >>> 24] ^ w[o >> 16 & 255] ^ b[s >> 8 & 255] ^ k[255 & h] ^ e[a + 3], a += 4, o = y, s = g, h = nt; for (l = 0; l < 4; l++)u[(3 & -l) + f] = d[o >>> 24] << 24 ^ d[s >> 16 & 255] << 16 ^ d[h >> 8 & 255] << 8 ^ d[255 & c] ^ e[a++], y = o, o = s, s = h, h = c, c = y }, kv); dv = (dr.prototype.on = function (n, t) { this.listeners[n] || (this.listeners[n] = []); this.listeners[n].push(t) }, dr.prototype.off = function (n, t) { if (!this.listeners[n]) return !1; var i = this.listeners[n].indexOf(t); return this.listeners[n].splice(i, 1), -1 < i }, dr.prototype.trigger = function (n, t) { var i = this.listeners[n], f, r; if (i) if (2 === arguments.length) for (f = i.length, r = 0; r < f; ++r)i[r].call(this, t); else for (var e = Array.prototype.slice.call(arguments, 1), o = i.length, u = 0; u < o; ++u)i[u].apply(this, e) }, dr.prototype.dispose = function () { this.listeners = {} }, dr.prototype.pipe = function (n) { this.on("data", function (t) { n.push(t) }) }, dr); gv = (function (n, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); n.prototype = Object.create(t && t.prototype, { constructor: { value: n, enumerable: !1, writable: !0, configurable: !0 } }); t && (Object.setPrototypeOf ? Object.setPrototypeOf(n, t) : n.__proto__ = t) }(ye, att = dv), ye.prototype.processJob_ = function () { this.jobs.shift()(); this.timeout_ = this.jobs.length ? setTimeout(this.processJob_.bind(this), this.delay) : null }, ye.prototype.push = function (n) { this.jobs.push(n); this.timeout_ || (this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay)) }, ye); ytt = (pe.prototype.decryptChunk_ = function (n, t, i, r) { return function () { var u = vtt(n, t, i); r.set(u, n.byteOffset) } }, htt(pe, null, [{ key: "STEP", get: function () { return 32e3 } }]), pe);
    /**
       * @videojs/http-streaming
       * @version 1.10.6
       * @copyright 2019 Brightcove, Inc
       * @license Apache-2.0
       */
    ri = function (n, t, i) { return t && ptt(n.prototype, t), i && ptt(n, i), n }; var eht = function (n, t) { if (Array.isArray(n)) return n; if (Symbol.iterator in Object(n)) return function (n, t) { var r = [], u = !0, f = !1, e = void 0, o, i; try { for (i = n[Symbol.iterator](); !(u = (o = i.next()).done) && (r.push(o.value), !t || r.length !== t); u = !0); } catch (n) { f = !0; e = n } finally { try { !u && i.return && i.return() } finally { if (f) throw e; } } return r }(n, t); throw new TypeError("Invalid attempt to destructure non-iterable instance"); }, ty = i.mergeOptions, oht = i.log, lh = (ai(gu, i.EventTarget), ri(gu, [{ key: "playlistRequestError", value: function (n, t, i) { this.request = null; i && (this.state = i); this.error = { playlist: this.master.playlists[t], status: n.status, message: "HLS playlist request error at URL: " + t + ".", responseText: n.responseText, code: 500 <= n.status ? 4 : 2 }; this.trigger("error") } }, { key: "haveMetadata", value: function (t, i) { var f = this, r, u; this.request = null; this.state = "HAVE_METADATA"; r = new cn; this.customTagParsers.forEach(function (n) { return r.addParser(n) }); this.customTagMappers.forEach(function (n) { return r.addTagMapper(n) }); r.push(t.responseText); r.end(); r.manifest.uri = i; r.manifest.attributes = r.manifest.attributes || {}; u = ny(this.master, r.manifest); this.targetDuration = r.manifest.targetDuration; u ? (this.master = u, this.media_ = this.master.playlists[r.manifest.uri]) : this.trigger("playlistunchanged"); this.media().endList || (n.clearTimeout(this.mediaUpdateTimeout), this.mediaUpdateTimeout = n.setTimeout(function () { f.trigger("mediaupdatetimeout") }, ktt(this.media(), !!u))); this.trigger("loadedplaylist") } }, { key: "dispose", value: function () { this.stopRequest(); n.clearTimeout(this.mediaUpdateTimeout); n.clearTimeout(this.finalRenditionTimeout) } }, { key: "stopRequest", value: function () { if (this.request) { var n = this.request; this.request = null; n.onreadystatechange = null; n.abort() } } }, { key: "media", value: function (t, i) { var r = this, e, u, f; if (!t) return this.media_; if ("HAVE_NOTHING" === this.state) throw new Error("Cannot switch media playlist from " + this.state); if ("string" == typeof t) { if (!this.master.playlists[t]) throw new Error("Unknown playlist URI: " + t); t = this.master.playlists[t] } if (n.clearTimeout(this.finalRenditionTimeout), i) e = t.targetDuration * 500 || 5e3, this.finalRenditionTimeout = n.setTimeout(this.media.bind(this, t, !1), e); else { if (u = this.state, f = !this.media_ || t.uri !== this.media_.uri, this.master.playlists[t.uri].endList) return this.request && (this.request.onreadystatechange = null, this.request.abort(), this.request = null), this.state = "HAVE_METADATA", this.media_ = t, void (f && (this.trigger("mediachanging"), this.trigger("mediachange"))); if (f) { if (this.state = "SWITCHING_MEDIA", this.request) { if (t.resolvedUri === this.request.url) return; this.request.onreadystatechange = null; this.request.abort(); this.request = null } this.media_ && this.trigger("mediachanging"); this.request = this.hls_.xhr({ uri: t.resolvedUri, withCredentials: this.withCredentials }, function (n, i) { if (r.request) { if (t.resolvedUri = hh(r.handleManifestRedirects, t.resolvedUri, i), n) return r.playlistRequestError(r.request, t.uri, u); r.haveMetadata(i, t.uri); "HAVE_MASTER" === u ? r.trigger("loadedmetadata") : r.trigger("mediachange") } }) } } } }, { key: "pause", value: function () { this.stopRequest(); n.clearTimeout(this.mediaUpdateTimeout); "HAVE_NOTHING" === this.state && (this.started = !1); "SWITCHING_MEDIA" === this.state ? this.state = this.media_ ? "HAVE_METADATA" : "HAVE_MASTER" : "HAVE_CURRENT_METADATA" === this.state && (this.state = "HAVE_METADATA") } }, { key: "load", value: function (t) { var u = this, i, r; n.clearTimeout(this.mediaUpdateTimeout); i = this.media(); t ? (r = i ? i.targetDuration * 500 : 5e3, this.mediaUpdateTimeout = n.setTimeout(function () { return u.load() }, r)) : this.started ? i && !i.endList ? this.trigger("mediaupdatetimeout") : this.trigger("loadedplaylist") : this.start() } }, { key: "start", value: function () { var t = this; this.started = !0; this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, function (i, r) { if (t.request) { if (t.request = null, i) return t.error = { status: r.status, message: "HLS playlist request error at URL: " + t.srcUrl + ".", responseText: r.responseText, code: 2 }, "HAVE_NOTHING" === t.state && (t.started = !1), t.trigger("error"); var u = new cn; return t.customTagParsers.forEach(function (n) { return u.addParser(n) }), t.customTagMappers.forEach(function (n) { return u.addTagMapper(n) }), u.push(r.responseText), u.end(), t.state = "HAVE_MASTER", t.srcUrl = hh(t.handleManifestRedirects, t.srcUrl, r), u.manifest.uri = t.srcUrl, u.manifest.playlists ? (t.master = u.manifest, wtt(t.master), btt(t.master), t.trigger("loadedplaylist"), void (t.request || t.media(u.manifest.playlists[0]))) : (t.master = { mediaGroups: { AUDIO: {}, VIDEO: {}, "CLOSED-CAPTIONS": {}, SUBTITLES: {} }, uri: n.location.href, playlists: [{ uri: t.srcUrl, id: 0, resolvedUri: t.srcUrl, attributes: {} }] }, t.master.playlists[t.srcUrl] = t.master.playlists[0], t.haveMetadata(r, t.srcUrl), t.trigger("loadedmetadata")) } }) } }]), gu); var wit = i.createTimeRange, aht = rit.bind(null, 1), vht = rit.bind(null, -1), vt = { duration: gtt, seekable: function (n, t) { var r = t || 0, i = tit(n, t, !0); return null === i ? wit() : wit(r, i) }, safeLiveIndex: nit, getMediaInfoForTime: function (n, t, i, r) { var u = void 0, f = void 0, o = n.segments.length, e = t - r; if (e < 0) { if (0 < i) for (u = i - 1; 0 <= u; u--)if (f = n.segments[u], 0 < (e += vht(f.duration))) return { mediaIndex: u, startTime: r - we(n, i, u) }; return { mediaIndex: 0, startTime: t } } if (i < 0) { for (u = i; u < 0; u++)if ((e -= n.targetDuration) < 0) return { mediaIndex: 0, startTime: t }; i = 0 } for (u = i; u < o; u++)if (f = n.segments[u], (e -= aht(f.duration)) < 0) return { mediaIndex: u, startTime: r + we(n, i, u) }; return { mediaIndex: o - 1, startTime: t } }, isEnabled: ah, isDisabled: function (n) { return n.disabled }, isBlacklisted: uit, isIncompatible: iy, playlistEnd: tit, isAes: function (n) { for (var t = 0; t < n.segments.length; t++)if (n.segments[t].key) return !0; return !1 }, isFmp4: function (n) { for (var t = 0; t < n.segments.length; t++)if (n.segments[t].map) return !0; return !1 }, hasAttribute: fit, estimateSegmentRequestTime: function (n, t, i, r) { var u = 3 < arguments.length && void 0 !== r ? r : 0; return fit("BANDWIDTH", i) ? (n * i.attributes.BANDWIDTH - 8 * u) / t : NaN }, isLowestEnabledRendition: ry }, yht = i.xhr, pht = i.mergeOptions, wht = Object.freeze({ createTransferableMessage: oit, initSegmentId: vh, segmentKeyId: sit, hexDump: hit, tagDump: function (n) { var t = n.bytes; return hit(t) }, textRanges: function (n) { for (var r, i, u = "", t = void 0, t = 0; t < n.length; t++)u += (i = t, (r = n).start(i) + "-" + r.end(i) + " "); return u } }), nu = "undefined" != typeof window ? window : {}, ey = "undefined" == typeof Symbol ? "__target" : Symbol(), bht = "application/javascript", kht = nu.BlobBuilder || nu.WebKitBlobBuilder || nu.MozBlobBuilder || nu.MSBlobBuilder, tf = nu.URL || nu.webkitURL || tf && tf.msURL, rf = nu.Worker; if (rf) { sy = kit("self.onmessage = function () {}"); hy = new Uint8Array(1); try { (oy = new rf(sy)).postMessage(hy, [hy.buffer]) } catch (fp) { rf = null } finally { tf.revokeObjectURL(sy); oy && oy.terminate() } } var ght = new bit("./transmuxer-worker.worker.js", function () { var n = this; !function () { function h() { this.init = function () { var n = {}; this.on = function (t, i) { n[t] || (n[t] = []); n[t] = n[t].concat(i) }; this.off = function (t, i) { var r; return !!n[t] && (r = n[t].indexOf(i), n[t] = n[t].slice(), n[t].splice(r, 1), -1 < r) }; this.trigger = function (t) { var r, i, u, f; if (r = n[t]) if (2 === arguments.length) for (u = r.length, i = 0; i < u; ++i)r[i].call(this, arguments[1]); else { for (f = [], i = arguments.length, i = 1; i < arguments.length; ++i)f.push(arguments[i]); for (u = r.length, i = 0; i < u; ++i)r[i].apply(this, f) } }; this.dispose = function () { n = {} } } } function bu(n, t) { var i = { size: 0, flags: { isLeading: 0, dependsOn: 1, isDependedOn: 0, hasRedundancy: 0, degradationPriority: 0, isNonSyncSample: 1 } }; return i.dataOffset = t, i.compositionTimeOffset = n.pts - n.dts, i.duration = n.duration, i.size = 4 * n.length, i.size += n.byteLength, n.keyFrame && (i.flags.dependsOn = 2, i.flags.isNonSyncSample = 0), i } function r(n) { for (var t = []; n--;)t.push(0); return t } function o() { o.prototype.init.call(this); this.captionPackets_ = []; this.ccStreams_ = [new u(0, 0), new u(0, 1), new u(1, 0), new u(1, 1)]; this.reset(); this.ccStreams_.forEach(function (n) { n.on("data", this.trigger.bind(this, "data")); n.on("partialdone", this.trigger.bind(this, "partialdone")); n.on("done", this.trigger.bind(this, "done")) }, this) } function b(n) { return null === n ? "" : (n = bf[n] || n, String.fromCharCode(n)) } function l() { for (var n = [], t = 15; t--;)n.push(""); return n } function fu(n, t) { var i = 1; for (t < n && (i = -1); 4294967296 < Math.abs(t - n);)n += 8589934592 * i; return n } function at(n) { var i, t; at.prototype.init.call(this); this.type_ = n || "shared"; this.push = function (n) { "shared" !== this.type_ && n.type !== this.type_ || (void 0 === t && (t = n.dts), n.dts = fu(n.dts, t), n.pts = fu(n.pts, t), i = n.dts, this.trigger("data", n)) }; this.flush = function () { t = i; this.trigger("done") }; this.endTimeline = function () { this.flush(); this.trigger("endedtimeline") }; this.discontinuity = function () { i = t = void 0 }; this.reset = function () { this.discontinuity(); this.trigger("reset") } } function eu(n, t, i) { for (var u = "", r = t; r < i; r++)u += "%" + ("00" + n[r].toString(16)).slice(-2); return u } function k(n, t, i) { return decodeURIComponent(eu(n, t, i)) } function d(n) { return n[0] << 21 | n[1] << 14 | n[2] << 7 | n[3] } function vu(n, t) { var i; if (n.length !== t.length) return !1; for (i = 0; i < n.length; i++)if (n[i] !== t[i]) return !1; return !0 } function yu(n, t, i, r, u, f) { return { start: { dts: n, pts: n + (i - t) }, end: { dts: n + (r - t), pts: n + (u - i) }, prependedContentDuration: f, baseMediaDecodeTime: n } } function wu(n, t) { for (var i, r = 0; r < t.length; r++)i = t[r], i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(n, i.key, i) } function ei(n, t) { !function (n, t) { if (!(n instanceof t)) throw new TypeError("Cannot call a class as a function"); }(this, ei); this.options = t || {}; this.self = n; this.init() } var i, oi, si, hi, ci, li, ai, vi, yi, pi, wi, bi, ki, di, gi, nr, tr, ir, rr, ur, rt, t, ut, fr, er, or, sr, hr, cr, lr, ar, w, vr, yr, pr, wr, br, kr, dr, ft, f, et, vt, e, yt, ou, pt, wt, g, bt, su, hu, kt, nt, gt, tt, lu, ni, au, pu, fi; h.prototype.pipe = function (n) { return this.on("data", function (t) { n.push(t) }), this.on("done", function (t) { n.flush(t) }), this.on("partialdone", function (t) { n.partialFlush(t) }), this.on("endedtimeline", function (t) { n.endTimeline(t) }), this.on("reset", function (t) { n.reset(t) }), n }; h.prototype.push = function (n) { this.trigger("data", n) }; h.prototype.flush = function (n) { this.trigger("done", n) }; h.prototype.partialFlush = function (n) { this.trigger("partialdone", n) }; h.prototype.endTimeline = function (n) { this.trigger("endedtimeline", n) }; h.prototype.reset = function (n) { this.trigger("reset", n) }; f = h; et = Math.pow(2, 32) - 1; !function () { var n; if (t = { avc1: [], avcC: [], btrt: [], dinf: [], dref: [], esds: [], ftyp: [], hdlr: [], mdat: [], mdhd: [], mdia: [], mfhd: [], minf: [], moof: [], moov: [], mp4a: [], mvex: [], mvhd: [], pasp: [], sdtp: [], smhd: [], stbl: [], stco: [], stsc: [], stsd: [], stsz: [], stts: [], styp: [], tfdt: [], tfhd: [], traf: [], trak: [], trun: [], trex: [], tkhd: [], vmhd: [] }, "undefined" != typeof Uint8Array) { for (n in t) t.hasOwnProperty(n) && (t[n] = [n.charCodeAt(0), n.charCodeAt(1), n.charCodeAt(2), n.charCodeAt(3)]); ut = new Uint8Array(["i".charCodeAt(0), "s".charCodeAt(0), "o".charCodeAt(0), "m".charCodeAt(0)]); er = new Uint8Array(["a".charCodeAt(0), "v".charCodeAt(0), "c".charCodeAt(0), "1".charCodeAt(0)]); fr = new Uint8Array([0, 0, 0, 1]); or = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 105, 100, 101, 111, 72, 97, 110, 100, 108, 101, 114, 0]); sr = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 111, 117, 110, 100, 72, 97, 110, 100, 108, 101, 114, 0]); hr = { video: or, audio: sr }; ar = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1]); lr = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]); w = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]); vr = w; yr = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]); pr = w; cr = new Uint8Array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]) } }(); i = function (n) { for (var i, r = [], u = 0, t = 1; t < arguments.length; t++)r.push(arguments[t]); for (t = r.length; t--;)u += r[t].byteLength; for (i = new Uint8Array(u + 8), new DataView(i.buffer, i.byteOffset, i.byteLength).setUint32(0, i.byteLength), i.set(n, 4), t = 0, u = 8; t < r.length; t++)i.set(r[t], u), u += r[t].byteLength; return i }; oi = function () { return i(t.dinf, i(t.dref, ar)) }; si = function (n) { return i(t.esds, new Uint8Array([0, 0, 0, 0, 3, 25, 0, 0, 0, 4, 17, 64, 21, 0, 6, 0, 0, 0, 218, 192, 0, 0, 218, 192, 5, 2, n.audioobjecttype << 3 | n.samplingfrequencyindex >>> 1, n.samplingfrequencyindex << 7 | n.channelcount << 3, 6, 1, 2])) }; gi = function (n) { return i(t.hdlr, hr[n]) }; di = function (n) { var r = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 3, 0, 1, 95, 144, n.duration >>> 24 & 255, n.duration >>> 16 & 255, n.duration >>> 8 & 255, 255 & n.duration, 85, 196, 0, 0]); return n.samplerate && (r[12] = n.samplerate >>> 24 & 255, r[13] = n.samplerate >>> 16 & 255, r[14] = n.samplerate >>> 8 & 255, r[15] = 255 & n.samplerate), i(t.mdhd, r) }; ki = function (n) { return i(t.mdia, di(n), gi(n.type), li(n)) }; ci = function (n) { return i(t.mfhd, new Uint8Array([0, 0, 0, 0, (4278190080 & n) >> 24, (16711680 & n) >> 16, (65280 & n) >> 8, 255 & n])) }; li = function (n) { return i(t.minf, "video" === n.type ? i(t.vmhd, cr) : i(t.smhd, lr), oi(), tr(n)) }; ai = function (n, r) { for (var f = [], u = r.length; u--;)f[u] = rr(r[u]); return i.apply(null, [t.moof, ci(n)].concat(f)) }; vi = function (n) { for (var r = n.length, u = []; r--;)u[r] = wi(n[r]); return i.apply(null, [t.moov, pi(4294967295)].concat(u).concat(yi(n))) }; yi = function (n) { for (var r = n.length, u = []; r--;)u[r] = ur(n[r]); return i.apply(null, [t.mvex].concat(u)) }; pi = function (n) { var r = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 1, 95, 144, (4278190080 & n) >> 24, (16711680 & n) >> 16, (65280 & n) >> 8, 255 & n, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255]); return i(t.mvhd, r) }; nr = function (n) { for (var u, f = n.samples || [], e = new Uint8Array(4 + f.length), r = 0; r < f.length; r++)u = f[r].flags, e[r + 4] = u.dependsOn << 4 | u.isDependedOn << 2 | u.hasRedundancy; return i(t.sdtp, e) }; tr = function (n) { return i(t.stbl, ir(n), i(t.stts, pr), i(t.stsc, vr), i(t.stsz, yr), i(t.stco, w)) }; ir = function (n) { return i(t.stsd, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1]), "video" === n.type ? wr(n) : br(n)) }; wr = function (n) { for (var c, u = n.sps || [], f = n.pps || [], e = [], o = [], s, h, r = 0; r < u.length; r++)e.push((65280 & u[r].byteLength) >>> 8), e.push(255 & u[r].byteLength), e = e.concat(Array.prototype.slice.call(u[r])); for (r = 0; r < f.length; r++)o.push((65280 & f[r].byteLength) >>> 8), o.push(255 & f[r].byteLength), o = o.concat(Array.prototype.slice.call(f[r])); return (c = [t.avc1, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (65280 & n.width) >> 8, 255 & n.width, (65280 & n.height) >> 8, 255 & n.height, 0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 19, 118, 105, 100, 101, 111, 106, 115, 45, 99, 111, 110, 116, 114, 105, 98, 45, 104, 108, 115, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 17, 17]), i(t.avcC, new Uint8Array([1, n.profileIdc, n.profileCompatibility, n.levelIdc, 255].concat([u.length], e, [f.length], o))), i(t.btrt, new Uint8Array([0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192]))], n.sarRatio) && (s = n.sarRatio[0], h = n.sarRatio[1], c.push(i(t.pasp, new Uint8Array([(4278190080 & s) >> 24, (16711680 & s) >> 16, (65280 & s) >> 8, 255 & s, (4278190080 & h) >> 24, (16711680 & h) >> 16, (65280 & h) >> 8, 255 & h])))), i.apply(null, c) }; br = function (n) { return i(t.mp4a, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, (65280 & n.channelcount) >> 8, 255 & n.channelcount, (65280 & n.samplesize) >> 8, 255 & n.samplesize, 0, 0, 0, 0, (65280 & n.samplerate) >> 8, 255 & n.samplerate, 0, 0]), si(n)) }; bi = function (n) { var r = new Uint8Array([0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, (4278190080 & n.id) >> 24, (16711680 & n.id) >> 16, (65280 & n.id) >> 8, 255 & n.id, 0, 0, 0, 0, (4278190080 & n.duration) >> 24, (16711680 & n.duration) >> 16, (65280 & n.duration) >> 8, 255 & n.duration, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, (65280 & n.width) >> 8, 255 & n.width, 0, 0, (65280 & n.height) >> 8, 255 & n.height, 0, 0]); return i(t.tkhd, r) }; rr = function (n) { var e, o, f, s, r, u; return e = i(t.tfhd, new Uint8Array([0, 0, 0, 58, (4278190080 & n.id) >> 24, (16711680 & n.id) >> 16, (65280 & n.id) >> 8, 255 & n.id, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])), r = Math.floor(n.baseMediaDecodeTime / (1 + et)), u = Math.floor(n.baseMediaDecodeTime % (1 + et)), o = i(t.tfdt, new Uint8Array([1, 0, 0, 0, r >>> 24 & 255, r >>> 16 & 255, r >>> 8 & 255, 255 & r, u >>> 24 & 255, u >>> 16 & 255, u >>> 8 & 255, 255 & u])), "audio" === n.type ? (f = rt(n, 92), i(t.traf, e, o, f)) : (s = nr(n), f = rt(n, s.length + 92), i(t.traf, e, o, f, s)) }; wi = function (n) { return n.duration = n.duration || 4294967295, i(t.trak, bi(n), ki(n)) }; ur = function (n) { var r = new Uint8Array([0, 0, 0, 0, (4278190080 & n.id) >> 24, (16711680 & n.id) >> 16, (65280 & n.id) >> 8, 255 & n.id, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1]); return "video" !== n.type && (r[r.length - 1] = 0), i(t.trex, r) }; ft = function (n, t) { var i = 0, r = 0, u = 0, f = 0; return n.length && (void 0 !== n[0].duration && (i = 1), void 0 !== n[0].size && (r = 2), void 0 !== n[0].flags && (u = 4), void 0 !== n[0].compositionTimeOffset && (f = 8)), [0, 0, i | r | u | f, 1, (4278190080 & n.length) >>> 24, (16711680 & n.length) >>> 16, (65280 & n.length) >>> 8, 255 & n.length, (4278190080 & t) >>> 24, (16711680 & t) >>> 16, (65280 & t) >>> 8, 255 & t] }; dr = function (n, r) { var f, e, u, o; for (r += 20 + 16 * (e = n.samples || []).length, f = ft(e, r), o = 0; o < e.length; o++)u = e[o], f = f.concat([(4278190080 & u.duration) >>> 24, (16711680 & u.duration) >>> 16, (65280 & u.duration) >>> 8, 255 & u.duration, (4278190080 & u.size) >>> 24, (16711680 & u.size) >>> 16, (65280 & u.size) >>> 8, 255 & u.size, u.flags.isLeading << 2 | u.flags.dependsOn, u.flags.isDependedOn << 6 | u.flags.hasRedundancy << 4 | u.flags.paddingValue << 1 | u.flags.isNonSyncSample, 61440 & u.flags.degradationPriority, 15 & u.flags.degradationPriority, (4278190080 & u.compositionTimeOffset) >>> 24, (16711680 & u.compositionTimeOffset) >>> 16, (65280 & u.compositionTimeOffset) >>> 8, 255 & u.compositionTimeOffset]); return i(t.trun, new Uint8Array(f)) }; kr = function (n, r) { var f, e, u, o; for (r += 20 + 8 * (e = n.samples || []).length, f = ft(e, r), o = 0; o < e.length; o++)u = e[o], f = f.concat([(4278190080 & u.duration) >>> 24, (16711680 & u.duration) >>> 16, (65280 & u.duration) >>> 8, 255 & u.duration, (4278190080 & u.size) >>> 24, (16711680 & u.size) >>> 16, (65280 & u.size) >>> 8, 255 & u.size]); return i(t.trun, new Uint8Array(f)) }; rt = function (n, t) { return "audio" === n.type ? kr(n, t) : dr(n, t) }; hi = function () { return i(t.ftyp, ut, fr, ut, er) }; var ot, gr, nu, st, tu, iu = function (n) { return i(t.mdat, n) }, ru = ai, ku = function (n) { var t, i = hi(), r = vi(n); return (t = new Uint8Array(i.byteLength + r.byteLength)).set(i), t.set(r, i.byteLength), t }, du = function (n) { var u, r, t = [], i = []; for (i.byteLength = 0, i.nalCount = 0, i.duration = 0, u = t.byteLength = 0; u < n.length; u++)"access_unit_delimiter_rbsp" === (r = n[u]).nalUnitType ? (t.length && (t.duration = r.dts - t.dts, i.byteLength += t.byteLength, i.nalCount += t.length, i.duration += t.duration, i.push(t)), (t = [r]).byteLength = r.data.byteLength, t.pts = r.pts, t.dts = r.dts) : ("slice_layer_without_partitioning_rbsp_idr" === r.nalUnitType && (t.keyFrame = !0), t.duration = r.dts - t.dts, t.byteLength += r.data.byteLength, t.push(r)); return i.length && (!t.duration || t.duration <= 0) && (t.duration = i[i.length - 1].duration), i.byteLength += t.byteLength, i.nalCount += t.length, i.duration += t.duration, i.push(t), i }, gu = function (n) { var u, r, t = [], i = []; for (t.byteLength = 0, t.nalCount = 0, t.duration = 0, t.pts = n[0].pts, t.dts = n[0].dts, i.byteLength = 0, i.nalCount = 0, i.duration = 0, i.pts = n[0].pts, i.dts = n[0].dts, u = 0; u < n.length; u++)(r = n[u]).keyFrame ? (t.length && (i.push(t), i.byteLength += t.byteLength, i.nalCount += t.nalCount, i.duration += t.duration), (t = [r]).nalCount = r.length, t.byteLength = r.byteLength, t.pts = r.pts, t.dts = r.dts, t.duration = r.duration) : (t.duration += r.duration, t.nalCount += r.length, t.byteLength += r.byteLength, t.push(r)); return i.length && t.duration <= 0 && (t.duration = i[i.length - 1].duration), i.byteLength += t.byteLength, i.nalCount += t.nalCount, i.duration += t.duration, i.push(t), i }, nf = function (n) { var t; return !n[0][0].keyFrame && 1 < n.length && (t = n.shift(), n.byteLength -= t.byteLength, n.nalCount -= t.nalCount, n[0][0].dts = t.dts, n[0][0].pts = t.pts, n[0][0].duration += t.duration), n }, tf = function (n, t) { for (var r, f, u, e, o = t || 0, s = [], i = 0; i < n.length; i++)for (u = n[i], r = 0; r < u.length; r++)e = u[r], o += (f = bu(e, o)).size, s.push(f); return s }, rf = function (n) { for (var i, r, e, o, u, f = 0, h = n.byteLength, c = n.nalCount, s = new Uint8Array(h + 4 * c), l = new DataView(s.buffer), t = 0; t < n.length; t++)for (e = n[t], i = 0; i < e.length; i++)for (o = e[i], r = 0; r < o.length; r++)u = o[r], l.setUint32(f, u.data.byteLength), f += 4, s.set(u.data, f), f += u.data.byteLength; return s }, c = [33, 16, 5, 32, 164, 27], ht = [33, 65, 108, 84, 1, 2, 4, 8, 168, 2, 4, 8, 17, 191, 252], uf = { 96e3: [c, [227, 64], r(154), [56]], 88200: [c, [231], r(170), [56]], 64e3: [c, [248, 192], r(240), [56]], 48e3: [c, [255, 192], r(268), [55, 148, 128], r(54), [112]], 44100: [c, [255, 192], r(268), [55, 163, 128], r(84), [112]], 32e3: [c, [255, 192], r(268), [55, 234], r(226), [112]], 24e3: [c, [255, 192], r(268), [55, 255, 128], r(268), [111, 112], r(126), [224]], 16e3: [c, [255, 192], r(268), [55, 255, 128], r(268), [111, 255], r(269), [223, 108], r(195), [1, 192]], 12e3: [ht, r(268), [3, 127, 248], r(268), [6, 255, 240], r(268), [13, 255, 224], r(268), [27, 253, 128], r(259), [56]], 11025: [ht, r(268), [3, 127, 248], r(268), [6, 255, 240], r(268), [13, 255, 224], r(268), [27, 255, 192], r(268), [55, 175, 128], r(108), [112]], 8e3: [ht, r(268), [3, 121, 16], r(47), [7]] }, ff = (ot = uf, Object.keys(ot).reduce(function (n, t) { return n[t] = new Uint8Array(ot[t].reduce(function (n, t) { return n.concat(t) }, [])), n }, {})), y = 9e4, ef = (gr = function (n) { return 9e4 * n }, nu = function (n, t) { return n * t }, st = function (n) { return n / 9e4 }, tu = function (n, t) { return n / t }, function (n, t) { return gr(tu(n, t)) }), of = function (n, t) { return nu(st(n), t) }, ct = function (n, t, i) { return st(i ? n : n - t) }, sf = function (n, t, i, r) { var c, u, f, e, o, l = 0, s = 0, h = 0; if (t.length && (c = ef(n.baseMediaDecodeTime, n.samplerate), u = Math.ceil(y / (n.samplerate / 1024)), i && r && (l = c - Math.max(i, r), h = (s = Math.floor(l / u)) * u), !(s < 1 || y / 2 < h))) { for (f = (f = ff[n.samplerate]) || t[0].data, e = 0; e < s; e++)o = t[0], t.splice(0, 0, { data: f, dts: o.dts - u, pts: o.pts - u }); n.baseMediaDecodeTime -= Math.floor(of(h, n.samplerate)) } }, hf = function (n, t, i) { return t.minSegmentDts >= i ? n : (t.minSegmentDts = 1 / 0, n.filter(function (n) { return n.dts >= i && (t.minSegmentDts = Math.min(t.minSegmentDts, n.dts), t.minSegmentPts = t.minSegmentDts, !0) })) }, cf = function (n) { for (var i, r = [], t = 0; t < n.length; t++)i = n[t], r.push({ size: i.data.byteLength, duration: 1024 }); return r }, lf = function (n) { for (var i, r = 0, u = new Uint8Array(function (n) { for (var i = 0, t = 0; t < n.length; t++)i += n[t].data.byteLength; return i }(n)), t = 0; t < n.length; t++)i = n[t], u.set(i.data, r), r += i.data.byteLength; return u }, af = y, a = function (n) { delete n.minSegmentDts; delete n.maxSegmentDts; delete n.minSegmentPts; delete n.maxSegmentPts }, uu = function (n, t) { var i, r = n.minSegmentDts; return t || (r -= n.timelineStartInfo.dts), i = n.timelineStartInfo.baseMediaDecodeTime, i += r, i = Math.max(0, i), "audio" === n.type && (i *= n.samplerate / af, i = Math.floor(i)), i }, lt = function (n, t) { "number" == typeof t.pts && (void 0 === n.timelineStartInfo.pts && (n.timelineStartInfo.pts = t.pts), n.minSegmentPts = void 0 === n.minSegmentPts ? t.pts : Math.min(n.minSegmentPts, t.pts), n.maxSegmentPts = void 0 === n.maxSegmentPts ? t.pts : Math.max(n.maxSegmentPts, t.pts)); "number" == typeof t.dts && (void 0 === n.timelineStartInfo.dts && (n.timelineStartInfo.dts = t.dts), n.minSegmentDts = void 0 === n.minSegmentDts ? t.dts : Math.min(n.minSegmentDts, t.dts), n.maxSegmentDts = void 0 === n.maxSegmentDts ? t.dts : Math.max(n.maxSegmentDts, t.dts)) }, vf = function (n) { for (var t = 0, r = { payloadType: -1, payloadSize: 0 }, u = 0, i = 0; t < n.byteLength && 128 !== n[t];) { for (; 255 === n[t];)u += 255, t++; for (u += n[t++]; 255 === n[t];)i += 255, t++; if (i += n[t++], !r.payload && 4 === u) { r.payloadType = u; r.payloadSize = i; r.payload = n.subarray(t, t + i); break } t += i; i = u = 0 } return r }, yf = function (n) { return 181 !== n.payload[0] ? null : 49 != (n.payload[1] << 8 | n.payload[2]) ? null : "GA94" !== String.fromCharCode(n.payload[3], n.payload[4], n.payload[5], n.payload[6]) ? null : 3 !== n.payload[7] ? null : n.payload.subarray(8, n.payload.length - 1) }, pf = function (n, t) { var i, e, r, u, f = []; if (!(64 & t[0])) return f; for (e = 31 & t[0], i = 0; i < e; i++)u = { type: 3 & t[2 + (r = 3 * i)], pts: n }, 4 & t[2 + r] && (u.ccData = t[3 + r] << 8 | t[4 + r], f.push(u)); return f }, wf = 4; (o.prototype = new f).push = function (n) { var t, i, r; if ("sei_rbsp" === n.nalUnitType && (t = vf(n.escapedRBSP)).payloadType === wf && (i = yf(t))) if (n.dts < this.latestDts_) this.ignoreNextEqualDts_ = !0; else { if (n.dts === this.latestDts_ && this.ignoreNextEqualDts_) return this.numSameDts_--, void (this.numSameDts_ || (this.ignoreNextEqualDts_ = !1)); r = pf(n.pts, i); this.captionPackets_ = this.captionPackets_.concat(r); this.latestDts_ !== n.dts && (this.numSameDts_ = 0); this.numSameDts_++; this.latestDts_ = n.dts } }; o.prototype.flushCCStreams = function (n) { this.ccStreams_.forEach(function (t) { return "flush" === n ? t.flush() : t.partialFlush() }, this) }; o.prototype.flushStream = function (n) { this.captionPackets_.length && (this.captionPackets_.forEach(function (n, t) { n.presortIndex = t }), this.captionPackets_.sort(function (n, t) { return n.pts === t.pts ? n.presortIndex - t.presortIndex : n.pts - t.pts }), this.captionPackets_.forEach(function (n) { n.type < 2 && this.dispatchCea608Packet(n) }, this), this.captionPackets_.length = 0); this.flushCCStreams(n) }; o.prototype.flush = function () { return this.flushStream("flush") }; o.prototype.partialFlush = function () { return this.flushStream("partialFlush") }; o.prototype.reset = function () { this.latestDts_ = null; this.ignoreNextEqualDts_ = !1; this.numSameDts_ = 0; this.activeCea608Channel_ = [null, null]; this.ccStreams_.forEach(function (n) { n.reset() }) }; o.prototype.dispatchCea608Packet = function (n) { this.setsTextOrXDSActive(n) ? this.activeCea608Channel_[n.type] = null : this.setsChannel1Active(n) ? this.activeCea608Channel_[n.type] = 0 : this.setsChannel2Active(n) && (this.activeCea608Channel_[n.type] = 1); null !== this.activeCea608Channel_[n.type] && this.ccStreams_[(n.type << 1) + this.activeCea608Channel_[n.type]].push(n) }; o.prototype.setsChannel1Active = function (n) { return 4096 == (30720 & n.ccData) }; o.prototype.setsChannel2Active = function (n) { return 6144 == (30720 & n.ccData) }; o.prototype.setsTextOrXDSActive = function (n) { return 256 == (28928 & n.ccData) || 4138 == (30974 & n.ccData) || 6186 == (30974 & n.ccData) }; var bf = { 42: 225, 92: 233, 94: 237, 95: 243, 96: 250, 123: 231, 124: 247, 125: 209, 126: 241, 127: 9608, 304: 174, 305: 176, 306: 189, 307: 191, 308: 8482, 309: 162, 310: 163, 311: 9834, 312: 224, 313: 160, 314: 232, 315: 226, 316: 234, 317: 238, 318: 244, 319: 251, 544: 193, 545: 201, 546: 211, 547: 218, 548: 220, 549: 252, 550: 8216, 551: 161, 552: 42, 553: 39, 554: 8212, 555: 169, 556: 8480, 557: 8226, 558: 8220, 559: 8221, 560: 192, 561: 194, 562: 199, 563: 200, 564: 202, 565: 203, 566: 235, 567: 206, 568: 207, 569: 239, 570: 212, 571: 217, 572: 249, 573: 219, 574: 171, 575: 187, 800: 195, 801: 227, 802: 205, 803: 204, 804: 236, 805: 210, 806: 242, 807: 213, 808: 245, 809: 123, 810: 125, 811: 92, 812: 94, 813: 95, 814: 124, 815: 126, 816: 196, 817: 228, 818: 214, 819: 246, 820: 223, 821: 165, 822: 164, 823: 9474, 824: 197, 825: 229, 826: 216, 827: 248, 828: 9484, 829: 9488, 830: 9492, 831: 9496 }, kf = [4352, 4384, 4608, 4640, 5376, 5408, 5632, 5664, 5888, 5920, 4096, 4864, 4896, 5120, 5152], u = function h(n, t) { h.prototype.init.call(this); this.field_ = n || 0; this.dataChannel_ = t || 0; this.name_ = "CC" + (1 + (this.field_ << 1 | this.dataChannel_)); this.setConstants(); this.reset(); this.push = function (n) { var t, e, r, i, u, f; (t = 32639 & n.ccData) !== this.lastControlCode_ ? (4096 == (61440 & t) ? this.lastControlCode_ = t : t !== this.PADDING_ && (this.lastControlCode_ = null), r = t >>> 8, i = 255 & t, t !== this.PADDING_) && (t === this.RESUME_CAPTION_LOADING_ ? this.mode_ = "popOn" : t === this.END_OF_CAPTION_ ? (this.mode_ = "popOn", this.clearFormatting(n.pts), this.flushDisplayed(n.pts), e = this.displayed_, this.displayed_ = this.nonDisplayed_, this.nonDisplayed_ = e, this.startPts_ = n.pts) : t === this.ROLL_UP_2_ROWS_ ? (this.rollUpRows_ = 2, this.setRollUp(n.pts)) : t === this.ROLL_UP_3_ROWS_ ? (this.rollUpRows_ = 3, this.setRollUp(n.pts)) : t === this.ROLL_UP_4_ROWS_ ? (this.rollUpRows_ = 4, this.setRollUp(n.pts)) : t === this.CARRIAGE_RETURN_ ? (this.clearFormatting(n.pts), this.flushDisplayed(n.pts), this.shiftRowsUp_(), this.startPts_ = n.pts) : t === this.BACKSPACE_ ? "popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[this.row_] = this.displayed_[this.row_].slice(0, -1) : t === this.ERASE_DISPLAYED_MEMORY_ ? (this.flushDisplayed(n.pts), this.displayed_ = l()) : t === this.ERASE_NON_DISPLAYED_MEMORY_ ? this.nonDisplayed_ = l() : t === this.RESUME_DIRECT_CAPTIONING_ ? ("paintOn" !== this.mode_ && (this.flushDisplayed(n.pts), this.displayed_ = l()), this.mode_ = "paintOn", this.startPts_ = n.pts) : this.isSpecialCharacter(r, i) ? (u = b((r = (3 & r) << 8) | i), this[this.mode_](n.pts, u), this.column_++) : this.isExtCharacter(r, i) ? ("popOn" === this.mode_ ? this.nonDisplayed_[this.row_] = this.nonDisplayed_[this.row_].slice(0, -1) : this.displayed_[this.row_] = this.displayed_[this.row_].slice(0, -1), u = b((r = (3 & r) << 8) | i), this[this.mode_](n.pts, u), this.column_++) : this.isMidRowCode(r, i) ? (this.clearFormatting(n.pts), this[this.mode_](n.pts, " "), this.column_++, 14 == (14 & i) && this.addFormatting(n.pts, ["i"]), 1 == (1 & i) && this.addFormatting(n.pts, ["u"])) : this.isOffsetControlCode(r, i) ? this.column_ += 3 & i : this.isPAC(r, i) ? (f = kf.indexOf(7968 & t), "rollUp" === this.mode_ && (f - this.rollUpRows_ + 1 < 0 && (f = this.rollUpRows_ - 1), this.setRollUp(n.pts, f)), f !== this.row_ && (this.clearFormatting(n.pts), this.row_ = f), 1 & i && -1 === this.formatting_.indexOf("u") && this.addFormatting(n.pts, ["u"]), 16 == (16 & t) && (this.column_ = 4 * ((14 & t) >> 1)), this.isColorPAC(i) && 14 == (14 & i) && this.addFormatting(n.pts, ["i"])) : this.isNormalChar(r) && (0 === i && (i = null), u = b(r), u += b(i), this[this.mode_](n.pts, u), this.column_ += u.length)) : this.lastControlCode_ = null } }; u.prototype = new f; u.prototype.flushDisplayed = function (n) { var t = this.displayed_.map(function (n) { try { return n.trim() } catch (n) { return "" } }).join("\n").replace(/^\n+|\n+$/g, ""); t.length && this.trigger("data", { startPts: this.startPts_, endPts: n, text: t, stream: this.name_ }) }; u.prototype.reset = function () { this.mode_ = "popOn"; this.topRow_ = 0; this.startPts_ = 0; this.displayed_ = l(); this.nonDisplayed_ = l(); this.lastControlCode_ = null; this.column_ = 0; this.row_ = 14; this.rollUpRows_ = 2; this.formatting_ = [] }; u.prototype.setConstants = function () { 0 === this.dataChannel_ ? (this.BASE_ = 16, this.EXT_ = 17, this.CONTROL_ = (20 | this.field_) << 8, this.OFFSET_ = 23) : 1 === this.dataChannel_ && (this.BASE_ = 24, this.EXT_ = 25, this.CONTROL_ = (28 | this.field_) << 8, this.OFFSET_ = 31); this.PADDING_ = 0; this.RESUME_CAPTION_LOADING_ = 32 | this.CONTROL_; this.END_OF_CAPTION_ = 47 | this.CONTROL_; this.ROLL_UP_2_ROWS_ = 37 | this.CONTROL_; this.ROLL_UP_3_ROWS_ = 38 | this.CONTROL_; this.ROLL_UP_4_ROWS_ = 39 | this.CONTROL_; this.CARRIAGE_RETURN_ = 45 | this.CONTROL_; this.RESUME_DIRECT_CAPTIONING_ = 41 | this.CONTROL_; this.BACKSPACE_ = 33 | this.CONTROL_; this.ERASE_DISPLAYED_MEMORY_ = 44 | this.CONTROL_; this.ERASE_NON_DISPLAYED_MEMORY_ = 46 | this.CONTROL_ }; u.prototype.isSpecialCharacter = function (n, t) { return n === this.EXT_ && 48 <= t && t <= 63 }; u.prototype.isExtCharacter = function (n, t) { return (n === this.EXT_ + 1 || n === this.EXT_ + 2) && 32 <= t && t <= 63 }; u.prototype.isMidRowCode = function (n, t) { return n === this.EXT_ && 32 <= t && t <= 47 }; u.prototype.isOffsetControlCode = function (n, t) { return n === this.OFFSET_ && 33 <= t && t <= 35 }; u.prototype.isPAC = function (n, t) { return n >= this.BASE_ && n < this.BASE_ + 8 && 64 <= t && t <= 127 }; u.prototype.isColorPAC = function (n) { return 64 <= n && n <= 79 || 96 <= n && n <= 127 }; u.prototype.isNormalChar = function (n) { return 32 <= n && n <= 127 }; u.prototype.setRollUp = function (n, t) { if ("rollUp" !== this.mode_ && (this.row_ = 14, this.mode_ = "rollUp", this.flushDisplayed(n), this.nonDisplayed_ = l(), this.displayed_ = l()), void 0 !== t && t !== this.row_) for (var i = 0; i < this.rollUpRows_; i++)this.displayed_[t - i] = this.displayed_[this.row_ - i], this.displayed_[this.row_ - i] = ""; void 0 === t && (t = this.row_); this.topRow_ = t - this.rollUpRows_ + 1 }; u.prototype.addFormatting = function (n, t) { this.formatting_ = this.formatting_.concat(t); var i = t.reduce(function (n, t) { return n + "<" + t + ">" }, ""); this[this.mode_](n, i) }; u.prototype.clearFormatting = function (n) { if (this.formatting_.length) { var t = this.formatting_.reverse().reduce(function (n, t) { return n + "<\/" + t + ">" }, ""); this.formatting_ = []; this[this.mode_](n, t) } }; u.prototype.popOn = function (n, t) { var i = this.nonDisplayed_[this.row_]; i += t; this.nonDisplayed_[this.row_] = i }; u.prototype.rollUp = function (n, t) { var i = this.displayed_[this.row_]; i += t; this.displayed_[this.row_] = i }; u.prototype.shiftRowsUp_ = function () { for (var n = 0; n < this.topRow_; n++)this.displayed_[n] = ""; for (n = this.row_ + 1; n < 15; n++)this.displayed_[n] = ""; for (n = this.topRow_; n < this.row_; n++)this.displayed_[n] = this.displayed_[n + 1]; this.displayed_[this.row_] = "" }; u.prototype.paintOn = function (n, t) { var i = this.displayed_[this.row_]; i += t; this.displayed_[this.row_] = i }; vt = { CaptionStream: o, Cea608Stream: u }; e = { H264_STREAM_TYPE: 27, ADTS_STREAM_TYPE: 15, METADATA_STREAM_TYPE: 21 }; at.prototype = new f; ou = at; pt = { TXXX: function (n) { var t; if (3 === n.data[0]) { for (t = 1; t < n.data.length; t++)if (0 === n.data[t]) { n.description = k(n.data, 1, t); n.value = k(n.data, t + 1, n.data.length).replace(/\0*$/, ""); break } n.data = n.value } }, WXXX: function (n) { var t; if (3 === n.data[0]) for (t = 1; t < n.data.length; t++)if (0 === n.data[t]) { n.description = k(n.data, 1, t); n.url = k(n.data, t + 1, n.data.length); break } }, PRIV: function (n) { for (var i, t = 0; t < n.data.length; t++)if (0 === n.data[t]) { n.owner = (i = n.data, unescape(eu(i, 0, t))); break } n.privateData = n.data.subarray(t + 1); n.data = n.privateData } }; (yt = function (n) { var r, u = { debug: !(!n || !n.debug), descriptor: n && n.descriptor }, i = 0, t = [], f = 0; if (yt.prototype.init.call(this), this.dispatchType = e.METADATA_STREAM_TYPE.toString(16), u.descriptor) for (r = 0; r < u.descriptor.length; r++)this.dispatchType += ("00" + u.descriptor[r].toString(16)).slice(-2); this.push = function (n) { var r, e, l, o, h, s, c; if ("timed-metadata" === n.type) if (n.dataAlignmentIndicator && (f = 0, t.length = 0), 0 === t.length && (n.data.length < 10 || n.data[0] !== "I".charCodeAt(0) || n.data[1] !== "D".charCodeAt(0) || n.data[2] !== "3".charCodeAt(0))) u.debug; else if (t.push(n), f += n.data.byteLength, 1 === t.length && (i = d(n.data.subarray(6, 10)), i += 10), !(f < i)) { for (r = { data: new Uint8Array(i), frames: [], pts: t[0].pts, dts: t[0].dts }, h = 0; h < i;)r.data.set(t[0].data.subarray(0, i - h), h), h += t[0].data.byteLength, f -= t[0].data.byteLength, t.shift(); e = 10; 64 & r.data[5] && (e += 4, e += d(r.data.subarray(10, 14)), i -= d(r.data.subarray(16, 20))); do { if ((l = d(r.data.subarray(e + 4, e + 8))) < 1) return; ((o = { id: String.fromCharCode(r.data[e], r.data[e + 1], r.data[e + 2], r.data[e + 3]), data: r.data.subarray(e + 10, e + l + 10) }).key = o.id, pt[o.id] && (pt[o.id](o), "com.apple.streaming.transportStreamTimestamp" === o.owner)) && (s = o.data, c = (1 & s[3]) << 30 | s[4] << 22 | s[5] << 14 | s[6] << 6 | s[7] >>> 2, c *= 4, c += 3 & s[7], o.timeStamp = c, void 0 === r.pts && void 0 === r.dts && (r.pts = o.timeStamp, r.dts = o.timeStamp), this.trigger("timestamp", o)); r.frames.push(o); e += 10; e += l } while (e < i); this.trigger("data", r) } } }).prototype = new f; su = yt; hu = ou; (wt = function () { var t = new Uint8Array(188), n = 0; wt.prototype.init.call(this); this.push = function (i) { var r, u = 0, f = 188; for (n ? ((r = new Uint8Array(i.byteLength + n)).set(t.subarray(0, n)), r.set(i, n), n = 0) : r = i; f < r.byteLength;)71 !== r[u] || 71 !== r[f] ? (u++, f++) : (this.trigger("data", r.subarray(u, f)), u += 188, f += 188); u < r.byteLength && (t.set(r.subarray(u), 0), n = r.byteLength - u) }; this.flush = function () { 188 === n && 71 === t[0] && (this.trigger("data", t), n = 0); this.trigger("done") }; this.endTimeline = function () { this.flush(); this.trigger("endedtimeline") }; this.reset = function () { n = 0; this.trigger("reset") } }).prototype = new f; (g = function () { var t, i, r, n; g.prototype.init.call(this); (n = this).packetsWaitingForPmt = []; this.programMapTable = void 0; t = function (n, t) { var u = 0; t.payloadUnitStartIndicator && (u += n[u] + 1); "pat" === t.type ? i(n.subarray(u), t) : r(n.subarray(u), t) }; i = function (t, i) { i.section_number = t[7]; i.last_section_number = t[8]; n.pmtPid = (31 & t[10]) << 8 | t[11]; i.pmtPid = n.pmtPid }; r = function (t, i) { var o, r, u, f; if (1 & t[5]) { for (n.programMapTable = { video: null, audio: null, "timed-metadata": {} }, o = 3 + ((15 & t[1]) << 8 | t[2]) - 4, r = 12 + ((15 & t[10]) << 8 | t[11]); r < o;)u = t[r], f = (31 & t[r + 1]) << 8 | t[r + 2], u === e.H264_STREAM_TYPE && null === n.programMapTable.video ? n.programMapTable.video = f : u === e.ADTS_STREAM_TYPE && null === n.programMapTable.audio ? n.programMapTable.audio = f : u === e.METADATA_STREAM_TYPE && (n.programMapTable["timed-metadata"][f] = u), r += 5 + ((15 & t[r + 3]) << 8 | t[r + 4]); i.programMapTable = n.programMapTable } }; this.push = function (n) { var i = {}, r = 4; if (i.payloadUnitStartIndicator = !!(64 & n[1]), i.pid = 31 & n[1], i.pid <<= 8, i.pid |= n[2], 1 < (48 & n[3]) >>> 4 && (r += n[r] + 1), 0 === i.pid) i.type = "pat", t(n.subarray(r), i), this.trigger("data", i); else if (i.pid === this.pmtPid) for (i.type = "pmt", t(n.subarray(r), i), this.trigger("data", i); this.packetsWaitingForPmt.length;)this.processPes_.apply(this, this.packetsWaitingForPmt.shift()); else void 0 === this.programMapTable ? this.packetsWaitingForPmt.push([n, r, i]) : this.processPes_(n, r, i) }; this.processPes_ = function (n, t, i) { i.streamType = i.pid === this.programMapTable.video ? e.H264_STREAM_TYPE : i.pid === this.programMapTable.audio ? e.ADTS_STREAM_TYPE : this.programMapTable["timed-metadata"][i.pid]; i.type = "pes"; i.data = n.subarray(t); this.trigger("data", i) } }).prototype = new f; g.STREAM_TYPES = { h264: 27, adts: 15 }; (bt = function () { function n(n, t, i) { var e, o, s = new Uint8Array(n.size), r = { type: t }, f = 0, h = 0; if (n.data.length && !(n.size < 9)) { for (r.trackId = n.data[0].pid, f = 0; f < n.data.length; f++)o = n.data[f], s.set(o.data, h), h += o.data.byteLength; !function (n, t) { var i; t.packetLength = 6 + (n[4] << 8 | n[5]); t.dataAlignmentIndicator = 0 != (4 & n[6]); 192 & (i = n[7]) && (t.pts = (14 & n[9]) << 27 | (255 & n[10]) << 20 | (254 & n[11]) << 12 | (255 & n[12]) << 5 | (254 & n[13]) >>> 3, t.pts *= 4, t.pts += (6 & n[13]) >>> 1, t.dts = t.pts, 64 & i && (t.dts = (14 & n[14]) << 27 | (255 & n[15]) << 20 | (254 & n[16]) << 12 | (255 & n[17]) << 5 | (254 & n[18]) >>> 3, t.dts *= 4, t.dts += (6 & n[18]) >>> 1)); t.data = n.subarray(9 + n[8]) }(s, r); e = "video" === t || r.packetLength <= n.size; (i || e) && (n.size = 0, n.data.length = 0); e && u.trigger("data", r) } } var t, u = this, i = { data: [], size: 0 }, r = { data: [], size: 0 }, f = { data: [], size: 0 }; bt.prototype.init.call(this); this.push = function (o) { ({ pat: function () { }, pes: function () { var t, u; switch (o.streamType) { case e.H264_STREAM_TYPE: case e.H264_STREAM_TYPE: t = i; u = "video"; break; case e.ADTS_STREAM_TYPE: t = r; u = "audio"; break; case e.METADATA_STREAM_TYPE: t = f; u = "timed-metadata"; break; default: return }o.payloadUnitStartIndicator && n(t, u, !0); t.data.push(o); t.size += o.data.byteLength }, pmt: function () { var n = { type: "metadata", tracks: [] }; null !== (t = o.programMapTable).video && n.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +t.video, codec: "avc", type: "video" }); null !== t.audio && n.tracks.push({ timelineStartInfo: { baseMediaDecodeTime: 0 }, id: +t.audio, codec: "adts", type: "audio" }); u.trigger("data", n) } })[o.type]() }; this.reset = function () { i.size = 0; i.data.length = 0; r.size = 0; r.data.length = 0; this.trigger("reset") }; this.flushStreams_ = function () { n(i, "video"); n(r, "audio"); n(f, "timed-metadata") }; this.flush = function () { this.flushStreams_(); this.trigger("done") } }).prototype = new f; kt = { PAT_PID: 0, MP2T_PACKET_LENGTH: 188, TransportPacketStream: wt, TransportParseStream: g, ElementaryStream: bt, TimestampRolloverStream: hu, CaptionStream: vt.CaptionStream, Cea608Stream: vt.Cea608Stream, MetadataStream: su }; for (nt in e) e.hasOwnProperty(nt) && (kt[nt] = e[nt]); var dt, s = kt, df = y, cu = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350]; (dt = function (n) { var t, i = 0; dt.prototype.init.call(this); this.push = function (r) { var s, h, f, e, c, o, u = 0; if (n || (i = 0), "audio" === r.type) for (t ? (e = t, (t = new Uint8Array(e.byteLength + r.data.byteLength)).set(e), t.set(r.data, e.byteLength)) : t = r.data; u + 5 < t.length;)if (255 === t[u] && 240 == (246 & t[u + 1])) { if (h = 2 * (1 & ~t[u + 1]), s = (3 & t[u + 3]) << 11 | t[u + 4] << 3 | (224 & t[u + 5]) >> 5, o = (c = 1024 * (1 + (3 & t[u + 6]))) * df / cu[(60 & t[u + 2]) >>> 2], f = u + s, t.byteLength < f) return; if (this.trigger("data", { pts: r.pts + i * o, dts: r.dts + i * o, sampleCount: c, audioobjecttype: 1 + (t[u + 2] >>> 6 & 3), channelcount: (1 & t[u + 2]) << 2 | (192 & t[u + 3]) >>> 6, samplerate: cu[(60 & t[u + 2]) >>> 2], samplingfrequencyindex: (60 & t[u + 2]) >>> 2, samplesize: 16, data: t.subarray(u + 7 + h, f) }), i++, t.byteLength === f) return void (t = void 0); t = t.subarray(f) } else u++ }; this.flush = function () { i = 0; this.trigger("done") }; this.reset = function () { t = void 0; this.trigger("reset") }; this.endTimeline = function () { t = void 0; this.trigger("endedtimeline") } }).prototype = new f; ni = dt; au = function (n) { var i = n.byteLength, r = 0, t = 0; this.length = function () { return 8 * i }; this.bitsAvailable = function () { return 8 * i + t }; this.loadWord = function () { var f = n.byteLength - i, e = new Uint8Array(4), u = Math.min(4, i); if (0 === u) throw new Error("no bytes available"); e.set(n.subarray(f, f + u)); r = new DataView(e.buffer).getUint32(0); t = 8 * u; i -= u }; this.skipBits = function (n) { var u; n < t || (n -= t, n -= 8 * (u = Math.floor(n / 8)), i -= u, this.loadWord()); r <<= n; t -= n }; this.readBits = function (n) { var u = Math.min(t, n), f = r >>> 32 - u; return 0 < (t -= u) ? r <<= u : 0 < i && this.loadWord(), 0 < (u = n - u) ? f << u | this.readBits(u) : f }; this.skipLeadingZeros = function () { for (var n = 0; n < t; ++n)if (0 != (r & 2147483648 >>> n)) return r <<= n, t -= n, n; return this.loadWord(), n + this.skipLeadingZeros() }; this.skipUnsignedExpGolomb = function () { this.skipBits(1 + this.skipLeadingZeros()) }; this.skipExpGolomb = function () { this.skipBits(1 + this.skipLeadingZeros()) }; this.readUnsignedExpGolomb = function () { var n = this.skipLeadingZeros(); return this.readBits(n + 1) - 1 }; this.readExpGolomb = function () { var n = this.readUnsignedExpGolomb(); return 1 & n ? 1 + n >>> 1 : -1 * (n >>> 1) }; this.readBoolean = function () { return 1 === this.readBits(1) }; this.readUnsignedByte = function () { return this.readBits(8) }; this.loadWord() }; (tt = function () { var n, t, i = 0; tt.prototype.init.call(this); this.push = function (r) { for (var u, f = (t = t ? ((u = new Uint8Array(t.byteLength + r.data.byteLength)).set(t), u.set(r.data, t.byteLength), u) : r.data).byteLength; i < f - 3; i++)if (1 === t[i + 2]) { n = i + 5; break } for (; n < f;)switch (t[n]) { case 0: if (0 !== t[n - 1]) { n += 2; break } if (0 !== t[n - 2]) { n++; break } for (i + 3 !== n - 2 && this.trigger("data", t.subarray(i + 3, n - 2)); 1 !== t[++n] && n < f;); i = n - 2; n += 3; break; case 1: if (0 !== t[n - 1] || 0 !== t[n - 2]) { n += 3; break } this.trigger("data", t.subarray(i + 3, n - 2)); i = n - 2; n += 3; break; default: n += 3 }t = t.subarray(i); n -= i; i = 0 }; this.reset = function () { t = null; i = 0; this.trigger("reset") }; this.flush = function () { t && 3 < t.byteLength && this.trigger("data", t.subarray(i + 3)); t = null; i = 0; this.trigger("done") }; this.endTimeline = function () { this.flush(); this.trigger("endedtimeline") } }).prototype = new f; lu = { 100: !0, 110: !0, 122: !0, 244: !0, 44: !0, 83: !0, 86: !0, 118: !0, 128: !0, 138: !0, 139: !0, 134: !0 }; (gt = function () { var t, r, u, f, i, e, o, n = new tt; gt.prototype.init.call(this); (t = this).push = function (t) { "video" === t.type && (r = t.trackId, u = t.pts, f = t.dts, n.push(t)) }; n.on("data", function (n) { var o = { trackId: r, pts: u, dts: f, data: n }; switch (31 & n[0]) { case 5: o.nalUnitType = "slice_layer_without_partitioning_rbsp_idr"; break; case 6: o.nalUnitType = "sei_rbsp"; o.escapedRBSP = i(n.subarray(1)); break; case 7: o.nalUnitType = "seq_parameter_set_rbsp"; o.escapedRBSP = i(n.subarray(1)); o.config = e(o.escapedRBSP); break; case 8: o.nalUnitType = "pic_parameter_set_rbsp"; break; case 9: o.nalUnitType = "access_unit_delimiter_rbsp" }t.trigger("data", o) }); n.on("done", function () { t.trigger("done") }); n.on("partialdone", function () { t.trigger("partialdone") }); n.on("reset", function () { t.trigger("reset") }); n.on("endedtimeline", function () { t.trigger("endedtimeline") }); this.flush = function () { n.flush() }; this.partialFlush = function () { n.partialFlush() }; this.reset = function () { n.reset() }; this.endTimeline = function () { n.endTimeline() }; o = function (n, t) { for (var u = 8, i = 8, r = 0; r < n; r++)0 !== i && (i = (u + t.readExpGolomb() + 256) % 256), u = 0 === i ? u : i }; i = function (n) { for (var r, u, f, e = n.byteLength, i = [], t = 1; t < e - 2;)0 === n[t] && 0 === n[t + 1] && 3 === n[t + 2] ? (i.push(t + 2), t += 2) : t++; if (0 === i.length) return n; for (u = e - i.length, f = new Uint8Array(u), r = 0, t = 0; t < u; r++, t++)r === i[0] && (r++, i.shift()), f[t] = n[r]; return f }; e = function (n) { var t, u, f, e, s, h, c, l, a, v, y, i, r, p = 0, w = 0, b = 0, k = 0, d = 1; if (u = (t = new au(n)).readUnsignedByte(), e = t.readUnsignedByte(), f = t.readUnsignedByte(), t.skipUnsignedExpGolomb(), lu[u] && (3 === (s = t.readUnsignedExpGolomb()) && t.skipBits(1), t.skipUnsignedExpGolomb(), t.skipUnsignedExpGolomb(), t.skipBits(1), t.readBoolean())) for (y = 3 !== s ? 8 : 12, r = 0; r < y; r++)t.readBoolean() && o(r < 6 ? 16 : 64, t); if (t.skipUnsignedExpGolomb(), 0 === (h = t.readUnsignedExpGolomb())) t.readUnsignedExpGolomb(); else if (1 === h) for (t.skipBits(1), t.skipExpGolomb(), t.skipExpGolomb(), c = t.readUnsignedExpGolomb(), r = 0; r < c; r++)t.skipExpGolomb(); if (t.skipUnsignedExpGolomb(), t.skipBits(1), l = t.readUnsignedExpGolomb(), a = t.readUnsignedExpGolomb(), 0 === (v = t.readBits(1)) && t.skipBits(1), t.skipBits(1), t.readBoolean() && (p = t.readUnsignedExpGolomb(), w = t.readUnsignedExpGolomb(), b = t.readUnsignedExpGolomb(), k = t.readUnsignedExpGolomb()), t.readBoolean() && t.readBoolean()) { switch (t.readUnsignedByte()) { case 1: i = [1, 1]; break; case 2: i = [12, 11]; break; case 3: i = [10, 11]; break; case 4: i = [16, 11]; break; case 5: i = [40, 33]; break; case 6: i = [24, 11]; break; case 7: i = [20, 11]; break; case 8: i = [32, 11]; break; case 9: i = [80, 33]; break; case 10: i = [18, 11]; break; case 11: i = [15, 11]; break; case 12: i = [64, 33]; break; case 13: i = [160, 99]; break; case 14: i = [4, 3]; break; case 15: i = [3, 2]; break; case 16: i = [2, 1]; break; case 255: i = [t.readUnsignedByte() << 8 | t.readUnsignedByte(), t.readUnsignedByte() << 8 | t.readUnsignedByte()] }i && (d = i[0] / i[1]) } return { profileIdc: u, levelIdc: f, profileCompatibility: e, width: Math.ceil((16 * (l + 1) - 2 * p - 2 * w) * d), height: (2 - v) * (a + 1) * 16 - 2 * b - 2 * k, sarRatio: i } } }).prototype = new f; var ti, gf = { H264Stream: gt, NalByteStream: tt }, ne = function (n) { return n[0] === "I".charCodeAt(0) && n[1] === "D".charCodeAt(0) && n[2] === "3".charCodeAt(0) }, te = function (n, t) { var i = n[t + 6] << 21 | n[t + 7] << 14 | n[t + 8] << 7 | n[t + 9]; return (16 & n[t + 5]) >> 4 ? 20 + i : 10 + i }, ie = function (n, t) { var i = (224 & n[t + 5]) >> 5, r = n[t + 4] << 3; return 6144 & n[t + 3] | r | i }; (ti = function () { var n = new Uint8Array, t = 0; ti.prototype.init.call(this); this.setTimestamp = function (n) { t = n }; this.push = function (i) { var e, o, s, f, u = 0, r = 0; for (n.length ? (f = n.length, (n = new Uint8Array(i.byteLength + f)).set(n.subarray(0, f)), n.set(i, f)) : n = i; 3 <= n.length - r;)if (n[r] !== "I".charCodeAt(0) || n[r + 1] !== "D".charCodeAt(0) || n[r + 2] !== "3".charCodeAt(0)) if (255 != (255 & n[r]) || 240 != (240 & n[r + 1])) r++; else { if (n.length - r < 7) break; if (r + (u = ie(n, r)) > n.length) break; s = { type: "audio", data: n.subarray(r, r + u), pts: t, dts: t }; this.trigger("data", s); r += u } else { if (n.length - r < 10) break; if (r + (u = te(n, r)) > n.length) break; o = { type: "timed-metadata", data: n.subarray(r, r + u) }; this.trigger("data", o); r += u } e = n.length - r; n = 0 < e ? n.subarray(r) : new Uint8Array }; this.reset = function () { n = new Uint8Array; this.trigger("reset") }; this.endTimeline = function () { n = new Uint8Array; this.trigger("endedtimeline") } }).prototype = new f; var it, p, ii, v, re = ti, ue = gf.H264Stream, fe = ne, ee = y, ri = ["audioobjecttype", "channelcount", "samplerate", "samplingfrequencyindex", "samplesize"], ui = ["width", "height", "profileIdc", "levelIdc", "profileCompatibility", "sarRatio"]; (p = function (n, t) { var i = [], r = 0, u = 0, f = 0, e = 1 / 0; t = t || {}; p.prototype.init.call(this); this.push = function (t) { lt(n, t); n && ri.forEach(function (i) { n[i] = t[i] }); i.push(t) }; this.setEarliestDts = function (t) { u = t - n.timelineStartInfo.baseMediaDecodeTime }; this.setVideoBaseMediaDecodeTime = function (n) { e = n }; this.setAudioAppendStart = function (n) { f = n }; this.flush = function () { var o, s, c, h, l; 0 !== i.length && (o = hf(i, n, u), n.baseMediaDecodeTime = uu(n, t.keepOriginalTimestamps), sf(n, o, f, e), n.samples = cf(o), c = iu(lf(o)), i = [], s = ru(r, [n]), h = new Uint8Array(s.byteLength + c.byteLength), r++, h.set(s), h.set(c, s.byteLength), a(n), l = Math.ceil(1024 * ee / n.samplerate), o.length && this.trigger("timingInfo", { start: o[0].dts, end: o[0].dts + o.length * l }), this.trigger("data", { track: n, boxes: h })); this.trigger("done", "AudioSegmentStream") }; this.reset = function () { a(n); i = []; this.trigger("reset") } }).prototype = new f; (it = function (n, t) { var u, f, e = 0, i = [], r = []; t = t || {}; it.prototype.init.call(this); delete n.minPTS; this.gopCache_ = []; this.push = function (t) { lt(n, t); "seq_parameter_set_rbsp" !== t.nalUnitType || u || (u = t.config, n.sps = [t.data], ui.forEach(function (t) { n[t] = u[t] }, this)); "pic_parameter_set_rbsp" !== t.nalUnitType || f || (f = t.data, n.pps = [t.data]); i.push(t) }; this.flush = function () { for (var y, f, u, s, c, h, l, o, p, v = 0; i.length && "access_unit_delimiter_rbsp" !== i[0].nalUnitType;)i.shift(); if (0 === i.length) return this.resetStream_(), void this.trigger("done", "VideoSegmentStream"); if (y = du(i), (u = gu(y))[0][0].keyFrame || ((f = this.getGopForFusion_(i[0], n)) ? (v = f.duration, u.unshift(f), u.byteLength += f.byteLength, u.nalCount += f.nalCount, u.pts = f.pts, u.dts = f.dts, u.duration += f.duration) : u = nf(u)), r.length) { if (!(p = t.alignGopsAtEnd ? this.alignGopsAtEnd_(u) : this.alignGopsAtStart_(u))) return this.gopCache_.unshift({ gop: u.pop(), pps: n.pps, sps: n.sps }), this.gopCache_.length = Math.min(6, this.gopCache_.length), i = [], this.resetStream_(), void this.trigger("done", "VideoSegmentStream"); a(n); u = p } lt(n, u); n.samples = tf(u); c = iu(rf(u)); n.baseMediaDecodeTime = uu(n, t.keepOriginalTimestamps); this.trigger("processedGopsInfo", u.map(function (n) { return { pts: n.pts, dts: n.dts, byteLength: n.byteLength } })); l = u[0]; o = u[u.length - 1]; this.trigger("segmentTimingInfo", yu(n.baseMediaDecodeTime, l.dts, l.pts, o.dts + o.duration, o.pts + o.duration, v)); this.trigger("timingInfo", { start: u[0].dts, end: u[u.length - 1].dts + u[u.length - 1].duration }); this.gopCache_.unshift({ gop: u.pop(), pps: n.pps, sps: n.sps }); this.gopCache_.length = Math.min(6, this.gopCache_.length); i = []; this.trigger("baseMediaDecodeTime", n.baseMediaDecodeTime); this.trigger("timelineStartInfo", n.timelineStartInfo); s = ru(e, [n]); h = new Uint8Array(s.byteLength + c.byteLength); e++; h.set(s); h.set(c, s.byteLength); this.trigger("data", { track: n, boxes: h }); this.resetStream_(); this.trigger("done", "VideoSegmentStream") }; this.reset = function () { this.resetStream_(); i = []; this.gopCache_.length = 0; r.length = 0; this.trigger("reset") }; this.resetStream_ = function () { a(n); f = u = void 0 }; this.getGopForFusion_ = function (t) { for (var i, r, u, f, o = 1 / 0, e = 0; e < this.gopCache_.length; e++)u = (f = this.gopCache_[e]).gop, n.pps && vu(n.pps[0], f.pps[0]) && n.sps && vu(n.sps[0], f.sps[0]) && (u.dts < n.timelineStartInfo.dts || -1e4 <= (i = t.dts - u.dts - u.duration) && i <= 45e3 && (!r || i < o) && (r = f, o = i)); return r ? r.gop : null }; this.alignGopsAtStart_ = function (n) { var f, i, e, u, o, s, h, t; for (o = n.byteLength, s = n.nalCount, h = n.duration, f = i = 0; f < r.length && i < n.length && (e = r[f], u = n[i], e.pts !== u.pts);)u.pts > e.pts ? f++ : (i++, o -= u.byteLength, s -= u.nalCount, h -= u.duration); return 0 === i ? n : i === n.length ? null : ((t = n.slice(i)).byteLength = o, t.duration = h, t.nalCount = s, t.pts = t[0].pts, t.dts = t[0].dts, t) }; this.alignGopsAtEnd_ = function (n) { var u, i, s, h, f, e, c, t, o; for (u = r.length - 1, i = n.length - 1, f = null, e = !1; 0 <= u && 0 <= i;) { if (s = r[u], h = n[i], s.pts === h.pts) { e = !0; break } s.pts > h.pts ? u-- : (u === r.length - 1 && (f = i), i--) } return !e && null === f ? null : 0 === (c = e ? i : f) ? n : (t = n.slice(c), o = t.reduce(function (n, t) { return n.byteLength += t.byteLength, n.duration += t.duration, n.nalCount += t.nalCount, n }, { byteLength: 0, duration: 0, nalCount: 0 }), t.byteLength = o.byteLength, t.duration = o.duration, t.nalCount = o.nalCount, t.pts = t[0].pts, t.dts = t[0].dts, t) }; this.alignGopsWith = function (n) { r = n } }).prototype = new f; (v = function (n, t) { this.numberOfTracks = 0; this.metadataStream = t; this.remuxTracks = "undefined" != typeof (n = n || {}).remux ? !!n.remux : !0; this.keepOriginalTimestamps = "boolean" == typeof n.keepOriginalTimestamps ? n.keepOriginalTimestamps : !1; this.pendingTracks = []; this.videoTrack = null; this.pendingBoxes = []; this.pendingCaptions = []; this.pendingMetadata = []; this.pendingBytes = 0; this.emittedTracks = 0; v.prototype.init.call(this); this.push = function (n) { return n.text ? this.pendingCaptions.push(n) : n.frames ? this.pendingMetadata.push(n) : (this.pendingTracks.push(n.track), this.pendingBytes += n.boxes.byteLength, "video" === n.track.type && (this.videoTrack = n.track, this.pendingBoxes.push(n.boxes)), void ("audio" === n.track.type && (this.audioTrack = n.track, this.pendingBoxes.unshift(n.boxes)))) } }).prototype = new f; v.prototype.flush = function (n) { var r, u, e, t, o = 0, i = { captions: [], captionStreams: {}, metadata: [], info: {} }, f = 0; if (this.pendingTracks.length < this.numberOfTracks) { if ("VideoSegmentStream" !== n && "AudioSegmentStream" !== n) return; if (this.remuxTracks) return; if (0 === this.pendingTracks.length) return this.emittedTracks++, void (this.emittedTracks >= this.numberOfTracks && (this.trigger("done"), this.emittedTracks = 0)) } if (this.videoTrack ? (f = this.videoTrack.timelineStartInfo.pts, ui.forEach(function (n) { i.info[n] = this.videoTrack[n] }, this)) : this.audioTrack && (f = this.audioTrack.timelineStartInfo.pts, ri.forEach(function (n) { i.info[n] = this.audioTrack[n] }, this)), this.videoTrack || this.audioTrack) { for (i.type = 1 === this.pendingTracks.length ? this.pendingTracks[0].type : "combined", this.emittedTracks += this.pendingTracks.length, e = ku(this.pendingTracks), i.initSegment = new Uint8Array(e.byteLength), i.initSegment.set(e), i.data = new Uint8Array(this.pendingBytes), t = 0; t < this.pendingBoxes.length; t++)i.data.set(this.pendingBoxes[t], o), o += this.pendingBoxes[t].byteLength; for (t = 0; t < this.pendingCaptions.length; t++)(r = this.pendingCaptions[t]).startTime = ct(r.startPts, f, this.keepOriginalTimestamps), r.endTime = ct(r.endPts, f, this.keepOriginalTimestamps), i.captionStreams[r.stream] = !0, i.captions.push(r); for (t = 0; t < this.pendingMetadata.length; t++)(u = this.pendingMetadata[t]).cueTime = ct(u.pts, f, this.keepOriginalTimestamps), i.metadata.push(u); for (i.metadata.dispatchType = this.metadataStream.dispatchType, this.pendingTracks.length = 0, this.videoTrack = null, this.pendingBoxes.length = 0, this.pendingCaptions.length = 0, this.pendingBytes = 0, this.pendingMetadata.length = 0, this.trigger("data", i), t = 0; t < i.captions.length; t++)r = i.captions[t], this.trigger("caption", r); for (t = 0; t < i.metadata.length; t++)u = i.metadata[t], this.trigger("id3Frame", u) } this.emittedTracks >= this.numberOfTracks && (this.trigger("done"), this.emittedTracks = 0) }; v.prototype.setRemux = function (n) { this.remuxTracks = n }; (ii = function (n) { var r, t, i = this, u = !0; ii.prototype.init.call(this); n = n || {}; this.baseMediaDecodeTime = n.baseMediaDecodeTime || 0; this.transmuxPipeline_ = {}; this.setupAacPipeline = function () { var u = {}; (this.transmuxPipeline_ = u).type = "aac"; u.metadataStream = new s.MetadataStream; u.aacStream = new re; u.audioTimestampRolloverStream = new s.TimestampRolloverStream("audio"); u.timedMetadataTimestampRolloverStream = new s.TimestampRolloverStream("timed-metadata"); u.adtsStream = new ni; u.coalesceStream = new v(n, u.metadataStream); u.headOfPipeline = u.aacStream; u.aacStream.pipe(u.audioTimestampRolloverStream).pipe(u.adtsStream); u.aacStream.pipe(u.timedMetadataTimestampRolloverStream).pipe(u.metadataStream).pipe(u.coalesceStream); u.metadataStream.on("timestamp", function (n) { u.aacStream.setTimestamp(n.timeStamp) }); u.aacStream.on("data", function (f) { "timed-metadata" !== f.type || u.audioSegmentStream || (t = t || { timelineStartInfo: { baseMediaDecodeTime: i.baseMediaDecodeTime }, codec: "adts", type: "audio" }, u.coalesceStream.numberOfTracks++, u.audioSegmentStream = new p(t, n), u.audioSegmentStream.on("timingInfo", i.trigger.bind(i, "audioTimingInfo")), u.adtsStream.pipe(u.audioSegmentStream).pipe(u.coalesceStream)); i.trigger("trackinfo", { hasAudio: !!t, hasVideo: !!r }) }); u.coalesceStream.on("data", this.trigger.bind(this, "data")); u.coalesceStream.on("done", this.trigger.bind(this, "done")) }; this.setupTsPipeline = function () { var u = {}; (this.transmuxPipeline_ = u).type = "ts"; u.metadataStream = new s.MetadataStream; u.packetStream = new s.TransportPacketStream; u.parseStream = new s.TransportParseStream; u.elementaryStream = new s.ElementaryStream; u.timestampRolloverStream = new s.TimestampRolloverStream; u.adtsStream = new ni; u.h264Stream = new ue; u.captionStream = new s.CaptionStream; u.coalesceStream = new v(n, u.metadataStream); u.headOfPipeline = u.packetStream; u.packetStream.pipe(u.parseStream).pipe(u.elementaryStream).pipe(u.timestampRolloverStream); u.timestampRolloverStream.pipe(u.h264Stream); u.timestampRolloverStream.pipe(u.adtsStream); u.timestampRolloverStream.pipe(u.metadataStream).pipe(u.coalesceStream); u.h264Stream.pipe(u.captionStream).pipe(u.coalesceStream); u.elementaryStream.on("data", function (f) { var e; if ("metadata" === f.type) { for (e = f.tracks.length; e--;)r || "video" !== f.tracks[e].type ? t || "audio" !== f.tracks[e].type || ((t = f.tracks[e]).timelineStartInfo.baseMediaDecodeTime = i.baseMediaDecodeTime) : (r = f.tracks[e]).timelineStartInfo.baseMediaDecodeTime = i.baseMediaDecodeTime; r && !u.videoSegmentStream && (u.coalesceStream.numberOfTracks++, u.videoSegmentStream = new it(r, n), u.videoSegmentStream.on("timelineStartInfo", function (n) { t && (t.timelineStartInfo = n, u.audioSegmentStream.setEarliestDts(n.dts)) }), u.videoSegmentStream.on("processedGopsInfo", i.trigger.bind(i, "gopInfo")), u.videoSegmentStream.on("segmentTimingInfo", i.trigger.bind(i, "videoSegmentTimingInfo")), u.videoSegmentStream.on("baseMediaDecodeTime", function (n) { t && u.audioSegmentStream.setVideoBaseMediaDecodeTime(n) }), u.videoSegmentStream.on("timingInfo", i.trigger.bind(i, "videoTimingInfo")), u.h264Stream.pipe(u.videoSegmentStream).pipe(u.coalesceStream)); t && !u.audioSegmentStream && (u.coalesceStream.numberOfTracks++, u.audioSegmentStream = new p(t, n), u.audioSegmentStream.on("timingInfo", i.trigger.bind(i, "audioTimingInfo")), u.adtsStream.pipe(u.audioSegmentStream).pipe(u.coalesceStream)); i.trigger("trackinfo", { hasAudio: !!t, hasVideo: !!r }) } }); u.coalesceStream.on("data", this.trigger.bind(this, "data")); u.coalesceStream.on("id3Frame", function (n) { n.dispatchType = u.metadataStream.dispatchType; i.trigger("id3Frame", n) }); u.coalesceStream.on("caption", this.trigger.bind(this, "caption")); u.coalesceStream.on("done", this.trigger.bind(this, "done")) }; this.setBaseMediaDecodeTime = function (i) { var u = this.transmuxPipeline_; n.keepOriginalTimestamps || (this.baseMediaDecodeTime = i); t && (t.timelineStartInfo.dts = void 0, t.timelineStartInfo.pts = void 0, a(t), n.keepOriginalTimestamps || (t.timelineStartInfo.baseMediaDecodeTime = i), u.audioTimestampRolloverStream && u.audioTimestampRolloverStream.discontinuity()); r && (u.videoSegmentStream && (u.videoSegmentStream.gopCache_ = []), r.timelineStartInfo.dts = void 0, r.timelineStartInfo.pts = void 0, a(r), u.captionStream.reset(), n.keepOriginalTimestamps || (r.timelineStartInfo.baseMediaDecodeTime = i)); u.timestampRolloverStream && u.timestampRolloverStream.discontinuity() }; this.setAudioAppendStart = function (n) { t && this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(n) }; this.setRemux = function (t) { var i = this.transmuxPipeline_; n.remux = t; i && i.coalesceStream && i.coalesceStream.setRemux(t) }; this.alignGopsWith = function (n) { r && this.transmuxPipeline_.videoSegmentStream && this.transmuxPipeline_.videoSegmentStream.alignGopsWith(n) }; this.push = function (n) { if (u) { var t = fe(n); t && "aac" !== this.transmuxPipeline_.type ? this.setupAacPipeline() : t || "ts" === this.transmuxPipeline_.type || this.setupTsPipeline(); u = !1 } this.transmuxPipeline_.headOfPipeline.push(n) }; this.flush = function () { u = !0; this.transmuxPipeline_.headOfPipeline.flush() }; this.endTimeline = function () { this.transmuxPipeline_.headOfPipeline.endTimeline() }; this.reset = function () { this.transmuxPipeline_.headOfPipeline && this.transmuxPipeline_.headOfPipeline.reset() }; this.resetCaptions = function () { this.transmuxPipeline_.captionStream && this.transmuxPipeline_.captionStream.reset() } }).prototype = new f; pu = { Transmuxer: ii, VideoSegmentStream: it, AudioSegmentStream: p, AUDIO_PROPERTIES: ri, VIDEO_PROPERTIES: ui, generateVideoSegmentTimingInfo: yu }; fi = (function (n, t, i) { return t && wu(n.prototype, t), i && wu(n, i), n }(ei, [{ key: "init", value: function () { this.transmuxer && this.transmuxer.dispose(); this.transmuxer = new pu.Transmuxer(this.options), function (n, t) { t.on("data", function (t) { var r = t.initSegment, i; t.initSegment = { data: r.buffer, byteOffset: r.byteOffset, byteLength: r.byteLength }; i = t.data; t.data = i.buffer; n.postMessage({ action: "data", segment: t, byteOffset: i.byteOffset, byteLength: i.byteLength }, [t.data]) }); t.captionStream && t.captionStream.on("data", function (t) { n.postMessage({ action: "caption", data: t }) }); t.on("done", function () { n.postMessage({ action: "done" }) }); t.on("gopInfo", function (t) { n.postMessage({ action: "gopInfo", gopInfo: t }) }); t.on("videoSegmentTimingInfo", function (t) { n.postMessage({ action: "videoSegmentTimingInfo", videoSegmentTimingInfo: t }) }) }(this.self, this.transmuxer) } }, { key: "push", value: function (n) { var t = new Uint8Array(n.data, n.byteOffset, n.byteLength); this.transmuxer.push(t) } }, { key: "reset", value: function () { this.init() } }, { key: "setTimestampOffset", value: function (n) { var t = n.timestampOffset || 0; this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4 * t)) } }, { key: "setAudioAppendStart", value: function (n) { this.transmuxer.setAudioAppendStart(Math.ceil(9e4 * n.appendStart)) } }, { key: "flush", value: function () { this.transmuxer.flush() } }, { key: "resetCaptions", value: function () { this.transmuxer.resetCaptions() } }, { key: "alignGopsWith", value: function (n) { this.transmuxer.alignGopsWith(n.gopsToAlignWith.slice()) } }]), ei), new function (n) { n.onmessage = function (t) { "init" === t.data.action && t.data.options ? this.messageHandlers = new fi(n, t.data.options) : (this.messageHandlers || (this.messageHandlers = new fi(n)), t.data && t.data.action && "init" !== t.data.action && this.messageHandlers[t.data.action] && this.messageHandlers[t.data.action](t.data)) } }(n) }() }), trt = { videoCodec: "avc1", videoObjectTypeIndicator: ".4d400d", audioProfile: "2" }, nct = (ai(uf, i.EventTarget), ri(uf, [{ key: "data_", value: function (n) { var t = n.data.segment; t.data = new Uint8Array(t.data, n.data.byteOffset, n.data.byteLength); t.initSegment = new Uint8Array(t.initSegment.data, t.initSegment.byteOffset, t.initSegment.byteLength), function (n, t, i) { var u = t.player_, r, f; if (i.captions && i.captions.length) for (r in n.inbandTextTracks_ || (n.inbandTextTracks_ = {}), i.captionStreams) n.inbandTextTracks_[r] || (u.tech_.trigger({ type: "usage", name: "hls-608" }), f = u.textTracks().getTrackById(r), n.inbandTextTracks_[r] = f || u.addRemoteTextTrack({ kind: "captions", id: r, label: r }, !1).track); i.metadata && i.metadata.length && !n.metadataTrack_ && (n.metadataTrack_ = u.addRemoteTextTrack({ kind: "metadata", label: "Timed Metadata" }, !1).track, n.metadataTrack_.inBandMetadataTrackDispatchType = i.metadata.dispatchType) }(this, this.mediaSource_, t); this.pendingBuffers_.push(t) } }, { key: "done_", value: function () { "closed" !== this.mediaSource_.readyState ? this.processPendingSegments_() : this.pendingBuffers_.length = 0 } }, { key: "videoSegmentTimingInfo_", value: function (n) { var t = { start: { decode: n.start.dts / 9e4, presentation: n.start.pts / 9e4 }, end: { decode: n.end.dts / 9e4, presentation: n.end.pts / 9e4 }, baseMediaDecodeTime: n.baseMediaDecodeTime / 9e4 }; n.prependedContentDuration && (t.prependedContentDuration = n.prependedContentDuration / 9e4); this.trigger({ type: "videoSegmentTimingInfo", videoSegmentTimingInfo: t }) } }, { key: "createRealSourceBuffers_", value: function () { var n = this, t = ["audio", "video"]; t.forEach(function (i) { var r, u; n[i + "Codec_"] && !n[i + "Buffer_"] && (r = null, n.mediaSource_[i + "Buffer_"] ? (r = n.mediaSource_[i + "Buffer_"]).updating = !1 : (u = i + '/mp4;codecs="' + n[i + "Codec_"] + '"', r = function (n, t) { function u(n) { "function" == typeof i[n] ? r[n] = function () { return i[n].apply(i, arguments) } : "undefined" == typeof r[n] && Object.defineProperty(r, n, { get: function () { return i[n] }, set: function (t) { return i[n] = t } }) } var i = n.addSourceBuffer(t), r = Object.create(null); for (var f in r.updating = !1, r.realBuffer_ = i) u(f); return r }(n.mediaSource_.nativeMediaSource_, u), n.mediaSource_[i + "Buffer_"] = r), n[i + "Buffer_"] = r, ["update", "updatestart", "updateend"].forEach(function (u) { r.addEventListener(u, function () { if ("audio" !== i || !n.audioDisabled_) return "updateend" === u && (n[i + "Buffer_"].updating = !1), t.every(function (t) { return !("audio" !== t || !n.audioDisabled_) || i === t || !n[t + "Buffer_"] || !n[t + "Buffer_"].updating }) ? n.trigger(u) : void 0 }) })) }) } }, { key: "appendBuffer", value: function (n) { if (this.bufferUpdating_ = !0, this.audioBuffer_ && this.audioBuffer_.buffered.length) { var t = this.audioBuffer_.buffered; this.transmuxer_.postMessage({ action: "setAudioAppendStart", appendStart: t.end(t.length - 1) }) } this.videoBuffer_ && this.transmuxer_.postMessage({ action: "alignGopsWith", gopsToAlignWith: function (n, t, i) { if ("undefined" == typeof t || null === t || !n.length) return []; for (var u = Math.ceil(9e4 * (t - i + 3)), r = void 0, r = 0; r < n.length && !(n[r].pts > u); r++); return n.slice(r) }(this.gopBuffer_, this.mediaSource_.player_ ? this.mediaSource_.player_.currentTime() : null, this.timeMapping_) }); this.transmuxer_.postMessage({ action: "push", data: n.buffer, byteOffset: n.byteOffset, byteLength: n.byteLength }, [n.buffer]); this.transmuxer_.postMessage({ action: "flush" }) } }, { key: "appendGopInfo_", value: function (n) { this.gopBuffer_ = function (n, t, i) { if (!t.length) return n; if (i) return t.slice(); for (var u = t[0].pts, r = 0; r < n.length && !(n[r].pts >= u); r++); return n.slice(0, r).concat(t) }(this.gopBuffer_, n.data.gopInfo, this.safeAppend_) } }, { key: "remove", value: function (n, t) { if (this.videoBuffer_ && (this.videoBuffer_.updating = !0, this.videoBuffer_.remove(n, t), this.gopBuffer_ = function (n, t, i, r) { for (var u, o = Math.ceil(9e4 * (t - r)), s = Math.ceil(9e4 * (i - r)), e = n.slice(), f = n.length; f-- && !(n[f].pts <= s);); if (-1 === f) return e; for (u = f + 1; u-- && !(n[u].pts <= o);); return u = Math.max(u, 0), e.splice(u, f - u + 1), e }(this.gopBuffer_, n, t, this.timeMapping_)), !this.audioDisabled_ && this.audioBuffer_ && (this.audioBuffer_.updating = !0, this.audioBuffer_.remove(n, t)), nf(n, t, this.metadataTrack_), this.inbandTextTracks_) for (var i in this.inbandTextTracks_) nf(n, t, this.inbandTextTracks_[i]) } }, { key: "processPendingSegments_", value: function () { var n = { video: { segments: [], bytes: 0 }, audio: { segments: [], bytes: 0 }, captions: [], metadata: [] }, t; if (!this.pendingBuffers_.length) return this.trigger("updateend"), void (this.bufferUpdating_ = !1); n = this.pendingBuffers_.reduce(function (n, t) { var i = t.type, r = t.data, u = t.initSegment; return n[i].segments.push(r), n[i].bytes += r.byteLength, n[i].initSegment = u, t.captions && (n.captions = n.captions.concat(t.captions)), t.info && (n[i].info = t.info), t.metadata && (n.metadata = n.metadata.concat(t.metadata)), n }, n); this.videoBuffer_ || this.audioBuffer_ || (0 === n.video.bytes && (this.videoCodec_ = null), 0 === n.audio.bytes && (this.audioCodec_ = null), this.createRealSourceBuffers_()); n.audio.info && this.mediaSource_.trigger({ type: "audioinfo", info: n.audio.info }); n.video.info && this.mediaSource_.trigger({ type: "videoinfo", info: n.video.info }); this.appendAudioInitSegment_ && (!this.audioDisabled_ && this.audioBuffer_ && (n.audio.segments.unshift(n.audio.initSegment), n.audio.bytes += n.audio.initSegment.byteLength), this.appendAudioInitSegment_ = !1); t = !1; this.videoBuffer_ && n.video.bytes ? (n.video.segments.unshift(n.video.initSegment), n.video.bytes += n.video.initSegment.byteLength, this.concatAndAppendSegments_(n.video, this.videoBuffer_)) : !this.videoBuffer_ || !this.audioDisabled_ && this.audioBuffer_ || (t = !0); lht(this, n.captions, n.metadata); !this.audioDisabled_ && this.audioBuffer_ && this.concatAndAppendSegments_(n.audio, this.audioBuffer_); this.pendingBuffers_.length = 0; t && this.trigger("updateend"); this.bufferUpdating_ = !1 } }, { key: "concatAndAppendSegments_", value: function (n, t) { var r = 0, i = void 0; if (n.bytes) { i = new Uint8Array(n.bytes); n.segments.forEach(function (n) { i.set(n, r); r += n.byteLength }); try { t.updating = !0; t.appendBuffer(i) } catch (n) { this.mediaSource_.player_ && this.mediaSource_.player_.error({ code: -3, type: "APPEND_BUFFER_ERR", message: n.message, originalError: n }) } } } }, { key: "abort", value: function () { this.videoBuffer_ && this.videoBuffer_.abort(); !this.audioDisabled_ && this.audioBuffer_ && this.audioBuffer_.abort(); this.transmuxer_ && this.transmuxer_.postMessage({ action: "reset" }); this.pendingBuffers_.length = 0; this.bufferUpdating_ = !1 } }]), uf); yh = (ai(tu, i.EventTarget), ri(tu, [{ key: "addSeekableRange_", value: function (n, t) { var i = void 0; if (this.duration !== 1 / 0) throw (i = new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name = "InvalidStateError", i.code = 11, i; (t > this.nativeMediaSource_.duration || isNaN(this.nativeMediaSource_.duration)) && (this.nativeMediaSource_.duration = t) } }, { key: "addSourceBuffer", value: function (n) { var i = void 0, r = function (n) { var t = { type: "", parameters: {} }, i = n.trim().split(";"); return t.type = i.shift().trim(), i.forEach(function (n) { var i = n.trim().split("="), r, u; 1 < i.length && (r = i[0].replace(/"/g, "").trim(), u = i[1].replace(/"/g, "").trim(), t.parameters[r] = u) }), t }(n), t; return /^(video|audio)\/mp2t$/i.test(r.type) ? (t = [], r.parameters && r.parameters.codecs && (t = r.parameters.codecs.split(","), t = (t = dit(t)).filter(function (n) { return git(n) || nrt(n) })), 0 === t.length && (t = ["avc1.4d400d", "mp4a.40.2"]), i = new nct(this, t), 0 !== this.sourceBuffers.length && (this.sourceBuffers[0].createRealSourceBuffers_(), i.createRealSourceBuffers_(), this.sourceBuffers[0].audioDisabled_ = !0)) : i = this.nativeMediaSource_.addSourceBuffer(n), this.sourceBuffers.push(i), i } }]), tu); ly = 0; i.mediaSources = {}; ke.open = irt; ke.supportsNativeMediaSources = ay; vy = { createObjectURL: function (t) { var r = void 0; return t instanceof yh ? (r = n.URL.createObjectURL(t.nativeMediaSource_), t.url_ = r) : t instanceof yh ? (r = "blob:vjs-media-source/" + ly, ly++, i.mediaSources[r] = t, r) : (r = n.URL.createObjectURL(t), t.url_ = r) } }; i.MediaSource = ke; i.URL = vy; py = i.mergeOptions; ph = (ai(ff, i.EventTarget), ri(ff, [{ key: "setupChildLoader", value: function (n, t) { this.masterPlaylistLoader_ = n; this.childPlaylist_ = t } }, { key: "dispose", value: function () { this.stopRequest(); this.loadedPlaylists_ = {}; n.clearTimeout(this.minimumUpdatePeriodTimeout_); n.clearTimeout(this.mediaRequest_); n.clearTimeout(this.mediaUpdateTimeout) } }, { key: "hasPendingRequest", value: function () { return this.request || this.mediaRequest_ } }, { key: "stopRequest", value: function () { if (this.request) { var n = this.request; this.request = null; n.onreadystatechange = null; n.abort() } } }, { key: "sidxRequestFinished_", value: function (n, t, i, r) { var u = this; return function (f, e) { if (u.request) { if (u.request = null, f) return u.error = { status: e.status, message: "DASH playlist request error at URL: " + n.uri, response: e.response, code: 2 }, i && (u.state = i), u.trigger("error"), r(t, null); var o = new Uint8Array(e.response), s = rh.parseSidx(o.subarray(8)); return r(t, s) } } } }, { key: "media", value: function (t) { var o = this, i, r, u, f, e; if (!t) return this.media_; if ("HAVE_NOTHING" === this.state) throw new Error("Cannot switch media playlist from " + this.state); if (i = this.state, "string" == typeof t) { if (!this.master.playlists[t]) throw new Error("Unknown playlist URI: " + t); t = this.master.playlists[t] } if (r = !this.media_ || t.uri !== this.media_.uri, r && this.loadedPlaylists_[t.uri] && this.loadedPlaylists_[t.uri].endList) return this.state = "HAVE_METADATA", this.media_ = t, void (r && (this.trigger("mediachanging"), this.trigger("mediachange"))); r && ((this.media_ && this.trigger("mediachanging"), t.sidx) ? (u = void 0, f = void 0, f = this.masterPlaylistLoader_ ? (u = this.masterPlaylistLoader_.master, this.masterPlaylistLoader_.sidxMapping_) : (u = this.master, this.sidxMapping_), e = yy(t.sidx), f[e] = { sidxInfo: t.sidx }, this.request = frt(t.sidx, t, this.hls_.xhr, { handleManifestRedirects: this.handleManifestRedirects }, this.sidxRequestFinished_(t, u, i, function (n, r) { if (!n || !r) throw new Error("failed to request sidx"); f[e].sidx = r; o.haveMetadata({ startingState: i, playlist: n.playlists[t.uri] }) }))) : this.mediaRequest_ = n.setTimeout(this.haveMetadata.bind(this, { startingState: i, playlist: t }), 0)) } }, { key: "haveMetadata", value: function (n) { var i = n.startingState, t = n.playlist; this.state = "HAVE_METADATA"; this.loadedPlaylists_[t.uri] = t; this.mediaRequest_ = null; this.refreshMedia_(t.uri); "HAVE_MASTER" === i ? this.trigger("loadedmetadata") : this.trigger("mediachange") } }, { key: "pause", value: function () { this.stopRequest(); n.clearTimeout(this.mediaUpdateTimeout); n.clearTimeout(this.minimumUpdatePeriodTimeout_); "HAVE_NOTHING" === this.state && (this.started = !1) } }, { key: "load", value: function (t) { var u = this, i, r; n.clearTimeout(this.mediaUpdateTimeout); n.clearTimeout(this.minimumUpdatePeriodTimeout_); i = this.media(); t ? (r = i ? i.targetDuration * 500 : 5e3, this.mediaUpdateTimeout = n.setTimeout(function () { return u.load() }, r)) : this.started ? this.trigger("loadedplaylist") : this.start() } }, { key: "parseMasterXml", value: function () { var n = dn(this.masterXml_, { manifestUri: this.srcUrl, clientOffset: this.clientOffset_, sidxMapping: this.sidxMapping_ }), t, i; for (n.uri = this.srcUrl, t = 0; t < n.playlists.length; t++)i = "placeholder-uri-" + t, n.playlists[t].uri = i, n.playlists[i] = n.playlists[t]; return ch(n, function (t, i, r, u) { if (t.playlists && t.playlists.length) { var f = "placeholder-uri-" + i + "-" + r + "-" + u; t.playlists[0].uri = f; n.playlists[f] = t.playlists[0] } }), wtt(n), btt(n), n } }, { key: "start", value: function () { var t = this; this.started = !0; this.masterPlaylistLoader_ ? this.mediaRequest_ = n.setTimeout(this.haveMaster_.bind(this), 0) : this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, function (n, i) { if (t.request) { if (t.request = null, n) return t.error = { status: i.status, message: "DASH playlist request error at URL: " + t.srcUrl, responseText: i.responseText, code: 2 }, "HAVE_NOTHING" === t.state && (t.started = !1), t.trigger("error"); t.masterXml_ = i.responseText; t.masterLoaded_ = i.responseHeaders && i.responseHeaders.date ? Date.parse(i.responseHeaders.date) : Date.now(); t.srcUrl = hh(t.handleManifestRedirects, t.srcUrl, i); t.syncClientServerClock_(t.onClientServerClockSync_.bind(t)) } }) } }, { key: "syncClientServerClock_", value: function (n) { var i = this, t = nst(this.masterXml_); return null === t ? (this.clientOffset_ = this.masterLoaded_ - Date.now(), n()) : "DIRECT" === t.method ? (this.clientOffset_ = t.value - Date.now(), n()) : void (this.request = this.hls_.xhr({ uri: gr(this.srcUrl, t.value), method: t.method, withCredentials: this.withCredentials }, function (r, u) { if (i.request) { if (r) return i.clientOffset_ = i.masterLoaded_ - Date.now(), n(); var f = void 0; f = "HEAD" === t.method ? u.responseHeaders && u.responseHeaders.date ? Date.parse(u.responseHeaders.date) : i.masterLoaded_ : Date.parse(u.responseText); i.clientOffset_ = f - Date.now(); n() } })) } }, { key: "haveMaster_", value: function () { this.state = "HAVE_MASTER"; this.mediaRequest_ = null; this.masterPlaylistLoader_ ? this.media_ || this.media(this.childPlaylist_) : (this.master = this.parseMasterXml(), this.trigger("loadedplaylist")) } }, { key: "onClientServerClockSync_", value: function () { var t = this; this.haveMaster_(); this.hasPendingRequest() || this.media_ || this.media(this.master.playlists[0]); this.master && this.master.minimumUpdatePeriod && (this.minimumUpdatePeriodTimeout_ = n.setTimeout(function () { t.trigger("minimumUpdatePeriod") }, this.master.minimumUpdatePeriod)) } }, { key: "refreshXml_", value: function () { var t = this; this.request = this.hls_.xhr({ uri: this.srcUrl, withCredentials: this.withCredentials }, function (i, r) { var f, u; if (t.request) { if (t.request = null, i) return t.error = { status: r.status, message: "DASH playlist request error at URL: " + t.srcUrl, responseText: r.responseText, code: 2 }, "HAVE_NOTHING" === t.state && (t.started = !1), t.trigger("error"); t.masterXml_ = r.responseText; t.sidxMapping_ = function (n, t, i, r) { var f = dn(n, { manifestUri: t, clientOffset: i }), u = urt(f.playlists, r); return ch(f, function (n) { if (n.playlists && n.playlists.length) { var t = n.playlists; u = py(u, urt(t, r)) } }), u }(t.masterXml_, t.srcUrl, t.clientOffset_, t.sidxMapping_); var e = t.parseMasterXml(), o = rrt(t.master, e), s = t.media().sidx; o && (s ? (f = yy(s), t.sidxMapping_[f] || (u = t.media(), t.request = frt(u.sidx, u, t.hls_.xhr, { handleManifestRedirects: t.handleManifestRedirects }, t.sidxRequestFinished_(u, e, t.state, function (i, r) { if (!i || !r) throw new Error("failed to request sidx on minimumUpdatePeriod"); t.sidxMapping_[f].sidx = r; t.minimumUpdatePeriodTimeout_ = n.setTimeout(function () { t.trigger("minimumUpdatePeriod") }, t.master.minimumUpdatePeriod); t.refreshMedia_(t.media().uri) })))) : t.master = o); t.minimumUpdatePeriodTimeout_ = n.setTimeout(function () { t.trigger("minimumUpdatePeriod") }, t.master.minimumUpdatePeriod) } }) } }, { key: "refreshMedia_", value: function (t) { var f = this, r, u, i; if (!t) throw new Error("refreshMedia_ must take a media uri"); r = void 0; u = void 0; u = this.masterPlaylistLoader_ ? (r = this.masterPlaylistLoader_.master, this.masterPlaylistLoader_.parseMasterXml()) : (r = this.master, this.parseMasterXml()); i = rrt(r, u); i ? (this.masterPlaylistLoader_ ? this.masterPlaylistLoader_.master = i : this.master = i, this.media_ = i.playlists[t]) : (this.media_ = u.playlists[t], this.trigger("playlistunchanged")); this.media().endList || (this.mediaUpdateTimeout = n.setTimeout(function () { f.trigger("mediaupdatetimeout") }, ktt(this.media(), !!i))); this.trigger("loadedplaylist") } }]), ff); ert = (ri(wy, [{ key: "createSourceBuffer_", value: function (n, t) { var i = this; this.sourceBuffer_ = this.mediaSource.addSourceBuffer(n); this.logger_("created SourceBuffer"); t && (t.trigger("sourcebufferadded"), this.mediaSource.sourceBuffers.length < 2) ? t.on("sourcebufferadded", function () { i.start_() }) : this.start_() } }, { key: "start_", value: function () { var n = this; this.started_ = !0; this.onUpdateendCallback_ = function () { var t = n.pendingCallback_; n.pendingCallback_ = null; n.sourceBuffer_.removing = !1; n.logger_("buffered [" + fy(n.buffered()) + "]"); t && t(); n.runCallback_() }; this.sourceBuffer_.addEventListener("updateend", this.onUpdateendCallback_); this.runCallback_() } }, { key: "abort", value: function (n) { var t = this; this.processedAppend_ && this.queueCallback_(function () { t.sourceBuffer_.abort() }, n) } }, { key: "appendBuffer", value: function (n, t) { var i = this; this.processedAppend_ = !0; this.queueCallback_(function () { n.videoSegmentTimingInfoCallback && i.sourceBuffer_.addEventListener("videoSegmentTimingInfo", n.videoSegmentTimingInfoCallback); i.sourceBuffer_.appendBuffer(n.bytes) }, function () { n.videoSegmentTimingInfoCallback && i.sourceBuffer_.removeEventListener("videoSegmentTimingInfo", n.videoSegmentTimingInfoCallback); t() }) } }, { key: "buffered", value: function () { return this.sourceBuffer_ ? this.sourceBuffer_.buffered : i.createTimeRanges() } }, { key: "remove", value: function (n, t, i) { var r = this, u = 2 < arguments.length && void 0 !== i ? i : ef; this.processedAppend_ && this.queueCallback_(function () { r.logger_("remove [" + n + " => " + t + "]"); r.sourceBuffer_.removing = !0; r.sourceBuffer_.remove(n, t) }, u) } }, { key: "updating", value: function () { return !this.sourceBuffer_ || this.sourceBuffer_.updating || !!this.pendingCallback_ && this.pendingCallback_ !== ef } }, { key: "timestampOffset", value: function (n) { var t = this; return "undefined" != typeof n && (this.queueCallback_(function () { t.sourceBuffer_.timestampOffset = n; t.runCallback_() }), this.timestampOffset_ = n), this.timestampOffset_ } }, { key: "queueCallback_", value: function (n, t) { this.callbacks_.push([n.bind(this), t]); this.runCallback_() } }, { key: "runCallback_", value: function () { var n = void 0; !this.updating() && this.callbacks_.length && this.started_ && (n = this.callbacks_.shift(), this.pendingCallback_ = n[1], n[0]()) } }, { key: "dispose", value: function () { function t() { n.sourceBuffer_ && "open" === n.mediaSource.readyState && n.sourceBuffer_.abort(); n.sourceBuffer_.removeEventListener("updateend", t) } var n = this; this.sourceBuffer_.removeEventListener("updateend", this.onUpdateendCallback_); this.sourceBuffer_.removing ? this.sourceBuffer_.addEventListener("updateend", t) : t() } }]), wy); var bt = { GOAL_BUFFER_LENGTH: 30, MAX_GOAL_BUFFER_LENGTH: 60, GOAL_BUFFER_LENGTH_RATE: 1, INITIAL_BANDWIDTH: 4194304, BANDWIDTH_VARIANCE: 1.2, BUFFER_LOW_WATER_LINE: 0, MAX_BUFFER_LOW_WATER_LINE: 30, BUFFER_LOW_WATER_LINE_RATE: 1 }, wh = 2, crt = -101, lrt = -102, dy = (ai(of, i.EventTarget), ri(of, [{ key: "resetStats_", value: function () { this.mediaBytesTransferred = 0; this.mediaRequests = 0; this.mediaRequestsAborted = 0; this.mediaRequestsTimedout = 0; this.mediaRequestsErrored = 0; this.mediaTransferDuration = 0; this.mediaSecondsLoaded = 0 } }, { key: "dispose", value: function () { this.state = "DISPOSED"; this.pause(); this.abort_(); this.sourceUpdater_ && this.sourceUpdater_.dispose(); this.resetStats_(); this.captionParser_ && this.captionParser_.reset() } }, { key: "abort", value: function () { "WAITING" === this.state ? (this.abort_(), this.state = "READY", this.paused() || this.monitorBuffer_()) : this.pendingSegment_ && (this.pendingSegment_ = null) } }, { key: "abort_", value: function () { this.pendingSegment_ && this.pendingSegment_.abortRequests(); this.pendingSegment_ = null } }, { key: "error", value: function (n) { return "undefined" != typeof n && (this.error_ = n), this.pendingSegment_ = null, this.error_ } }, { key: "endOfStream", value: function () { this.ended_ = !0; this.pause(); this.trigger("ended") } }, { key: "buffered_", value: function () { return this.sourceUpdater_ ? this.sourceUpdater_.buffered() : i.createTimeRanges() } }, { key: "initSegment", value: function (n, t) { var u = 1 < arguments.length && void 0 !== t && t, r, i; return n ? (r = vh(n), i = this.initSegments_[r], u && !i && n.bytes && (this.initSegments_[r] = i = { resolvedUri: n.resolvedUri, byterange: n.byterange, bytes: n.bytes, timescales: n.timescales, videoTrackIds: n.videoTrackIds }), i || n) : null } }, { key: "segmentKey", value: function (n, t) { var f = 1 < arguments.length && void 0 !== t && t, r, i, u; return n ? (r = sit(n), i = this.keyCache_[r], this.cacheEncryptionKeys_ && f && !i && n.bytes && (this.keyCache_[r] = i = { resolvedUri: n.resolvedUri, bytes: n.bytes }), u = { resolvedUri: (i || n).resolvedUri }, i && (u.bytes = i.bytes), u) : null } }, { key: "couldBeginLoading_", value: function () { return this.playlist_ && (this.sourceUpdater_ || this.mimeType_ && "INIT" === this.state) && !this.paused() } }, { key: "load", value: function () { if (this.monitorBuffer_(), this.playlist_) { if (this.syncController_.setDateTimeMapping(this.playlist_), "INIT" === this.state && this.couldBeginLoading_()) return this.init_(); this.couldBeginLoading_() && ("READY" === this.state || "INIT" === this.state) && (this.state = "READY") } } }, { key: "init_", value: function () { return this.state = "READY", this.sourceUpdater_ = new ert(this.mediaSource_, this.mimeType_, this.loaderType_, this.sourceBufferEmitter_), this.resetEverything(), this.monitorBuffer_() } }, { key: "playlist", value: function (n, t) { var e = 1 < arguments.length && void 0 !== t ? t : {}, i, r, u, f; if (n) { if (i = this.playlist_, r = this.pendingSegment_, this.playlist_ = n, this.xhrOptions_ = e, this.hasPlayed_() || (n.syncInfo = { mediaSequence: n.mediaSequence, time: 0 }), u = null, i && (i.id ? u = i.id : i.uri && (u = i.uri)), this.logger_("playlist update [" + u + " => " + (n.id || n.uri) + "]"), this.trigger("syncinfoupdate"), "INIT" === this.state && this.couldBeginLoading_()) return this.init_(); i && i.uri === n.uri ? (f = n.mediaSequence - i.mediaSequence, this.logger_("live window shift [" + f + "]"), null !== this.mediaIndex && (this.mediaIndex -= f), r && (r.mediaIndex -= f, 0 <= r.mediaIndex && (r.segment = n.segments[r.mediaIndex])), this.syncController_.saveExpiredSegmentInfo(i, n)) : null !== this.mediaIndex && this.resyncLoader() } } }, { key: "pause", value: function () { this.checkBufferTimeout_ && (n.clearTimeout(this.checkBufferTimeout_), this.checkBufferTimeout_ = null) } }, { key: "paused", value: function () { return null === this.checkBufferTimeout_ } }, { key: "mimeType", value: function (n, t) { this.mimeType_ || (this.mimeType_ = n, this.sourceBufferEmitter_ = t, "INIT" === this.state && this.couldBeginLoading_() && this.init_()) } }, { key: "resetEverything", value: function (n) { this.ended_ = !1; this.resetLoader(); this.remove(0, this.duration_(), n); this.captionParser_ && this.captionParser_.clearAllCaptions(); this.trigger("reseteverything") } }, { key: "resetLoader", value: function () { this.fetchAtBuffer_ = !1; this.resyncLoader() } }, { key: "resyncLoader", value: function () { this.mediaIndex = null; this.syncPoint_ = null; this.abort() } }, { key: "remove", value: function (n, t, i) { if (this.sourceUpdater_ && this.sourceUpdater_.remove(n, t, i), nf(n, t, this.segmentMetadataTrack_), this.inbandTextTracks_) for (var r in this.inbandTextTracks_) nf(n, t, this.inbandTextTracks_[r]) } }, { key: "monitorBuffer_", value: function () { this.checkBufferTimeout_ && n.clearTimeout(this.checkBufferTimeout_); this.checkBufferTimeout_ = n.setTimeout(this.monitorBufferTick_.bind(this), 1) } }, { key: "monitorBufferTick_", value: function () { "READY" === this.state && this.fillBuffer_(); this.checkBufferTimeout_ && n.clearTimeout(this.checkBufferTimeout_); this.checkBufferTimeout_ = n.setTimeout(this.monitorBufferTick_.bind(this), 500) } }, { key: "fillBuffer_", value: function () { if (!this.sourceUpdater_.updating()) { this.syncPoint_ || (this.syncPoint_ = this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_())); var n = this.checkBuffer_(this.buffered_(), this.playlist_, this.mediaIndex, this.hasPlayed_(), this.currentTime_(), this.syncPoint_); n && (this.isEndOfStream_(n.mediaIndex) ? this.endOfStream() : n.mediaIndex === this.playlist_.segments.length - 1 && "ended" === this.mediaSource_.readyState && !this.seeking_() || (n.timeline !== this.currentTimeline_ && (this.syncController_.reset(), n.timestampOffset = n.startOfSegment, this.captionParser_ && this.captionParser_.clearAllCaptions()), this.loadSegment_(n))) } } }, { key: "isEndOfStream_", value: function (n, t) { return function (n, t, i) { if (!n || !t) return !1; var r = i === n.segments.length; return n.endList && "open" === t.readyState && r }(1 < arguments.length && void 0 !== t ? t : this.playlist_, this.mediaSource_, n) && !this.sourceUpdater_.updating() } }, { key: "checkBuffer_", value: function (n, t, i, r, u, f) { var o = 0, e = void 0, s, h, c; return (n.length && (o = n.end(n.length - 1)), s = Math.max(0, o - u), !t.segments.length) ? null : s >= this.goalBufferLength_() ? null : !r && 1 <= s ? null : null === f ? (i = this.getSyncSegmentCandidate_(t), this.generateSegmentInfo_(t, i, null, !0)) : null !== i ? (t.segments[i], e = o, this.generateSegmentInfo_(t, i + 1, e, !1)) : (this.fetchAtBuffer_ ? (h = vt.getMediaInfoForTime(t, o, f.segmentIndex, f.time), i = h.mediaIndex, e = h.startTime) : (c = vt.getMediaInfoForTime(t, u, f.segmentIndex, f.time), i = c.mediaIndex, e = c.startTime), this.generateSegmentInfo_(t, i, e, !1)) } }, { key: "getSyncSegmentCandidate_", value: function (n) { var i = this, t; return -1 === this.currentTimeline_ ? 0 : (t = n.segments.map(function (n, t) { return { timeline: n.timeline, segmentIndex: t } }).filter(function (n) { return n.timeline === i.currentTimeline_ }), t.length ? t[Math.min(t.length - 1, 1)].segmentIndex : Math.max(n.segments.length - 1, 0)) } }, { key: "generateSegmentInfo_", value: function (n, t, i, r) { if (t < 0 || t >= n.segments.length) return null; var u = n.segments[t]; return { requestId: "segment-loader-" + Math.random(), uri: u.resolvedUri, mediaIndex: t, isSyncRequest: r, startOfSegment: i, playlist: n, bytes: null, encryptedBytes: null, timestampOffset: null, timeline: u.timeline, duration: u.duration, segment: u } } }, { key: "abortRequestEarly_", value: function (n) { var t, s, r; if (this.hls_.tech_.paused() || !this.xhrOptions_.timeout || !this.playlist_.attributes.BANDWIDTH || Date.now() - (n.firstBytesReceivedAt || Date.now()) < 1e3) return !1; var u = this.currentTime_(), f = n.bandwidth, e = this.pendingSegment_.duration, o = vt.estimateSegmentRequestTime(e, f, this.playlist_, n.bytesReceived), i = function (n, t, i) { var r = 2 < arguments.length && void 0 !== i ? i : 1; return ((n.length ? n.end(n.length - 1) : 0) - t) / r }(this.buffered_(), u, this.hls_.tech_.playbackRate()) - 1; return o <= i ? !1 : (t = function (n) { var f = n.master, e = n.currentTime, o = n.bandwidth, s = n.duration, h = n.segmentDuration, c = n.timeUntilRebuffer, l = n.currentTimeline, a = n.syncController, u = f.playlists.filter(function (n) { return !vt.isIncompatible(n) }), r = u.filter(vt.isEnabled), t, i; return r.length || (r = u.filter(function (n) { return !vt.isDisabled(n) })), t = r.filter(vt.hasAttribute.bind(null, "BANDWIDTH")).map(function (n) { var t = a.getSyncPoint(n, s, l, e) ? 1 : 2; return { playlist: n, rebufferingImpact: vt.estimateSegmentRequestTime(h, o, n) * t - c } }), i = t.filter(function (n) { return n.rebufferingImpact <= 0 }), ge(i, function (n, t) { return ky(t.playlist, n.playlist) }), i.length ? i[0] : (ge(t, function (n, t) { return n.rebufferingImpact - t.rebufferingImpact }), t[0] || null) }({ master: this.hls_.playlists.master, currentTime: u, bandwidth: f, duration: this.duration_(), segmentDuration: e, timeUntilRebuffer: i, currentTimeline: this.currentTimeline_, syncController: this.syncController_ }), t ? (s = o - i - t.rebufferingImpact, r = .5, i <= 1 / 30 && (r = 1), !(!t.playlist || t.playlist.uri === this.playlist_.uri || s < r) && (this.bandwidth = t.playlist.attributes.BANDWIDTH * bt.BANDWIDTH_VARIANCE + 1, this.abort(), this.trigger("earlyabort"), !0)) : void 0) } }, { key: "handleProgress_", value: function (n, t) { this.pendingSegment_ && t.requestId === this.pendingSegment_.requestId && !this.abortRequestEarly_(t.stats) && this.trigger("progress") } }, { key: "loadSegment_", value: function (n) { this.state = "WAITING"; this.pendingSegment_ = n; this.trimBackBuffer_(n); n.abortRequests = rct(this.hls_.xhr, this.xhrOptions_, this.decrypter_, this.captionParser_, this.createSimplifiedSegmentObj_(n), this.handleProgress_.bind(this), this.segmentRequestFinished_.bind(this)) } }, { key: "trimBackBuffer_", value: function () { var n = function (n, t, i) { var r = void 0; return r = n.length && 0 < n.start(0) && n.start(0) < t ? n.start(0) : t - 30, Math.min(r, t - i) }(this.seekable_(), this.currentTime_(), this.playlist_.targetDuration || 10); 0 < n && this.remove(0, n) } }, { key: "createSimplifiedSegmentObj_", value: function (n) { var t = n.segment, i = { resolvedUri: t.resolvedUri, byterange: t.byterange, requestId: n.requestId }, r; return t.key && (r = t.key.iv || new Uint32Array([0, 0, 0, n.mediaIndex + n.playlist.mediaSequence]), i.key = this.segmentKey(t.key), i.key.iv = r), t.map && (i.map = this.initSegment(t.map)), i } }, { key: "segmentRequestFinished_", value: function (n, t) { if (this.mediaRequests += 1, t.stats && (this.mediaBytesTransferred += t.stats.bytesReceived, this.mediaTransferDuration += t.stats.roundTripTime), this.pendingSegment_) { if (t.requestId === this.pendingSegment_.requestId) { if (n) return this.pendingSegment_ = null, this.state = "READY", n.code === lrt ? void (this.mediaRequestsAborted += 1) : (this.pause(), n.code === crt ? (this.mediaRequestsTimedout += 1, this.bandwidth = 1, this.roundTrip = NaN, void this.trigger("bandwidthupdate")) : (this.mediaRequestsErrored += 1, this.error(n), void this.trigger("error"))); this.bandwidth = t.stats.bandwidth; this.roundTrip = t.stats.roundTripTime; t.map && (t.map = this.initSegment(t.map, !0)); t.key && this.segmentKey(t.key, !0); this.processSegmentResponse_(t) } } else this.mediaRequestsAborted += 1 } }, { key: "processSegmentResponse_", value: function (n) { var t = this.pendingSegment_; t.bytes = n.bytes; n.map && (t.segment.map.bytes = n.map.bytes); t.endOfAllRequests = n.endOfAllRequests; n.fmp4Captions && (function (n, t, i) { var r, u; for (r in i) n[r] || (t.trigger({ type: "usage", name: "hls-608" }), u = t.textTracks().getTrackById(r), n[r] = u || t.addRemoteTextTrack({ kind: "captions", id: r, label: r }, !1).track) }(this.inbandTextTracks_, this.hls_.tech_, n.captionStreams), function (n) { var t = n.inbandTextTracks, i = n.captionArray, r = n.timestampOffset, u; i && (u = window.WebKitDataCue || window.VTTCue, i.forEach(function (n) { var i = n.stream, f = n.startTime, e = n.endTime; t[i] && (f += r, e += r, t[i].addCue(new u(f, e, n.text))) })) }({ inbandTextTracks: this.inbandTextTracks_, captionArray: n.fmp4Captions, timestampOffset: 0 }), this.captionParser_ && this.captionParser_.clearParsedCaptions()); this.handleSegment_() } }, { key: "handleSegment_", value: function () { var h = this, r, e, o, u, f, s; if (this.pendingSegment_) { var n = this.pendingSegment_, i = n.segment, t = this.syncController_.probeSegmentInfo(n); if ("undefined" == typeof this.startingMedia_ && t && (t.containsAudio || t.containsVideo) && (this.startingMedia_ = { containsAudio: t.containsAudio, containsVideo: t.containsVideo }), r = function (n, t, i) { return "main" === n && t && i ? i.containsAudio || i.containsVideo ? t.containsVideo && !i.containsVideo ? "Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest." : !t.containsVideo && i.containsVideo ? "Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest." : null : "Neither audio nor video found in segment." : null }(this.loaderType_, this.startingMedia_, t), r) return this.error({ message: r, blacklistDuration: 1 / 0 }), void this.trigger("error"); if (n.isSyncRequest) return this.trigger("syncinfoupdate"), this.pendingSegment_ = null, void (this.state = "READY"); null !== n.timestampOffset && n.timestampOffset !== this.sourceUpdater_.timestampOffset() && (t && t.segmentTimestampInfo && (e = t.segmentTimestampInfo[0].ptsTime, o = t.segmentTimestampInfo[0].dtsTime, n.timestampOffset -= e - o), this.sourceUpdater_.timestampOffset(n.timestampOffset), this.trigger("timestampoffset")); u = this.syncController_.mappingForTimeline(n.timeline); (null !== u && this.trigger({ type: "segmenttimemapping", mapping: u }), this.state = "APPENDING", i.map) && (f = vh(i.map), this.activeInitSegmentId_ && this.activeInitSegmentId_ === f || (s = this.initSegment(i.map), this.sourceUpdater_.appendBuffer({ bytes: s.bytes }, function () { h.activeInitSegmentId_ = f }))); n.byteLength = n.bytes.byteLength; this.mediaSecondsLoaded += "number" == typeof i.start && "number" == typeof i.end ? i.end - i.start : i.duration; this.logger_(function (n) { var i = n.segment, f = i.start, e = i.end, t = n.playlist, r = t.mediaSequence, o = t.id, u = t.segments, s = void 0 === u ? [] : u, h = n.mediaIndex, c = n.timeline; return ["appending [" + h + "] of [" + r + ", " + (r + s.length) + "] from playlist [" + o + "]", "[" + f + " => " + e + "] in timeline [" + c + "]"].join(" ") }(n)); this.sourceUpdater_.appendBuffer({ bytes: n.bytes, videoSegmentTimingInfoCallback: this.handleVideoSegmentTimingInfo_.bind(this, n.requestId) }, this.handleUpdateEnd_.bind(this)) } else this.state = "READY" } }, { key: "handleVideoSegmentTimingInfo_", value: function (n, t) { if (this.pendingSegment_ && n === this.pendingSegment_.requestId) { var i = this.pendingSegment_.segment; i.videoTimingInfo || (i.videoTimingInfo = {}); i.videoTimingInfo.transmuxerPrependedSeconds = t.videoSegmentTimingInfo.prependedContentDuration || 0; i.videoTimingInfo.transmuxedPresentationStart = t.videoSegmentTimingInfo.start.presentation; i.videoTimingInfo.transmuxedPresentationEnd = t.videoSegmentTimingInfo.end.presentation; i.videoTimingInfo.baseMediaDecodeTime = t.videoSegmentTimingInfo.baseMediaDecodeTime } } }, { key: "handleUpdateEnd_", value: function () { if (!this.pendingSegment_) return this.state = "READY", void (this.paused() || this.monitorBuffer_()); var n = this.pendingSegment_, t = n.segment, i = null !== this.mediaIndex; this.pendingSegment_ = null; this.recordThroughput_(n); this.addSegmentMetadataCue_(n); this.state = "READY"; this.mediaIndex = n.mediaIndex; this.fetchAtBuffer_ = !0; this.currentTimeline_ = n.timeline; this.trigger("syncinfoupdate"); t.end && this.currentTime_() - t.end > 3 * n.playlist.targetDuration ? this.resetEverything() : (i && this.trigger("bandwidthupdate"), this.trigger("progress"), this.isEndOfStream_(n.mediaIndex + 1, n.playlist) && this.endOfStream(), this.paused() || this.monitorBuffer_()) } }, { key: "recordThroughput_", value: function (n) { var t = this.throughput.rate, i = Date.now() - n.endOfAllRequests + 1, r = Math.floor(n.byteLength / i * 8e3); this.throughput.rate += (r - t) / ++this.throughput.count } }, { key: "addSegmentMetadataCue_", value: function (t) { if (this.segmentMetadataTrack_) { var i = t.segment, r = i.start, u = i.end; if (hrt(r) && hrt(u)) { nf(r, u, this.segmentMetadataTrack_); var o = n.WebKitDataCue || n.VTTCue, f = { custom: i.custom, dateTimeObject: i.dateTimeObject, dateTimeString: i.dateTimeString, bandwidth: t.playlist.attributes.BANDWIDTH, resolution: t.playlist.attributes.RESOLUTION, codecs: t.playlist.attributes.CODECS, byteLength: t.byteLength, uri: t.uri, timeline: t.timeline, playlist: t.playlist.uri, start: r, end: u }, e = new o(r, u, JSON.stringify(f)); e.value = f; this.segmentMetadataTrack_.addCue(e) } } } }]), of); gy = new Uint8Array("\n\n".split("").map(function (n) { return n.charCodeAt(0) })); vrt = (ai(sf, dy), ri(sf, [{ key: "buffered_", value: function () { if (!this.subtitlesTrack_ || !this.subtitlesTrack_.cues.length) return i.createTimeRanges(); var n = this.subtitlesTrack_.cues, t = n[0].startTime, r = n[n.length - 1].startTime; return i.createTimeRanges([[t, r]]) } }, { key: "initSegment", value: function (n, t) { var e = 1 < arguments.length && void 0 !== t && t, u, i, f, r; return n ? (u = vh(n), i = this.initSegments_[u], e && !i && n.bytes && (f = gy.byteLength + n.bytes.byteLength, r = new Uint8Array(f), r.set(n.bytes), r.set(gy, n.bytes.byteLength), this.initSegments_[u] = i = { resolvedUri: n.resolvedUri, byterange: n.byterange, bytes: r }), i || n) : null } }, { key: "couldBeginLoading_", value: function () { return this.playlist_ && this.subtitlesTrack_ && !this.paused() } }, { key: "init_", value: function () { return this.state = "READY", this.resetEverything(), this.monitorBuffer_() } }, { key: "track", value: function (n) { return "undefined" == typeof n || (this.subtitlesTrack_ = n, "INIT" === this.state && this.couldBeginLoading_() && this.init_()), this.subtitlesTrack_ } }, { key: "remove", value: function (n, t) { nf(n, t, this.subtitlesTrack_) } }, { key: "fillBuffer_", value: function () { var t = this, n; if (this.syncPoint_ || (this.syncPoint_ = this.syncController_.getSyncPoint(this.playlist_, this.duration_(), this.currentTimeline_, this.currentTime_())), n = this.checkBuffer_(this.buffered_(), this.playlist_, this.mediaIndex, this.hasPlayed_(), this.currentTime_(), this.syncPoint_), n = this.skipEmptySegments_(n)) { if (null === this.syncController_.timestampOffsetForTimeline(n.timeline)) return this.syncController_.one("timestampoffset", function () { t.state = "READY"; t.paused() || t.monitorBuffer_() }), void (this.state = "WAITING_ON_TIMELINE"); this.loadSegment_(n) } } }, { key: "skipEmptySegments_", value: function (n) { for (; n && n.segment.empty;)n = this.generateSegmentInfo_(n.playlist, n.mediaIndex + 1, n.startOfSegment + n.duration, n.isSyncRequest); return n } }, { key: "handleSegment_", value: function () { var i = this, t, u, r; if (this.pendingSegment_ && this.subtitlesTrack_) { if (this.state = "APPENDING", t = this.pendingSegment_, u = t.segment, "function" != typeof n.WebVTT && this.subtitlesTrack_ && this.subtitlesTrack_.tech_) { function n() { i.subtitlesTrack_.tech_.off("vttjsloaded", r); i.error({ message: "Error loading vtt.js" }); i.state = "READY"; i.pause(); i.trigger("error") } return r = void 0, r = function () { i.subtitlesTrack_.tech_.off("vttjserror", n); i.handleSegment_() }, this.state = "WAITING_ON_VTTJS", this.subtitlesTrack_.tech_.one("vttjsloaded", r), void this.subtitlesTrack_.tech_.one("vttjserror", n) } u.requested = !0; try { this.parseVTTCues_(t) } catch (t) { return this.error({ message: t.message }), this.state = "READY", this.pause(), this.trigger("error") } if (this.updateTimeMapping_(t, this.syncController_.timelines[t.timeline], this.playlist_), t.isSyncRequest) return this.trigger("syncinfoupdate"), this.pendingSegment_ = null, void (this.state = "READY"); t.byteLength = t.bytes.byteLength; this.mediaSecondsLoaded += u.duration; t.cues.length && this.remove(t.cues[0].endTime, t.cues[t.cues.length - 1].endTime); t.cues.forEach(function (n) { i.subtitlesTrack_.addCue(n) }); this.handleUpdateEnd_() } else this.state = "READY" } }, { key: "parseVTTCues_", value: function (t) { var e = void 0, o = !1, r, u, f; "function" == typeof n.TextDecoder ? e = new n.TextDecoder("utf8") : (e = n.WebVTT.StringDecoder(), o = !0); r = new n.WebVTT.Parser(n, n.vttjs, e); (t.cues = [], t.timestampmap = { MPEGTS: 0, LOCAL: 0 }, r.oncue = t.cues.push.bind(t.cues), r.ontimestampmap = function (n) { return t.timestampmap = n }, r.onparsingerror = function (n) { i.log.warn("Error encountered when parsing cues: " + n.message) }, t.segment.map) && (u = t.segment.map.bytes, o && (u = art(u)), r.parse(u)); f = t.bytes; o && (f = art(f)); r.parse(f); r.flush() } }, { key: "updateTimeMapping_", value: function (n, t, i) { var f = n.segment, r, u, e, o; t && (n.cues.length ? (r = n.timestampmap, u = r.MPEGTS / 9e4 - r.LOCAL + t.mapping, (n.cues.forEach(function (n) { n.startTime += u; n.endTime += u }), i.syncInfo) || (e = n.cues[0].startTime, o = n.cues[n.cues.length - 1].startTime, i.syncInfo = { mediaSequence: i.mediaSequence + n.mediaIndex, time: Math.min(e, o - f.duration) })) : f.empty = !0) } }]), sf); var fct = fht, yrt = [{ name: "VOD", run: function (n, t, i) { return i === 1 / 0 ? null : { time: 0, segmentIndex: 0 } } }, { name: "ProgramDateTime", run: function (n, t, i, r, u) { var f, s, h, e; if (!n.datetimeToDisplayTime) return null; var c = t.segments || [], l = null, o = null; for (u = u || 0, f = 0; f < c.length; f++)if (s = c[f], s.dateTimeObject) { if (h = s.dateTimeObject.getTime() / 1e3 + n.datetimeToDisplayTime, e = Math.abs(u - h), null !== o && (0 === e || o < e)) break; o = e; l = { time: h, segmentIndex: f } } return l } }, { name: "Segment", run: function (n, t, i, r, u) { var c = t.segments || [], h = null, f = null, e, o, s; for (u = u || 0, e = 0; e < c.length; e++)if (o = c[e], o.timeline === r && "undefined" != typeof o.start) { if (s = Math.abs(u - o.start), null !== f && f < s) break; (!h || null === f || s <= f) && (f = s, h = { time: o.start, segmentIndex: e }) } return h } }, { name: "Discontinuity", run: function (n, t, i, r, u) { var s = null, f, e, o; if (u = u || 0, t.discontinuityStarts && t.discontinuityStarts.length) for (f = null, e = 0; e < t.discontinuityStarts.length; e++) { var c = t.discontinuityStarts[e], l = t.discontinuitySequence + e + 1, h = n.discontinuities[l]; if (h) { if (o = Math.abs(u - h.time), null !== f && f < o) break; (!s || null === f || o <= f) && (f = o, s = { time: h.time, segmentIndex: c }) } } return s } }, { name: "Playlist", run: function (n, t) { return t.syncInfo ? { time: t.syncInfo.time, segmentIndex: t.syncInfo.mediaSequence - t.mediaSequence } : null } }], ect = (ai(hf, i.EventTarget), ri(hf, [{ key: "getSyncPoint", value: function (n, t, i, r) { var u = this.runStrategies_(n, t, i, r); return u.length ? this.selectSyncPoint_(u, { key: "time", value: r }) : null } }, { key: "getExpiredTime", value: function (n, t) { var r, i; return !n || !n.segments ? null : (r = this.runStrategies_(n, t, n.discontinuitySequence, 0), !r.length) ? null : (i = this.selectSyncPoint_(r, { key: "segmentIndex", value: 0 }), 0 < i.segmentIndex && (i.time *= -1), Math.abs(i.time + we(n, i.segmentIndex, 0))) } }, { key: "runStrategies_", value: function (n, t, i, r) { for (var f, e, o = [], u = 0; u < yrt.length; u++)f = yrt[u], e = f.run(this, n, t, i, r), e && (e.strategy = f.name, o.push({ strategy: f.name, syncPoint: e })); return o } }, { key: "selectSyncPoint_", value: function (n, t) { for (var u, r = n[0].syncPoint, f = Math.abs(n[0].syncPoint[t.key] - t.value), e = n[0].strategy, i = 1; i < n.length; i++)u = Math.abs(n[i].syncPoint[t.key] - t.value), u < f && (f = u, r = n[i].syncPoint, e = n[i].strategy); return this.logger_("syncPoint for [" + t.key + ": " + t.value + "] chosen with strategy [" + e + "]: [time:" + r.time + ", segmentIndex:" + r.segmentIndex + "]"), r } }, { key: "saveExpiredSegmentInfo", value: function (n, t) { for (var r, i = t.mediaSequence - n.mediaSequence - 1; 0 <= i; i--)if (r = n.segments[i], r && "undefined" != typeof r.start) { t.syncInfo = { mediaSequence: n.mediaSequence + i, time: r.start }; this.logger_("playlist refresh sync: [time:" + t.syncInfo.time + ", mediaSequence: " + t.syncInfo.mediaSequence + "]"); this.trigger("syncinfoupdate"); break } } }, { key: "setDateTimeMapping", value: function (n) { if (!this.datetimeToDisplayTime && n.segments && n.segments.length && n.segments[0].dateTimeObject) { var t = n.segments[0].dateTimeObject.getTime() / 1e3; this.datetimeToDisplayTime = -t } } }, { key: "reset", value: function () { this.inspectCache_ = void 0 } }, { key: "probeSegmentInfo", value: function (n) { var r = n.segment, t = n.playlist, i = void 0; return (i = r.map ? this.probeMp4Segment_(n) : this.probeTsSegment_(n)) && this.calculateSegmentTimeMapping_(n, i) && (this.saveDiscontinuitySyncInfo_(n), t.syncInfo || (t.syncInfo = { mediaSequence: t.mediaSequence + n.mediaIndex, time: r.start })), i } }, { key: "probeMp4Segment_", value: function (n) { var i = n.segment, r = oi.timescale(i.map.bytes), t = oi.startTime(r, n.bytes); return null !== n.timestampOffset && (n.timestampOffset -= t), { start: t, end: t + i.duration } } }, { key: "probeTsSegment_", value: function (n) { var t = fct(n.bytes, this.inspectCache_), i = void 0, r = void 0, u = void 0; return t ? (t.video && 2 === t.video.length ? (this.inspectCache_ = t.video[1].dts, i = t.video[0].dtsTime, r = t.video[1].dtsTime, u = t.video) : t.audio && 2 === t.audio.length && (this.inspectCache_ = t.audio[1].dts, i = t.audio[0].dtsTime, r = t.audio[1].dtsTime, u = t.audio), { segmentTimestampInfo: u, start: i, end: r, containsVideo: t.video && 2 === t.video.length, containsAudio: t.audio && 2 === t.audio.length }) : null } }, { key: "timestampOffsetForTimeline", value: function (n) { return "undefined" == typeof this.timelines[n] ? null : this.timelines[n].time } }, { key: "mappingForTimeline", value: function (n) { return "undefined" == typeof this.timelines[n] ? null : this.timelines[n].mapping } }, { key: "calculateSegmentTimeMapping_", value: function (n, t) { var r = n.segment, i = this.timelines[n.timeline]; if (null !== n.timestampOffset) i = { time: n.startOfSegment, mapping: n.startOfSegment - t.start }, this.timelines[n.timeline] = i, this.trigger("timestampoffset"), this.logger_("time mapping for timeline " + n.timeline + ": [time: " + i.time + "] [mapping: " + i.mapping + "]"), r.start = n.startOfSegment, r.end = t.end + i.mapping; else { if (!i) return !1; r.start = t.start + i.mapping; r.end = t.end + i.mapping } return !0 } }, { key: "saveDiscontinuitySyncInfo_", value: function (n) { var t = n.playlist, i = n.segment, r, e; if (i.discontinuity) this.discontinuities[i.timeline] = { time: i.start, accuracy: 0 }; else if (t.discontinuityStarts && t.discontinuityStarts.length) for (r = 0; r < t.discontinuityStarts.length; r++) { var u = t.discontinuityStarts[r], f = t.discontinuitySequence + r + 1, o = u - n.mediaIndex, s = Math.abs(o); (!this.discontinuities[f] || this.discontinuities[f].accuracy > s) && (e = void 0, e = o < 0 ? i.start - we(t, n.mediaIndex, u) : i.end + we(t, n.mediaIndex + 1, u), this.discontinuities[f] = { time: e, accuracy: s }) } } }]), hf); var sct = new bit("./decrypter-worker.worker.js", function () { function f(n, t) { if (!(n instanceof t)) throw new TypeError("Cannot call a class as a function"); } function v(n, t) { for (var i, r = 0; r < t.length; r++)i = t[r], i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), Object.defineProperty(n, i.key, i) } function e(t) { f(this, e); n = n || function () { for (var h = [[[], [], [], [], []], [[], [], [], [], []]], f = h[0], e = h[1], l = f[4], y = e[4], n = void 0, i = void 0, t = void 0, u = [], a = [], c = void 0, v = void 0, r = void 0, o = void 0, s = void 0, n = 0; n < 256; n++)a[(u[n] = n << 1 ^ 283 * (n >> 7)) ^ n] = n; for (i = t = 0; !l[i]; i ^= c || 1, t = a[t] || 1)for (r = (r = t ^ t << 1 ^ t << 2 ^ t << 3 ^ t << 4) >> 8 ^ 255 & r ^ 99, s = 16843009 * u[v = u[c = u[y[l[i] = r] = i]]] ^ 65537 * v ^ 257 * c ^ 16843008 * i, o = 257 * u[r] ^ 16843008 * r, n = 0; n < 4; n++)f[n][i] = o = o << 24 ^ o >>> 8, e[n][r] = s = s << 24 ^ s >>> 8; for (n = 0; n < 5; n++)f[n] = f[n].slice(0), e[n] = e[n].slice(0); return h }(); this._tables = [[n[0][0].slice(), n[0][1].slice(), n[0][2].slice(), n[0][3].slice(), n[0][4].slice()], [n[1][0].slice(), n[1][1].slice(), n[1][2].slice(), n[1][3].slice(), n[1][4].slice()]]; var r = void 0, h = void 0, i = void 0, s = void 0, a = void 0, o = this._tables[0][4], c = this._tables[1], u = t.length, l = 1; if (4 !== u && 6 !== u && 8 !== u) throw new Error("Invalid aes key size"); for (s = t.slice(0), a = [], this._key = [s, a], r = u; r < 4 * u + 28; r++)i = s[r - 1], (r % u == 0 || 8 === u && r % u == 4) && (i = o[i >>> 24] << 24 ^ o[i >> 16 & 255] << 16 ^ o[i >> 8 & 255] << 8 ^ o[255 & i], r % u == 0 && (i = i << 8 ^ i >>> 24 ^ l << 24, l = l << 1 ^ 283 * (l >> 7))), s[r] = s[r - u] ^ i; for (h = 0; r; h++, r--)i = s[3 & h ? r : r - 4], a[h] = r <= 4 || h < 4 ? i : c[0][o[i >>> 24]] ^ c[1][o[i >> 16 & 255]] ^ c[2][o[i >> 8 & 255]] ^ c[3][o[255 & i]] } function i() { f(this, i); this.listeners = {} } function r() { f(this, r); var n = function (n, t) { if (!n) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? n : t }(this, c.call(this, h)); return n.jobs = [], n.delay = 1, n.timeout_ = null, n } function t(n) { return n << 24 | (65280 & n) << 8 | (16711680 & n) >> 8 | n >>> 24 } function u(n, i, r, e) { f(this, u); var h = u.STEP, s = new Int32Array(n.buffer), c = new Uint8Array(n.byteLength), o = 0; for (this.asyncStream_ = new l, this.asyncStream_.push(this.decryptChunk_(s.subarray(o, o + h), i, r, c)), o = h; o < s.length; o += h)r = new Uint32Array([t(s[o - 4]), t(s[o - 3]), t(s[o - 2]), t(s[o - 1])]), this.asyncStream_.push(this.decryptChunk_(s.subarray(o, o + h), i, r, c)); this.asyncStream_.push(function () { e(null, function (n) { return n.subarray(0, n.byteLength - n[n.byteLength - 1]) }(c)) }) } var o, n, s, h, c, l, a, y = this; o = function (n, t, i) { return t && v(n.prototype, t), i && v(n, i), n }; n = null; e.prototype.decrypt = function (n, t, i, r, u, f) { for (var e = this._key[1], o = n ^ e[0], s = r ^ e[1], h = i ^ e[2], c = t ^ e[3], y = void 0, g = void 0, nt = void 0, tt = e.length / 4 - 2, l = void 0, a = 4, v = this._tables[1], p = v[0], w = v[1], b = v[2], k = v[3], d = v[4], l = 0; l < tt; l++)y = p[o >>> 24] ^ w[s >> 16 & 255] ^ b[h >> 8 & 255] ^ k[255 & c] ^ e[a], g = p[s >>> 24] ^ w[h >> 16 & 255] ^ b[c >> 8 & 255] ^ k[255 & o] ^ e[a + 1], nt = p[h >>> 24] ^ w[c >> 16 & 255] ^ b[o >> 8 & 255] ^ k[255 & s] ^ e[a + 2], c = p[c >>> 24] ^ w[o >> 16 & 255] ^ b[s >> 8 & 255] ^ k[255 & h] ^ e[a + 3], a += 4, o = y, s = g, h = nt; for (l = 0; l < 4; l++)u[(3 & -l) + f] = d[o >>> 24] << 24 ^ d[s >> 16 & 255] << 16 ^ d[h >> 8 & 255] << 8 ^ d[255 & c] ^ e[a++], y = o, o = s, s = h, h = c, c = y }; s = e; i.prototype.on = function (n, t) { this.listeners[n] || (this.listeners[n] = []); this.listeners[n].push(t) }; i.prototype.off = function (n, t) { if (!this.listeners[n]) return !1; var i = this.listeners[n].indexOf(t); return this.listeners[n].splice(i, 1), -1 < i }; i.prototype.trigger = function (n, t) { var i = this.listeners[n], f, r; if (i) if (2 === arguments.length) for (f = i.length, r = 0; r < f; ++r)i[r].call(this, t); else for (var e = Array.prototype.slice.call(arguments, 1), o = i.length, u = 0; u < o; ++u)i[u].apply(this, e) }; i.prototype.dispose = function () { this.listeners = {} }; i.prototype.pipe = function (n) { this.on("data", function (t) { n.push(t) }) }, function (n, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); n.prototype = Object.create(t && t.prototype, { constructor: { value: n, enumerable: !1, writable: !0, configurable: !0 } }); t && (Object.setPrototypeOf ? Object.setPrototypeOf(n, t) : n.__proto__ = t) }(r, c = h = i); r.prototype.processJob_ = function () { this.jobs.shift()(); this.timeout_ = this.jobs.length ? setTimeout(this.processJob_.bind(this), this.delay) : null }; r.prototype.push = function (n) { this.jobs.push(n); this.timeout_ || (this.timeout_ = setTimeout(this.processJob_.bind(this), this.delay)) }; l = r; u.prototype.decryptChunk_ = function (n, i, r, u) { return function () { var f = function (n, i, r) { var e = new Int32Array(n.buffer, n.byteOffset, n.byteLength >> 2), b = new s(Array.prototype.slice.call(i)), w = new Uint8Array(n.byteLength), f = new Int32Array(w.buffer), o = void 0, h = void 0, c = void 0, l = void 0, a = void 0, v = void 0, y = void 0, p = void 0, u = void 0; for (o = r[0], h = r[1], c = r[2], l = r[3], u = 0; u < e.length; u += 4)a = t(e[u]), v = t(e[u + 1]), y = t(e[u + 2]), p = t(e[u + 3]), b.decrypt(a, v, y, p, f, u), f[u] = t(f[u] ^ o), f[u + 1] = t(f[u + 1] ^ h), f[u + 2] = t(f[u + 2] ^ c), f[u + 3] = t(f[u + 3] ^ l), o = a, h = v, c = y, l = p; return w }(n, i, r); u.set(f, n.byteOffset) } }; o(u, null, [{ key: "STEP", get: function () { return 32e3 } }]); a = u, new function (n) { n.onmessage = function (t) { var i = t.data, r = new Uint8Array(i.encrypted.bytes, i.encrypted.byteOffset, i.encrypted.byteLength), u = new Uint32Array(i.key.bytes, i.key.byteOffset, i.key.byteLength / 4), f = new Uint32Array(i.iv.bytes, i.iv.byteOffset, i.iv.byteLength / 4); new a(r, u, f, function (t, r) { n.postMessage(function (n) { var t = {}; return Object.keys(n).forEach(function (i) { var r = n[i]; t[i] = ArrayBuffer.isView(r) ? { bytes: r.buffer, byteOffset: r.byteOffset, byteLength: r.byteLength } : r }), t }({ source: i.source, decrypted: r }), [r.buffer]) }) } }(y) }), kh = { AUDIO: function (n, t) { return function () { var o = t.segmentLoaders[n], r = t.mediaTypes[n], s = t.blacklistCurrentPlaylist, u; bh(o, r); var h = r.activeTrack(), f = r.activeGroup(), c = (f.filter(function (n) { return n.default })[0] || f[0]).id, e = r.tracks[c]; if (h !== e) { for (u in i.log.warn("Problem encountered loading the alternate audio track.Switching back to default."), r.tracks) r.tracks[u].enabled = r.tracks[u] === e; r.onTrackChanged() } else s({ message: "Problem encountered loading the default audio track." }) } }, SUBTITLES: function (n, t) { return function () { var f = t.segmentLoaders[n], r = t.mediaTypes[n], u; i.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."); bh(f, r); u = r.activeTrack(); u && (u.mode = "disabled"); r.onTrackChanged() } } }, wrt = { AUDIO: function (n, t, i) { if (t) { var u = i.tech, f = i.requestOptions, r = i.segmentLoaders[n]; t.on("loadedmetadata", function () { var n = t.media(); r.playlist(n, f); (!u.paused() || n.endList && "none" !== u.preload()) && r.load() }); t.on("loadedplaylist", function () { r.playlist(t.media(), f); u.paused() || r.load() }); t.on("error", kh[n](n, i)) } }, SUBTITLES: function (n, t, i) { var u = i.tech, f = i.requestOptions, r = i.segmentLoaders[n], e = i.mediaTypes[n]; t.on("loadedmetadata", function () { var n = t.media(); r.playlist(n, f); r.track(e.activeTrack()); (!u.paused() || n.endList && "none" !== u.preload()) && r.load() }); t.on("loadedplaylist", function () { r.playlist(t.media(), f); u.paused() || r.load() }); t.on("error", kh[n](n, i)) } }, hct = { AUDIO: function (n, t) { var o, s, l = t.hls, w = t.sourceType, b = t.segmentLoaders[n], a = t.requestOptions, f = t.master.mediaGroups, v = t.mediaTypes[n], h = v.groups, y = v.tracks, k = t.masterPlaylistLoader, e, u, r, c, p; for (e in f[n] && 0 !== Object.keys(f[n]).length || (f[n] = { main: { "default": { "default": !0 } } }), f[n]) for (u in h[e] || (h[e] = []), f[n][e]) r = f[n][e][u], c = void 0, (c = r.resolvedUri ? new lh(r.resolvedUri, l, a) : r.playlists && "dash" === w ? new ph(r.playlists[0], l, a, k) : null, r = i.mergeOptions({ id: u, playlistLoader: c }, r), wrt[n](n, r.playlistLoader, t), h[e].push(r), "undefined" == typeof y[u]) && (p = new i.AudioTrack({ id: u, kind: (o = r, s = void 0, s = o.default ? "main" : "alternative", o.characteristics && 0 <= o.characteristics.indexOf("public.accessibility.describes-video") && (s = "main-desc"), s), enabled: !1, language: r.language, "default": r.default, label: u }), y[u] = p); b.on("error", kh[n](n, t)) }, SUBTITLES: function (n, t) { var p = t.tech, h = t.hls, c = t.sourceType, w = t.segmentLoaders[n], l = t.requestOptions, e = t.master.mediaGroups, a = t.mediaTypes[n], s = a.groups, v = a.tracks, b = t.masterPlaylistLoader, f, u, r, o, y; for (f in e[n]) for (u in s[f] || (s[f] = []), e[n][f]) e[n][f][u].forced || (r = e[n][f][u], o = void 0, ("hls" === c ? o = new lh(r.resolvedUri, h, l) : "dash" === c && (o = new ph(r.playlists[0], h, l, b)), r = i.mergeOptions({ id: u, playlistLoader: o }, r), wrt[n](n, r.playlistLoader, t), s[f].push(r), "undefined" == typeof v[u]) && (y = p.addRemoteTextTrack({ id: u, kind: "subtitles", "default": r.default && r.autoselect, language: r.language, label: u }, !1).track, v[u] = y)); w.on("error", kh[n](n, t)) }, "CLOSED-CAPTIONS": function (n, t) { var l = t.tech, e = t.master.mediaGroups, s = t.mediaTypes[n], o = s.groups, h = s.tracks, u, f, r, c; for (u in e[n]) for (f in o[u] || (o[u] = []), e[n][u]) r = e[n][u][f], r.instreamId.match(/CC\d/) && (o[u].push(i.mergeOptions({ id: f }, r)), "undefined" == typeof h[f]) && (c = l.addRemoteTextTrack({ id: r.instreamId, kind: "captions", "default": r.default && r.autoselect, language: r.language, label: f }, !1).track, h[f] = c) } }, cct = { AUDIO: function (n, t) { return function () { var i = t.mediaTypes[n].tracks; for (var r in i) if (i[r].enabled) return i[r]; return null } }, SUBTITLES: function (n, t) { return function () { var i = t.mediaTypes[n].tracks; for (var r in i) if ("showing" === i[r].mode) return i[r]; return null } } }, nr = void 0, lct = ["mediaRequests", "mediaRequestsAborted", "mediaRequestsTimedout", "mediaRequestsErrored", "mediaTransferDuration", "mediaBytesTransferred"], act = (ai(cf, i.EventTarget), ri(cf, [{ key: "setupMasterPlaylistLoaderListeners_", value: function () { var n = this; this.masterPlaylistLoader_.on("loadedmetadata", function () { var t = n.masterPlaylistLoader_.media(), r = 1.5 * t.targetDuration * 1e3; n.requestOptions_.timeout = ry(n.masterPlaylistLoader_.master, n.masterPlaylistLoader_.media()) ? 0 : r; t.endList && "none" !== n.tech_.preload() && (n.mainSegmentLoader_.playlist(t, n.requestOptions_), n.mainSegmentLoader_.load()); oct({ sourceType: n.sourceType_, segmentLoaders: { AUDIO: n.audioSegmentLoader_, SUBTITLES: n.subtitleSegmentLoader_, main: n.mainSegmentLoader_ }, tech: n.tech_, requestOptions: n.requestOptions_, masterPlaylistLoader: n.masterPlaylistLoader_, hls: n.hls_, master: n.master(), mediaTypes: n.mediaTypes_, blacklistCurrentPlaylist: n.blacklistCurrentPlaylist.bind(n) }); n.triggerPresenceUsage_(n.master(), t); try { n.setupSourceBuffers_() } catch (t) { return i.log.warn("Failed to create SourceBuffers", t), n.mediaSource.endOfStream("decode") } n.setupFirstPlay(); !n.mediaTypes_.AUDIO.activePlaylistLoader || n.mediaTypes_.AUDIO.activePlaylistLoader.media() ? n.trigger("selectedinitialmedia") : n.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata", function () { n.trigger("selectedinitialmedia") }) }); this.masterPlaylistLoader_.on("loadedplaylist", function () { var t = n.masterPlaylistLoader_.media(), i; if (!t) return n.excludeUnsupportedVariants_(), i = void 0, n.enableLowInitialPlaylist && (i = n.selectInitialPlaylist()), i = i || n.selectPlaylist(), n.initialMedia_ = i, void n.masterPlaylistLoader_.media(n.initialMedia_); if (n.useCueTags_ && n.updateAdCues_(t), n.mainSegmentLoader_.playlist(t, n.requestOptions_), n.updateDuration(), n.tech_.paused() || (n.mainSegmentLoader_.load(), n.audioSegmentLoader_ && n.audioSegmentLoader_.load()), !t.endList) { function t() { var t = n.seekable(); 0 !== t.length && n.mediaSource.addSeekableRange_(t.start(0), t.end(0)) } n.duration() !== 1 / 0 ? n.tech_.one("durationchange", function t() { n.duration() === 1 / 0 ? t() : n.tech_.one("durationchange", t) }) : t() } }); this.masterPlaylistLoader_.on("error", function () { n.blacklistCurrentPlaylist(n.masterPlaylistLoader_.error) }); this.masterPlaylistLoader_.on("mediachanging", function () { n.mainSegmentLoader_.abort(); n.mainSegmentLoader_.pause() }); this.masterPlaylistLoader_.on("mediachange", function () { var t = n.masterPlaylistLoader_.media(), i = 1.5 * t.targetDuration * 1e3; n.requestOptions_.timeout = ry(n.masterPlaylistLoader_.master, n.masterPlaylistLoader_.media()) ? 0 : i; n.mainSegmentLoader_.playlist(t, n.requestOptions_); n.mainSegmentLoader_.load(); n.tech_.trigger({ type: "mediachange", bubbles: !0 }) }); this.masterPlaylistLoader_.on("playlistunchanged", function () { var t = n.masterPlaylistLoader_.media(); n.stuckAtPlaylistEnd_(t) && (n.blacklistCurrentPlaylist({ message: "Playlist no longer updating." }), n.tech_.trigger("playliststuck")) }); this.masterPlaylistLoader_.on("renditiondisabled", function () { n.tech_.trigger({ type: "usage", name: "hls-rendition-disabled" }) }); this.masterPlaylistLoader_.on("renditionenabled", function () { n.tech_.trigger({ type: "usage", name: "hls-rendition-enabled" }) }) } }, { key: "triggerPresenceUsage_", value: function (n, t) { var i = n.mediaGroups || {}, u = !0, f = Object.keys(i.AUDIO), r, e; for (r in i.AUDIO) for (e in i.AUDIO[r]) i.AUDIO[r][e].uri || (u = !1); u && this.tech_.trigger({ type: "usage", name: "hls-demuxed" }); Object.keys(i.SUBTITLES).length && this.tech_.trigger({ type: "usage", name: "hls-webvtt" }); nr.Playlist.isAes(t) && this.tech_.trigger({ type: "usage", name: "hls-aes" }); nr.Playlist.isFmp4(t) && this.tech_.trigger({ type: "usage", name: "hls-fmp4" }); f.length && 1 < Object.keys(i.AUDIO[f[0]]).length && this.tech_.trigger({ type: "usage", name: "hls-alternate-audio" }); this.useCueTags_ && this.tech_.trigger({ type: "usage", name: "hls-playlist-cue-tags" }) } }, { key: "setupSegmentLoaderListeners_", value: function () { var n = this; this.mainSegmentLoader_.on("bandwidthupdate", function () { var i = n.selectPlaylist(), r = n.masterPlaylistLoader_.media(), t = n.tech_.buffered(), u = t.length ? t.end(t.length - 1) - n.tech_.currentTime() : 0, f = n.bufferLowWaterLine(); (!r.endList || n.duration() < bt.MAX_BUFFER_LOW_WATER_LINE || i.attributes.BANDWIDTH < r.attributes.BANDWIDTH || f <= u) && n.masterPlaylistLoader_.media(i); n.tech_.trigger("bandwidthupdate") }); this.mainSegmentLoader_.on("progress", function () { n.trigger("progress") }); this.mainSegmentLoader_.on("error", function () { n.blacklistCurrentPlaylist(n.mainSegmentLoader_.error()) }); this.mainSegmentLoader_.on("syncinfoupdate", function () { n.onSyncInfoUpdate_() }); this.mainSegmentLoader_.on("timestampoffset", function () { n.tech_.trigger({ type: "usage", name: "hls-timestamp-offset" }) }); this.audioSegmentLoader_.on("syncinfoupdate", function () { n.onSyncInfoUpdate_() }); this.mainSegmentLoader_.on("ended", function () { n.onEndOfStream() }); this.mainSegmentLoader_.on("earlyabort", function () { n.blacklistCurrentPlaylist({ message: "Aborted early because there isn't enough bandwidth to complete the request without rebuffering." }, 120) }); this.mainSegmentLoader_.on("reseteverything", function () { n.tech_.trigger("hls-reset") }); this.mainSegmentLoader_.on("segmenttimemapping", function (t) { n.tech_.trigger({ type: "hls-segment-time-mapping", mapping: t.mapping }) }); this.audioSegmentLoader_.on("ended", function () { n.onEndOfStream() }) } }, { key: "mediaSecondsLoaded_", value: function () { return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded + this.mainSegmentLoader_.mediaSecondsLoaded) } }, { key: "load", value: function () { this.mainSegmentLoader_.load(); this.mediaTypes_.AUDIO.activePlaylistLoader && this.audioSegmentLoader_.load(); this.mediaTypes_.SUBTITLES.activePlaylistLoader && this.subtitleSegmentLoader_.load() } }, { key: "smoothQualityChange_", value: function () { var n = this.selectPlaylist(); n !== this.masterPlaylistLoader_.media() && (this.masterPlaylistLoader_.media(n), this.mainSegmentLoader_.resetLoader()) } }, { key: "fastQualityChange_", value: function () { var n = this, t = this.selectPlaylist(); t !== this.masterPlaylistLoader_.media() && (this.masterPlaylistLoader_.media(t), this.mainSegmentLoader_.resetEverything(function () { i.browser.IE_VERSION || i.browser.IS_EDGE ? n.tech_.setCurrentTime(n.tech_.currentTime() + .04) : n.tech_.setCurrentTime(n.tech_.currentTime()) })) } }, { key: "play", value: function () { if (!this.setupFirstPlay()) { this.tech_.ended() && this.seekTo_(0); this.hasPlayed_() && this.load(); var n = this.tech_.seekable(); return this.tech_.duration() === 1 / 0 && this.tech_.currentTime() < n.start(0) ? this.seekTo_(n.end(n.length - 1)) : void 0 } } }, { key: "setupFirstPlay", value: function () { var t = this, r = this.masterPlaylistLoader_.media(), n; if (!r || this.tech_.paused() || this.hasPlayed_()) return !1; if (!r.endList) { if (n = this.seekable(), !n.length) return !1; if (i.browser.IE_VERSION && 0 === this.tech_.readyState()) return this.tech_.one("loadedmetadata", function () { t.trigger("firstplay"); t.seekTo_(n.end(0)); t.hasPlayed_ = function () { return !0 } }), !1; this.trigger("firstplay"); this.seekTo_(n.end(0)) } return this.hasPlayed_ = function () { return !0 }, this.load(), !0 } }, { key: "handleSourceOpen_", value: function () { try { this.setupSourceBuffers_() } catch (n) { return i.log.warn("Failed to create Source Buffers", n), this.mediaSource.endOfStream("decode") } if (this.tech_.autoplay()) { var n = this.tech_.play(); "undefined" != typeof n && "function" == typeof n.then && n.then(null, function () { }) } this.trigger("sourceopen") } }, { key: "onEndOfStream", value: function () { var n = this.mainSegmentLoader_.ended_; if (this.mediaTypes_.AUDIO.activePlaylistLoader && (n = !this.mainSegmentLoader_.startingMedia_ || this.mainSegmentLoader_.startingMedia_.containsVideo ? n && this.audioSegmentLoader_.ended_ : this.audioSegmentLoader_.ended_), n) { this.logger_("calling mediaSource.endOfStream()"); try { this.mediaSource.endOfStream() } catch (n) { i.log.warn("Failed to call media source endOfStream", n) } } } }, { key: "stuckAtPlaylistEnd_", value: function (n) { var t, r; if (!this.seekable().length || (t = this.syncController_.getExpiredTime(n, this.mediaSource.duration), null === t)) return !1; var u = nr.Playlist.playlistEnd(n, t), f = this.tech_.currentTime(), i = this.tech_.buffered(); return i.length ? (r = i.end(i.length - 1), r - f <= .1 && u - r <= .1) : u - f <= .1 } }, { key: "blacklistCurrentPlaylist", value: function (n, t) { var s, r = 0 < arguments.length && void 0 !== n ? n : {}, f = t, e = void 0, u, o; if (e = r.playlist || this.masterPlaylistLoader_.media(), f = f || r.blacklistDuration || this.blacklistDuration, !e) { this.error = r; try { return this.mediaSource.endOfStream("network") } catch (n) { return this.trigger("error") } } return u = 1 === this.masterPlaylistLoader_.master.playlists.filter(ah).length, o = this.masterPlaylistLoader_.master.playlists, 1 === o.length ? (i.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."), this.tech_.trigger("retryplaylist"), this.masterPlaylistLoader_.load(u)) : (u && (i.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."), o.forEach(function (n) { n.excludeUntil !== 1 / 0 && delete n.excludeUntil }), this.tech_.trigger("retryplaylist")), e.excludeUntil = Date.now() + 1e3 * f, this.tech_.trigger("blacklistplaylist"), this.tech_.trigger({ type: "usage", name: "hls-rendition-blacklisted" }), s = this.selectPlaylist(), i.log.warn("Problem encountered with the current HLS playlist." + (r.message ? " " + r.message : "") + " Switching to another playlist."), this.masterPlaylistLoader_.media(s, u)) } }, { key: "pauseLoading", value: function () { this.mainSegmentLoader_.pause(); this.mediaTypes_.AUDIO.activePlaylistLoader && this.audioSegmentLoader_.pause(); this.mediaTypes_.SUBTITLES.activePlaylistLoader && this.subtitleSegmentLoader_.pause() } }, { key: "setCurrentTime", value: function (n) { var t = ait(this.tech_.buffered(), n); return this.masterPlaylistLoader_ && this.masterPlaylistLoader_.media() && this.masterPlaylistLoader_.media().segments ? t && t.length ? n : (this.mainSegmentLoader_.resetEverything(), this.mainSegmentLoader_.abort(), this.mediaTypes_.AUDIO.activePlaylistLoader && (this.audioSegmentLoader_.resetEverything(), this.audioSegmentLoader_.abort()), this.mediaTypes_.SUBTITLES.activePlaylistLoader && (this.subtitleSegmentLoader_.resetEverything(), this.subtitleSegmentLoader_.abort()), void this.load()) : 0 } }, { key: "duration", value: function () { return this.masterPlaylistLoader_ ? this.mediaSource ? this.mediaSource.duration : nr.Playlist.duration(this.masterPlaylistLoader_.media()) : 0 } }, { key: "seekable", value: function () { return this.seekable_ } }, { key: "onSyncInfoUpdate_", value: function () { var n = void 0, t = void 0, r, u, f, e; if (this.masterPlaylistLoader_ && (r = this.masterPlaylistLoader_.media(), r && (u = this.syncController_.getExpiredTime(r, this.mediaSource.duration), null !== u && 0 !== (n = nr.Playlist.seekable(r, u)).length))) { if (this.mediaTypes_.AUDIO.activePlaylistLoader) { if (r = this.mediaTypes_.AUDIO.activePlaylistLoader.media(), null === (u = this.syncController_.getExpiredTime(r, this.mediaSource.duration))) return; if (0 === (t = nr.Playlist.seekable(r, u)).length) return } f = void 0; e = void 0; this.seekable_ && this.seekable_.length && (f = this.seekable_.end(0), e = this.seekable_.start(0)); this.seekable_ = t ? t.start(0) > n.end(0) || n.start(0) > t.end(0) ? n : i.createTimeRanges([[t.start(0) > n.start(0) ? t.start(0) : n.start(0), t.end(0) < n.end(0) ? t.end(0) : n.end(0)]]) : n; this.seekable_ && this.seekable_.length && this.seekable_.end(0) === f && this.seekable_.start(0) === e || (this.logger_("seekable updated [" + fy(this.seekable_) + "]"), this.tech_.trigger("seekablechanged")) } } }, { key: "updateDuration", value: function () { function r() { n.logger_("Setting duration from " + n.mediaSource.duration + " => " + t); try { n.mediaSource.duration = t } catch (r) { i.log.warn("Failed to set media source duration", r) } n.tech_.trigger("durationchange"); n.mediaSource.removeEventListener("sourceopen", r) } var n = this, f = this.mediaSource.duration, t = nr.Playlist.duration(this.masterPlaylistLoader_.media()), u = this.tech_.buffered(); 0 < u.length && (t = Math.max(t, u.end(u.length - 1))); f !== t && ("open" !== this.mediaSource.readyState ? this.mediaSource.addEventListener("sourceopen", r) : r()) } }, { key: "dispose", value: function () { var n = this; this.decrypter_.terminate(); this.masterPlaylistLoader_.dispose(); this.mainSegmentLoader_.dispose();["AUDIO", "SUBTITLES"].forEach(function (t) { var i = n.mediaTypes_[t].groups; for (var r in i) i[r].forEach(function (n) { n.playlistLoader && n.playlistLoader.dispose() }) }); this.audioSegmentLoader_.dispose(); this.subtitleSegmentLoader_.dispose() } }, { key: "master", value: function () { return this.masterPlaylistLoader_.master } }, { key: "media", value: function () { return this.masterPlaylistLoader_.media() || this.initialMedia_ } }, { key: "setupSourceBuffers_", value: function () { var t, n = this.masterPlaylistLoader_.media(); if (n && "open" === this.mediaSource.readyState) { if ((t = dht(this.masterPlaylistLoader_.master, n)).length < 1) return this.error = "No compatible SourceBuffer configuration for the variant stream:" + n.resolvedUri, this.mediaSource.endOfStream("decode"); this.configureLoaderMimeTypes_(t); this.excludeIncompatibleVariants_(n) } } }, { key: "configureLoaderMimeTypes_", value: function (n) { var t = 1 < n.length && -1 === n[0].indexOf(",") && n[0] !== n[1] ? new i.EventTarget : null; this.mainSegmentLoader_.mimeType(n[0], t); n[1] && this.audioSegmentLoader_.mimeType(n[1], t) } }, { key: "excludeUnsupportedVariants_", value: function () { this.master().playlists.forEach(function (t) { t.attributes.CODECS && n.MediaSource && n.MediaSource.isTypeSupported && !n.MediaSource.isTypeSupported('video/mp4; codecs="' + function (n) { return n.replace(/avc1\.(\d+)\.(\d+)/i, function (n) { return dit([n])[0] }) }(t.attributes.CODECS) + '"') && (t.excludeUntil = 1 / 0) }) } }, { key: "excludeIncompatibleVariants_", value: function (n) { var i = 2, r = null, t = void 0; n.attributes.CODECS && (t = be(n.attributes.CODECS), r = t.videoCodec, i = t.codecCount); this.master().playlists.forEach(function (n) { var t = { codecCount: 2, videoCodec: null }; n.attributes.CODECS && (t = be(n.attributes.CODECS)); t.codecCount !== i && (n.excludeUntil = 1 / 0); t.videoCodec !== r && (n.excludeUntil = 1 / 0) }) } }, { key: "updateAdCues_", value: function (t) { var i = 0, r = this.seekable(); r.length && (i = r.start(0)), function (t, i, r) { var a = 2 < arguments.length && void 0 !== r ? r : 0, e, h, c, l, s; if (t.segments) for (var u = a, f = void 0, o = 0; o < t.segments.length; o++) { if (e = t.segments[o], f = f || uct(i, u + e.duration / 2)) { if ("cueIn" in e) { f.endTime = u; f.adEndTime = u; u += e.duration; f = null; continue } if (u < f.endTime) { u += e.duration; continue } f.endTime += e.duration } else ("cueOut" in e && ((f = new n.VTTCue(u, u + e.duration, e.cueOut)).adStartTime = u, f.adEndTime = u + parseFloat(e.cueOut), i.addCue(f)), "cueOutCont" in e) && (l = e.cueOutCont.split("/").map(parseFloat), s = eht(l, 2), h = s[0], c = s[1], (f = new n.VTTCue(u, u + e.duration, "")).adStartTime = u - h, f.adEndTime = f.adStartTime + c, i.addCue(f)); u += e.duration } }(t, this.cueTagsTrack_, i) } }, { key: "goalBufferLength", value: function () { var t = this.tech_.currentTime(), n = bt.GOAL_BUFFER_LENGTH, i = bt.GOAL_BUFFER_LENGTH_RATE, r = Math.max(n, bt.MAX_GOAL_BUFFER_LENGTH); return Math.min(n + t * i, r) } }, { key: "bufferLowWaterLine", value: function () { var t = this.tech_.currentTime(), n = bt.BUFFER_LOW_WATER_LINE, i = bt.BUFFER_LOW_WATER_LINE_RATE, r = Math.max(n, bt.MAX_BUFFER_LOW_WATER_LINE); return Math.min(n + t * i, r) } }]), cf); return np = ["seeking", "seeked", "pause", "playing", "error"], krt = (ri(tp, [{ key: "monitorCurrentTime_", value: function () { this.checkCurrentTime_(); this.checkCurrentTimeTimeout_ && n.clearTimeout(this.checkCurrentTimeTimeout_); this.checkCurrentTimeTimeout_ = n.setTimeout(this.monitorCurrentTime_.bind(this), 250) } }, { key: "checkCurrentTime_", value: function () { if (this.tech_.seeking() && this.fixesBadSeeks_()) return this.consecutiveUpdates = 0, void (this.lastRecordedTime = this.tech_.currentTime()); if (!this.tech_.paused() && !this.tech_.seeking()) { var n = this.tech_.currentTime(), t = this.tech_.buffered(); if (this.lastRecordedTime === n && (!t.length || n + .1 >= t.end(t.length - 1))) return this.techWaiting_(); 5 <= this.consecutiveUpdates && n === this.lastRecordedTime ? (this.consecutiveUpdates++, this.waiting_()) : n === this.lastRecordedTime ? this.consecutiveUpdates++ : (this.consecutiveUpdates = 0, this.lastRecordedTime = n) } } }, { key: "cancelTimer_", value: function () { this.consecutiveUpdates = 0; this.timer_ && (this.logger_("cancelTimer_"), clearTimeout(this.timer_)); this.timer_ = null } }, { key: "fixesBadSeeks_", value: function () { if (!this.tech_.seeking()) return !1; var n = this.seekable(), i = this.tech_.currentTime(), t = void 0; return this.afterSeekableWindow_(n, i, this.media(), this.allowSeeksWithinUnsafeLiveWindow) && (t = n.end(n.length - 1)), this.beforeSeekableWindow_(n, i) && (t = n.start(0) + .1), "undefined" != typeof t && (this.logger_("Trying to seek outside of seekable at time " + i + " with seekable range " + fy(n) + ". Seeking to " + t + "."), this.seekTo(t), !0) } }, { key: "waiting_", value: function () { if (!this.techWaiting_()) { var n = this.tech_.currentTime(), i = this.tech_.buffered(), t = ait(i, n); return t.length && n + 3 <= t.end(0) ? (this.cancelTimer_(), this.seekTo(n), this.logger_("Stopped at " + n + " while inside a buffered region [" + t.start(0) + " -> " + t.end(0) + "]. Attempting to resume playback by seeking to the current time."), void this.tech_.trigger({ type: "usage", name: "hls-unknown-waiting" })) : void 0 } } }, { key: "techWaiting_", value: function () { var i = this.seekable(), n = this.tech_.currentTime(), r, u, t, f; return this.tech_.seeking() && this.fixesBadSeeks_() ? !0 : this.tech_.seeking() || null !== this.timer_ ? !0 : this.beforeSeekableWindow_(i, n) ? (r = i.end(i.length - 1), this.logger_("Fell out of live window at time " + n + ". Seeking to live point (seekable end) " + r), this.cancelTimer_(), this.seekTo(r), this.tech_.trigger({ type: "usage", name: "hls-live-resync" }), !0) : (u = this.tech_.buffered(), t = vit(u, n), this.videoUnderflow_(t, u, n)) ? (this.cancelTimer_(), this.seekTo(n), this.tech_.trigger({ type: "usage", name: "hls-video-underflow" }), !0) : 0 < t.length ? (f = t.start(0) - n, this.logger_("Stopped at " + n + ", setting timer for " + f + ", seeking to " + t.start(0)), this.timer_ = setTimeout(this.skipTheGap_.bind(this), 1e3 * f, n), !0) : !1 } }, { key: "afterSeekableWindow_", value: function (n, t, i, r) { var f = 3 < arguments.length && void 0 !== r && r, u; return n.length ? (u = n.end(n.length - 1) + .1, !i.endList && f && (u = n.end(n.length - 1) + 3 * i.targetDuration), u < t) : !1 } }, { key: "beforeSeekableWindow_", value: function (n, t) { return !!(n.length && 0 < n.start(0) && t < n.start(0) - .1) } }, { key: "videoUnderflow_", value: function (n, t, i) { if (0 === n.length) { var r = this.gapFromVideoUnderflow_(t, i); if (r) return this.logger_("Encountered a gap in video from " + r.start + " to " + r.end + ". Seeking to current time " + i), !0 } return !1 } }, { key: "skipTheGap_", value: function (n) { var r = this.tech_.buffered(), t = this.tech_.currentTime(), i = vit(r, t); this.cancelTimer_(); 0 !== i.length && t === n && (this.logger_("skipTheGap_:", "currentTime:", t, "scheduled currentTime:", n, "nextRange start:", i.start(0)), this.seekTo(i.start(0) + 1 / 30), this.tech_.trigger({ type: "usage", name: "hls-gap-skip" })) } }, { key: "gapFromVideoUnderflow_", value: function (n, t) { for (var f, e, u = function (n) { var r, t, u, f; if (n.length < 2) return i.createTimeRanges(); for (r = [], t = 1; t < n.length; t++)u = n.end(t - 1), f = n.start(t), r.push([u, f]); return i.createTimeRanges(r) }(n), r = 0; r < u.length; r++)if (f = u.start(r), e = u.end(r), t - f < 4 && 2 < t - f) return { start: f, end: e }; return null } }]), tp), grt = { errorInterval: 30, getSource: function (n) { return n(this.tech({ IWillNotUseThisInPlugins: !0 }).currentSource_) } }, i.use("*", function (n) { return { setSource: function (n, t) { t(null, n) }, setCurrentTime: function (t) { return n.vhs && n.currentSource().src === n.vhs.source_.src && n.vhs.setCurrentTime(t), t }, play: function () { n.vhs && n.currentSource().src === n.vhs.source_.src && n.vhs.setCurrentTime(n.tech_.currentTime()) } } }), ct = { PlaylistLoader: lh, Playlist: vt, Decrypter: ytt, AsyncStream: gv, decrypt: vtt, utils: wht, STANDARD_PLAYLIST_SELECTOR: function () { return function (t, i, r, u, f) { var e = t.playlists.map(function (t) { var i, r; return i = t.attributes.RESOLUTION && t.attributes.RESOLUTION.width, r = t.attributes.RESOLUTION && t.attributes.RESOLUTION.height, { bandwidth: t.attributes.BANDWIDTH || n.Number.MAX_VALUE, width: i, height: r, playlist: t } }), o, v, c, l, p; ge(e, function (n, t) { return n.bandwidth - t.bandwidth }); o = (e = e.filter(function (n) { return !vt.isIncompatible(n.playlist) })).filter(function (n) { return vt.isEnabled(n.playlist) }); o.length || (o = e.filter(function (n) { return !vt.isDisabled(n.playlist) })); var h = o.filter(function (n) { return n.bandwidth * bt.BANDWIDTH_VARIANCE < i }), s = h[h.length - 1], w = h.filter(function (n) { return n.bandwidth === s.bandwidth })[0]; if (!1 === f) return v = w || o[0] || e[0], v ? v.playlist : null; c = h.filter(function (n) { return n.width && n.height }); ge(c, function (n, t) { return n.width - t.width }); l = c.filter(function (n) { return n.width === r && n.height === u }); s = l[l.length - 1]; var b = l.filter(function (n) { return n.bandwidth === s.bandwidth })[0], y = void 0, a = void 0, k = void 0; return b || (a = (y = c.filter(function (n) { return n.width > r || n.height > u })).filter(function (n) { return n.width === y[0].width && n.height === y[0].height }), s = a[a.length - 1], k = a.filter(function (n) { return n.bandwidth === s.bandwidth })[0]), p = k || b || w || o[0] || e[0], p ? p.playlist : null }(this.playlists.master, this.systemBandwidth, parseInt(srt(this.tech_.el(), "width"), 10), parseInt(srt(this.tech_.el(), "height"), 10), this.limitRenditionByPlayerDimensions) }, INITIAL_PLAYLIST_SELECTOR: function () { var n = this.playlists.master.playlists.filter(vt.isEnabled); return ge(n, function (n, t) { return ky(n, t) }), n.filter(function (n) { return be(n.attributes.CODECS).videoCodec })[0] || null }, comparePlaylistBandwidth: ky, comparePlaylistResolution: function (t, i) { var r = void 0, u = void 0; return t.attributes.RESOLUTION && t.attributes.RESOLUTION.width && (r = t.attributes.RESOLUTION.width), r = r || n.Number.MAX_VALUE, i.attributes.RESOLUTION && i.attributes.RESOLUTION.width && (u = i.attributes.RESOLUTION.width), r === (u = u || n.Number.MAX_VALUE) && t.attributes.BANDWIDTH && i.attributes.BANDWIDTH ? t.attributes.BANDWIDTH - i.attributes.BANDWIDTH : r - u }, xhr: eit() }, ["GOAL_BUFFER_LENGTH", "MAX_GOAL_BUFFER_LENGTH", "GOAL_BUFFER_LENGTH_RATE", "BUFFER_LOW_WATER_LINE", "MAX_BUFFER_LOW_WATER_LINE", "BUFFER_LOW_WATER_LINE_RATE", "BANDWIDTH_VARIANCE"].forEach(function (n) { Object.defineProperty(ct, n, { get: function () { return i.log.warn("using Hls." + n + " is UNSAFE be sure you know what you are doing"), bt[n] }, set: function (t) { i.log.warn("using Hls." + n + " is UNSAFE be sure you know what you are doing"); "number" != typeof t || t < 0 ? i.log.warn("value of Hls." + n + " must be greater than or equal to 0") : bt[n] = t } }) }), ip = "videojs-vhs", ct.canPlaySource = function () { return i.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.") }, ct.supportsNativeHls = function () { var n = t.createElement("video"); return i.getTech("Html5").isSupported() ? ["application/vnd.apple.mpegurl", "audio/mpegurl", "audio/x-mpegurl", "application/x-mpegurl", "video/x-mpegurl", "video/mpegurl", "application/mpegurl"].some(function (t) { return /maybe|probably/i.test(n.canPlayType(t)) }) : !1 }(), ct.supportsNativeDash = !!i.getTech("Html5").isSupported() && /maybe|probably/i.test(t.createElement("video").canPlayType("application/dash+xml")), ct.supportsTypeNatively = function (n) { return "hls" === n ? ct.supportsNativeHls : "dash" === n && ct.supportsNativeDash }, ct.isSupported = function () { return i.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.") }, rut = i.getComponent("Component"), rp = (ai(tr, rut), ri(tr, [{ key: "setOptions_", value: function () { var t = this, n; (this.options_.withCredentials = this.options_.withCredentials || !1, this.options_.handleManifestRedirects = this.options_.handleManifestRedirects || !1, this.options_.limitRenditionByPlayerDimensions = !1 !== this.options_.limitRenditionByPlayerDimensions, this.options_.smoothQualityChange = this.options_.smoothQualityChange || !1, this.options_.useBandwidthFromLocalStorage = "undefined" != typeof this.source_.useBandwidthFromLocalStorage ? this.source_.useBandwidthFromLocalStorage : this.options_.useBandwidthFromLocalStorage || !1, this.options_.customTagParsers = this.options_.customTagParsers || [], this.options_.customTagMappers = this.options_.customTagMappers || [], this.options_.cacheEncryptionKeys = this.options_.cacheEncryptionKeys || !1, "number" != typeof this.options_.blacklistDuration && (this.options_.blacklistDuration = 300), "number" != typeof this.options_.bandwidth && this.options_.useBandwidthFromLocalStorage) && (n = iut(), n && n.bandwidth && (this.options_.bandwidth = n.bandwidth, this.tech_.trigger({ type: "usage", name: "hls-bandwidth-from-local-storage" })), n && n.throughput && (this.options_.throughput = n.throughput, this.tech_.trigger({ type: "usage", name: "hls-throughput-from-local-storage" }))); "number" != typeof this.options_.bandwidth && (this.options_.bandwidth = bt.INITIAL_BANDWIDTH); this.options_.enableLowInitialPlaylist = this.options_.enableLowInitialPlaylist && this.options_.bandwidth === bt.INITIAL_BANDWIDTH;["withCredentials", "limitRenditionByPlayerDimensions", "bandwidth", "smoothQualityChange", "customTagParsers", "customTagMappers", "handleManifestRedirects", "cacheEncryptionKeys"].forEach(function (n) { "undefined" != typeof t.source_[n] && (t.options_[n] = t.source_[n]) }); this.limitRenditionByPlayerDimensions = this.options_.limitRenditionByPlayerDimensions } }, { key: "src", value: function (n, t) { var r = this; n && (this.setOptions_(), this.options_.url = this.source_.src, this.options_.tech = this.tech_, this.options_.externHls = ct, this.options_.sourceType = nut(t), this.options_.seekTo = function (n) { r.tech_.setCurrentTime(n); r.setCurrentTime(n) }, this.masterPlaylistController_ = new act(this.options_), this.playbackWatcher_ = new krt(i.mergeOptions(this.options_, { seekable: function () { return r.seekable() }, media: function () { return r.masterPlaylistController_.media() } })), this.masterPlaylistController_.on("error", function () { i.players[r.tech_.options_.playerId].error(r.masterPlaylistController_.error) }), this.masterPlaylistController_.selectPlaylist = this.selectPlaylist ? this.selectPlaylist.bind(this) : ct.STANDARD_PLAYLIST_SELECTOR.bind(this), this.masterPlaylistController_.selectInitialPlaylist = ct.INITIAL_PLAYLIST_SELECTOR.bind(this), this.playlists = this.masterPlaylistController_.masterPlaylistLoader_, this.mediaSource = this.masterPlaylistController_.mediaSource, Object.defineProperties(this, { selectPlaylist: { get: function () { return this.masterPlaylistController_.selectPlaylist }, set: function (n) { this.masterPlaylistController_.selectPlaylist = n.bind(this) } }, throughput: { get: function () { return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate }, set: function (n) { this.masterPlaylistController_.mainSegmentLoader_.throughput.rate = n; this.masterPlaylistController_.mainSegmentLoader_.throughput.count = 1 } }, bandwidth: { get: function () { return this.masterPlaylistController_.mainSegmentLoader_.bandwidth }, set: function (n) { this.masterPlaylistController_.mainSegmentLoader_.bandwidth = n; this.masterPlaylistController_.mainSegmentLoader_.throughput = { rate: 0, count: 0 } } }, systemBandwidth: { get: function () { var t = 1 / (this.bandwidth || 1), n = void 0; return n = 0 < this.throughput ? 1 / this.throughput : 0, Math.floor(1 / (t + n)) }, set: function () { i.log.error('The "systemBandwidth" property is read-only') } } }), this.options_.bandwidth && (this.bandwidth = this.options_.bandwidth), this.options_.throughput && (this.throughput = this.options_.throughput), Object.defineProperties(this.stats, { bandwidth: { get: function () { return r.bandwidth || 0 }, enumerable: !0 }, mediaRequests: { get: function () { return r.masterPlaylistController_.mediaRequests_() || 0 }, enumerable: !0 }, mediaRequestsAborted: { get: function () { return r.masterPlaylistController_.mediaRequestsAborted_() || 0 }, enumerable: !0 }, mediaRequestsTimedout: { get: function () { return r.masterPlaylistController_.mediaRequestsTimedout_() || 0 }, enumerable: !0 }, mediaRequestsErrored: { get: function () { return r.masterPlaylistController_.mediaRequestsErrored_() || 0 }, enumerable: !0 }, mediaTransferDuration: { get: function () { return r.masterPlaylistController_.mediaTransferDuration_() || 0 }, enumerable: !0 }, mediaBytesTransferred: { get: function () { return r.masterPlaylistController_.mediaBytesTransferred_() || 0 }, enumerable: !0 }, mediaSecondsLoaded: { get: function () { return r.masterPlaylistController_.mediaSecondsLoaded_() || 0 }, enumerable: !0 }, buffered: { get: function () { return yit(r.tech_.buffered()) }, enumerable: !0 }, currentTime: { get: function () { return r.tech_.currentTime() }, enumerable: !0 }, currentSource: { get: function () { return r.tech_.currentSource_ }, enumerable: !0 }, currentTech: { get: function () { return r.tech_.name_ }, enumerable: !0 }, duration: { get: function () { return r.tech_.duration() }, enumerable: !0 }, master: { get: function () { return r.playlists.master }, enumerable: !0 }, playerDimensions: { get: function () { return r.tech_.currentDimensions() }, enumerable: !0 }, seekable: { get: function () { return yit(r.tech_.seekable()) }, enumerable: !0 }, timestamp: { get: function () { return Date.now() }, enumerable: !0 }, videoPlaybackQuality: { get: function () { return r.tech_.getVideoPlaybackQuality() }, enumerable: !0 } }), this.tech_.one("canplay", this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)), this.tech_.on("bandwidthupdate", function () { r.options_.useBandwidthFromLocalStorage && function (n) { if (window.localStorage) { var t = iut(); t = t ? i.mergeOptions(t, n) : n; try { window.localStorage.setItem(ip, JSON.stringify(t)) } catch (n) { return } } }({ bandwidth: r.bandwidth, throughput: Math.round(r.throughput) }) }), this.masterPlaylistController_.on("selectedinitialmedia", function () { !function (n) { var t = n.playlists; n.representations = function () { return t.master.playlists.filter(function (n) { return !iy(n) }).map(function (t) { return new brt(n, t, t.uri) }) } }(r); vct(r) }), this.on(this.masterPlaylistController_, "progress", function () { this.tech_.trigger("progress") }), this.tech_.ready(function () { return r.setupQualityLevels_() }), this.tech_.el() && this.tech_.src(i.URL.createObjectURL(this.masterPlaylistController_.mediaSource))) } }, { key: "setupQualityLevels_", value: function () { var n = this, t = i.players[this.tech_.options_.playerId]; t && t.qualityLevels && (this.qualityLevels_ = t.qualityLevels(), this.masterPlaylistController_.on("selectedinitialmedia", function () { !function (n, t) { t.representations().forEach(function (t) { n.addQualityLevel(t) }); tut(n, t.playlists) }(n.qualityLevels_, n) }), this.playlists.on("mediachange", function () { tut(n.qualityLevels_, n.playlists) })) } }, { key: "play", value: function () { this.masterPlaylistController_.play() } }, { key: "setCurrentTime", value: function (n) { this.masterPlaylistController_.setCurrentTime(n) } }, { key: "duration", value: function () { return this.masterPlaylistController_.duration() } }, { key: "seekable", value: function () { return this.masterPlaylistController_.seekable() } }, { key: "dispose", value: function () { this.playbackWatcher_ && this.playbackWatcher_.dispose(); this.masterPlaylistController_ && this.masterPlaylistController_.dispose(); this.qualityLevels_ && this.qualityLevels_.dispose(); this.player_ && (delete this.player_.vhs, delete this.player_.dash, delete this.player_.hls); this.tech_ && this.tech_.hls && delete this.tech_.hls, function n(t, i, r) { var u, f, e; return (null === t && (t = Function.prototype), u = Object.getOwnPropertyDescriptor(t, i), void 0 === u) ? (f = Object.getPrototypeOf(t), null === f ? void 0 : n(f, i, r)) : "value" in u ? u.value : (e = u.get, void 0 !== e ? e.call(r) : void 0) }(tr.prototype.__proto__ || Object.getPrototypeOf(tr.prototype), "dispose", this).call(this) } }, { key: "convertToProgramTime", value: function (n, t) { return cht({ playlist: this.masterPlaylistController_.media(), time: n, callback: t }) } }, { key: "seekToProgramTime", value: function (n, t, i, r) { var u = !(2 < arguments.length && void 0 !== i) || i, f = 3 < arguments.length && void 0 !== r ? r : 2; return cit({ programTime: n, playlist: this.masterPlaylistController_.media(), retryCount: f, pauseAfterSeek: u, seekTo: this.options_.seekTo, tech: this.options_.tech, callback: t }) } }]), tr), dh = { name: "videojs-http-streaming", VERSION: "1.10.6", canHandleSource: function (n, t) { var r = i.mergeOptions(i.options, 1 < arguments.length && void 0 !== t ? t : {}); return dh.canPlayType(n.type, r) }, handleSource: function (n, t, r) { var u = i.mergeOptions(i.options, 2 < arguments.length && void 0 !== r ? r : {}); return t.hls = new rp(n, t, u), t.hls.xhr = eit(), t.hls.src(n.src, n.type), t.hls }, canPlayType: function (n, t) { var u = i.mergeOptions(i.options, 1 < arguments.length && void 0 !== t ? t : {}).hls.overrideNative, r = nut(n); return r && (!ct.supportsTypeNatively(r) || u) ? "maybe" : "" } }, "undefined" != typeof i.MediaSource && "undefined" != typeof i.URL || (i.MediaSource = ke, i.URL = vy), ke.supportsNativeMediaSources() && i.getTech("Html5").registerSourceHandler(dh, 0), i.HlsHandler = rp, i.HlsSourceHandler = dh, i.Hls = ct, i.use || i.registerComponent("Hls", ct), i.options.hls = i.options.hls || {}, i.registerPlugin ? i.registerPlugin("reloadSourceOnError", drt) : i.plugin("reloadSourceOnError", drt), i
}), function (n) { typeof module == "object" && typeof module.exports == "object" ? module.exports = function (t) { n(t, window, document) } : n(jQuery, window, document) }(function (n, t, i) { function f(n, t) { t = t || {}; n._options.elementContainer = t.elementContainer || "div"; var i = t.classNames || {}; n._options.classNameSeconds = i.seconds || "jst-seconds"; n._options.classNameMinutes = i.minutes || "jst-minutes"; n._options.classNameHours = i.hours || "jst-hours"; n._options.classNameClearDiv = i.clearDiv || "jst-clearDiv"; n._options.classNameTimeout = i.timeout || "jst-timeout" } Number.isFinite = Number.isFinite || function (n) { return typeof n == "number" && isFinite(n) }; var u, r = function (n) { return this._options = {}, this.targetElement = n, this }; r.start = function (n, t) { return u = new r(t), f(u, n), u.start(n) }; r.prototype.start = function (t) { var r = this, f = function (n) { var e = i.createElement(r._options.elementContainer), t, u, f; return e.className = r._options.classNameSeconds, t = i.createElement(r._options.elementContainer), t.className = r._options.classNameMinutes, u = i.createElement(r._options.elementContainer), u.className = r._options.classNameHours, f = i.createElement(r._options.elementContainer), f.className = r._options.classNameClearDiv, n.append(u).append(t).append(e).append(f) }; this.targetElement.each(function (i, r) { var o = this, e = n(r), s = e.attr("class"); e.on("complete", function () { clearInterval(e.intervalId) }); e.on("complete", function () { e.onComplete(e) }); e.on("complete", function () { e.addClass(o._options.classNameTimeout) }); e.on("complete", function () { t && t.loop === !0 && u.resetTimer(e, t, s) }); e.on("pause", function () { clearInterval(e.intervalId); e.paused = !0 }); e.on("resume", function () { e.paused = !1; o.startCountdown(e, { secondsLeft: e.data("timeLeft") }) }); return f(e), this.startCountdown(e, t) }.bind(this)) }; r.prototype.resetTimer = function (n, t, i) { var r = 0; t.loopInterval && (r = parseInt(t.loopInterval, 10) * 1e3); setTimeout(function () { n.trigger("reset"); n.attr("class", i + " loop"); u.startCountdown(n, t) }, r) }; r.prototype.fetchSecondsLeft = function (n) { var t = n.data("seconds-left"), i = n.data("minutes-left"); if (Number.isFinite(t)) return parseInt(t, 10); if (Number.isFinite(i)) return parseFloat(i) * 60; throw "Missing time data"; }; r.prototype.startCountdown = function (n, t) { var r, u; if (t = t || {}, r = null, u = function () { return clearInterval(r), this.clearTimer(n) }.bind(this), n.onComplete = t.onComplete || u, n.allowPause = t.allowPause || !1, n.allowPause) n.on("click", function () { n.paused ? n.trigger("resume") : n.trigger("pause") }); var e = t.secondsLeft || this.fetchSecondsLeft(n), o = t.refreshRate || 1e3, f = e + this.currentTime(), i = f - this.currentTime(); this.setFinalValue(this.formatTimeLeft(i), n); r = setInterval(function () { i = f - this.currentTime(); i < 0 && (i = 0); n.data("timeLeft", i); this.setFinalValue(this.formatTimeLeft(i), n) }.bind(this), o); n.intervalId = r }; r.prototype.clearTimer = function (n) { n.find(".jst-seconds").text("00"); n.find(".jst-minutes").text("00:"); n.find(".jst-hours").text("00:") }; r.prototype.currentTime = function () { return Math.round((new Date).getTime() / 1e3) }; r.prototype.formatTimeLeft = function (n) { var i = function (n, t) { return t = t || 2, n = n + "", n.length >= t ? n : Array(t - n.length + 1).join(0) + n }, r = Math.floor(n / 3600), t, u; return n -= r * 3600, t = Math.floor(n / 60), n -= t * 60, u = parseInt(n % 60, 10), +r == 0 && +t == 0 && +u == 0 ? [] : [i(r), i(t), i(u)] }; r.prototype.setFinalValue = function (n, t) { if (n.length === 0) return this.clearTimer(t), t.trigger("complete"), !1; t.find("." + this._options.classNameSeconds).text(n.pop()); t.find("." + this._options.classNameMinutes).text(n.pop() + ":"); t.find("." + this._options.classNameHours).text(n.pop() + ":") }; n.fn.startTimer = function (n) { return this.TimerObject = r, r.start(n, this), this } }); Players = []; currentCommentPageId = 0; $(window).ready(function () { $(".view-Live").bind("touchstart", function () { $(".video-items-layer .video-item .video-Live-layer").css("display", "none"); $(".video-items-layer .video-item .video-Live-layer").empty(); $(this).parents().closest(".video-item").find(".video-Live-layer").fadeIn("fast"); var n = $(this).parents().closest(".video-item").find(".video-Live-layer").attr("id"), t = $(this).parents().closest(".video-item").find(".video-Live-layer").attr("episodeId"); LoadVideoForShowLive(t, n) }); $(document).on("click", ".video-items-layer .video-item > .view-Live", function () { $(".video-items-layer .video-item .video-Live-layer").css("display", "none"); $(".video-items-layer .video-item .video-Live-layer").empty(); $(this).parents().closest(".video-item").find(".video-Live-layer").fadeIn("fast"); var n = $(this).parents().closest(".video-item").find(".video-Live-layer").attr("id"), t = $(this).parents().closest(".video-item").find(".video-Live-layer").attr("episodeId"); LoadVideoForShowLive(t, n) }); scrollForEpisode(); initVideoPlayer(); setCourseId(); loadComments() }); i = 0; $(window).bind("beforeunload", function () { SendCurrentTimeToServer() }); $(".timer").startTimer({ elementContainer: "i", onComplete: function () { location.reload() } });